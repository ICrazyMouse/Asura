mini={components:{},globalOpts:{},uids:{},ux:{},isReady:false,byClass:function(e,t){if(typeof t=="string")t=mini.byId(t);return jQuery("."+e,t)[0]},getComponents:function(){var e=[];for(var t in mini.components){var i=mini.components[t];e.push(i)}return e},get:function(e){if(!e)return null;if(mini.isControl(e))return e;if(typeof e=="string"){if(e.charAt(0)=="#")e=e.substr(1)}if(typeof e=="string")return mini.components[e];else{var t=mini.uids[e.uid];if(t&&t.el==e)return t}return null},getbyUID:function(e){return mini.uids[e]},findControls:function(e,t){if(!e)return[];t=t||mini;var i=[];var n=mini.uids;for(var s in n){var r=n[s];var l=e.call(t,r);if(l===true||l===1){i.push(r);if(l===1)break}}return i},getChildControls:function(e){var t=mini.get(e);if(!t)return[];var i=e.el?e.el:e;var n=mini.findControls(function(t){if(!t.el||e==t)return false;if(mini.isAncestor(i,t.el)&&t.within)return true;return false});return n},emptyFn:function(){},createNameControls:function(e,t){if(!e||!e.el)return;if(!t)t="_";var i=e.el;var n=mini.findControls(function(e){if(!e.el||!e.name)return false;if(mini.isAncestor(i,e.el))return true;return false});for(var s=0,r=n.length;s<r;s++){var l=n[s];var o=t+l.name;if(t===true){o=l.name[0].toUpperCase()+l.name.substring(1,l.name.length)}e[o]=l}},getbyName:function(e,t){var i=mini.isControl(t);var n=t;if(t&&i){t=t.el}t=mini.byId(t);t=t||document.body;var s=this.findControls(function(i){if(!i.el)return false;if(i.name==e&&mini.isAncestor(t,i.el))return 1;return false},this);if(i&&s.length==0&&n&&n.getbyName){return n.getbyName(e)}return s[0]},getParams:function(e){if(!e)e=location.href;e=e.split("?")[1];var t={};if(e){var i=e.split("&");for(var n=0,s=i.length;n<s;n++){var r=i[n].split("=");try{t[r[0]]=decodeURIComponent(unescape(r[1]))}catch(l){}}}return t},reg:function(e){this.components[e.id]=e;this.uids[e.uid]=e},unreg:function(e){delete mini.components[e.id];delete mini.uids[e.uid]},classes:{},uiClasses:{},getClass:function(e){if(!e)return null;return this.classes[e.toLowerCase()]},getClassByUICls:function(e){return this.uiClasses[e.toLowerCase()]},idPre:"mini-",idIndex:1,newId:function(e){return(e||this.idPre)+this.idIndex++},copyTo:function(e,t){if(e&&t){for(var i in t){e[i]=t[i]}}return e},copyIf:function(e,t){if(e&&t){for(var i in t){if(mini.isNull(e[i])){e[i]=t[i]}}}return e},createDelegate:function(e,t){if(!e)return function(){};return function(){return e.apply(t,arguments)}},isControl:function(e){return!!(e&&e.isControl)},isElement:function(e){return e&&e.appendChild},isDate:function(e){return!!(e&&e.getFullYear)},isArray:function(e){return!!(e&&!!e.unshift)},isNull:function(e){return e===null||e===undefined},isNumber:function(e){return!isNaN(e)&&typeof e=="number"},isEquals:function(e,t){if(e!==0&&t!==0){if((mini.isNull(e)||e=="")&&(mini.isNull(t)||t==""))return true}if(e&&t&&e.getFullYear&&t.getFullYear)return e.getTime()===t.getTime();if(typeof e=="object"&&typeof t=="object"){return mini.encode(e)==mini.encode(t)}return String(e)===String(t)},forEach:function(e,t,i){var n=e.clone();for(var s=0,r=n.length;s<r;s++){var l=n[s];if(t.call(i,l,s,e)===false)break}},sort:function(e,t,i){i=i||e;e.sort(t)},removeNode:function(e){jQuery(e).remove()},elWarp:document.createElement("div")};mini_regClass=function(e,t){t=t.toLowerCase();if(!mini.classes[t]){mini.classes[t]=e;e.prototype.type=t}var i=e.prototype.uiCls;if(!mini.isNull(i)&&!mini.uiClasses[i]){mini.uiClasses[i]=e}};mini_extend=function(e,t,i){if(typeof t!="function")return this;var n=e,s=n.prototype,r=t.prototype;if(n.superclass==r)return;n.superclass=r;n.superclass.constructor=t;for(var l in r){s[l]=r[l]}if(i){for(var l in i){s[l]=i[l]}}return n};mini.copyTo(mini,{extend:mini_extend,regClass:mini_regClass,debug:false});mini.namespace=function(e){if(typeof e!="string")return;e=e.split(".");var t=window;for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=t[s];if(!r){r=t[s]={}}t=r}};mini._getFunctoin=function(e){if(typeof e!="string")return null;var t=e.split(".");var i=null;for(var n=0,s=t.length;n<s;n++){var r=t[n];if(!i)i=window[r];else i=i[r];if(!i)break}return i};mini._getMap=function(name,obj){if(!name)return null;if(name.indexOf(".")==-1&&name.indexOf("[")==-1)return obj[name];var s="obj."+name;try{var v=eval(s)}catch(e){return null}return v};mini._setMap=function(e,t,i){if(!i)return;if(typeof e!="string")return;var n=e.split(".");function s(e,t,i,n){var s=e[t];if(!s){s=e[t]=[]}for(var r=0;r<=i;r++){var l=s[r];if(!l){if(n===null||n===undefined){l=s[r]={}}else{l=s[r]=n}}}return e[t][i]}var r=null;for(var l=0,o=n.length;l<=o-1;l++){var e=n[l];if(l==o-1){if(e.indexOf("]")==-1){i[e]=t}else{var a=e.split("[");var h=a[0],u=parseInt(a[1]);s(i,h,u,"");i[h][u]=t}break}if(e.indexOf("]")==-1){r=i[e];if(l<=o-2&&r==null){i[e]=r={}}i=r}else{var a=e.split("[");var h=a[0],u=parseInt(a[1]);i=s(i,h,u)}}return t};mini.getAndCreate=function(e){if(!e)return null;if(typeof e=="string")return mini.components[e];if(typeof e=="object"){if(mini.isControl(e)){return e}else if(mini.isElement(e)){return mini.uids[e.uid]}else{return mini.create(e)}}return null};mini.create=function(e){if(!e)return null;if(mini.get(e.id)===e)return e;var t=this.getClass(e.type);if(!t)return null;var i=new t;i.set(e);return i};__mini_setControls=function(e,t,i){t=t||this._contentEl;i=i||this;if(!e)e=[];if(!mini.isArray(e))e=[e];for(var n=0,s=e.length;n<s;n++){var r=e[n];if(typeof r=="string"){if(r.indexOf("#")==0)r=mini.byId(r)}else if(mini.isElement(r)){}else{r=mini.getAndCreate(r);r=r.el}if(!r)continue;mini.append(t,r)}mini.parse(t);i.doLayout();return i};mini._Layouts={};mini.layout=function(e,t){if(!document.body)return;function i(e){if(!e)return;var n=mini.get(e);if(n){if(n.doLayout){if(!mini._Layouts[n.uid]){mini._Layouts[n.uid]=n;if(t!==false||n.isFixedSize()==false){n.doLayout(false)}delete mini._Layouts[n.uid]}}}else{var s=e.childNodes;if(s){for(var r=0,l=s.length;r<l;r++){var o=s[r];i(o)}}}}if(!e)e=document.body;i(e);if(e==document.body){mini.layoutIFrames()}};mini.applyTo=function(e){e=mini.byId(e);if(!e)return this;if(mini.get(e))throw new Error("not applyTo a mini control");var t=this.getAttrs(e);delete t._applyTo;if(mini.isNull(t.defaultValue)&&!mini.isNull(t.value)){t.defaultValue=t.value}var i=e.parentNode;if(i&&this.el!=e){i.replaceChild(this.el,e)}this.set(t);this._afterApply(e);return this};mini._Removes=[];mini._ParseString=function(e,t,i){for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=mini.getAttr(e,r);if(l){t[r]=l}}};mini._ParseBool=function(e,t,i){for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=mini.getAttr(e,r);if(l){t[r]=l=="true"?true:false}}};mini._ParseInt=function(e,t,i){for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=parseInt(mini.getAttr(e,r));if(!isNaN(l)){t[r]=l}}};mini._ParseColumns=function(el){var columns=[];var cs=mini.getChildNodes(el);for(var i=0,l=cs.length;i<l;i++){var node=cs[i];var jq=jQuery(node);var column={};var editor=null,filter=null;var subCs=mini.getChildNodes(node);if(subCs){for(var ii=0,li=subCs.length;ii<li;ii++){var subNode=subCs[ii];var property=jQuery(subNode).attr("property");if(!property)continue;property=property.toLowerCase();if(property=="columns"){column.columns=mini._ParseColumns(subNode);jQuery(subNode).remove()}if(property=="editor"||property=="filter"){var className=subNode.className;var classes=className.split(" ");for(var i3=0,l3=classes.length;i3<l3;i3++){var cls=classes[i3];var clazz=mini.getClassByUICls(cls);if(clazz){var ui=new clazz;if(property=="filter"){filter=ui.getAttrs(subNode);filter.type=ui.type}else{editor=ui.getAttrs(subNode);editor.type=ui.type}break}}jQuery(subNode).remove()}}}column.header=node.innerHTML;mini._ParseString(node,column,["name","header","field","editor","filter","renderer","width","type","renderer","headerAlign","align","headerCls","cellCls","headerStyle","cellStyle","displayField","dateFormat","listFormat","mapFormat","trueValue","falseValue","dataType","vtype","currencyUnit","digit","summaryType","summaryRenderer","groupSummaryType","groupSummaryRenderer","defaultValue","defaultText","decimalPlaces","data-options","emptyText"]);mini._ParseBool(node,column,["visible","readOnly","allowSort","allowResize","allowMove","allowDrag","autoShowPopup","unique","showPercent","autoEscape"]);if(column.autoEscape===undefined)column.autoEscape=true;if(editor)column.editor=editor;if(filter)column.filter=filter;if(column.dataType)column.dataType=column.dataType.toLowerCase();if(column.defaultValue==="true")column.defaultValue=true;if(column.defaultValue==="false")column.defaultValue=false;columns.push(column);var options=column["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(column,options)}}}return columns};mini._topWindow=null;mini._getTopWindow=function(){if(mini._topWindow)return mini._topWindow;var e=[];function t(i){try{i["___try"]=1;e.push(i)}catch(n){}if(i.parent&&i.parent!=i){t(i.parent)}}t(window);mini._topWindow=e[e.length-1];return mini._topWindow};var __ps=mini.getParams();if(__ps._winid){try{window.Owner=mini._getTopWindow()[__ps._winid]}catch(ex){}}mini._WindowID="w"+Math.floor(Math.random()*1e4);mini._getTopWindow()[mini._WindowID]=window;mini.__IFrameCreateCount=1;mini.createIFrame=function(e,t){var i="__iframe_onload"+mini.__IFrameCreateCount++;window[i]=u;if(!e)e="";var n=e.split("#");e=n[0];var s="_t="+Math.floor(Math.random()*1e6);if(e.indexOf("?")==-1){e+="?"+s}else{e+="&"+s}if(n[1]){e=e+"#"+n[1]}var r='<iframe style="width:100%;height:100%;" onload="'+i+'()"  frameborder="0"></iframe>';var l=document.createElement("div");var o=mini.append(l,r);var a=false;setTimeout(function(){if(o){o.src=e;a=true}},5);var h=true;function u(){if(a==false)return;setTimeout(function(){if(t)t(o,h);h=false},1)}o._ondestroy=function(){window[i]=mini.emptyFn;o.onload=function(){};jQuery(o).unbind("load");o.src="";try{o.contentWindow.document.write("");o.contentWindow.document.close()}catch(e){}o._ondestroy=null;o=null};return o};mini._doOpen=function(e){if(typeof e=="string"){e={url:e}}e=mini.copyTo({width:700,height:400,allowResize:true,allowModal:true,closeAction:"destroy",title:"",titleIcon:"",iconCls:"",iconStyle:"",bodyStyle:"padding: 0",url:"",showCloseButton:true,showFooter:false},e);e.closeAction="destroy";var t=e.onload;delete e.onload;var i=e.ondestroy;delete e.ondestroy;var n=e.url;delete e.url;var s=new mini.Window;s.set(e);s.load(n,t,i);s.show();return s};mini.open=function(e){if(!e)return;var t=e.currentWindow;if(!t)t=false;var i=e.url;if(!i)i="";var n=i.split("#");var i=n[0];var s="_winid="+mini._WindowID;if(i.indexOf("?")==-1){i+="?"+s}else{i+="&"+s}if(n[1]){i=i+"#"+n[1]}var r=i.indexOf("http")!=-1;if(r){e.url=i}else{if(t)e.url=i;else{var l=document.getElementsByTagName("BASE");var o=l&&l.length?l[0].href:null;if(o){e.url=o+"/"+i}else{var a=i.substr(0,1);if(a=="/"){e.url=window.location.protocol+"//"+window.location.host+i}else{var h=location.href;var u=h.indexOf("?")!=-1;if(u)h=h.substring(0,h.indexOf("?"));var d=h.split("/");d.length=d.length-1;var c=d.join("/");e.url=c+"/"+i}}}}e.Owner=window;var f=[];function m(e){try{if(e.mini)f.push(e);if(e.parent&&e.parent!=e){m(e.parent)}}catch(t){}}m(window);var p=f[f.length-1];e.win=p;if(e.beforeopen){e.beforeopen(e)}if(t)return mini._doOpen(e);return p["mini"]._doOpen(e)};mini.openTop=mini.open;mini.getData=function(e,t,i,n,s){var r=mini.getText(e,t,i,n,s);var l=mini.decode(r);return l};mini.getText=function(e,t,i,n,s){var r=null;mini.ajax({url:e,data:t,async:false,type:s?s:"get",cache:false,success:function(e,t){r=e;if(i)i(e,t)},error:n});return r};mini.update=function(e,t){if(typeof e=="string")e={url:e};if(t)e.el=t;var i=mini.loadText(e.url);mini.innerHTML(e.el,i);mini.parse(e.el)};mini.createSingle=function(e){if(typeof e=="string"){e=mini.getClass(e)}if(typeof e!="function")return;var t=e.single;if(!t){t=e.single=new e}return t};mini.createTopSingle=function(e){if(typeof e!="function")return;var t=e.prototype.type;if(top&&top!=window&&top.mini&&top.mini.getClass(t)){return top.mini.createSingle(t)}else{return mini.createSingle(e)}};mini.sortTypes={string:function(e){return String(e).toUpperCase()},date:function(e){if(!e){return 0}if(mini.isDate(e)){return e.getTime()}return mini.parseDate(String(e))},"float":function(e){var t=parseFloat(String(e).replace(/,/g,""));return isNaN(t)?0:t},"int":function(e){var t=parseInt(String(e).replace(/,/g,""),10);return isNaN(t)?0:t},currency:function(e){var t=parseFloat(String(e).replace(/,/g,""));return isNaN(t)?0:t}};mini.emptyFn=function(){};mini.clone=function(e,t){if(e===null||e===undefined)return e;var i=mini.encode(e);var n=mini.decode(i);function s(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];delete n._state;delete n._id;delete n._pid;delete n._uid;for(var r in n){var l=n[r];if(l instanceof Array)s(l)}}}if(t!==false){s(n instanceof Array?n:[n])}return n};mini.append=function(e,t){e=mini.byId(e);if(!t||!e)return;if(typeof t=="string"){if(t.charAt(0)=="#"){t=mini.byId(t);if(!t)return;e.appendChild(t);return t}else{if(t.indexOf("<tr")==0){return jQuery(e).append(t)[0].lastChild}var i=document.createElement("div");i.innerHTML=t;t=i.firstChild;while(i.firstChild){e.appendChild(i.firstChild)}return t}}else{e.appendChild(t);return t}};mini.prepend=function(e,t){if(typeof t=="string"){if(t.charAt(0)=="#"){t=mini.byId(t)}else{var i=document.createElement("div");i.innerHTML=t;t=i.firstChild}}return jQuery(e).prepend(t)[0].firstChild};mini.after=function(e,t){if(typeof t=="string"){if(t.charAt(0)=="#"){t=mini.byId(t)}else{var i=document.createElement("div");i.innerHTML=t;t=i.firstChild}}if(!t||!e)return;e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t);return t};mini.before=function(e,t){if(typeof t=="string"){if(t.charAt(0)=="#"){t=mini.byId(t)}else{var i=document.createElement("div");i.innerHTML=t;t=i.firstChild}}if(!t||!e)return;e.parentNode.insertBefore(t,e);return t};mini.__wrap=document.createElement("div");mini.createElements=function(e){mini.removeChilds(mini.__wrap);var t=e.indexOf("<tr")==0;if(t){e="<table>"+e+"</table>"}mini.__wrap.innerHTML=e;return t?mini.__wrap.firstChild.rows:mini.__wrap.childNodes};mini_byId=function(e,t){if(typeof e=="string"){if(e.charAt(0)=="#")e=e.substr(1);var i=document.getElementById(e);if(i)return i;if(t){var n=t.getElementsByTagName("*");for(var s=0,r=n.length;s<r;s++){var i=n[s];if(i.id==e)return i}i=null}return i}else{return e}};mini_hasClass=function(e,t){e=mini.byId(e);if(!e)return;if(!e.className)return false;var i=String(e.className).split(" ");return i.indexOf(t)!=-1};mini_addClass=function(e,t){if(!t)return;if(mini.hasClass(e,t)==false){jQuery(e).addClass(t)}};mini_removeClass=function(e,t){if(!t)return;jQuery(e).removeClass(t)};mini_getMargins=function(e){e=mini.byId(e);var t=jQuery(e);return{top:parseInt(t.css("margin-top"),10)||0,left:parseInt(t.css("margin-left"),10)||0,bottom:parseInt(t.css("margin-bottom"),10)||0,right:parseInt(t.css("margin-right"),10)||0}};mini_getBorders=function(e){e=mini.byId(e);var t=jQuery(e);return{top:parseInt(t.css("border-top-width"),10)||0,left:parseInt(t.css("border-left-width"),10)||0,bottom:parseInt(t.css("border-bottom-width"),10)||0,right:parseInt(t.css("border-right-width"),10)||0}};mini_getPaddings=function(e){e=mini.byId(e);var t=jQuery(e);return{top:parseInt(t.css("padding-top"),10)||0,left:parseInt(t.css("padding-left"),10)||0,bottom:parseInt(t.css("padding-bottom"),10)||0,right:parseInt(t.css("padding-right"),10)||0}};mini_setWidth=function(e,t){e=mini.byId(e);t=parseInt(t);if(isNaN(t)||!e)return;if(jQuery.boxModel){var i=mini.getPaddings(e);var n=mini.getBorders(e);t=t-i.left-i.right-n.left-n.right}if(t<0)t=0;e.style.width=t+"px"};mini_setHeight=function(e,t){e=mini.byId(e);t=parseInt(t);if(isNaN(t)||!e)return;if(jQuery.boxModel){var i=mini.getPaddings(e);var n=mini.getBorders(e);t=t-i.top-i.bottom-n.top-n.bottom}if(t<0)t=0;e.style.height=t+"px"};mini_getWidth=function(e,t){e=mini.byId(e);if(e.style.display=="none"||e.type=="text/javascript")return 0;return t?jQuery(e).width():jQuery(e).outerWidth()};mini_getHeight=function(e,t){e=mini.byId(e);if(!jQuery(e).is(":visible")||e.type=="text/javascript")return 0;return t?jQuery(e).height():jQuery(e).outerHeight()};mini_setBox=function(e,t,i,n,s){if(i===undefined){i=t.y;n=t.width;s=t.height;t=t.x}mini.setXY(e,t,i);mini.setWidth(e,n);mini.setHeight(e,s)};mini_getBox=function(e){var t=mini.getXY(e);var i=mini.getWidth(e);var n=mini.getHeight(e);var s={x:t[0],y:t[1],width:i,height:n};s.left=s.x;s.top=s.y;s.right=s.x+s.width;s.bottom=s.y+s.height;return s};mini_setStyle=function(e,t){e=mini.byId(e);if(!e||typeof t!="string")return;var i=jQuery(e);var n=t.toLowerCase().split(";");for(var s=0,r=n.length;s<r;s++){var l=n[s];var o=l.split(":");if(o.length>1){if(o.length>2){var a=o[0].trim();o.removeAt(0);var h=o.join(":").trim();i.css(a,h)}else{i.css(o[0].trim(),o[1].trim())}}}};mini_getStyle=function(){var e=document.defaultView;return new Function("el","style",["style.indexOf('-')>-1 && (style=style.replace(/-(\\w)/g,function(m,a){return a.toUpperCase()}));","style=='float' && (style='",e?"cssFloat":"styleFloat","');return el.style[style] || ",e?"window.getComputedStyle(el, null)[style]":"el.currentStyle[style]"," || null;"].join(""))}();mini_isAncestor=function(e,t){var i=false;e=mini.byId(e);t=mini.byId(t);if(e===t)return true;if(e&&t){if(e.contains){try{return e.contains(t)}catch(n){return false}}else if(e.compareDocumentPosition){return!!(e.compareDocumentPosition(t)&16)}else{while(t=t.parentNode){i=t==e||i}}}return i};mini_findParent=function(e,t,i){e=mini.byId(e);var n=document.body,s=0,r;i=i||50;if(typeof i!="number"){r=mini.byId(i);i=10}while(e&&e.nodeType==1&&s<i&&e!=n&&e!=r){if(mini.hasClass(e,t)){return e}s++;e=e.parentNode}return null};mini.copyTo(mini,{byId:mini_byId,hasClass:mini_hasClass,addClass:mini_addClass,removeClass:mini_removeClass,getMargins:mini_getMargins,getBorders:mini_getBorders,getPaddings:mini_getPaddings,setWidth:mini_setWidth,setHeight:mini_setHeight,getWidth:mini_getWidth,getHeight:mini_getHeight,setBox:mini_setBox,getBox:mini_getBox,setStyle:mini_setStyle,getStyle:mini_getStyle,repaint:function(e){if(!e)e=document.body;mini.addClass(e,"mini-repaint");setTimeout(function(){mini.removeClass(e,"mini-repaint")},1)},getSize:function(e,t){return{width:mini.getWidth(e,t),height:mini.getHeight(e,t)}},setSize:function(e,t,i){mini.setWidth(e,t);mini.setHeight(e,i)},setX:function(e,t){t=parseInt(t);var i=jQuery(e).offset();var n=parseInt(i.top);if(n===undefined)n=i[1];mini.setXY(e,t,n)},setY:function(e,t){t=parseInt(t);var i=jQuery(e).offset();var n=parseInt(i.left);if(n===undefined)n=i[0];mini.setXY(e,n,t)},setXY:function(e,t,i){var n={left:parseInt(t),top:parseInt(i)};jQuery(e).offset(n)},getXY:function(e){var t=jQuery(e).offset();return[parseInt(t.left),parseInt(t.top)]},getViewportBox:function(){var e=jQuery(window).width(),t=jQuery(window).height();var i=jQuery(document).scrollLeft(),n=jQuery(document.body).scrollTop();if(document.documentElement)n=document.documentElement.scrollTop;return{x:i,y:n,top:n,left:i,width:e,height:t,right:i+e,bottom:n+t}},getChildNodes:function(e,t){e=mini.byId(e);if(!e)return;var i=e.childNodes;var n=[];for(var s=0,r=i.length;s<r;s++){var l=i[s];if(l.nodeType==1||t===true){n.push(l)}}return n},removeChilds:function(e,t){e=mini.byId(e);if(!e)return;var i=mini.getChildNodes(e,true);for(var n=0,s=i.length;n<s;n++){var r=i[n];if(t&&r==t){}else{e.removeChild(i[n])}}},isAncestor:mini_isAncestor,findParent:mini_findParent,findChild:function(e,t){e=mini.byId(e);var i=e.getElementsByTagName("*");for(var n=0,s=i.length;n<s;n++){var e=i[n];if(mini.hasClass(e,t))return e}},isAncestor:function(e,t){var i=false;e=mini.byId(e);t=mini.byId(t);if(e===t)return true;if(e&&t){if(e.contains){try{return e.contains(t)}catch(n){return false}}else if(e.compareDocumentPosition){return!!(e.compareDocumentPosition(t)&16)}else{while(t=t.parentNode){i=t==e||i}}}return i},getOffsetsTo:function(e,t){var i=this.getXY(e),n=this.getXY(t);return[i[0]-n[0],i[1]-n[1]]},scrollIntoView:function(e,t,i){var n=mini.byId(t)||document.body,s=this.getOffsetsTo(e,n),r=s[0]+n.scrollLeft,l=s[1]+n.scrollTop,o=l+e.offsetHeight,a=r+e.offsetWidth,h=n.clientHeight,u=parseInt(n.scrollTop,10),d=parseInt(n.scrollLeft,10),c=u+h,f=d+n.clientWidth;if(e.offsetHeight>h||l<u){n.scrollTop=l}else if(o>c){n.scrollTop=o-h}n.scrollTop=n.scrollTop;if(i!==false){if(e.offsetWidth>n.clientWidth||r<d){n.scrollLeft=r}else if(a>f){n.scrollLeft=a-n.clientWidth}n.scrollLeft=n.scrollLeft}return this},setOpacity:function(e,t){jQuery(e).css({opacity:t})},selectable:function(e,t){e=mini.byId(e);if(!!t){jQuery(e).removeClass("mini-unselectable");if(isIE)e.unselectable="off";else{e.style.MozUserSelect="";e.style.KhtmlUserSelect="";e.style.UserSelect=""}}else{jQuery(e).addClass("mini-unselectable");if(isIE)e.unselectable="on";else{e.style.MozUserSelect="none";e.style.UserSelect="none";e.style.KhtmlUserSelect="none"}}},selectRange:function(e,t,i){if(e.createTextRange){var n=e.createTextRange();n.moveStart("character",t);n.moveEnd("character",i-e.value.length);n.select()}else{if(e.setSelectionRange){e.setSelectionRange(t,i)}}try{e.focus()}catch(s){}},getSelectRange:function(e){e=mini.byId(e);if(!e)return;try{e.focus()}catch(t){}var i=0,n=0;if(e.createTextRange){var s=document.selection.createRange().duplicate();s.moveEnd("character",e.value.length);if(s.text===""){i=e.value.length}else{i=e.value.lastIndexOf(s.text)}var s=document.selection.createRange().duplicate();s.moveStart("character",-e.value.length);n=s.text.length}else{i=e.selectionStart;n=e.selectionEnd}return[i,n]}});(function(){var e={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};var t=document.createElement("div");t.setAttribute("class","t");var i=t.className==="t";mini.setAttr=function(t,n,s){t.setAttribute(i?n:e[n]||n,s)};mini.getAttr=function(t,n){if(n=="value"&&(isIE6||isIE7)){var s=t.attributes[n];return s?s.value:null}var r=t.getAttribute(i?n:e[n]||n);if(typeof r=="function"){r=t.attributes[n].value}return r}})();mini.copyTo(mini,{treeToArray:function(e,t,i,n,s){if(!t)t="children";var r=[];for(var l=0,o=e.length;l<o;l++){var a=e[l];r[r.length]=a;if(n)a[n]=s;var h=a[t];if(h&&h.length>0){var u=a[i];var d=this.treeToArray(h,t,i,n,u);r.addRange(d)}}return r},arrayToTree:function(e,t,i,n){if(!t)t="children";i=i||"_id";n=n||"_pid";var s=[];var r={};for(var l=0,o=e.length;l<o;l++){var a=e[l];if(!a)continue;var h=a[i];if(h!==null&&h!==undefined){r[h]=a}delete a[t]}for(var l=0,o=e.length;l<o;l++){var a=e[l];var u=r[a[n]];if(!u){s.push(a);continue}if(!u[t]){u[t]=[]}u[t].push(a)}return s}});mini.treeToList=mini.treeToArray;mini.listToTree=mini.arrayToTree;mini.copyTo(mini,{measureText:function(e,t,i){if(!this.measureEl){this.measureEl=mini.append(document.body,"<div></div>")}this.measureEl.style.cssText="position:absolute;left:-1000px;top:-1000px;visibility:hidden;";if(typeof e=="string"){this.measureEl.className=e}else{this.measureEl.className="";var n=jQuery(e);var s=jQuery(this.measureEl);var r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(var l=0,o=r.length;l<o;l++){var a=r[l];s.css(a,n.css(a))}}if(i)mini.setStyle(this.measureEl,i);this.measureEl.innerHTML=t;return mini.getSize(this.measureEl)}});mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight;mini.allowLayout=true;mini.isDisplay=function(e,t){var i=t||document.body;while(1){if(e==null||!e.style)return false;if(e&&e.style&&e.style.display=="none")return false;if(e==i)return true;e=e.parentNode}};mini.isWindowDisplay=function(){try{var e=window.parent;var t=e!=window;if(t){var i=e.document.getElementsByTagName("iframe");var n=e.document.getElementsByTagName("frame");var s=[];for(var r=0,l=i.length;r<l;r++){s.push(i[r])}for(var r=0,l=n.length;r<l;r++){s.push(n[r])}var o=null;for(var r=0,l=s.length;r<l;r++){var a=s[r];if(a.contentWindow==window){o=a;break}}if(!o)return false;return mini.isDisplay(o,e.document.body)}else{return true}}catch(h){return true}};mini.WindowVisible=mini.isWindowDisplay();mini.layoutIFrames=function(e){if(!e)e=document.body;if(!e)return;var t=e.getElementsByTagName("iframe");setTimeout(function(){for(var i=0,n=t.length;i<n;i++){var s=t[i];try{if(mini.isDisplay(s)&&mini.isAncestor(e,s)){if(s.contentWindow.mini){if(s.contentWindow.mini.WindowVisible==false){s.contentWindow.mini.WindowVisible=s.contentWindow.mini.isWindowDisplay();s.contentWindow.mini.layout()}else{s.contentWindow.mini.layout(null,false)}}s.contentWindow.mini.layoutIFrames()}}catch(r){}}},30)};mini.zIndex=1e3;mini.getMaxZIndex=function(){return mini.zIndex++};function js_isTouchDevice(){try{document.createEvent("TouchEvent");return true}catch(e){return false}}function js_touchScroll(e){if(js_isTouchDevice()){var t=typeof e=="string"?document.getElementById(e):e;var i=0;t.addEventListener("touchstart",function(e){i=this.scrollTop+e.touches[0].pageY;e.preventDefault()},false);t.addEventListener("touchmove",function(e){this.scrollTop=i-e.touches[0].pageY;e.preventDefault()},false)}}mini._placeholder=function(e){e=mini.byId(e);if(!e||!isIE||isIE10)return;function t(){var t=e._placeholder_label;if(!t)return;var i=e.getAttribute("placeholder");if(!i)i=e.placeholder;if(!e.value){t.innerHTML=i;t.style.display="";if(e.disabled)t.disabled=true}else{t.style.display="none"}}if(e._placeholder){t();return}e._placeholder=true;var i=document.createElement("label");i.className="mini-placeholder-label";e.parentNode.appendChild(i);e._placeholder_label=i;i.onmousedown=function(){e.focus()};e.onpropertychange=function(e){e=e||window.event;if(e.propertyName=="value"){t()}};t();mini.on(e,"focus",function(t){if(!e.readOnly){i.style.display="none"}});mini.on(e,"blur",function(e){t()})};mini.removeChildUI=function(e,t){if(typeof e=="string"){e=document.getElementById(e)}if(!e)return;var i=mini.getChildNodes(e,false);for(var n=0;n<i.length;n++){var s=i[n];if(s.uid){var r=mini.get(s);if(mini.isControl(r))r.destroy()}else{mini.removeChildUI(s)}}if(t){jQuery(e).html("")}};mini.ajax=function(e){if(!e.dataType){e.dataType="text"}e.isMini=true;return window.jQuery.ajax(e)};mini.getCalculatedOffset=function(e,t,i,n){if(e=="bottom")return{top:t.top+t.height,left:t.left+t.width/2-i/2};if(e=="top")return{top:t.top-n,left:t.left+t.width/2-i/2};if(e=="left")return{top:t.top+t.height/2-n/2,left:t.left-i};if(e=="bottomleft")return{top:t.top+t.height,left:t.left};if(e=="bottomright")return{top:t.top+t.height,left:t.left+t.width-i};if(e=="topleft")return{top:t.top-n,left:t.left};if(e=="topright")return{top:t.top-n,left:t.left+t.width-i};return{top:t.top+t.height/2-n/2,left:t.left+t.width}};jQuery.ajaxSetup({cache:false});if(typeof window.rootpath=="undefined"){rootpath="/"}if(typeof mini_debugger=="undefined"){mini_debugger=true}if(typeof mini_useShims=="undefined"){mini_useShims=false}if(typeof mini_autoRun=="undefined"){mini_autoRun=true}mini_CreateJSPath=function(e){var t=document.getElementsByTagName("script");var i="";for(var n=0,s=t.length;n<s;n++){var r=t[n].src;if(r.indexOf(e)!=-1){var l=r.split(e);i=l[0];break}}var o=location.href;o=o.split("#")[0];o=o.split("?")[0];var l=o.split("/");l.length=l.length-1;o=l.join("/");if(i.indexOf("http:")==-1&&i.indexOf("file:")==-1){i=o+"/"+i}return i};if(!window.mini_JSPath){mini_JSPath=mini_CreateJSPath("miniui.js")}var ua=navigator.userAgent.toLowerCase(),check=function(e){return e.test(ua)},DOC=document,isStrict=document.compatMode=="CSS1Compat",version=function(e,t){var i;return e&&(i=t.exec(ua))?parseFloat(i[1]):0},docMode=document.documentMode,isOpera=check(/opera/),isOpera10_5=isOpera&&check(/version\/10\.5/),isChrome=check(/\bchrome\b/),isWebKit=check(/webkit/),isSafari=!isChrome&&check(/safari/),isSafari2=isSafari&&check(/applewebkit\/4/),isSafari3=isSafari&&check(/version\/3/),isSafari4=isSafari&&check(/version\/4/),isSafari5_0=isSafari&&check(/version\/5\.0/),isSafari5=isSafari&&check(/version\/5/),isIE=!isOpera&&check(/msie/),isIE7=isIE&&(check(/msie 7/)&&docMode!=8&&docMode!=9&&docMode!=10||docMode==7),isIE8=isIE&&(check(/msie 8/)&&docMode!=7&&docMode!=9&&docMode!=10||docMode==8),isIE9=isIE&&(check(/msie 9/)&&docMode!=7&&docMode!=8&&docMode!=10||docMode==9),isIE10=isIE&&(check(/msie 10/)&&docMode!=7&&docMode!=8&&docMode!=9||docMode==10),isIE11=ua.indexOf("trident")>-1&&ua.indexOf("rv")>-1,isIE6=isIE&&!isIE7&&!isIE8&&!isIE9&&!isIE10&&!isIE11,isFirefox=navigator.userAgent.indexOf("Firefox")>0,isGecko=!isWebKit&&check(/gecko/),isGecko3=isGecko&&check(/rv:1\.9/),isGecko4=isGecko&&check(/rv:2\.0/),isGecko5=isGecko&&check(/rv:5\./),isGecko10=isGecko&&check(/rv:10\./),isFF3_0=isGecko3&&check(/rv:1\.9\.0/),isFF3_5=isGecko3&&check(/rv:1\.9\.1/),isFF3_6=isGecko3&&check(/rv:1\.9\.2/),isWindows=check(/windows|win32/),isMac=check(/macintosh|mac os x/),isAir=check(/adobeair/),isLinux=check(/linux/),scrollbarSize=null,chromeVersion=version(true,/\bchrome\/(\d+\.\d+)/),firefoxVersion=version(true,/\bfirefox\/(\d+\.\d+)/),ieVersion=version(isIE,/msie (\d+\.\d+)/),operaVersion=version(isOpera,/version\/(\d+\.\d+)/),safariVersion=version(isSafari,/version\/(\d+\.\d+)/),webKitVersion=version(isWebKit,/webkit\/(\d+\.\d+)/),isSecure=/^https/i.test(window.location.protocol),isBorderBox=isIE&&!isStrict;if(isIE6){try{DOC.execCommand("BackgroundImageCache",false,true)}catch(e){}}mini.boxModel=!isBorderBox;mini.isIE=isIE;mini.isIE6=isIE6;mini.isIE7=isIE7;mini.isIE8=isIE8;mini.isIE9=isIE9;mini.isFirefox=isFirefox;mini.isOpera=isOpera;mini.isSafari=isSafari;if(jQuery)jQuery.boxModel=mini.boxModel;mini.noBorderBox=false;if(jQuery.boxModel==false&&isIE&&isIE9==false)mini.noBorderBox=true;mini.copyTo(Array.prototype,{add:Array.prototype.enqueue=function(e){this[this.length]=e;return this},getRange:function(e,t){var i=[];for(var n=e;n<=t;n++){var s=this[n];if(s){i[i.length]=s}}return i},addRange:function(e){for(var t=0,i=e.length;t<i;t++)this[this.length]=e[t];return this},clear:function(){this.length=0;return this},clone:function(){if(this.length===1){return[this[0]]}else{return Array.apply(null,this)}},contains:function(e){return this.indexOf(e)>=0},indexOf:function(e,t){var i=this.length;for(var n=t<0?Math.max(0,i+t):t||0;n<i;n++){if(this[n]===e)return n}return-1},dequeue:function(){return this.shift()},insert:function(e,t){this.splice(e,0,t);return this},insertRange:function(e,t){for(var i=t.length-1;i>=0;i--){var n=t[i];this.splice(e,0,n)}return this},remove:function(e){var t=this.indexOf(e);if(t>=0){this.splice(t,1)}return t>=0},removeAt:function(e){var t=this[e];this.splice(e,1);return t},removeRange:function(e){e=e.clone();for(var t=0,i=e.length;t<i;t++){this.remove(e[t])}}});Date.prototype.getHalfYear=function(){if(!this.getMonth)return null;var e=this.getMonth();if(e<6)return 0;return 1};Date.prototype.getQuarter=function(){if(!this.getMonth)return null;var e=this.getMonth();if(e<3)return 0;if(e<6)return 1;if(e<9)return 2;return 3};var DAY_MS=864e5,HOUR_MS=36e5,MINUTE_MS=6e4;mini.copyTo(mini,{clearTime:function(e){if(!e)return null;return new Date(e.getFullYear(),e.getMonth(),e.getDate())},maxTime:function(e){if(!e)return null;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59)},cloneDate:function(e){if(!e)return null;return new Date(e.getTime())},addDate:function(e,t,i){if(!i)i="D";e=new Date(e.getTime());switch(i.toUpperCase()){case"Y":e.setFullYear(e.getFullYear()+t);break;case"MO":e.setMonth(e.getMonth()+t);break;case"D":e.setDate(e.getDate()+t);break;case"H":e.setHours(e.getHours()+t);break;case"M":e.setMinutes(e.getMinutes()+t);break;case"S":e.setSeconds(e.getSeconds()+t);break;case"MS":e.setMilliseconds(e.getMilliseconds()+t);break}return e;
},getWeek:function(e,t,i){t+=1;var n=Math.floor((14-t)/12);var s=e+4800-n;var r=t+12*n-3;var l=i+Math.floor((153*r+2)/5)+365*s+Math.floor(s/4)-Math.floor(s/100)+Math.floor(s/400)-32045;var o=(l+31741-l%7)%146097%36524%1461;var a=Math.floor(o/1460);var h=(o-a)%365+a;NumberOfWeek=Math.floor(h/7)+1;return NumberOfWeek},getWeekStartDate:function(e,t){if(!t)t=0;if(t>6||t<0)throw new Error("out of weekday");var i=e.getDay();var n=t-i;if(i<t){n-=7}var s=new Date(e.getFullYear(),e.getMonth(),e.getDate()+n);return s},getShortWeek:function(e){var t=this.dateInfo.daysShort;return t[e]},getLongWeek:function(e){var t=this.dateInfo.daysLong;return t[e]},getShortMonth:function(e){var t=this.dateInfo.monthsShort;return t[e]},getLongMonth:function(e){var t=this.dateInfo.monthsLong;return t[e]},dateInfo:{monthsLong:["January","Febraury","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysLong:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],quarterLong:["Q1","Q2","Q3","Q4"],quarterShort:["Q1","Q2","Q3","Q4"],halfYearLong:["first half","second half"],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy H:mm tt",F:"dddd, MMMM dd, yyyy H:mm:ss tt",g:"M/d/yyyy H:mm tt",G:"M/d/yyyy H:mm:ss tt",m:"MMMM dd",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm tt",T:"H:mm:ss tt",U:"dddd, MMMM dd, yyyy HH:mm:ss tt",y:"MMM, yyyy"},tt:{AM:"AM",PM:"PM"},ten:{Early:"Early",Mid:"Mid",Late:"Late"},today:"Today",clockType:24}});mini.formatDate=function(e,t,i){if(!e||!e.getFullYear||isNaN(e))return"";var n=e.toString();var s=mini.dateInfo;if(!s)s=mini.dateInfo;if(typeof s!=="undefined"){var r=typeof s.patterns[t]!=="undefined"?s.patterns[t]:t;var l=e.getFullYear();var o=e.getMonth();var a=e.getDate();if(t=="yyyy-MM-dd"){o=o+1<10?"0"+(o+1):o+1;a=a<10?"0"+a:a;return l+"-"+o+"-"+a}if(t=="MM/dd/yyyy"){o=o+1<10?"0"+(o+1):o+1;a=a<10?"0"+a:a;return o+"/"+a+"/"+l}n=r.replace(/yyyy/g,l);n=n.replace(/yy/g,(l+"").substring(2));var h=e.getHalfYear();n=n.replace(/hy/g,s.halfYearLong[h]);var u=e.getQuarter();n=n.replace(/Q/g,s.quarterLong[u]);n=n.replace(/q/g,s.quarterShort[u]);n=n.replace(/MMMM/g,s.monthsLong[o].escapeDateTimeTokens());n=n.replace(/MMM/g,s.monthsShort[o].escapeDateTimeTokens());n=n.replace(/MM/g,o+1<10?"0"+(o+1):o+1);n=n.replace(/(\\)?M/g,function(e,t){return t?e:o+1});var d=e.getDay();n=n.replace(/dddd/g,s.daysLong[d].escapeDateTimeTokens());n=n.replace(/ddd/g,s.daysShort[d].escapeDateTimeTokens());n=n.replace(/dd/g,a<10?"0"+a:a);n=n.replace(/(\\)?d/g,function(e,t){return t?e:a});var c=e.getHours();var f=c>12?c-12:c;if(s.clockType==12){if(c>12){c-=12}}n=n.replace(/HH/g,c<10?"0"+c:c);n=n.replace(/(\\)?H/g,function(e,t){return t?e:c});n=n.replace(/hh/g,f<10?"0"+f:f);n=n.replace(/(\\)?h/g,function(e,t){return t?e:f});var m=e.getMinutes();n=n.replace(/mm/g,m<10?"0"+m:m);n=n.replace(/(\\)?m/g,function(e,t){return t?e:m});var p=e.getSeconds();n=n.replace(/ss/g,p<10?"0"+p:p);n=n.replace(/(\\)?s/g,function(e,t){return t?e:p});n=n.replace(/fff/g,e.getMilliseconds());n=n.replace(/tt/g,e.getHours()>12||e.getHours()==0?s.tt["PM"]:s.tt["AM"]);var e=e.getDate();var g="";if(e<=10)g=s.ten["Early"];else if(e<=20)g=s.ten["Mid"];else g=s.ten["Late"];n=n.replace(/ten/g,g)}return n.replace(/\\/g,"")};mini.fixDate=function(e,t){if(+e){while(e.getDate()!=t.getDate()){e.setTime(+e+(e<t?1:-1)*HOUR_MS)}}};mini.parseDate=function(s,ignoreTimezone){try{var d=eval(s);if(d&&d.getFullYear)return d}catch(ex){}if(typeof s=="object"){return isNaN(s)?null:s}if(typeof s=="number"){var d=new Date(s*1e3);if(d.getTime()!=s)return null;return isNaN(d)?null:d}if(typeof s=="string"){m=s.match(/^([0-9]{4})([0-9]{2})([0-9]{0,2})$/);if(m){var date=new Date(parseInt(m[1],10),parseInt(m[2],10)-1);if(m[3])date.setDate(m[3]);return date}m=s.match(/^([0-9]{4}).([0-9]*)$/);if(m){var date=new Date(m[1],m[2]-1);return date}if(s.match(/^\d+(\.\d+)?$/)){var d=new Date(parseFloat(s)*1e3);if(d.getTime()!=s)return null;else return d}if(ignoreTimezone===undefined){ignoreTimezone=true}var d=mini.parseISO8601(s,ignoreTimezone)||(s?new Date(s):null);return isNaN(d)?null:d}return null};mini.parseISO8601=function(e,t){var i=e.match(/^([0-9]{4})([-\/\.]([0-9]{1,2})([-\/\.]([0-9]{1,2})([T ]([0-9]{1,2}):([0-9]{1,2})(:([0-9]{1,2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!i){i=e.match(/^([0-9]{4})[-\/\.]([0-9]{2})[-\/\.]([0-9]{2})[T ]([0-9]{1,2})/);if(i){var n=new Date(i[1],i[2]-1,i[3],i[4]);return n}i=e.match(/^([0-9]{4}).([0-9]*)/);if(i){var n=new Date(i[1],i[2]-1);return n}i=e.match(/^([0-9]{4}).([0-9]*).([0-9]*)/);if(i){var n=new Date(i[1],i[2]-1,i[3]);return n}i=e.match(/^([0-9]{2})-([0-9]{2})-([0-9]{4})$/);if(!i)return null;else{var n=new Date(i[3],i[1]-1,i[2]);return n}}var n=new Date(i[1],0,1);if(t||!i[14]){var s=new Date(i[1],0,1,9,0);if(i[3]){n.setMonth(i[3]-1);s.setMonth(i[3]-1)}if(i[5]){n.setDate(i[5]);s.setDate(i[5])}mini.fixDate(n,s);if(i[7]){n.setHours(i[7])}if(i[8]){n.setMinutes(i[8])}if(i[10]){n.setSeconds(i[10])}if(i[12]){n.setMilliseconds(Number("0."+i[12])*1e3)}mini.fixDate(n,s)}else{n.setUTCFullYear(i[1],i[3]?i[3]-1:0,i[5]||1);n.setUTCHours(i[7]||0,i[8]||0,i[10]||0,i[12]?Number("0."+i[12])*1e3:0);var r=Number(i[16])*60+(i[18]?Number(i[18]):0);r*=i[15]=="-"?1:-1;n=new Date(+n+r*60*1e3)}return n};mini.parseTime=function(e,t){if(!e)return null;var i=parseInt(e);if(i==e&&t){n=new Date(0);if(t[0]=="H"){n.setHours(i)}else if(t[0]=="m"){n.setMinutes(i)}else if(t[0]=="s"){n.setSeconds(i)}return n}var n=mini.parseDate(e);if(!n){var s=e.split(":");var r=parseInt(parseFloat(s[0]));var l=parseInt(parseFloat(s[1]));var o=parseInt(parseFloat(s[2]));if(!isNaN(r)&&!isNaN(l)&&!isNaN(o)){n=new Date(0);n.setHours(r);n.setMinutes(l);n.setSeconds(o)}if(!isNaN(r)&&(t=="H"||t=="HH")){n=new Date(0);n.setHours(r)}else if(!isNaN(r)&&!isNaN(l)&&(t=="H:mm"||t=="HH:mm")){n=new Date(0);n.setHours(r);n.setMinutes(l)}else if(!isNaN(r)&&!isNaN(l)&&t=="mm:ss"){n=new Date(0);n.setMinutes(r);n.setSeconds(l)}}return n};mini.Cookie={get:function(e){var t=document.cookie.split("; ");var i=null;for(var n=0;n<t.length;n++){var s=t[n].split("=");if(e==s[0]){i=s}}if(i){var r=i[1];if(r===undefined)return r;return unescape(r)}return null},set:function(e,t,i,n){var s=new Date;if(i!=null){s=new Date(s.getTime()+i*1e3*3600*24)}document.cookie=e+"="+escape(t)+(i==null?"":"; expires="+s.toGMTString())+";path=/"+(n?"; domain="+n:"")},del:function(e,t){this.set(e,null,-100,t)}};mini.htmlEncode=function(e){if(typeof e!=="string")return e;var t="";if(e.length==0)return"";t=e;t=t.replace(/</g,"&lt;");t=t.replace(/>/g,"&gt;");t=t.replace(/ /g,"&nbsp;");t=t.replace(/\'/g,"&#39;");t=t.replace(/\"/g,"&quot;");return t};mini.htmlDecode=function(e){if(typeof e!=="string")return e;var t="";if(e.length==0)return"";t=e.replace(/&amp;/g,"&");t=t.replace(/&lt;/g,"<");t=t.replace(/&gt;/g,">");t=t.replace(/&nbsp;/g," ");t=t.replace(/&#39;/g,"'");t=t.replace(/&quot;/g,'"');return t};mini.JSON=new function(){var sb=[];var _dateFormat=null;var useHasOwn=!!{}.hasOwnProperty,replaceString=function(e,t){var i=m[t];if(i){return i}i=t.charCodeAt();return"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16)},doEncode=function(e,t){if(e===null){sb[sb.length]="null";return}var i=typeof e;if(i=="undefined"){sb[sb.length]="null";return}else if(e.push){sb[sb.length]="[";var n,s,r=e.length,l;for(s=0;s<r;s+=1){l=e[s];i=typeof l;if(i=="undefined"||i=="function"||i=="unknown"){}else{if(n){sb[sb.length]=","}doEncode(l);n=true}}sb[sb.length]="]";return}else if(e.getFullYear){if(_dateFormat){sb[sb.length]='"';if(typeof _dateFormat=="function"){sb[sb.length]=_dateFormat(e,t)}else{sb[sb.length]=mini.formatDate(e,_dateFormat)}sb[sb.length]='"'}else{var o;sb[sb.length]='"';sb[sb.length]=e.getFullYear();sb[sb.length]="-";o=e.getMonth()+1;sb[sb.length]=o<10?"0"+o:o;sb[sb.length]="-";o=e.getDate();sb[sb.length]=o<10?"0"+o:o;sb[sb.length]="T";o=e.getHours();sb[sb.length]=o<10?"0"+o:o;sb[sb.length]=":";o=e.getMinutes();sb[sb.length]=o<10?"0"+o:o;sb[sb.length]=":";o=e.getSeconds();sb[sb.length]=o<10?"0"+o:o;sb[sb.length]='"'}return}else if(i=="string"){if(strReg1.test(e)){sb[sb.length]='"';sb[sb.length]=e.replace(strReg2,replaceString);sb[sb.length]='"';return}sb[sb.length]='"'+e+'"';return}else if(i=="number"){sb[sb.length]=e;return}else if(i=="boolean"){sb[sb.length]=String(e);return}else{sb[sb.length]="{";var n,s,l;for(s in e){if(!useHasOwn||e.hasOwnProperty&&e.hasOwnProperty(s)){l=e[s];i=typeof l;if(i=="undefined"||i=="function"||i=="unknown"){}else{if(n){sb[sb.length]=","}doEncode(s);sb[sb.length]=":";doEncode(l,s);n=true}}}sb[sb.length]="}";return}},m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},strReg1=/["\\\x00-\x1f]/,strReg2=/([\x00-\x1f\\"])/g;this.encode=function(){var e;return function(e,t){sb=[];_dateFormat=t;doEncode(e);_dateFormat=null;return sb.join("")}}();this.decode=function(){var dateRe1=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.*\d*)?)Z*$/;var dateRe2=new RegExp("^/+Date\\(([0-9]+).*\\)/+$","g");var re=/[\"\'](\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})[\"\']/g;return function(json,parseDate){if(json===""||json===null||json===undefined)return json;if(typeof json=="object"){json=this.encode(json)}function evalParse(json){if(parseDate!==false){json=json.replace(__js_dateRegEx,"$1new Date($2)");json=json.replace(re,"new Date($1,$2-1,$3,$4,$5,$6)");json=json.replace(__js_dateRegEx2,"new Date($1)")}return eval("("+json+")")}var data=null;if(window.JSON&&window.JSON.parse){var dateReviver=function(e,t){if(typeof t==="string"){dateRe1.lastIndex=0;var i=dateRe1.exec(t);if(i){t=new Date(i[1],i[2]-1,i[3],i[4],i[5],i[6]);return t}dateRe2.lastIndex=0;var i=dateRe2.exec(t);if(i){t=new Date(parseInt(i[1]));return t}}return t};try{var json2=json.replace(__js_dateRegEx,'$1"/Date($2)/"');data=window.JSON.parse(json2,dateReviver)}catch(ex){data=evalParse(json)}}else{data=evalParse(json)}return data}}()};__js_dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");__js_dateRegEx2=new RegExp("[\"']/Date\\(([0-9]+)\\)/[\"']","g");mini.encode=mini.JSON.encode;mini.decode=mini.JSON.decode;mini.Keyboard={Left:37,Top:38,Right:39,Bottom:40,PageUp:33,PageDown:34,End:35,Home:36,Enter:13,ESC:27,Space:32,Tab:9,Del:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};mini.MouseButton={Left:0,Middle:1,Right:2};if(isIE&&!isIE9){mini.MouseButton={Left:1,Middle:4,Right:2}}String.format=function(e){var t=Array.prototype.slice.call(arguments,1);e=e||"";return e.replace(/\{(\d+)\}/g,function(e,i){return t[i]})};String.prototype.trim=function(){var e=/^\s+|\s+$/g;return function(){return this.replace(e,"")}}();String.prototype.escapeDateTimeTokens=function(){return this.replace(/([dMyHmsft])/g,"\\$1")};mini.util={};mini.util.StringUtil={};mini.util.CookieUtil={};mini.util.HtmlUtil={};mini.util.StringUtil.lTrim=function(e){for(var t=0;t<e.length;t++)if(e.charAt(t)!=" ")return e.substring(t,e.length);return""};mini.util.StringUtil.rTrim=function(e){for(var t=e.length-1;t>=0;t--)if(e.charAt(t)!=" ")return e.substring(0,t+1);return""};mini.util.StringUtil.nvl=function(e,t){if(e==null||e==""){return t}else{return e}};mini.util.StringUtil.trimSpace=function(e){return mini.util.StringUtil.rTrim(mini.util.StringUtil.lTrim(e))};mini.util.StringUtil.trimAllSpace=function(e){return e.replace(/\s/g,"")};mini.util.StringUtil.clearEnter=function(e){var t="";var i="";var n=0;for(n=0;n<e.length;n++){t=e.charAt(n);if(!(t=="\n"||t=="\r")){i=i+t}}return mini.util.StringUtil.trimSpace(i)};mini.util.StringUtil.getLength=function(e){var t,i;i=0;for(t=0;t<e.length;t++){if(e.charCodeAt(t)>=0&&e.charCodeAt(t)<=255)i=i+1;else i=i+2}return i};mini.util.StringUtil.formatMoney=function(e,t,i){if(t===undefined)t=2;if(mini.isNull(e)||e===""){return""}e=new String(e);e=e.replace(/\,/g,"");var n=new Number(e);if(isNaN(n)){return""}if(t!==""&&t!==undefined){if(window.numeral){var s=t>0?".":"";while(t--){s+=0}n=numeral(n).format("0,0"+s)}else{n=n.toFixed(t);n=r(n)+""}}return(i||"")+n;function r(e){var t=/^(-?\d+)(\d{3})(\.?\d*)/;while(t.test(e)){e=e.replace(t,"$1,$2$3")}return e}};mini.util.HtmlUtil.getURI=function(){protocol=window.location.protocol;host=window.location.host;url=window.location.href;return url.replace(protocol+"//"+host,"")};mini.util.CookieUtil.getCookie=function(e){return $.cookie(e)};mini.util.CookieUtil.setCookie=function(e,t,i){$.cookie(e,t,option)};mini.util.disableBackspaceToPreviousPage=function(){$(document).unbind("keydown").bind("keydown",function(e){var t=false;if(e.keyCode===8){var i=e.srcElement||e.target;if(i.tagName.toUpperCase()==="INPUT"&&(i.type.toUpperCase()==="TEXT"||i.type.toUpperCase()==="PASSWORD"||i.type.toUpperCase()==="FILE"||i.type.toUpperCase()==="EMAIL"||i.type.toUpperCase()==="SEARCH"||i.type.toUpperCase()==="DATE")||i.tagName.toUpperCase()==="TEXTAREA"){t=i.readOnly||i.disabled}else{t=true}}if(t){e.preventDefault()}})};mini.util.getMap=function(e,t){return mini._getMap(e,t)};mini.util.setMap=function(e,t,i){return mini._setMap(e,t,i)};function UUID(){var e=[],t="0123456789ABCDEF".split("");for(var i=0;i<36;i++)e[i]=Math.floor(Math.random()*16);e[14]=4;e[19]=e[19]&3|8;for(var i=0;i<36;i++)e[i]=t[e[i]];e[8]=e[13]=e[18]=e[23]="-";return e.join("")}mini=mini||{};mini_onOne=function(e,t,i,n){var s="on"+t.toLowerCase();e[s]=function(e){e=e||window.event;e.target=e.target||e.srcElement;if(!e.preventDefault){e.preventDefault=function(){if(window.event){window.event.returnValue=false}}}if(!e.stopPropogation){e.stopPropogation=function(){if(window.event){window.event.cancelBubble=true}}}var t=i.call(n,e);if(window.event){try{e.stopPropogation=null;e.preventDefault=null}catch(e){}}if(t===false)return false}};mini_on=function(e,t,i,n){e=mini.byId(e);n=n||e;if(!e||!t||!i||!n)return false;var s=mini.findListener(e,t,i,n);if(s)return false;var r=mini.createDelegate(i,n);mini.listeners.push([e,t,i,n,r]);if(isFirefox&&t=="mousewheel")t="DOMMouseScroll";jQuery(e).bind(t,r)};mini_un=function(e,t,i,n){e=mini.byId(e);n=n||e;if(!e||!t||!i||!n)return false;var s=mini.findListener(e,t,i,n);if(!s)return false;mini.listeners.remove(s);if(isFirefox&&t=="mousewheel")t="DOMMouseScroll";jQuery(e).unbind(t,s[4])};mini.copyTo(mini,{listeners:[],on:mini_on,un:mini_un,findListener:function(e,t,i,n){e=mini.byId(e);n=n||e;if(!e||!t||!i||!n)return false;var s=mini.listeners;for(var r=0,l=s.length;r<l;r++){var o=s[r];if(o[0]==e&&o[1]==t&&o[2]==i&&o[3]==n){return o}}},clearEvent:function(e,t){e=mini.byId(e);if(!e)return false;var i=mini.listeners;for(var n=i.length-1;n>=0;n--){var s=i[n];if(s[0]==e){if(!t||t==s[1]){mini.un(e,s[1],s[2],s[3])}}}e.onmouseover=e.onmousedown=null}});mini.__windowResizes=[];mini.onWindowResize=function(e,t){mini.__windowResizes.push([e,t])};mini._BindCallbacks=[];mini._BindEvents=function(e,t){mini._BindCallbacks.push([e,t]);if(!mini._EventTimer){mini._FireBindEvents()}};mini._FireBindEvents=function(){for(var e=0,t=mini._BindCallbacks.length;e<t;e++){var i=mini._BindCallbacks[e];i[0].call(i[1])}mini._BindCallbacks=[];mini._EventTimer=null};mini=mini||{};mini.doWindowResizeTimer=null;mini_onresize=function(e){if(mini.doWindowResizeTimer){clearTimeout(mini.doWindowResizeTimer)}mini.WindowVisible=mini.isWindowDisplay();if(mini.WindowVisible==false||mini.allowLayout==false)return;if(typeof Ext!="undefined"){mini.doWindowResizeTimer=setTimeout(function(){var e=document.documentElement.clientWidth;var t=document.documentElement.clientHeight;if(mini.__LastWindowWidth==e&&mini.__LastWindowHeight==t){}else{mini.__LastWindowWidth=e;mini.__LastWindowHeight=t;mini.layout(null,false)}mini.doWindowResizeTimer=null},300)}else{var t=100;try{if(parent&&parent!=window&&parent.mini){t=0}}catch(i){}mini.doWindowResizeTimer=setTimeout(function(){var e=document.documentElement.clientWidth;var t=document.documentElement.clientHeight;if(mini.__LastWindowWidth==e&&mini.__LastWindowHeight==t){}else{mini.__LastWindowWidth=e;mini.__LastWindowHeight=t;mini.layout(null,false)}mini.doWindowResizeTimer=null},t)}};mini_onload=function(e){mini.layout(null,false);mini.on(window,"resize",mini_onresize)};mini_unload=function(e){try{var t=mini._getTopWindow();t[mini._WindowID]="";delete t[mini._WindowID]}catch(i){}var n=document.body.getElementsByTagName("iframe");if(n.length>0){var s=[];for(var r=0,l=n.length;r<l;r++){s.push(n[r])}for(var r=0,l=s.length;r<l;r++){try{var o=s[r];o._ondestroy=null;o.onload=function(){};jQuery(o).unbind("load");o.src="";try{o.contentWindow.document.write("");o.contentWindow.document.close()}catch(i){}if(o.parentNode)o.parentNode.removeChild(o)}catch(e){}}}var a=mini.getComponents();for(var r=0,l=a.length;r<l;r++){var h=a[r];if(h.destroyed!==true){h.destroy(false)}}a.length=0;a=null;mini.un(window,"unload",mini_unload);mini.un(window,"load",mini_onload);mini.un(window,"resize",mini_onresize);mini.clearEvent(window);mini.clearEvent(document);mini.components={};mini.classes={};mini.uiClasses={};mini.uids={};mini._topWindow=null;window.Owner=null;window.CloseOwnerWindow=null;delete String.prototype.trim;delete String.prototype.escapeDateTimeTokens;delete String.format;delete Array.prototype.add;delete Array.prototype.enqueue;delete Array.prototype.getRange;delete Array.prototype.addRange;delete Array.prototype.clear;delete Array.prototype.clone;delete Array.prototype.contains;delete Array.prototype.indexOf;delete Array.prototype.dequeue;delete Array.prototype.insert;delete Array.prototype.insertRange;delete Array.prototype.remove;delete Array.prototype.removeAt;delete Array.prototype.removeRange;delete Date.prototype.getHalfYear;delete Date.prototype.getQuarter;try{CollectGarbage()}catch(e){}};function __OnIFrameMouseDown(){jQuery(document).trigger("mousedown")}function __BindIFrames(){var e=document.getElementsByTagName("iframe");for(var t=0,i=e.length;t<i;t++){var n=e[t];try{if(n.contentWindow){var s=n.contentWindow.document;jQuery(s).bind("mousedown",__OnIFrameMouseDown)}}catch(r){}}}mini=mini||{};mini.Drag=function(e){mini.copyTo(this,e)};mini.Drag.prototype={onStart:mini.emptyFn,onMove:mini.emptyFn,onStop:mini.emptyFn,capture:false,fps:20,event:null,delay:80,destroy:function(e){mini.clearEvent(document);delete this.trigger;if(this.context){mini.clearEvent(this.context);this.context.parentNode.removeChild(this.context);this.context=null}},start:function(e){e.preventDefault();if(e)this.event=e;this.now=this.init=[this.event.pageX,this.event.pageY];var t=document;mini.on(t,"mousemove",this.move,this);mini.on(t,"mouseup",this.stop,this);mini.on(t,"contextmenu",this.contextmenu,this);if(this.context)mini.on(this.context,"contextmenu",this.contextmenu,this);this.trigger=e.target;mini.selectable(this.trigger,false);mini.selectable(t.body,false);if(this.capture){if(isIE)this.trigger.setCapture(true);else if(document.captureEvents)document.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP|Event.MOUSEDOWN)}this.started=false;this.startTime=new Date},contextmenu:function(e){if(this.context)mini.un(this.context,"contextmenu",this.contextmenu,this);mini.un(document,"contextmenu",this.contextmenu,this);e.preventDefault();e.stopPropagation()},move:function(e){if(this.delay){if(new Date-this.startTime<this.delay)return}if(!this.started){this.started=true;this.onStart(this)}var t=this;if(!this.timer){this.timer=setTimeout(function(){t.now=[e.pageX,e.pageY];t.event=e;t.onMove(t);t.timer=null},5)}},stop:function(e){this.now=[e.pageX,e.pageY];this.event=e;if(this.timer){clearTimeout(this.timer);this.timer=null}var t=document;mini.selectable(this.trigger,true);mini.selectable(t.body,true);if(isIE){this.trigger.setCapture(false);this.trigger.releaseCapture()}var i=mini.MouseButton.Right!=e.button;if(i==false){e.preventDefault()}mini.un(t,"mousemove",this.move,this);mini.un(t,"mouseup",this.stop,this);var n=this;setTimeout(function(){mini.un(document,"contextmenu",n.contextmenu,n);if(n.context)mini.un(n.context,"contextmenu",n.contextmenu,n)},1);if(this.started){n.onStop(n,i)}}};mini=mini||{};mini.loadJS=function(e,t){if(!e)return;if(typeof t=="function"){return loadJS._async(e,t)}else{return loadJS._sync(e)}};mini.loadJS._js={};mini.loadJS._async=function(e,t){var i=mini.loadJS._js[e];if(!i){i=mini.loadJS._js[e]={create:false,loaded:false,callbacks:[]}}if(i.loaded){setTimeout(function(){t()},1);return}else{i.callbacks.push(t);if(i.create)return}i.create=true;var n=document.getElementsByTagName("head")[0];var s=document.createElement("script");s.src=e;s.type="text/javascript";function r(){for(var e=0;e<i.callbacks.length;e++){var t=i.callbacks[e];if(t)t()}i.callbacks.length=0}setTimeout(function(){if(document.all){s.onreadystatechange=function(){if(s.readyState=="loaded"||s.readyState=="complete"){r();i.loaded=true}}}else{s.onload=function(){r();i.loaded=true}}n.appendChild(s)},1);return s};mini.loadJS._sync=function(e){if(loadJS._js[e])return;loadJS._js[e]={create:true,loaded:true,callbacks:[]};var t=document.getElementsByTagName("head")[0];var i=document.createElement("script");i.type="text/javascript";i.text=loadText(e);t.appendChild(i);return i};mini.loadText=function(e){var t="";var i=document.all&&location.protocol=="file:";var n=null;if(i){n=new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){n=new XMLHttpRequest}else if(window.ActiveXObject){n=new ActiveXObject("Microsoft.XMLHTTP")}}n.onreadystatechange=r;var s="_t="+(new Date).getTime();if(e.indexOf("?")==-1)s="?"+s;else s="&"+s;e+=s;n.open("GET",e,false);n.send(null);function r(){if(n.readyState==4){var e=i?0:200;if(n.status==e){t=n.responseText}else{}}}return t};mini.loadJSON=function(url){var text=loadText(url);var o=eval("("+text+")");return o};mini.loadCSS=function(e,t){if(!e)return;if(loadCSS._css[e])return;var i=document.getElementsByTagName("head")[0];var n=document.createElement("link");if(t)n.id=t;n.href=e;n.rel="stylesheet";n.type="text/css";i.appendChild(n);return n};mini.loadCSS._css={};mini.innerHTML=function(e,t){if(typeof e=="string")e=document.getElementById(e);if(!e)return;t='<div style="display:none">&nbsp;</div>'+t;e.innerHTML=t;mini.__executeScripts(e);var i=e.firstChild};mini.__executeScripts=function(e){var t=e.getElementsByTagName("script");for(var i=0,n=t.length;i<n;i++){var s=t[i];var r=s.src;if(r){mini.loadJS(r)}else{var l=document.createElement("script");l.type="text/javascript";l.text=s.text;e.appendChild(l)}}for(var i=t.length-1;i>=0;i--){var s=t[i];s.parentNode.removeChild(s)}};mini=mini||{};mini._MaskID=1;mini._MaskObjects={};mini.mask=function(e){var t=mini.byId(e);if(mini.isElement(t))e={el:t};else if(typeof e=="string")e={html:e};e=mini.copyTo({html:"",cls:"",style:"",iconCls:"",message:"",backStyle:"background:#ccc"},e);e.el=mini.byId(e.el);if(!e.el)e.el=document.body;var t=e.el;mini["unmask"](e.el);t._maskid=mini._MaskID++;mini._MaskObjects[t._maskid]=e;var i='<div class="'+e.iconCls+'"></div>';var n='<table class="mini-messagebox-table"  cellspacing="0" cellpadding="0"><tr><td>'+i+'</td><td  class="mini-messagebox-content-text">'+(e.html||e.message||"")+"</td></tr></table>";var s=mini.append(t,'<div class="mini-mask">'+'<div class="mini-mask-background" style="'+e.backStyle+'"></div>'+'<div class="mini-mask-msg '+e.cls+'" style="'+e.style+'">'+n+"</div>"+"</div>");if(t==document.body)mini.addClass(s,"mini-fixed");e.maskEl=s;if(!mini.isNull(e.opacity)){mini.setOpacity(s.firstChild,e.opacity)}function r(){l.style.display="block";var e=mini.getSize(l);l.style.marginLeft=-e.width/2+"px";l.style.marginTop=-e.height/2+"px"}var l=s.lastChild;l.style.display="none";setTimeout(function(){r()},0)};mini["unmask"]=function(e){e=mini.byId(e);if(!e)e=document.body;var t=mini._MaskObjects[e._maskid];if(!t)return;delete mini._MaskObjects[e._maskid];var i=t.maskEl;t.maskEl=null;if(i&&i.parentNode){i.parentNode.removeChild(i)}};mini=mini||{};mini._Columns={};mini._getColumn=function(e){var t=mini._Columns[e.toLowerCase()];if(!t)return{};return t()};mini.IndexColumn=function(e){return mini.copyTo({width:30,cellCls:"",align:"center",draggable:false,allowDrag:true,init:function(e){e.on("addrow",this.__OnIndexChanged,this);e.on("removerow",this.__OnIndexChanged,this);e.on("moverow",this.__OnIndexChanged,this);if(e.isTree){e.on("loadnode",this.__OnIndexChanged,this);this._gridUID=e.uid;this._rowIdField="_id"}},getNumberId:function(e){return this._gridUID+"$number$"+e[this._rowIdField]},createNumber:function(e,t){if(mini.isNull(e.pageIndex)){return t+1}else return e.pageIndex*e.pageSize+t+1},renderer:function(e){var t=e.sender;if(this.draggable){if(!e.cellStyle)e.cellStyle="";e.cellStyle+=";cursor:move;"}var i='<div id="'+this.getNumberId(e.record)+'">';if(mini.isNull(t.pager.pageIndex))i+=e.rowIndex+1;else i+=t.pager.pageIndex*t.pager.pageSize+e.rowIndex+1;i+="</div>";return i},__OnIndexChanged:function(e){var t=e.sender;var i=t.toArray();for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=this.getNumberId(r);var o=document.getElementById(l);if(o)o.innerHTML=this.createNumber(t,n)}}},e)};mini._Columns["indexcolumn"]=mini.IndexColumn;mini.CheckColumn=function(e){return mini.copyTo({width:30,cellCls:"mini-checkcolumn",headerCls:"mini-checkcolumn",_multiRowSelect:true,header:function(e){var t=this.uid+"checkall";var i='<input type="checkbox" id="'+t+'" />';if(this.multiSelect==false)i="";return i},getCheckId:function(e){return this._gridUID+"$checkcolumn$"+e[this._rowIdField]},init:function(e){e.on("selectionchanged",this.__OnSelectionChanged,this);e.on("HeaderCellClick",this.__OnHeaderCellClick,this)},renderer:function(e){var t=this.getCheckId(e.record);var i=e.sender.isSelected?e.sender.isSelected(e.record):false;var n="checkbox";var s=e.sender;if(s.multiSelect==false)n="radio";return'<input type="'+n+'" id="'+t+'" '+(i?"checked":"")+' hidefocus style="outline:none;" onclick="return false"/>'},__OnHeaderCellClick:function(e){var t=e.sender;if(e.column!=this)return;var i=t.uid+"checkall";var n=document.getElementById(i);if(n&&e.htmlEvent.target.id==i){if(t.getMultiSelect()){if(n.checked){t.selectAll()}else{t.deselectAll()}}else{t.deselectAll();if(n.checked){t.select(0)}}t.fire("checkall")}},__OnSelectionChanged:function(e){var t=e.sender;var i=t.toArray();for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=t.isSelected(r);var o=t.uid+"$checkcolumn$"+r[t._rowIdField];var a=document.getElementById(o);if(a)a.checked=l}},_doCheckState:function(e){var t=e.getData();if(t.length==0){return}var i=e.uid+"checkall";var n=document.getElementById(i);if(n&&e._getSelectAllCheckState){var s=e._getSelectAllCheckState();if(s=="has"){n.indeterminate=true;n.checked=true}else{n.indeterminate=false;n.checked=s}}}},e)};mini._Columns["checkcolumn"]=mini.CheckColumn;mini.ExpandColumn=function(e){return mini.copyTo({width:30,cellCls:"",align:"center",draggable:false,cellStyle:"padding:0",renderer:function(e){return'<a class="mini-grid-ecIcon" href="javascript:#" onclick="return false"></a>'},init:function(e){e.on("cellclick",this.__OnCellClick,this)},__OnCellClick:function(e){var t=e.sender;if(e.column==this&&t.isShowRowDetail){if(mini.findParent(e.htmlEvent.target,"mini-grid-ecIcon")){var i=t.isShowRowDetail(e.record);if(t.autoHideRowDetail){t.hideAllRowDetail()}if(i){t.hideRowDetail(e.record)}else{t.showRowDetail(e.record)}}}}},e)};mini._Columns["expandcolumn"]=mini.ExpandColumn;mini.CheckBoxColumn=function(e){return mini.copyTo({_type:"checkboxcolumn",header:"#",headerAlign:"center",cellCls:"mini-checkcolumn",trueValue:true,falseValue:false,readOnly:false,getCheckId:function(e){return this._gridUID+"$checkbox$"+e[this._rowIdField]},getCheckBoxEl:function(e){return document.getElementById(this.getCheckId(e))},renderer:function(e){var t=this.getCheckId(e.record);var i=mini._getMap(e.field,e.record);var n=i==this.trueValue?true:false;var s="checkbox";return'<input type="'+s+'" id="'+t+'" '+(n?"checked":"")+' hidefocus style="outline:none;" onclick="return false;"/>'},init:function(e){this.grid=e;function t(t){if(e.isReadOnly()||this.readOnly)return;t.value=mini._getMap(t.field,t.record);e.fire("cellbeginedit",t);if(t.cancel!==true){var i=mini._getMap(t.column.field,t.record);var n=i==this.trueValue?this.falseValue:this.trueValue;if(e._OnCellCommitEdit){e._OnCellCommitEdit(t.record,t.column,n)}}}function i(i){if(i.column==this){var n=this.getCheckId(i.record);var s=i.htmlEvent.target;if(s.id==n){if(e.allowCellEdit){i.cancel=false;t.call(this,i)}else{if(e.isEditingRow&&e.isEditingRow(i.record)){setTimeout(function(){s.checked=!s.checked},1)}}}}}e.on("cellclick",i,this);mini.on(this.grid.el,"keydown",function(i){if(i.keyCode==32&&e.allowCellEdit){var n=e.getCurrentCell();if(!n)return;var s={record:n[0],column:n[1]};t.call(this,s);i.preventDefault()}},this);var n=parseInt(this.trueValue),s=parseInt(this.falseValue);if(!isNaN(n))this.trueValue=n;if(!isNaN(s))this.falseValue=s}},e)};mini._Columns["checkboxcolumn"]=mini.CheckBoxColumn;mini.ComboBoxColumn=function(e){return mini.copyTo({renderer:function(e){var t=!mini.isNull(e.value)?String(e.value):"";var i=t.split(",");var n="id",s="text";var r={};var l=e.column.editor;if(l&&l.type=="combobox"){var o=this.__editor;if(!o){if(mini.isControl(l)){o=l}else{l=mini.clone(l);o=mini.create(l)}this.__editor=o}n=o.getValueField();s=o.getTextField();r={};var a=o.getData();for(var h=0,u=a.length;h<u;h++){var d=a[h];r[d[n]]=d}this._valueMaps=r}var c=[];for(var h=0,u=i.length;h<u;h++){var f=i[h];var d=r[f];if(d){var m=d[s];if(m===null||m===undefined){m=""}c.push(m)}}return c.join(",")}},e)};mini._Columns["comboboxcolumn"]=mini.ComboBoxColumn;mini.RadioButtonColumn=function(e){return mini.copyTo({_type:"radiobuttoncolumn",header:"",headerAlign:"center",cellCls:"mini-checkcolumn",trueValue:true,falseValue:false,readOnly:false,getCheckId:function(e){return this._gridUID+"$radio$"+e[this._rowIdField]},getCheckBoxEl:function(e){return document.getElementById(this.getCheckId(e))},renderer:function(e){var t=e.sender;var i=this.getCheckId(e.record);var n=mini._getMap(e.field,e.record);var s=n==this.trueValue?true:false;var r="radio";var l=t._id+e.column.field;var o="";var a='<div style="position:relative;">';a+='<input name="'+l+'" type="'+r+'" id="'+i+'" '+(s?"checked":"")+' hidefocus style="outline:none;" onclick="return false;" style="position:relative;z-index:1;"/>';if(!t.allowCellEdit){if(!t.isEditingRow(e.record)){a+='<div class="mini-grid-radio-mask"></div>'}}a+="</div>";return a},init:function(e){this.grid=e;function t(t){if(e.isReadOnly()||this.readOnly)return;t.value=mini._getMap(t.field,t.record);e.fire("cellbeginedit",t);if(t.cancel!==true){var i=mini._getMap(t.column.field,t.record);if(i==this.trueValue)return;var n=i==this.trueValue?this.falseValue:this.trueValue;var s=e.data;for(var r=0,l=s.length;r<l;r++){var o=s[r];if(o==t.record)continue;var i=mini._getMap(t.column.field,o);if(i!=this.falseValue){e.updateRow(o,t.column.field,this.falseValue)}}if(e._OnCellCommitEdit){e._OnCellCommitEdit(t.record,t.column,n)}}}function i(i){if(i.column==this){var n=this.getCheckId(i.record);var s=i.htmlEvent.target;if(s.id==n){if(e.allowCellEdit){i.cancel=false;t.call(this,i)}else{if(e.isEditingRow&&e.isEditingRow(i.record)){var r=this;setTimeout(function(){s.checked=true;var t=e.getData();for(var n=0,l=t.length;n<l;n++){var o=t[n];if(o==i.record)continue;var a=i.column.field;var h=mini._getMap(a,o);if(h!=r.falseValue){if(o!=i.record){if(e._dataSource){mini._setMap(i.column.field,r.falseValue,o);e._dataSource._setModified(o,a,h)}else{var u={};mini._setMap(a,r.falseValue,u);e._doUpdateRow(o,u)}}}}},1)}}}}}e.on("cellclick",i,this);mini.on(this.grid.el,"keydown",function(i){if(i.keyCode==32&&e.allowCellEdit){var n=e.getCurrentCell();if(!n)return;if(n[1]!=this)return;var s={record:n[0],column:n[1]};s.field=s.column.field;t.call(this,s);i.preventDefault();
}},this);var n=parseInt(this.trueValue),s=parseInt(this.falseValue);if(!isNaN(n))this.trueValue=n;if(!isNaN(s))this.falseValue=s}},e)};mini._Columns["radiobuttoncolumn"]=mini.RadioButtonColumn;mini=mini||{};mini._firstParse=true;mini.parse=function(e){if(mini._firstParse){mini._firstParse=false;var t=document.getElementsByTagName("iframe");var i=[];for(var n=0,s=t.length;n<s;n++){var r=t[n];i.push(r)}for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=$(r).attr("src");if(!l)continue;r.loaded=false;r._onload=r.onload;r._src=l;r.onload=function(){};r.src=""}setTimeout(function(){for(var e=0,t=i.length;e<t;e++){var n=i[e];if(n._src&&$(n).attr("src")==""){n.loaded=true;n.onload=n._onload;n.src=n._src;n._src=n._onload=null}}},20)}if(typeof e=="string"){var o=e;e=mini.byId(o);if(!e)e=document.body}if(e&&!mini.isElement(e))e=e.el;if(!e)e=document.body;var a=mini.WindowVisible;if(isIE){mini.WindowVisible=false}mini._doParse(e);mini.WindowVisible=a;mini.layout(e)};mini._doParse=function(e){if(!e)return;var t=e.nodeName.toLowerCase();if(!t)return;var i=e.className;if(i&&i.split){var n=mini.get(e);if(!n){var s=i.split(" ");for(var r=0,l=s.length;r<l;r++){var o=s[r];var a=mini.getClassByUICls(o);if(a){mini.removeClass(e,o);var h=new a;h._allowLayout=false;h=mini.applyTo.call(h,e);e=h.el;h._allowLayout=true;break}}}}if(t=="select"||mini.hasClass(e,"mini-menu")||mini.hasClass(e,"mini-datagrid")||mini.hasClass(e,"mini-treegrid")||mini.hasClass(e,"mini-tree")||mini.hasClass(e,"mini-button")||mini.hasClass(e,"mini-textbox")||mini.hasClass(e,"mini-buttonedit")){return}var u=mini.getChildNodes(e,true);for(var r=0,l=u.length;r<l;r++){var d=u[r];if(d.nodeType==1){if(d.parentNode==e){mini._doParse(d)}}}};jQuery(function(){if(!mini_autoRun)return;mini.run()});mini.run=function(){mini.isReady=true;mini.parse();mini._FireBindEvents();if((mini.getStyle(document.body,"overflow")=="hidden"||mini.getStyle(document.documentElement,"overflow")=="hidden")&&(isIE6||isIE7)){jQuery(document.body).css("overflow","visible");jQuery(document.documentElement).css("overflow","visible")}mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight;if(mini_autoRun)mini.on(window,"load",mini_onload);else mini_onload(null);mini.on(window,"resize",function(e){var t=mini.__windowResizes;for(var i=0,n=t.length;i<n;i++){var s=t[i];s[0].call(s[1],e)}});mini.on(window,"unload",mini_unload);if(isIE){setInterval(function(){CollectGarbage()},1e3)}};mini=mini||{};mini._ValidateVType=function(e,t,i,n){var s=e.split(";");for(var r=0,l=s.length;r<l;r++){var e=s[r].trim();var o=e.split(":");var a=o[0];var h=o[1];if(h)h=h.split(",");else h=[];var u=mini.VTypes[a];if(u){var d=u(t,h);if(d!==true){i.isValid=false;var c=o[0]+"ErrorText";i.errorText=n[c]||mini.VTypes[c]||"";i.errorText=String.format(i.errorText,h[0],h[1],h[2],h[3],h[4]);break}}}};mini._getErrorText=function(e,t){if(e&&e[t]){return e[t]}else{return mini.VTypes[t]}};mini.VTypes={uniqueErrorText:"不能重复.",requiredErrorText:"不能为空.",emailErrorText:"请输入邮件格式.",urlErrorText:"请输入URL格式.",floatErrorText:"请输入数字.",intErrorText:"请输入整数.",dateErrorText:"请输入日期格式 {0}.",maxLengthErrorText:"不能超过 {0} 个字符.",minLengthErrorText:"不能少于 {0} 个字符.",maxErrorText:"数字不能大于 {0}.",minErrorText:"数字不能小于 {0}.",rangeLengthErrorText:"字符长度必须在 {0} 到 {1} 之间.",rangeCharErrorText:"字符数必须在 {0} 到 {1} 之间.",rangeErrorText:"数字必须在 {0} 到 {1} 之间.",rangeDecimalsErrorText:"请保留小数点后 {0} 位小数.",moneyErrorText:"金额格式应为9,999,999.00.",required:function(e,t){if(mini.isNull(e)||e==="")return false;return true},email:function(e,t){if(mini.isNull(e)||e==="")return true;if(e.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)!=-1)return true;else return false},url:function(e,t){if(mini.isNull(e)||e==="")return true;function i(e){e=e.toLowerCase();var t="^((https|http|ftp|rtsp|mms)?://)"+"?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?"+"(([0-9]{1,3}.){3}[0-9]{1,3}"+"|"+"([0-9a-z_!~*'()-]+.)*"+"([0-9a-z][0-9a-z-]{0,61})?[0-9a-z]."+"[a-z]{2,6})"+"(:[0-9]{1,4})?"+"((/?)|"+"(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$";var i=new RegExp(t);if(i.test(e)){return true}else{return false}}return i(e)},"int":function(e,t){if(mini.isNull(e)||e==="")return true;function i(e){if(e<0){e=-e}var t=String(e);return t.length>0&&!/[^0-9]/.test(t)}return i(e)},"float":function(e,t){if(mini.isNull(e)||e==="")return true;function i(e){if(e<0){e=-e}var t=String(e);var i=/^([-]?)([1-9]\d*(\.\d+){0,1})$|^0(\.\d+){0,1}$/;return t.length>0&&i.test(t)}return i(e)},date:function(e,t){if(mini.isNull(e)||e==="")return true;if(!e)return false;var i=null;var n=t[0];if(n){i=mini.parseDate(e,n);if(i&&i.getFullYear){if(mini.formatDate(i,n)==e)return true}}else{i=mini.parseDate(e,"yyyy-MM-dd");if(!i)i=mini.parseDate(e,"yyyy/MM/dd");if(!i)i=mini.parseDate(e,"MM/dd/yyyy");if(i&&i.getFullYear)return true}return false},maxLength:function(e,t){if(mini.isNull(e)||e==="")return true;var i=parseInt(t);if(!e||isNaN(i))return true;if(e.length<=i)return true;else return false},minLength:function(e,t){if(mini.isNull(e)||e==="")return true;var i=parseInt(t);if(isNaN(i))return true;if(e.length>=i)return true;else return false},rangeLength:function(e,t){if(mini.isNull(e)||e==="")return true;if(!e)return false;var i=parseFloat(t[0]),n=parseFloat(t[1]);if(isNaN(i)||isNaN(n))return true;if(i<=e.length&&e.length<=n)return true;return false},rangeChar:function(e,t){if(mini.isNull(e)||e==="")return true;var i=parseFloat(t[0]),n=parseFloat(t[1]);if(isNaN(i)||isNaN(n))return true;function s(e){var t=/[^\x00-\xff]/gi;if(e.match(t)!=null)return true;return false}var r=0;var l=String(e).split("");for(var o=0,a=l.length;o<a;o++){if(s(l[o])){r+=2}else{r+=1}}if(i<=r&&r<=n)return true;return false},range:function(e,t){if(mini.VTypes["float"](e,t)==false)return false;if(mini.isNull(e)||e==="")return true;e=parseFloat(e);if(isNaN(e))return false;var i=parseFloat(t[0]),n=parseFloat(t[1]);if(isNaN(i)||isNaN(n))return true;if(i<=e&&e<=n)return true;return false},rangeDecimals:function(e,t){if(mini.isNull(e)||e==="")return true;if(e.indexOf(".")==-1)return true;var i=parseInt(t);if(isNaN(i))return true;var n=new RegExp("^-?0\\.\\d{1,"+i+"}$|^-?[1-9]\\d*\\.\\d{1,"+i+"}$");if(e.match(n)!=null)return true;return false},money:function(e,t){if(mini.isNull(e)||e==="")return true;var i;i=/^[\d|\,\.]*$/;if(!i.test(e))return false;var n=parseInt(t);if(isNaN(n))i="^-?([1-9]{1,3})(,\\d{3})*(\\.\\d+)?$|^-?(0\\.\\d+)$";else i="^-?([1-9]{1,3})(,\\d{3})*(\\.\\d{"+n+"})$|^-?(0\\.\\d{"+n+"})$";i=new RegExp(i);if(e.match(i)!=null)return true;return false}};mini.summaryTypes={count:function(e){if(!e)e=[];return e.length},max:function(e,t){if(!e)e=[];var i=null;for(var n=0,s=e.length;n<s;n++){var r=e[n];var l=parseFloat(r[t]);if(l===null||l===undefined||isNaN(l))continue;if(i==null||i<l){i=l}}return i},min:function(e,t){if(!e)e=[];var i=null;for(var n=0,s=e.length;n<s;n++){var r=e[n];var l=parseFloat(r[t]);if(l===null||l===undefined||isNaN(l))continue;if(i==null||i>l){i=l}}return i},avg:function(e,t){if(!e)e=[];if(e.length==0)return 0;var i=0;for(var n=0,s=e.length;n<s;n++){var r=e[n];var l=parseFloat(r[t]);if(l===null||l===undefined||isNaN(l))continue;i+=l}var o=i/e.length;return o},sum:function(e,t){if(!e)e=[];var i=0;for(var n=0,s=e.length;n<s;n++){var r=e[n];var l=parseFloat(r[t]);if(l===null||l===undefined||isNaN(l))continue;i+=l}return i}};mini.formatCurrency=function(e,t){if(e===null||e===undefined)e=0;e=String(e).replace(/\$|\,/g,"");if(isNaN(e)){e="0"}sign=e==(e=Math.abs(e));e=Math.floor(e*100+.50000000001);cents=e%100;e=Math.floor(e/100).toString();if(cents<10){cents="0"+cents}for(var i=0;i<Math.floor((e.length-(1+i))/3);i++){e=e.substring(0,e.length-(4*i+3))+","+e.substring(e.length-(4*i+3))}t=t||"";return t+((sign?"":"-")+e+"."+cents)};mini.formatPercent=function(e,t,i){if(e===null||e===undefined)e="";e=Number(e);if(isNaN(e)){e="0"}var n="%";if(t===false){n=""}return parseFloat((e*100).toFixed(i))+n};mini._Resizer=function(e){this.owner=e;mini.on(this.owner.el,"mousedown",this.__OnMouseDown,this)};mini._Resizer.prototype={destroy:function(e){if(this._resizeDragger){this._resizeDragger.destroy()}},__OnMouseDown:function(e){var t=mini.hasClass(e.target,"mini-resizer-trigger");if(t&&this.owner.allowResize){var i=this._getResizeDrag();i.start(e)}},_getResizeDrag:function(){if(!this._resizeDragger){this._resizeDragger=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this._resizeDragger},_OnDragStart:function(e){this.proxy=mini.append(document.body,'<div class="mini-resizer-proxy"></div>');this.proxy.style.cursor="se-resize";this.elBox=mini.getBox(this.owner.el);mini.setBox(this.proxy,this.elBox)},_OnDragMove:function(e){var t=this.owner;var i=e.now[0]-e.init[0];var n=e.now[1]-e.init[1];var s=this.elBox.width+i;var r=this.elBox.height+n;if(s<t.minWidth)s=t.minWidth;if(r<t.minHeight)r=t.minHeight;if(s>t.maxWidth)s=t.maxWidth;if(r>t.maxHeight)r=t.maxHeight;mini.setSize(this.proxy,s,r)},_OnDragStop:function(e,t){if(!this.proxy)return;var i=mini.getBox(this.proxy);jQuery(this.proxy).remove();this.proxy=null;this.elBox=null;if(t){this.owner.setWidth(i.width);this.owner.setHeight(i.height);this.owner.fire("resize")}}};mini=mini||{};mini.Component=function(){this._events={};this.uid=mini.newId(this._idPre);this._id=this.uid;if(!this.id){this.id=this.uid}mini.reg(this)};mini.Component.prototype={defaultValueTriggerChange:false,isControl:true,id:null,_idPre:"mini-",_idSet:false,_canFire:true,set:function(e){if(typeof e=="string"){return this}var t=this._allowLayout;this._allowLayout=false;var i=e.renderTo||e.render;delete e.renderTo;delete e.render;for(var n in e){if(n.toLowerCase().indexOf("on")==0){var s=e[n];this.on(n.substring(2,n.length).toLowerCase(),s);delete e[n]}}for(var n in e){var r=e[n];var l="set"+n.charAt(0).toUpperCase()+n.substring(1,n.length);var o=this[l];if(o){if(n=="value"){o.call(this,r,this.defaultValueTriggerChange)}else o.call(this,r)}else{this[n]=r}}if(i&&this.render){this.render(i)}this._allowLayout=t;if(this.doLayout)this.doLayout();return this},fire:function(e,t){if(this._canFire==false)return;e=e.toLowerCase();var i=this._events[e];if(i){if(!t)t={};if(t&&t!=this){t.source=t.sender=this;if(!t.type){t.type=e}}for(var n=0,s=i.length;n<s;n++){var r=i[n];if(r){r[0].apply(r[1],[t])}}}},on:function(type,fn,scope){if(typeof fn=="string"){var f=mini._getFunctoin(fn);if(!f){var id=mini.newId("__str_");window[id]=fn;eval("fn = function(e){var s = "+id+";var fn = mini._getFunctoin(s); if(fn) {fn.call(this, e)}else{eval(s);}}")}else{fn=f}}if(typeof fn!="function"||!type)return false;type=type.toLowerCase();var event=this._events[type];if(!event){event=this._events[type]=[]}scope=scope||this;if(!this.findListener(type,fn,scope)){event.push([fn,scope])}return this},un:function(e,t,i){if(typeof t!="function")return false;e=e.toLowerCase();var n=this._events[e];if(n){i=i||this;var s=this.findListener(e,t,i);if(s){n.remove(s)}}return this},findListener:function(e,t,i){e=e.toLowerCase();i=i||this;var n=this._events[e];if(n){for(var s=0,r=n.length;s<r;s++){var l=n[s];if(l[0]===t&&l[1]===i)return l}}},setId:function(e){if(!e)throw new Error("id not null");if(this._idSet)throw new Error("id just set only one");mini["unreg"](this);this.id=e;if(this.el)this.el.id=e;if(this._textEl)this._textEl.id=e+"$text";if(this._valueEl)this._valueEl.id=e+"$value";this._idSet=true;mini.reg(this)},getId:function(){return this.id},destroy:function(){mini["unreg"](this);this.fire("destroy")}};mini=mini||{};mini.Control=function(){mini.Control.superclass.constructor.call(this);this._create();this.el.uid=this.uid;this._initEvents();if(this._clearBorder){this.el.style.borderWidth="0";this.el.style.padding="0px"}this.addCls(this.uiCls);this.setWidth(this.width);this.setHeight(this.height);this.el.style.display=this.visible?this._displayStyle:"none"};mini.extend(mini.Control,mini.Component,{jsName:null,width:"",height:"",visible:true,readOnly:false,enabled:true,tooltip:"",_autoLoad:true,_readOnlyCls:"mini-readonly",_disabledCls:"mini-disabled",_create:function(){this.el=document.createElement("div")},_initEvents:function(){},within:function(e){if(mini.isAncestor(this.el,e.target))return true;return false},name:"",setName:function(e){this.name=e},getName:function(){return this.name},isAutoHeight:function(){var e=this.el.style.height;return e=="auto"||e==""},isAutoWidth:function(){var e=this.el.style.width;return e=="auto"||e==""},isFixedSize:function(){var e=this.width;var t=this.height;if(parseInt(e)+"px"==e&&parseInt(t)+"px"==t)return true;return false},isRender:function(e){return!!(this.el&&this.el.parentNode&&this.el.parentNode.tagName)},render:function(e,t){if(typeof e==="string"){if(e=="#body")e=document.body;else e=mini.byId(e)}if(!e)return;if(!t)t="append";t=t.toLowerCase();if(t=="before"){jQuery(e).before(this.el)}else if(t=="prepend"){jQuery(e).prepend(this.el)}else if(t=="after"){jQuery(e).after(this.el)}else{e.appendChild(this.el)}this.el.id=this.id;this.doLayout();this.fire("render")},getEl:function(){return this.el},setJsName:function(e){this.jsName=e;window[e]=this},getJsName:function(){return this.jsName},setTooltip:function(e){this.tooltip=e;this.el.title=e},getTooltip:function(){return this.tooltip},_sizeChaned:function(){this.doLayout()},setWidth:function(e){if(parseInt(e)==e)e+="px";this.width=e;this.el.style.width=e;this._sizeChaned()},getWidth:function(e){var t=e?jQuery(this.el).width():jQuery(this.el).outerWidth();if(e&&this._borderEl){var i=mini.getBorders(this._borderEl);t=t-i.left-i.right}return t},setHeight:function(e){if(parseInt(e)==e)e+="px";this.height=e;this.el.style.height=e;this._sizeChaned()},getHeight:function(e){var t=e?jQuery(this.el).height():jQuery(this.el).outerHeight();if(e&&this._borderEl){var i=mini.getBorders(this._borderEl);t=t-i.top-i.bottom}return t},getBox:function(){return mini.getBox(this.el)},setBorderStyle:function(e){var t=this._borderEl||this.el;mini.setStyle(t,e);this.doLayout()},getBorderStyle:function(){return this.borderStyle},_clearBorder:true,setStyle:function(e){this.style=e;mini.setStyle(this.el,e);if(this._clearBorder){this.el.style.borderWidth="0"}this.width=this.el.style.width;this.height=this.el.style.height;this._sizeChaned()},getStyle:function(){return this.style},setCls:function(e){this.addCls(e)},getCls:function(){return this.cls},addCls:function(e){mini.addClass(this.el,e)},removeCls:function(e){mini.removeClass(this.el,e)},_doReadOnly:function(){if(this.readOnly){this.addCls(this._readOnlyCls)}else{this.removeCls(this._readOnlyCls)}},setReadOnly:function(e){this.readOnly=e;this._doReadOnly()},getReadOnly:function(){return this.readOnly},getParent:function(e){var t=document;var i=this.el.parentNode;while(i!=t&&i!=null){var n=mini.get(i);if(n){if(!mini.isControl(n))return null;if(!e||n.uiCls==e)return n}i=i.parentNode}return null},isReadOnly:function(){if(this.readOnly||!this.enabled)return true;var e=this.getParent();if(e)return e.isReadOnly();return false},setEnabled:function(e){this.enabled=e;if(this.enabled){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}this._doReadOnly()},getEnabled:function(){return this.enabled},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)},_displayStyle:"",setVisible:function(e){this.visible=e;if(this.el){this.el.style.display=e?this._displayStyle:"none";this.doLayout()}},getVisible:function(){return this.visible},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},isDisplay:function(){if(mini.isWindowDisplay()==false)return false;return jQuery(this.el).is(":visible")},_allowUpdate:true,beginUpdate:function(){this._allowUpdate=false},endUpdate:function(){this._allowUpdate=true;this.doUpdate()},doUpdate:function(){},canLayout:function(){if(this._allowLayout==false)return false;return this.isDisplay()},doLayout:function(){},layoutChanged:function(){if(this.canLayout()==false)return;this.doLayout()},_destroyChildren:function(e){if(this.el){var t=mini.getChildControls(this);for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.destroyed!==true){s.destroy(e)}}}},destroy:function(e){if(this.destroyed!==true){this._destroyChildren(e)}if(this.el){mini.clearEvent(this.el);if(e!==false){var t=this.el.parentNode;if(t)t.removeChild(this.el)}}this._borderEl=null;this.el=null;mini.clearEvent(this);mini["unreg"](this);this.destroyed=true;this.fire("destroy")},parseUrl:function(urlPar){if(!urlPar)return null;if(urlPar.substring(0,1)=="#"){var name=urlPar.substring(1,urlPar.length);try{return eval(name)}catch(e){return null}}return urlPar},focus:function(){try{var e=this;e.el.focus()}catch(t){}},blur:function(){try{var e=this;e.el.blur()}catch(t){}},allowAnim:true,setAllowAnim:function(e){this.allowAnim=e},getAllowAnim:function(){return this.allowAnim},_getMaskWrapEl:function(){return this.el},mask:function(e){if(typeof e=="string")e={html:e};e=e||{};e.el=this._getMaskWrapEl();if(!e.cls)e.cls=this._maskCls;mini.mask(e)},unmask:function(){mini.unmask(this._getMaskWrapEl())},_maskCls:"mini-mask-loading",loadingMsg:"Loading...",loading:function(e){this.mask(e||this.loadingMsg)},setLoadingMsg:function(e){this.loadingMsg=e},getLoadingMsg:function(){return this.loadingMsg},_getContextMenu:function(e){var t=e;if(typeof e=="string"){t=mini.get(e);if(!t){mini.parse(e);t=mini.get(e)}}else if(mini.isArray(e)){t={type:"menu",items:e}}else if(!mini.isControl(e)){t=mini.create(e)}return t},__OnHtmlContextMenu:function(e){var t={popupEl:this.el,htmlEvent:e,cancel:false};this.contextMenu.fire("BeforeOpen",t);if(t.cancel==true)return;this.contextMenu.fire("opening",t);if(t.cancel==true)return;this.contextMenu.showAtPos(e.pageX,e.pageY);this.contextMenu.fire("Open",t);return false},contextMenu:null,setContextMenu:function(e){var t=this._getContextMenu(e);if(!t)return;if(this.contextMenu!==t){this.contextMenu=t;this.contextMenu.owner=this;mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this)}},getContextMenu:function(){return this.contextMenu},setDefaultValue:function(e){this.defaultValue=e},getDefaultValue:function(){return this.defaultValue},setValue:function(e){this.value=e},getValue:function(){return this.value},_afterApply:function(e){},dataField:"",setDataField:function(e){this.dataField=e},getDataField:function(){return this.dataField},getAttrs:function(el){var attrs={};var cls=el.className;if(cls)attrs.cls=cls;if(el.value)attrs.value=el.value;mini._ParseString(el,attrs,["id","name","width","height","borderStyle","value","defaultValue","contextMenu","tooltip","ondestroy","data-options","dataField"]);mini._ParseBool(el,attrs,["visible","enabled","readOnly"]);if(el.readOnly&&el.readOnly!="false")attrs.readOnly=true;var style=el.style.cssText;if(style){attrs.style=style}if(isIE9){var bg=el.style.background;if(bg){if(!attrs.style)attrs.style="";attrs.style+=";background:"+bg}}if(this.style){if(attrs.style)attrs.style=this.style+";"+attrs.style;else attrs.style=this.style}if(this.borderStyle){if(attrs.borderStyle)attrs.borderStyle=this.borderStyle+";"+attrs.borderStyle;else attrs.borderStyle=this.borderStyle}var ts=mini._attrs;if(ts){for(var i=0,l=ts.length;i<l;i++){var t=ts[i];var name=t[0];var type=t[1];if(!type)type="string";if(type=="string")mini._ParseString(el,attrs,[name]);else if(type=="bool")mini._ParseBool(el,attrs,[name]);else if(type=="int")mini._ParseInt(el,attrs,[name])}}var options=attrs["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(attrs,options)}}return attrs}});mini._attrs=null;mini.regHtmlAttr=function(e,t){if(!e)return;if(!t)t="string";if(!mini._attrs)mini._attrs=[];mini._attrs.push([e,t])};mini=mini||{};mini.Container=function(){mini.Container.superclass.constructor.call(this);this._contentEl=this.el};mini.extend(mini.Container,mini.Control,{setControls:__mini_setControls,getContentEl:function(){return this._contentEl},getBodyEl:function(){return this._contentEl}});mini=mini||{};mini.ValidatorBase=function(){mini.ValidatorBase.superclass.constructor.call(this)};mini.extend(mini.ValidatorBase,mini.Control,{required:false,requiredErrorText:"不能为空.",_requiredCls:"mini-required",errorText:"",_errorCls:"mini-error",_invalidCls:"mini-invalid",errorMode:"icon",validateOnChanged:true,validateOnLeave:true,_IsValid:true,indentSpace:false,_indentCls:"mini-indent",setIndentSpace:function(e){if(e){this.addCls(this._indentCls)}else{this.removeCls(this._indentCls)}this.indentSpace=e},getIndentSpace:function(){return this.indentSpace},_tryValidate:function(){this.validate()},validate:function(){if(this.enabled==false){this.setIsValid(true);return true}var e={value:this.getValue(),errorText:"",isValid:true};if(this.required){if(mini.isNull(e.value)||String(e.value).trim()===""){e.isValid=false;e.errorText=this.requiredErrorText}}this.fire("validation",e);this.errorText=e.errorText;this.setIsValid(e.isValid);return this.isValid()},isValid:function(){return this._IsValid},setIsValid:function(e){this._IsValid=e;this.doUpdateValid()},getIsValid:function(){return this._IsValid},setValidateOnChanged:function(e){this.validateOnChanged=e},getValidateOnChanged:function(e){return this.validateOnChanged},setValidateOnLeave:function(e){this.validateOnLeave=e},getValidateOnLeave:function(e){return this.validateOnLeave},setErrorMode:function(e){if(!e)e="none";this.errorMode=e.toLowerCase();if(this._IsValid==false)this.doUpdateValid()},getErrorMode:function(){return this.errorMode},setErrorText:function(e){this.errorText=e;if(this._IsValid==false)this.doUpdateValid()},getErrorText:function(){return this.errorText},setRequired:function(e){this.required=e;if(this.required){this.addCls(this._requiredCls)}else{this.removeCls(this._requiredCls)}},getRequired:function(){return this.required},setRequiredErrorText:function(e){this.requiredErrorText=e},getRequiredErrorText:function(){return this.requiredErrorText},errorIconEl:null,getErrorIconEl:function(){return this._errorIconEl},_RemoveErrorIcon:function(){},doUpdateValid:function(){var e=this;this._doUpdateValidTimer=setTimeout(function(){e.__doUpdateValid()},1)},__doUpdateValid:function(){if(!this.el)return;this.removeCls(this._errorCls);this.removeCls(this._invalidCls);if(this._IsValid==false){switch(this.errorMode){case"icon":this.addCls(this._errorCls);var e=this.getErrorIconEl();if(e)e.title=this.errorText;break;case"border":this.addCls(this._invalidCls);this.el.title=this.errorText;default:this._RemoveErrorIcon();break}}else{this._RemoveErrorIcon()}this.doLayout()},_OnValueChanged:function(){if(this.validateOnChanged){this._tryValidate()}this.fire("valuechanged",{value:this.getValue()})},onValueChanged:function(e,t){this.on("valuechanged",e,t)},onValidation:function(e,t){this.on("validation",e,t)},getAttrs:function(e){var t=mini.ValidatorBase.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["onvaluechanged","onvalidation","requiredErrorText","errorMode"]);mini._ParseBool(e,t,["validateOnChanged","validateOnLeave","indentSpace"]);var i=e.getAttribute("required");if(!i)i=e.required;if(!i){var n=e.attributes["required"];if(n){i=n.value=="null"?null:"true"}}if(i){t.required=i!="false"?true:false}return t}});mini=mini||{};mini.ListControl=function(){this.data=[];this._selecteds=[];mini.ListControl.superclass.constructor.call(this);this.doUpdate()};mini.extend(mini.ListControl,mini.ValidatorBase,{defaultValue:"",value:"",valueField:"id",textField:"text",delimiter:",",data:null,url:"",_itemCls:"mini-list-item",_itemHoverCls:"mini-list-item-hover",_itemSelectedCls:"mini-list-item-selected",set:function(e){if(typeof e=="string"){return this}var t=e.value;delete e.value;var i=e.url;delete e.url;var n=e.data;delete e.data;mini.ListControl.superclass.set.call(this,e);if(!mini.isNull(n)){this.setData(n)}if(!mini.isNull(i)){if(!e.lazy){this.setUrl(i)}else{this.url=this.parseUrl(i)}}if(!mini.isNull(t)){this.setValue(t,this.defaultValueTriggerChange)}return this},uiCls:"mini-list",_create:function(){},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"click",this.__OnClick,this);mini_onOne(this.el,"dblclick",this.__OnDblClick,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"mouseup",this.__OnMouseUp,this);mini_onOne(this.el,"mousemove",this.__OnMouseMove,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this);mini_onOne(this.el,"keydown",this.__OnKeyDown,this);mini_onOne(this.el,"keyup",this.__OnKeyUp,this);mini_onOne(this.el,"contextmenu",this.__OnContextMenu,this)},this)},destroy:function(e){if(this.el){this.el.onclick=null;this.el.ondblclick=null;this.el.onmousedown=null;this.el.onmouseup=null;this.el.onmousemove=null;this.el.onmouseover=null;this.el.onmouseout=null;this.el.onkeydown=null;this.el.onkeyup=null;this.el.oncontextmenu=null}if(this._valueEl){mini.clearEvent(this._valueEl);this._valueEl.parentNode.removeChild(this._valueEl);this._valueEl=null}delete this._focusedItem;delete this.data;delete this._selecteds;mini.ListControl.superclass.destroy.call(this,e)},name:"",setName:function(e){this.name=e;if(this._valueEl)mini.setAttr(this._valueEl,"name",this.name)},getItemByEvent:function(e){var t=mini.findParent(e.target,this._itemCls);if(t){var i=parseInt(mini.getAttr(t,"index"));return this.data[i]}},addItemCls:function(e,t){var i=this.getItemEl(e);if(i)mini.addClass(i,t)},removeItemCls:function(e,t){var i=this.getItemEl(e);if(i)mini.removeClass(i,t)},getItemEl:function(e){e=this.getItem(e);var t=this.data.indexOf(e);var i=this._createItemId(t);return document.getElementById(i)},_focusItem:function(e,t){e=this.getItem(e);if(!e)return;var i=this.getItemEl(e);if(t&&i){this.scrollIntoView(e)}if(this._focusedItem==e){if(i)mini.addClass(i,this._itemHoverCls);return}this._blurItem();this._focusedItem=e;if(i)mini.addClass(i,this._itemHoverCls)},_blurItem:function(){if(!this._focusedItem)return;try{var e=this.getItemEl(this._focusedItem);if(e){mini.removeClass(e,this._itemHoverCls)}}catch(t){}this._focusedItem=null},getFocusedItem:function(){return this._focusedItem},getFocusedIndex:function(){return this.data.indexOf(this._focusedItem)},_scrollViewEl:null,scrollIntoView:function(e){try{var t=this.getItemEl(e);var i=this._scrollViewEl||this.el;mini.scrollIntoView(t,i,false)}catch(n){}},getItem:function(e){if(typeof e=="object")return e;if(typeof e=="number")return this.data[e];return this.findItems(e)[0]},getCount:function(){return this.data.length},indexOf:function(e){return this.data.indexOf(e)},getAt:function(e){return this.data[e]},updateItem:function(e,t){e=this.getItem(e);if(!e)return;mini.copyTo(e,t);this.doUpdate()},load:function(e){if(typeof e=="string")this.setUrl(e);else this.setData(e)},loadData:function(e){this.setData(e)},setData:function(data){if(typeof data=="string"){data=eval(data)}if(!mini.isArray(data))data=[];this.data=data;this.doUpdate();if(this.value!=""){this.deselectAll();var records=this.findItems(this.value);this.selects(records)}},getData:function(){return this.data.clone()},setUrl:function(e,t){this.url=this.parseUrl(e);if(this._autoLoad)this._doLoad(t)},getUrl:function(){return this.url},_doLoad:function(params){try{var url=eval(this.url);if(url!=undefined){this.url=url}}catch(e){}var e={url:this.url,async:this.async||false,type:"get",dataType:"json",params:params,data:params,needpid:this.needpid===undefined?false:this.needpid,cache:this.cache===undefined?false:this.cache,cancel:false,timeout:this.timeout||3e4};this.fire("beforeload",e);if(e.data!=e.params&&e.params!=params){e.data=e.params}if(e.cancel==true)return;delete e.sender;delete e.source;var sf=this;var url=e.url;mini.copyTo(e,{success:function(e){var t=null;try{t=mini.decode(e)}catch(i){t=[];if(mini_debugger==true){alert(url+"\njson is error.")}}if(sf.dataField){t=mini._getMap(sf.dataField,t)}if(!t)t=[];var i={data:t,cancel:false};sf.fire("preload",i);if(i.cancel==true)return;sf.setData(i.data);sf.fire("load");setTimeout(function(){sf.doLayout()},100)},error:function(e,t,i){var n={xmlHttp:e,errorMsg:e.responseText,errorCode:e.status};if(mini_debugger==true){alert(url+"\n"+n.errorCode+"\n"+n.errorMsg)}sf.fire("loaderror",n)}});this._ajaxer=mini.ajax(e)},setValue:function(e,t){if(mini.isNull(e))e="";if(!mini.isEquals(this.value,e)){this.deselectAll();this.value=e;if(this._valueEl)this._valueEl.value=e;var i=this.findItems(this.value);this.selects(i);if(t===undefined)t=true;if(t)this._OnValueChanged()}},getValue:function(){return this.value},getFormValue:function(){return this.value},setValueField:function(e){this.valueField=e},getValueField:function(){return this.valueField},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},getItemValue:function(e){return String(mini._getMap(this.valueField,e))},getItemText:function(e){var t=mini._getMap(this.textField,e);return mini.isNull(t)?"":String(t)},getValueAndText:function(e){if(mini.isNull(e))e=[];if(!mini.isArray(e)){e=this.findItems(e)}var t=[];var i=[];for(var n=0,s=e.length;n<s;n++){var r=e[n];if(r){t.push(this.getItemValue(r));i.push(this.getItemText(r))}}return[t.join(this.delimiter),i.join(this.delimiter)]},findItems:function(e){if(mini.isNull(e))e="";var t=String(e).split(this.delimiter);var i=this.data;var n={};for(var s=0,r=i.length;s<r;s++){var l=i[s];var o=l[this.valueField];n[o]=l}var a=[];for(var h=0,u=t.length;h<u;h++){var o=t[h];var l=n[o];if(l){a.push(l)}}return a},removeAll:function(){var e=this.getData();this.removeItems(e)},addItems:function(e,t){if(!mini.isArray(e))return;if(mini.isNull(t))t=this.data.length;this.data.insertRange(t,e);this.doUpdate()},addItem:function(e,t){if(!e)return;if(this.data.indexOf(e)!=-1)return;if(mini.isNull(t))t=this.data.length;this.data.insert(t,e);this.doUpdate()},removeItems:function(e){if(!mini.isArray(e))return;this.data.removeRange(e);this._checkSelecteds();this.doUpdate()},removeItem:function(e){var t=this.data.indexOf(e);if(t!=-1){this.data.removeAt(t);this._checkSelecteds();this.doUpdate()}},moveItem:function(e,t){if(!e||!mini.isNumber(t))return;if(t<0)t=0;if(t>this.data.length)t=this.data.length;this.data.remove(e);this.data.insert(t,e);this.doUpdate()},_selected:null,_selecteds:[],multiSelect:false,_checkSelecteds:function(){for(var e=this._selecteds.length-1;e>=0;e--){var t=this._selecteds[e];if(this.data.indexOf(t)==-1){this._selecteds.removeAt(e)}}var i=this.getValueAndText(this._selecteds);this.value=i[0];if(this._valueEl)this._valueEl.value=this.value},setMultiSelect:function(e){this.multiSelect=e},getMultiSelect:function(){return this.multiSelect},isSelected:function(e){if(!e)return false;return this._selecteds.indexOf(e)!=-1},getSelecteds:function(){var e=this._selecteds.clone();var t=this;mini.sort(e,function(e,i){var n=t.indexOf(e);var s=t.indexOf(i);if(n>s)return 1;if(n<s)return-1;return 0});return e},setSelected:function(e){if(e){this._selected=e;this.select(e)}},getSelected:function(){return this._selected},select:function(e){e=this.getItem(e);if(!e)return;if(this.isSelected(e))return;this.selects([e])},deselect:function(e){e=this.getItem(e);if(!e)return;if(!this.isSelected(e))return;this.deselects([e])},selectAll:function(){var e=this.data.clone();this.selects(e)},deselectAll:function(){this.deselects(this._selecteds)},clearSelect:function(){this.deselectAll()},selects:function(e){if(!e||e.length==0)return;e=e.clone();for(var t=0,i=e.length;t<i;t++){var n=e[t];if(!this.isSelected(n)){this._selecteds.push(n)}}var s=this;s._doSelects()},deselects:function(e){if(!e||e.length==0)return;e=e.clone();for(var t=e.length-1;t>=0;t--){var i=e[t];if(this.isSelected(i)){this._selecteds.remove(i)}}var n=this;n._doSelects()},_doSelects:function(){var e=this.getValueAndText(this._selecteds);this.value=e[0];if(this._valueEl)this._valueEl.value=this.value;for(var t=0,i=this.data.length;t<i;t++){
    var n=this.data[t];var s=this.isSelected(n);if(s){this.addItemCls(n,this._itemSelectedCls)}else{this.removeItemCls(n,this._itemSelectedCls)}var r=this.data.indexOf(n);var l=this._createCheckId(r);var o=document.getElementById(l);if(o){o.checked=!!s;o.defaultChecked=!!s}}},_OnSelectionChanged:function(e,t){var i=this.getValueAndText(this._selecteds);this.value=i[0];if(this._valueEl)this._valueEl.value=this.value;var n={selecteds:this.getSelecteds(),selected:this.getSelected(),value:this.getValue()};this.fire("SelectionChanged",n)},_createCheckId:function(e){return this.uid+"$ck$"+e},_createItemId:function(e){return this.uid+"$"+e},__OnClick:function(e){this._fireEvent(e,"Click")},__OnDblClick:function(e){this._fireEvent(e,"Dblclick")},__OnMouseDown:function(e){this._fireEvent(e,"MouseDown")},__OnMouseUp:function(e){this._fireEvent(e,"MouseUp")},__OnMouseMove:function(e){this._fireEvent(e,"MouseMove")},__OnMouseOver:function(e){this._fireEvent(e,"MouseOver")},__OnMouseOut:function(e){this._fireEvent(e,"MouseOut")},__OnKeyDown:function(e){this._fireEvent(e,"KeyDown");this.__OnInputKeyDown(e)},__OnKeyUp:function(e){this._fireEvent(e,"KeyUp")},__OnContextMenu:function(e){this._fireEvent(e,"ContextMenu")},_fireEvent:function(e,t){if(!this.enabled)return;var i=this.getItemByEvent(e);if(!i)return;var n=this["_OnItem"+t];if(n){n.call(this,i,e)}else{var s={item:i,htmlEvent:e};this.fire("item"+t,s)}},_OnItemClick:function(e,t){if(this.isReadOnly()||this.enabled==false||e.enabled===false){t.preventDefault();return}var i=this.getValue();if(this.multiSelect){if(this.isSelected(e)){this.deselect(e);if(this._selected==e){this._selected=null}}else{this.select(e);this._selected=e}this._OnSelectionChanged()}else{if(!this.isSelected(e)){this.deselectAll();this.select(e);this._selected=e;this._OnSelectionChanged()}}if(i!=this.getValue()){this._OnValueChanged()}var t={item:e,htmlEvent:t};this.fire("itemclick",t)},_blurOnOut:true,_OnItemMouseOut:function(e,t){mini.repaint(this.el);if(!this.enabled)return;if(this._blurOnOut){this._blurItem()}var t={item:e,htmlEvent:t};this.fire("itemmouseout",t)},_OnItemMouseMove:function(e,t){mini.repaint(this.el);if(!this.enabled||e.enabled===false)return;this._focusItem(e);var t={item:e,htmlEvent:t};this.fire("itemmousemove",t)},onItemClick:function(e,t){this.on("itemclick",e,t)},onItemMouseDown:function(e,t){this.on("itemmousedown",e,t)},onBeforeLoad:function(e,t){this.on("beforeload",e,t)},onLoad:function(e,t){this.on("load",e,t)},onLoadError:function(e,t){this.on("loaderror",e,t)},onPreLoad:function(e,t){this.on("preload",e,t)},getAttrs:function(e){var t=mini.ListControl.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["url","data","value","textField","valueField","onitemclick","onitemmousemove","onselectionchanged","onitemdblclick","onbeforeload","onload","onloaderror","ondataload"]);mini._ParseBool(e,t,["multiSelect"]);var i=t.valueField||this.valueField;var n=t.textField||this.textField;if(e.nodeName.toLowerCase()=="select"){var s=[];for(var r=0,l=e.length;r<l;r++){var o=e.options[r];var a={};a[n]=o.text;a[i]=o.value;s.push(a)}if(s.length>0){t.data=s}}return t}});mini.CheckBox=function(){mini.CheckBox.superclass.constructor.call(this)};mini.extend(mini.CheckBox,mini.Control,{formField:true,_clearText:false,text:"",checked:false,defaultValue:false,trueValue:true,falseValue:false,uiCls:"mini-checkbox",_create:function(){var e=this.uid+"$check";this.el=document.createElement("span");this.el.className="mini-checkbox";this.el.innerHTML='<input id="'+e+'" name="'+this.id+'" type="checkbox" class="mini-checkbox-check"><label for="'+e+'" onclick="return false;">'+this.text+"</label>";this._checkEl=this.el.firstChild;this._labelEl=this.el.lastChild},destroy:function(e){if(this._checkEl){this._checkEl.onmouseup=null;this._checkEl.onclick=null;mini.clearEvent(this._checkEl);this.el.removeChild(this._checkEl);this._checkEl=null}if(this._labelEl){mini.clearEvent(this._labelEl);this.el.removeChild(this._labelEl);this._labelEl=null}mini.CheckBox.superclass.destroy.call(this,e)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__onClick,this);this._checkEl.onmouseup=function(){return false};var e=this;this._checkEl.onclick=function(){if(e.isReadOnly())return false};mini.on(this._checkEl,"keydown",this.__OnInputKeyDown,this)},this)},setName:function(e){this.name=e;mini.setAttr(this._checkEl,"name",this.name)},setText:function(e){if(this.text!==e){this.text=e;this._labelEl.innerHTML=e}},getText:function(){return this.text},setChecked:function(e,t){if(e===true)e=true;else if(e==this.trueValue)e=true;else if(e=="true")e=true;else if(e===1)e=true;else if(e=="Y")e=true;else e=false;if(this.checked!==e){this.checked=!!e;this._checkEl.checked=this.checked;this.value=this.getValue();if(t===undefined)t=true;if(t){this.fire("checkedchanged",{checked:this.checked});this.fire("valuechanged",{value:this.getValue()})}}},getChecked:function(){return this.checked},setValue:function(e,t){if(this.checked!=e){this.setChecked(e,t);this.value=this.getValue()}},getValue:function(){return String(this.checked==true?this.trueValue:this.falseValue)},getFormValue:function(){return this.getValue()},setTrueValue:function(e){this._checkEl.value=e;this.trueValue=e},getTrueValue:function(){return this.trueValue},setFalseValue:function(e){this.falseValue=e},getFalseValue:function(){return this.falseValue},__onClick:function(e){if(this.isReadOnly())return;this.setChecked(!this.checked);this.fire("click",e,this)},focus:function(){this._checkEl.focus()},__OnInputKeyDown:function(e){var t={htmlEvent:e};if(e.keyCode==13){this.fire("enter",t)}if(e.keyCode==27){e.preventDefault()}},getAttrs:function(e){var t=mini.CheckBox.superclass.getAttrs.call(this,e);var i=jQuery(e);t.text=e.innerHTML;mini._ParseString(e,t,["text","oncheckedchanged","onclick","onvaluechanged"]);mini._ParseBool(e,t,["enabled"]);var n=mini.getAttr(e,"checked");if(n){t.checked=n=="true"||n=="checked"?true:false}var s=i.attr("trueValue");if(s){t.trueValue=s;s=parseInt(s);if(!isNaN(s)){t.trueValue=s}}var r=i.attr("falseValue");if(r){t.falseValue=r;r=parseInt(r);if(!isNaN(r)){t.falseValue=r}}return t}});mini.regClass(mini.CheckBox,"checkbox");mini.CheckBoxList=function(){mini.CheckBoxList.superclass.constructor.call(this)};mini.extend(mini.CheckBoxList,mini.ListControl,{formField:true,multiSelect:true,repeatItems:0,repeatLayout:"none",repeatDirection:"horizontal",_itemCls:"mini-checkboxlist-item",_itemHoverCls:"mini-checkboxlist-item-hover",_itemSelectedCls:"mini-checkboxlist-item-selected",_tableCls:"mini-checkboxlist-table",_tdCls:"mini-checkboxlist-td",_checkType:"checkbox",uiCls:"mini-checkboxlist",_create:function(){var e=this.el=document.createElement("div");this.el.className=this.uiCls;this.el.innerHTML='<div class="mini-list-inner"></div><div class="mini-errorIcon"></div><input type="hidden" />';this._innerEl=this.el.firstChild;this._valueEl=this.el.lastChild;this._errorIconEl=this.el.childNodes[1]},_getRepeatTable:function(){var e=[];if(this.repeatItems>0){if(this.repeatDirection=="horizontal"){var t=[];for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];if(t.length==this.repeatItems){e.push(t);t=[]}t.push(s)}e.push(t)}else{var r=this.repeatItems>this.data.length?this.data.length:this.repeatItems;for(var i=0,n=r;i<n;i++){e.push([])}for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var l=i%this.repeatItems;e[l].push(s)}}}else{e=[this.data.clone()]}return e},doUpdate:function(){var e=this.data;var t="";for(var i=0,n=e.length;i<n;i++){var s=e[i];s._i=i}if(this.repeatLayout=="flow"){var r=this._getRepeatTable();for(var i=0,n=r.length;i<n;i++){var l=r[i];for(var o=0,a=l.length;o<a;o++){var s=l[o];t+=this._createItemHtml(s,s._i)}if(i!=n-1){t+="<br/>"}}}else if(this.repeatLayout=="table"){var r=this._getRepeatTable();t+='<table class="'+this._tableCls+'" cellpadding="0" cellspacing="1">';for(var i=0,n=r.length;i<n;i++){var l=r[i];t+="<tr>";for(var o=0,a=l.length;o<a;o++){var s=l[o];t+='<td class="'+this._tdCls+'">';t+=this._createItemHtml(s,s._i);t+="</td>"}t+="</tr>"}t+="</table>"}else{for(var i=0,n=e.length;i<n;i++){var s=e[i];t+=this._createItemHtml(s,i)}}this._innerEl.innerHTML=t;for(var i=0,n=e.length;i<n;i++){var s=e[i];delete s._i}},destroy:function(e){if(this._valueEl){this._valueEl=null}if(this._errorIconEl){this._errorIconEl=null}if(this._innerEl){this._innerEl=null}mini.CheckBoxList.superclass.destroy.call(this,e)},_createItemHtml:function(e,t){var i=this._OnDrawItem(e,t);var n=this._createItemId(t);var s=this._createCheckId(t);var r=this.getItemValue(e);var l="";var o='<div id="'+n+'" index="'+t+'" class="'+this._itemCls+" ";if(e.enabled===false){o+=" mini-disabled ";l="disabled"}var a='onclick="return false"';a='onmousedown="this._checked = this.checked;" onclick="this.checked = this._checked"';o+=i.itemCls+'" style="'+i.itemStyle+'"><input '+a+" "+l+' value="'+r+'" id="'+s+'" type="'+this._checkType+'" /><label for="'+s+'" onclick="return false;">';o+=i.itemHtml+"</label></div>";return o},_OnDrawItem:function(e,t){var i=this.getItemText(e);var n={index:t,item:e,itemHtml:i,itemCls:"",itemStyle:""};this.fire("drawitem",n);if(n.itemHtml===null||n.itemHtml===undefined)n.itemHtml="";return n},focus:function(){if(jQuery(this._innerEl).find("input:checked:enabled").length>0)jQuery(this._innerEl).find("input:checked:enabled:first").focus();else jQuery(this._innerEl).find("input:first").focus()},__OnInputKeyDown:function(e){var t={htmlEvent:e};if(e.keyCode==13){this.fire("enter",t)}if(e.keyCode==27){e.preventDefault()}},setRepeatItems:function(e){e=parseInt(e);if(isNaN(e))e=0;if(this.repeatItems!=e){this.repeatItems=e;this.doUpdate()}},getRepeatItems:function(){return this.repeatItems},setRepeatLayout:function(e){if(e!="flow"&&e!="table")e="none";if(this.repeatLayout!=e){this.repeatLayout=e;this.doUpdate()}},getRepeatLayout:function(){return this.repeatLayout},setRepeatDirection:function(e){if(e!="vertical")e="horizontal";if(this.repeatDirection!=e){this.repeatDirection=e;this.doUpdate()}},getRepeatDirection:function(){return this.repeatDirection},getAttrs:function(e){var t=mini.CheckBoxList.superclass.getAttrs.call(this,e);var i=jQuery(e);var n=parseInt(i.attr("repeatItems"));if(!isNaN(n)){t.repeatItems=n}var s=i.attr("repeatLayout");if(s){t.repeatLayout=s}var r=i.attr("repeatDirection");if(r){t.repeatDirection=r}var l=i.attr("ondrawitem");if(l){t.ondrawitem=l}return t}});mini.regClass(mini.CheckBoxList,"checkboxlist");mini.Box=function(){mini.Box.superclass.constructor.call(this)};mini.extend(mini.Box,mini.Container,{style:"",borderStyle:"",bodyStyle:"",uiCls:"mini-box",_create:function(){this.el=document.createElement("div");this.el.className="mini-box";this.el.innerHTML='<div class="mini-box-border"></div>';this._bodyEl=this._borderEl=this.el.firstChild;this._contentEl=this._bodyEl},_initEvents:function(){},doLayout:function(){if(!this.canLayout())return;var e=this.isAutoHeight();var t=this.isAutoWidth();var i=mini.getPaddings(this._bodyEl);var n=mini.getMargins(this._bodyEl);if(!e){var s=this.getHeight(true);if(jQuery.boxModel){s=s-i.top-i.bottom}s=s-n.top-n.bottom;if(s<0)s=0;this._bodyEl.style.height=s+"px"}else{this._bodyEl.style.height=""}var r=this.getWidth(true);var l=r;r=r-n.left-n.right;if(jQuery.boxModel){r=r-i.left-i.right}if(r<0)r=0;this._bodyEl.style.width=r+"px";mini.layout(this._borderEl);this.fire("layout")},setBody:function(e){if(!e)return;if(!mini.isArray(e))e=[e];for(var t=0,i=e.length;t<i;t++){mini.append(this._bodyEl,e[t])}mini.parse(this._bodyEl);this.doLayout()},set_bodyParent:function(e){if(!e)return;var t=this._bodyEl;var i=e;while(i.firstChild){t.appendChild(i.firstChild)}this.doLayout()},setBodyStyle:function(e){mini.setStyle(this._bodyEl,e);this.doLayout()},getAttrs:function(e){var t=mini.Box.superclass.getAttrs.call(this,e);t._bodyParent=e;mini._ParseString(e,t,["bodyStyle"]);return t}});mini.regClass(mini.Box,"box");mini=mini||{};mini.Button=function(){mini.Button.superclass.constructor.call(this)};mini.extend(mini.Button,mini.Control,{text:"",iconCls:"",iconStyle:"",plain:false,checkOnClick:false,checked:false,groupName:"",_plainCls:"mini-button-plain",_hoverCls:"mini-button-hover",_pressedCls:"mini-button-pressed",_checkedCls:"mini-button-checked",_disabledCls:"mini-button-disabled",allowCls:"",_clearBorder:false,set:function(e){if(typeof e=="string"){return this}this._allowUpdate=e.text||e.iconStyle||e.iconCls||e.iconPosition;mini.Button.superclass.set.call(this,e);if(this._allowUpdate===false){this._allowUpdate=true;this.doUpdate()}return this},uiCls:"mini-button",_create:function(){this.el=document.createElement("a");this.el.className="mini-button";this.el.hideFocus=true;this.el.href="javascript:void(0)";this.doUpdate()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"click",this.__OnClick,this)},this)},destroy:function(e){if(this.el){this.el.onclick=null;this.el.onmousedown=null}if(this.menu)this.menu.owner=null;this.menu=null;mini.Button.superclass.destroy.call(this,e)},doUpdate:function(){if(this._allowUpdate===false)return;var e="",t=this.text;if(this.iconCls&&t){e=" mini-button-icon "+this.iconCls}else if(this.iconCls&&t===""){e=" mini-button-iconOnly "+this.iconCls;t="&nbsp;"}else{if(t=="")t="&nbsp;"}var i='<span class="mini-button-text '+e+'">'+t+"</span>";if(this.allowCls){i=i+'<span class="mini-button-allow '+this.allowCls+'"></span>'}this.el.innerHTML=i},href:"",setHref:function(e){this.href=e;this.el.href=e;var t=this.el;setTimeout(function(){t.onclick=null},100)},getHref:function(){return this.href},target:"",setTarget:function(e){this.target=e;this.el.target=e},getTarget:function(){return this.target},setText:function(e){if(this.text!=e){this.text=e;this.doUpdate()}},getText:function(){return this.text},setIconCls:function(e){this.iconCls=e;this.doUpdate()},getIconCls:function(){return this.iconCls},setIconStyle:function(e){this.iconStyle=e;this.doUpdate()},getIconStyle:function(){return this.iconStyle},setIconPosition:function(e){this.iconPosition="left";this.doUpdate()},getIconPosition:function(){return this.iconPosition},setPlain:function(e){this.plain=e;if(e)this.addCls(this._plainCls);else this.removeCls(this._plainCls)},getPlain:function(){return this.plain},setGroupName:function(e){this.groupName=e},getGroupName:function(){return this.groupName},setCheckOnClick:function(e){this.checkOnClick=e},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(e){var t=this.checked!=e;this.checked=e;if(e)this.addCls(this._checkedCls);else this.removeCls(this._checkedCls);if(t){this.fire("CheckedChanged")}},getChecked:function(){return this.checked},doClick:function(){this.__OnClick(null)},__OnClick:function(e){if(this.readOnly||this.enabled==false)return;this.focus();if(this.checkOnClick){if(this.groupName){var t=this.groupName;var i=mini.findControls(function(e){if(e.type=="button"&&e.groupName==t)return true});if(i.length>0){for(var n=0,s=i.length;n<s;n++){var r=i[n];if(r!=this)r.setChecked(false)}this.setChecked(true)}else{this.setChecked(!this.checked)}}else{this.setChecked(!this.checked)}}this.fire("click",{htmlEvent:e});return false},__OnMouseDown:function(e){if(this.isReadOnly())return;this.addCls(this._pressedCls);mini.on(document,"mouseup",this.__OnDocMouseUp,this)},__OnDocMouseUp:function(e){this.removeCls(this._pressedCls);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},onClick:function(e,t){this.on("click",e,t)},getAttrs:function(e){var t=mini.Button.superclass.getAttrs.call(this,e);t.text=e.innerHTML;mini._ParseString(e,t,["text","href","iconCls","iconStyle","iconPosition","groupName","menu","onclick","oncheckedchanged","target"]);mini._ParseBool(e,t,["plain","checkOnClick","checked"]);return t}});mini.regClass(mini.Button,"button");mini=mini||{};mini.ButtonEdit=function(){mini.ButtonEdit.superclass.constructor.call(this);var e=this.isReadOnly();if(e||this.allowInput==false){this._textEl.readOnly=true}if(this.enabled==false){this.addCls(this._disabledCls)}if(e){this.addCls(this._readOnlyCls)}if(this.required){this.addCls(this._requiredCls)}};mini.extend(mini.ButtonEdit,mini.ValidatorBase,{name:"",formField:true,selectOnFocus:false,showClose:false,emptyText:"",defaultValue:"",value:"",text:"",maxLength:1e3,minLength:0,width:125,height:21,delimiter:",",inputAsValue:false,allowInput:true,_noInputCls:"mini-buttonedit-noInput",_readOnlyCls:"mini-buttonedit-readOnly",_disabledCls:"mini-buttonedit-disabled",_emptyCls:"mini-buttonedit-empty",_focusCls:"mini-buttonedit-focus",_buttonCls:"mini-buttonedit-button",_buttonHoverCls:"mini-buttonedit-button-hover",_buttonPressedCls:"mini-buttonedit-button-pressed",_closeCls:"mini-buttonedit-close",showToolTip:true,set:function(e){if(typeof e=="string"){return this}var t=e.value;delete e.value;var i=e.text;delete e.text;this._allowUpdate=!(e.enabled==false||e.allowInput==false||e.readOnly);mini.ButtonEdit.superclass.set.call(this,e);if(this._allowUpdate===false){this._allowUpdate=true;this.doUpdate()}if(!mini.isNull(i)){this.setText(i)}if(!mini.isNull(t)){this.setValue(t,this.defaultValueTriggerChange)}if(!e.showClose){this.setShowClose(this.showClose)}if(!e.showToolTip)this.setShowToolTip(this.showToolTip);return this},uiCls:"mini-buttonedit",_getButtonsHTML:function(){var e='<span class="mini-buttonedit-close"></span>'+this._getButtonHtml();return'<span class="mini-buttonedit-buttons">'+e+"</span>"},_getButtonHtml:function(){var e="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" "+"onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+e+'><span class="mini-buttonedit-icon"></span></span>'},_create:function(){this.el=document.createElement("span");this.el.className="mini-buttonedit";var e=this._getButtonsHTML();this.el.innerHTML='<span class="mini-buttonedit-border"><span><input type="input" class="mini-buttonedit-input" autocomplete="off"/></span>'+e+'</span><input name="'+this.name+'" type="hidden"/>';this._borderEl=this.el.firstChild;this._textCtnEl=this._borderEl.firstChild;this._textEl=this._textCtnEl.firstChild;this._valueEl=this.el.lastChild;this._buttonsEl=this._borderEl.lastChild;this._buttonEl=this._buttonsEl.lastChild;this._closeEl=this._buttonEl.previousSibling;this._doEmpty()},_addTooltip:function(e){this.tooltip=new mini.ButtonEditTip(this._textEl,this._textCtnEl)},_destroyTooltip:function(e){if(this.tooltip){mini.clearEvent(this.tooltip);this.tooltip.destroy(e);this.tooltip=null}},destroy:function(e){if(this.el){this.el.onmousedown=null;this.el.onmousewheel=null;this.el.onmouseover=null;this.el.onmouseout=null}this._destroyTooltip(e);if(this._textEl){this._textEl.readOnly=null;this._textEl.onchange=null;this._textEl.onfocus=null;this._textEl.onmouseover=null;this._textEl.onmouseout=null;this._textEl.placeholder=null;this._textEl.onpropertychange=null;if(this._textEl._placeholder_label){this._textEl._placeholder_label.onmousedown=null;this._textEl._placeholder_label.parentNode.removeChild(this._textEl._placeholder_label);this._textEl._placeholder_label=null}mini.clearEvent(this._textEl);this._textEl.parentNode.removeChild(this._textEl);this._textEl=null}if(this._buttonEl){this._buttonEl.onmouseover=null;this._buttonEl.onmouseout=null;mini.clearEvent(this._buttonEl);this._buttonEl.parentNode.removeChild(this._buttonEl);this._buttonEl=null}if(this._closeEl){this._closeEl.onclick=null;mini.clearEvent(this._closeEl);this._closeEl.parentNode.removeChild(this._closeEl);this._closeEl=null}if(this._buttonsEl){mini.clearEvent(this._buttonsEl);this._buttonsEl.parentNode.removeChild(this._buttonsEl);this._buttonsEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this._borderEl.parentNode.removeChild(this._borderEl);this._borderEl=null}if(this._valueEl){mini.clearEvent(this._valueEl);this._valueEl.parentNode.removeChild(this._valueEl);this._valueEl=null}mini.ButtonEdit.superclass.destroy.call(this,e)},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);mini_onOne(this._closeEl,"click",this._onClearClick,this);var e=this.text;this.text=null;this.setText(e)},this)},_onClearClick:function(){if(!this.enabled||this.readOnly)return;this.setValue("");this.setText("")},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited)return;this._inputEventsInited=true;mini.on(this.el,"click",this.__OnClick,this);mini.on(this._textEl,"blur",this.__OnBlur,this);mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this);mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this);mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this)},_buttonWidth:20,_closeWidth:20,_doInputLayout:function(){this.doLayout()},doLayout:function(){if(this.showClose){if(this.value)this._closeEl.style.display="inline-block";else this._closeEl.style.display="none"}var e=this._buttonsEl.offsetWidth+2;this._borderEl.style["paddingRight"]=e+"px"},setHeight:function(e){if(parseInt(e)==e)e+="px";this.height=e},focus:function(){if(this.enabled==false)return;try{this._textEl.focus();var e=this;setTimeout(function(){if(e._focused){e._textEl.focus()}},10)}catch(t){}},blur:function(){try{this._textEl.blur()}catch(e){}},selectText:function(){this._textEl.select()},getTextEl:function(){return this._textEl},setName:function(e){this.name=e;if(this._valueEl)mini.setAttr(this._valueEl,"name",this.name)},setText:function(e){if(e===null||e===undefined)e="";var t=this.text!==e;this.text=e;this._textEl.value=e;this._doEmpty()},getText:function(){var e=this._textEl.value;return e},setValue:function(e,t){var i=this.getValue();if(e===null||e===undefined)e="";var n=this.value!==e;this.value=e;this._valueEl.value=this.getFormValue();if(!mini.isEquals(this.value,i)){if(t===undefined)t=true;if(t)this._OnValueChanged()}},setShowToolTip:function(e){this.showToolTip=e;if(this.showToolTip)this._addTooltip(this.el)},_OnValueChanged:function(){mini.ButtonEdit.superclass._OnValueChanged.call(this);this._doInputLayout()},getValue:function(){return this.value},getFormValue:function(){var e=this.value;if(e===null||e===undefined)e="";return String(e)},_doEmpty:function(){this._textEl.placeholder=this.emptyText;if(this.emptyText){mini._placeholder(this._textEl)}},setEmptyText:function(e){if(this.emptyText!=e){this.emptyText=e;this._doEmpty()}},getEmptyText:function(){return this.emptyText},setMaxLength:function(e){e=parseInt(e);if(isNaN(e))return;this.maxLength=e;this._textEl.maxLength=e},getMaxLength:function(){return this.maxLength},setMinLength:function(e){e=parseInt(e);if(isNaN(e))return;this.minLength=e},getMinLength:function(){return this.minLength},setEnabled:function(e){mini.ButtonEdit.superclass.setEnabled.call(this,e);if(this._textEl._placeholder_label)this._textEl._placeholder_label.disabled=true;this._tryValidate()},_doReadOnly:function(){var e=this.isReadOnly();if(e||this.allowInput==false){this._textEl.readOnly=true}else{this._textEl.readOnly=false}if(e){this.addCls(this._readOnlyCls)}else{this.removeCls(this._readOnlyCls)}if(this.allowInput){this.removeCls(this._noInputCls)}else{this.addCls(this._noInputCls)}if(this.enabled){this._textEl.disabled=false}else{this._textEl.disabled=true}},setAllowInput:function(e){this.allowInput=e;this._doReadOnly()},getAllowInput:function(){return this.allowInput},setInputAsValue:function(e){this.inputAsValue=e},getInputAsValue:function(){return this.inputAsValue},_errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){this._errorIconEl=mini.append(this.el,'<span class="mini-errorIcon"></span>')}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){var e=this._errorIconEl;jQuery(e).remove()}this._errorIconEl=null},__OnClick:function(e){if(this.isReadOnly()||this.enabled==false)return;if(!mini.isAncestor(this._borderEl,e.target))return;var t=new Date;if(mini.isAncestor(this._buttonEl,e.target)){this._OnButtonClick(e)}if(mini.findParent(e.target,this._closeCls)){this.fire("closeclick",{htmlEvent:e})}},__OnMouseDown:function(e){if(this.isReadOnly()||this.enabled==false)return;if(!mini.isAncestor(this._borderEl,e.target))return;if(!mini.isAncestor(this._textEl,e.target)){this._clickTarget=e.target;var t=this;if(mini.isAncestor(this._buttonEl,e.target)){var i=mini.findParent(e.target,"mini-buttonedit-up");var n=mini.findParent(e.target,"mini-buttonedit-down");if(i){mini.addClass(i,this._buttonPressedCls);this._OnButtonMouseDown(e,"up")}else if(n){mini.addClass(n,this._buttonPressedCls);this._OnButtonMouseDown(e,"down")}else{mini.addClass(this._buttonEl,this._buttonPressedCls);this._OnButtonMouseDown(e)}mini.on(document,"mouseup",this.__OnDocMouseUp,this)}}},__OnDocMouseUp:function(e){this._clickTarget=null;var t=this;setTimeout(function(){var e=t._buttonEl.getElementsByTagName("*");for(var i=0,n=e.length;i<n;i++){mini.removeClass(e[i],t._buttonPressedCls)}mini.removeClass(t._buttonEl,t._buttonPressedCls);mini.removeClass(t.el,t._pressedCls)},80);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},__OnFocus:function(e){this.doUpdate();this._initInputEvents();if(this.isReadOnly())return;this._focused=true;this.addCls(this._focusCls);if(this.selectOnFocus){this.selectText()}this.fire("focus",{htmlEvent:e})},__doFocusCls:function(){if(this._focused==false){this.removeCls(this._focusCls)}},__fireBlur:function(e){this._focused=false;var t=this;function i(){t.__doFocusCls()}setTimeout(function(){i.call(t)},2);this.fire("blur",{htmlEvent:e});if(this.validateOnLeave){this._tryValidate()}},__OnBlur:function(e){this._focused=false;var t=this;setTimeout(function(){t.__fireBlur(e)},10)},__OnInputKeyDown:function(e){var t={htmlEvent:e};this.fire("keydown",t);if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==27||e.keyCode==13||e.keyCode==9){var i=this;i.__OnInputTextChanged(null);if(e.keyCode==13){var n=this;n.fire("enter",t)}}if(e.keyCode==27){e.preventDefault()}},__OnInputTextChanged:function(){var e=this._textEl.value;var t=this.getValue();this.setValue(e)},__OnInputKeyUp:function(e){this.fire("keyup",{htmlEvent:e})},__OnInputKeyPress:function(e){this.fire("keypress",{htmlEvent:e})},_OnButtonClick:function(e){var t={htmlEvent:e,cancel:false};this.fire("beforebuttonclick",t);if(t.cancel==true)return;this.fire("buttonclick",t)},_OnButtonMouseDown:function(e,t){this.focus();this.addCls(this._focusCls);this.fire("buttonmousedown",{htmlEvent:e,spinType:t})},onButtonClick:function(e,t){this.on("buttonclick",e,t)},onButtonMouseDown:function(e,t){this.on("buttonmousedown",e,t)},onTextChanged:function(e,t){this.on("textchanged",e,t)},textName:"",setTextName:function(e){this.textName=e;if(this._textEl)mini.setAttr(this._textEl,"name",this.textName)},getTextName:function(){return this.textName},setSelectOnFocus:function(e){this.selectOnFocus=e},getSelectOnFocus:function(e){return this.selectOnFocus},setShowClose:function(e){this.showClose=e},getShowClose:function(e){return this.showClose},inputStyle:"",setInputStyle:function(e){this.inputStyle=e;mini.setStyle(this._textEl,e)},getAttrs:function(e){var t=mini.ButtonEdit.superclass.getAttrs.call(this,e);var i=jQuery(e);mini._ParseString(e,t,["value","text","textName","emptyText","inputStyle","onenter","onkeydown","onkeyup","onkeypress","onbuttonclick","onbuttonmousedown","ontextchanged","onfocus","onblur","oncloseclick"]);mini._ParseBool(e,t,["allowInput","inputAsValue","selectOnFocus","showClose","showToolTip"]);mini._ParseInt(e,t,["maxLength","minLength"]);return t}});mini.regClass(mini.ButtonEdit,"buttonedit");mini.ButtonEditTip=function(e,t){this.ctnEl=t||e;this.textEl=e;this.attr="";this.attrDelimiter=",";this._create()};mini.ButtonEditTip.prototype={delimiter:"<br/>",attrDelimiter:",",_create:function(){var e=document.getElementById("mini-buttonedittip");if(!e){this.el=document.createElement("div");this.el.className="mini-buttonedittip";this.el.id="mini-buttonedittip";this.el.innerHTML='<div class="mini-buttonedittip-colortip">'+'<div class="mini-buttonedittip-content"></div>'+'<div class="mini-buttonedittip-pointy"><span class="mini-buttonedittip-pointytipshadow"></span><span class="mini-buttonedittip-pointytip"></span></div>'+"</div>";this._contentEl=this.el.firstChild.childNodes[0];this._pointyEl=this.el.firstChild.childNodes[1];this._lengthspanEl=document.createElement("span");this._lengthspanEl.className="lengthspan";this._lengthspanEl.id="lengthspan";document.body.appendChild(this._lengthspanEl);document.body.appendChild(this.el)}else{this.el=e;this._contentEl=this.el.firstChild.childNodes[0];this._lengthspanEl=document.getElementById("lengthspan")}mini_on(this.ctnEl,"mouseenter",this.show,this);mini_on(document,"mousemove",this.hide,this)},destroy:function(e){if(this.textEl){this.textEl.onmouseenter=null;this.textEl.onmouseleave=null;mini.clearEvent(this.textEl);mini.clearEvent(document)}this.el=null;this._lengthspanEl=null;this._contentEl=null},_doUpdate:function(e){e=mini.htmlEncode(e).split(mini.htmlEncode(this.attrDelimiter)).join(this.delimiter);this._contentEl.innerHTML=e},isOverFlow:function(e,t){if(mini.isNull(t)||t==="")return false;if(t.length>300)t=t.substring(0,300);var i;if(document.defaultView)i=document.defaultView.getComputedStyle(e,null);else i=e.currentStyle;var n=i.fontSize;var s=i.fontFamily;this._lengthspanEl.innerHTML=t;this._lengthspanEl.style.fontSize=n;this._lengthspanEl.style.fontFamily=s;if(this._lengthspanEl.offsetWidth-2>e.clientWidth){return true}return false},show:function(){var e=this.textEl.value;if(!this.isOverFlow(this.textEl,e))return;this._doUpdate(e);var t=mini.getBox(this.textEl);this._contentEl.height="auto";var i=Math.max(parseInt(this.textEl.clientWidth)+10,200);var n=t.x+t.width/2-i/2;var s=t.y+t.height+7;if(n+i>jQuery(window).width())n=jQuery(window).width()-i;if(n<0)n=0;this.el.style.left=n+5+"px";this.el.style.top=s+"px";this.el.style.display="block";this._contentEl.style.height="auto";mini.setWidth(this._contentEl,i);mini.setWidth(this._pointyEl,i);if(mini.getHeight(this._contentEl)>200){mini.setHeight(this._contentEl,188)}this.el.focus();this.isshow=true},hide:function(e){if(!e.target.nodeType||mini.findParent(e.target,"mini-buttonedittip")||mini.findParent(e.target,"mini-buttonedit-input")||$(e.target).is(this.textEl)||$(e.target).is(this.ctnEl)){return}this.el.style.display="none"},setIsshow:function(e){if(this.isshow!=e){this.isshow=e;this.isshow?this.show():this.hide()}},getIsshow:function(){return this.isshow}};mini.Calendar=function(){this.viewDate=new Date;this._selectedDates=[];mini.Calendar.superclass.constructor.call(this)};mini.extend(mini.Calendar,mini.Control,{width:220,height:160,monthPicker:false,_clearBorder:false,viewDate:null,_selectedDate:"",_selectedDates:[],multiSelect:false,firstDayOfWeek:0,todayText:"Today",clearText:"Clear",okText:"OK",cancelText:"Cancel",daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],format:"MMM, yyyy",timeFormat:"H:mm",showTime:false,currentTime:true,rows:1,columns:1,headerCls:"",bodyCls:"",footerCls:"",_todayCls:"mini-calendar-today",_weekendCls:"mini-calendar-weekend",_otherMonthCls:"mini-calendar-othermonth",_selectedDateCls:"mini-calendar-selected",showHeader:true,showFooter:true,showWeekNumber:false,showDaysHeader:true,showMonthButtons:true,showYearButtons:true,showTodayButton:true,showClearButton:true,showOkButton:false,isWeekend:function(e){var t=e.getDay();return t==0||t==6},getFirstDateOfMonth:function(e){var e=new Date(e.getFullYear(),e.getMonth(),1);return mini.getWeekStartDate(e,this.firstDayOfWeek)},getShortWeek:function(e){return this.daysShort[e]},uiCls:"mini-calendar",_create:function(){var e='<tr style="width:100%;"><td style="width:100%;"></td></tr>';e+='<tr ><td><div class="mini-calendar-footer">'+'<span style="display:inline-block;"><input name="time" class="mini-timespinner" style="width:80px" format="'+this.timeFormat+'"/>'+'<span class="mini-calendar-footerSpace"></span></span>'+'<span class="mini-calendar-tadayButton">'+this.todayText+"</span>"+'<span class="mini-calendar-footerSpace"></span>'+'<span class="mini-calendar-clearButton">'+this.clearText+"</span>"+'<span class="mini-calendar-okButton">'+this.okText+"</span>"+'<a href="#" class="mini-calendar-focus" style="position:absolute;left:-10px;top:-10px;width:0px;height:0px;outline:none" hideFocus></a>'+"</div></td></tr>";
    var t='<table class="mini-calendar" cellpadding="0" cellspacing="0">'+e+"</table>";var i=document.createElement("div");i.innerHTML=t;this.el=i.firstChild;var n=this.el.getElementsByTagName("tr");var s=this.el.getElementsByTagName("td");this._innerEl=s[0];this._footerEl=mini.byClass("mini-calendar-footer",this.el);this.timeWrapEl=this._footerEl.childNodes[0];this.todayButtonEl=this._footerEl.childNodes[1];this.footerSpaceEl=this._footerEl.childNodes[2];this.closeButtonEl=this._footerEl.childNodes[3];this.okButtonEl=this._footerEl.childNodes[4];this._focusEl=this._footerEl.lastChild;mini.parse(this._footerEl);this.timeSpinner=mini.getbyName("time",this.el);this.doUpdate()},focus:function(){try{this._focusEl.focus()}catch(e){}},destroy:function(e){this._innerEl=this._footerEl=this.timeWrapEl=this.todayButtonEl=this.footerSpaceEl=this.closeButtonEl=null;mini.Calendar.superclass.destroy.call(this,e)},_initEvents:function(){if(this.timeSpinner)this.timeSpinner.on("valuechanged",this.__OnTimeChanged,this);mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"keydown",this.__OnKeyDown,this)},this)},getDateEl:function(e){if(!e)return null;var t=this.uid+"$"+mini.clearTime(e).getTime();return document.getElementById(t)},within:function(e){if(mini.isAncestor(this.el,e.target))return true;if(this.menuEl&&mini.isAncestor(this.menuEl,e.target))return true;return false},setShowHeader:function(e){this.showHeader=e;this.doUpdate()},getShowHeader:function(){return this.showHeader},setShowFooter:function(e){this.showFooter=e;this.doUpdate()},getShowFooter:function(){return this.showFooter},setShowWeekNumber:function(e){this.showWeekNumber=e;this.doUpdate()},getShowWeekNumber:function(){return this.showWeekNumber},setShowDaysHeader:function(e){this.showDaysHeader=e;this.doUpdate()},getShowDaysHeader:function(){return this.showDaysHeader},setShowMonthButtons:function(e){this.showMonthButtons=e;this.doUpdate()},getShowMonthButtons:function(){return this.showMonthButtons},setShowYearButtons:function(e){this.showYearButtons=e;this.doUpdate()},getShowYearButtons:function(){return this.showYearButtons},setShowTodayButton:function(e){this.showTodayButton=e;this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.doUpdate()},getShowTodayButton:function(){return this.showTodayButton},setShowClearButton:function(e){this.showClearButton=e;this.closeButtonEl.style.display=this.showClearButton?"":"none";this.doUpdate()},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(e){this.showOkButton=e;this.okButtonEl.style.display=this.showOkButton?"":"none";this.doUpdate()},getShowOkButton:function(){return this.showOkButton},setViewDate:function(e){e=mini.parseDate(e);if(!e)e=new Date;if(mini.isDate(e))e=new Date(e.getTime());this.viewDate=e;this.doUpdate()},getViewDate:function(){return this.viewDate},setSelectedDate:function(e){e=mini.parseDate(e);if(!mini.isDate(e))e="";else e=new Date(e.getTime());var t=this.getDateEl(this._selectedDate);if(t)mini.removeClass(t,this._selectedDateCls);this._selectedDate=e;if(this._selectedDate)this._selectedDate=mini.cloneDate(this._selectedDate);var t=this.getDateEl(this._selectedDate);if(t)mini.addClass(t,this._selectedDateCls);this.fire("datechanged")},setSelectedDates:function(e){if(!mini.isArray(e))e=[];this._selectedDates=e;this.doUpdate()},getSelectedDate:function(){return this._selectedDate?this._selectedDate:""},setTime:function(e){this.timeSpinner.setValue(e)},getTime:function(){return this.timeSpinner.getFormValue()},setValue:function(e){this.setSelectedDate(e);if(!e){e=new Date}this.setTime(e)},getValue:function(){var e=this._selectedDate;if(e){e=mini.clearTime(e);if(this.showTime){var t=this.timeSpinner.getValue();if(t){e.setHours(t.getHours());e.setMinutes(t.getMinutes());e.setSeconds(t.getSeconds())}}}return e?e:""},getFormValue:function(){var e=this.getValue();if(e)return mini.formatDate(e,"yyyy-MM-dd HH:mm:ss");return""},isSelectedDate:function(e){if(!e||!this._selectedDate)return false;return mini.clearTime(e).getTime()==mini.clearTime(this._selectedDate).getTime()},setMultiSelect:function(e){this.multiSelect=e;this.doUpdate()},getMultiSelect:function(){return this.multiSelect},setRows:function(e){if(isNaN(e))return;if(e<1)e=1;this.rows=e;this.doUpdate()},getRows:function(){return this.rows},setColumns:function(e){if(isNaN(e))return;if(e<1)e=1;this.columns=e;this.doUpdate()},getColumns:function(){return this.columns},setShowTime:function(e){if(this.showTime!=e){this.showTime=e;this.timeWrapEl.style.display=this.showTime?"":"none";this.doLayout()}},getShowTime:function(){return this.showTime},setTimeFormat:function(e){if(this.timeFormat!=e){this.timeSpinner.setFormat(e);this.timeFormat=this.timeSpinner.format}},getTimeFormat:function(){return this.timeFormat},doLayout:function(){if(!this.canLayout())return;this.timeWrapEl.style.display=this.showTime?"":"none";this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.closeButtonEl.style.display=this.showClearButton?"":"none";this.okButtonEl.style.display=this.showOkButton?"":"none";this.footerSpaceEl.style.display=this.showClearButton&&this.showTodayButton?"":"none";this._footerEl.style.display=this.showFooter?"":"none";var e=this._innerEl.firstChild;var t=this.isAutoHeight();if(!t){e.parentNode.style.height="100px";h=jQuery(this.el).height();h-=jQuery(this._footerEl).outerHeight();e.parentNode.style.height=h+"px"}else{e.parentNode.style.height=""}mini.layout(this._footerEl);if(this.monthPicker)this._tryShowMenu()},doUpdate:function(){if(!this._allowUpdate)return;var e=new Date(this.viewDate.getTime());var t=this.rows==1&&this.columns==1;var i=100/this.rows;var n='<table class="mini-calendar-views" border="0" cellpadding="0" cellspacing="0">';for(var s=0,r=this.rows;s<r;s++){n+="<tr >";for(var l=0,o=this.columns;l<o;l++){n+='<td style="height:'+i+'%">';n+=this._CreateView(e,s,l);n+="</td>";e=new Date(e.getFullYear(),e.getMonth()+1,1)}n+="</tr>"}n+="</table>";this._innerEl.innerHTML=n;var a=this.el;setTimeout(function(){mini.repaint(a)},100);this.doLayout()},_CreateView:function(e,t,i){var n=e.getMonth();var s=this.getFirstDateOfMonth(e);var r=new Date(s.getTime());var l=mini.clearTime(new Date).getTime();var o=this.value?mini.clearTime(this.value).getTime():-1;var a=this.rows>1||this.columns>1;var h="";h+='<table class="mini-calendar-view" border="0" cellpadding="0" cellspacing="0">';if(this.showHeader){h+='<tr ><td colSpan="10" class="mini-calendar-header"><div class="mini-calendar-headerInner">';if(t==0&&i==0){h+='<div class="mini-calendar-prev">';if(this.showYearButtons)h+='<span class="mini-calendar-yearPrev"></span>';if(this.showMonthButtons)h+='<span class="mini-calendar-monthPrev"></span>';h+="</div>"}if(t==0&&i==this.columns-1){h+='<div class="mini-calendar-next">';if(this.showMonthButtons)h+='<span class="mini-calendar-monthNext"></span>';if(this.showYearButtons)h+='<span class="mini-calendar-yearNext"></span>';h+="</div>"}h+='<span class="mini-calendar-title">'+mini.formatDate(e,this.format)+"</span>";h+="</div></td></tr>"}if(this.showDaysHeader){h+='<tr class="mini-calendar-daysheader"><td class="mini-calendar-space"></td>';if(this.showWeekNumber){h+='<td sclass="mini-calendar-weeknumber"></td>'}for(var u=this.firstDayOfWeek,d=u+7;u<d;u++){var c=this.getShortWeek(u);h+='<td yAlign="middle">';h+=c;h+="</td>";s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}h+='<td class="mini-calendar-space"></td></tr>'}s=r;for(var f=0;f<=5;f++){h+='<tr class="mini-calendar-days"><td class="mini-calendar-space"></td>';if(this.showWeekNumber){var m=mini.getWeek(s.getFullYear(),s.getMonth()+1,s.getDate());if(String(m).length==1)m="0"+m;h+='<td class="mini-calendar-weeknumber" yAlign="middle">'+m+"</td>"}for(var u=this.firstDayOfWeek,d=u+7;u<d;u++){var p=this.isWeekend(s);var g=mini.clearTime(s).getTime();var v=g==l;var _=this.isSelectedDate(s);if(n!=s.getMonth()&&a){g=-1}var y=this._OnDrawDate(s);h+='<td yAlign="middle" id="';h+=this.uid+"$"+g;h+='" class="mini-calendar-date ';if(p){h+=" mini-calendar-weekend "}if(y.allowSelect==false){h+=" mini-calendar-disabled "}if(n!=s.getMonth()&&a){}else{if(_){h+=" "+this._selectedDateCls+" "}if(v){h+=" mini-calendar-today "}}if(n!=s.getMonth()){h+=" mini-calendar-othermonth "}if(y.dateCls)h+=" "+y.dateCls;h+='" style="';if(y.dateStyle)h+=y.dateStyle;h+='">';if(n!=s.getMonth()&&a){}else{h+=y.dateHtml}h+="</td>";s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}h+='<td class="mini-calendar-space"></td></tr>'}h+='<tr class="mini-calendar-bottom" colSpan="10"><td ></td></tr>';h+="</table>";return h},_OnDrawDate:function(e){var t={date:e,dateCls:"",dateStyle:"",dateHtml:e.getDate(),allowSelect:true};this.fire("drawdate",t);return t},_OnDateClick:function(e,t){this.hideMenu();var i={date:e,action:t};this.fire("dateclick",i);this._OnValueChanged()},menuEl:null,menuYear:null,menuSelectMonth:null,menuSelectYear:null,_tryShowMenu:function(){if(!this.menuEl){var e=this;setTimeout(function(){e.showMenu()},1)}},showMenu:function(){this.hideMenu();this.menuYear=parseInt(this.viewDate.getFullYear()/10)*10;this._menuselectMonth=this.viewDate.getMonth();this._menuselectYear=this.viewDate.getFullYear();var e='<div class="mini-calendar-menu"></div>';this.menuEl=mini.append(document.body,e);this.updateMenu(this.viewDate);var t=this.getBox();if(this.el.style.borderWidth=="0px"){this.menuEl.style.border="0"}mini.setBox(this.menuEl,t);mini.on(this.menuEl,"click",this.__OnMenuClick,this);mini.on(document,"mousedown",this.__OnBodyMenuMouseDown,this)},hideMenu:function(){if(this.menuEl){mini.un(this.menuEl,"click",this.__OnMenuClick,this);mini.un(document,"mousedown",this.__OnBodyMenuMouseDown,this);jQuery(this.menuEl).remove();this.menuEl=null}},updateMenu:function(){var e='<div class="mini-calendar-menu-years">';var t=mini.parseDate(this.maxDate);var i=mini.parseDate(this.minDate);for(var n=this.menuYear,s=this.menuYear+10;n<s;n++){var r=n;var l="";var o=mini.isDate(i)&&n<i.getFullYear()||mini.isDate(t)&&n>t.getFullYear();if(this._menuselectYear==n)l="mini-calendar-menu-selected";e+='<a id="'+n+'" class="mini-calendar-menu-year '+l+'" href="javascript:void(0);" hideFocus onclick="return false" '+(o?"disabled":"")+">"+r+"</a>"}e+='<div class="mini-calendar-menu-prevYear" '+(mini.isDate(i)&&this.menuYear<=i.getFullYear()?"disabled":"")+'></div><div class="mini-calendar-menu-nextYear" '+(mini.isDate(t)&&this.menuYear+10>t.getFullYear()?"disabled":"")+'></div><div style="clear:both;"></div></div>';e+='<div class="mini-calendar-menu-months">';for(var n=0,s=12;n<s;n++){var o=mini.isDate(i)&&(this._menuselectYear<i.getFullYear()||this._menuselectYear==i.getFullYear()&&n<i.getMonth())||mini.isDate(t)&&(this._menuselectYear>t.getFullYear()||this._menuselectYear==t.getFullYear()&&n>t.getMonth());var r=mini.getShortMonth(n);var l="";if(this._menuselectMonth==n)l="mini-calendar-menu-selected";e+='<a id="'+n+'" class="mini-calendar-menu-month '+l+'" href="javascript:void(0);" hideFocus onclick="return false" '+(o?"disabled":"")+">"+r+"</a>"}e+='<div style="clear:both;"></div></div>';e+='<div class="mini-calendar-footer">'+'<span class="mini-calendar-okButton">'+this.okText+"</span>"+'<span class="mini-calendar-footerSpace"></span>'+'<span class="mini-calendar-cancelButton">'+this.cancelText+"</span>"+"</div>"+'<div style="clear:both;"></div>';this.menuEl.innerHTML=e},__OnMenuClick:function(e){var t=e.target;if($(t).is("[disabled]"))return;var i=mini.findParent(t,"mini-calendar-menu-month");var n=mini.findParent(t,"mini-calendar-menu-year");if(i){if($(i).is("[disabled]"))return;this._menuselectMonth=parseInt(i.id);this.updateMenu();var s=new Date(this._menuselectYear,this._menuselectMonth,1);if(this.monthPicker){this.setViewDate(s);this.setSelectedDate(s);this._OnDateClick(s)}else{this.setViewDate(s);this.hideMenu()}}else if(n){this._menuselectYear=parseInt(n.id);this.updateMenu()}else if(mini.findParent(t,"mini-calendar-menu-prevYear")){this.menuYear=this.menuYear-1;this.menuYear=parseInt(this.menuYear/10)*10;this.updateMenu()}else if(mini.findParent(t,"mini-calendar-menu-nextYear")){this.menuYear=this.menuYear+11;this.menuYear=parseInt(this.menuYear/10)*10;this.updateMenu()}else if(mini.findParent(t,"mini-calendar-okButton")){var s=new Date(this._menuselectYear,this._menuselectMonth,1);if(this.monthPicker){this.setViewDate(s);this.setSelectedDate(s);this._OnDateClick(s)}else{this.setViewDate(s);this.hideMenu()}}else if(mini.findParent(t,"mini-calendar-cancelButton")){if(this.monthPicker){this._OnDateClick(null,"cancel")}else{this.hideMenu()}}e.preventDefault();return false},__OnBodyMenuMouseDown:function(e){if(!mini.findParent(e.target,"mini-calendar-menu")){if(!mini.findParent(e.target,"mini-monthpicker")){this.hideMenu()}}},__OnClick:function(e){var t=this.viewDate;if(this.enabled==false)return;var i=e.target;var n=mini.findParent(e.target,"mini-calendar-title");if(mini.findParent(i,"mini-calendar-monthNext")){t.setMonth(t.getMonth()+1);this.setViewDate(t)}else if(mini.findParent(i,"mini-calendar-yearNext")){t.setFullYear(t.getFullYear()+1);this.setViewDate(t)}else if(mini.findParent(i,"mini-calendar-monthPrev")){t.setMonth(t.getMonth()-1);this.setViewDate(t)}else if(mini.findParent(i,"mini-calendar-yearPrev")){t.setFullYear(t.getFullYear()-1);this.setViewDate(t)}else if(mini.findParent(i,"mini-calendar-tadayButton")){var s=new Date;this.setViewDate(s);this.setSelectedDate(s);if(this.currentTime){var r=new Date;this.setTime(r)}this._OnDateClick(s,"today")}else if(mini.findParent(i,"mini-calendar-clearButton")){this.setSelectedDate(null);this.setTime(null);this._OnDateClick(null,"clear")}else if(mini.findParent(i,"mini-calendar-okButton")){this._OnDateClick(null,"ok")}else if(n){this.showMenu()}var l=mini.findParent(e.target,"mini-calendar-date");if(l&&!mini.hasClass(l,"mini-calendar-disabled")){var o=l.id.split("$");var a=parseInt(o[o.length-1]);if(a==-1)return;var h=new Date(a);this._OnDateClick(h)}},__OnMouseDown:function(e){if(this.enabled==false)return;var t=mini.findParent(e.target,"mini-calendar-date");if(t&&!mini.hasClass(t,"mini-calendar-disabled")){var i=t.id.split("$");var n=parseInt(i[i.length-1]);if(n==-1)return;var s=new Date(n);this.setSelectedDate(s)}},__OnTimeChanged:function(e){this.fire("timechanged");this._OnValueChanged()},__OnKeyDown:function(e){if(this.enabled==false)return;var t=this.getSelectedDate();if(!t)t=new Date(this.viewDate.getTime());switch(e.keyCode){case 27:break;case 13:break;case 37:t=mini.addDate(t,-1,"D");break;case 38:t=mini.addDate(t,-7,"D");break;case 39:t=mini.addDate(t,1,"D");break;case 40:t=mini.addDate(t,7,"D");break;default:break}var i=this;if(t.getMonth()!=i.viewDate.getMonth()){i.setViewDate(mini.cloneDate(t));i.focus()}var n=this.getDateEl(t);if(n&&mini.hasClass(n,"mini-calendar-disabled")){return}i.setSelectedDate(t);if(e.keyCode==37||e.keyCode==38||e.keyCode==39||e.keyCode==40){e.preventDefault()}},_OnValueChanged:function(){this.fire("valuechanged")},getAttrs:function(e){var t=mini.Calendar.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["viewDate","rows","columns","ondateclick","ondrawdate","ondatechanged","timeFormat","ontimechanged","onvaluechanged"]);mini._ParseBool(e,t,["multiSelect","showHeader","showFooter","showWeekNumber","showDaysHeader","showMonthButtons","showYearButtons","showTodayButton","showClearButton","showTime","showOkButton"]);return t}});mini.regClass(mini.Calendar,"calendar");mini.CalendarYear=function(){this.viewDate=new Date;this._selectedDates=[];mini.CalendarYear.superclass.constructor.call(this)};mini.extend(mini.CalendarYear,mini.Control,{width:220,viewDate:null,_clearBorder:false,uiCls:"mini-calendaryear",_create:function(){this.el=document.createElement("div");this.startYear=parseInt(this.viewDate.getFullYear()/10)*10;this.selectYear=this.viewDate.getFullYear();s='<div class="mini-calendaryear-years"></div>';this.el.innerHTML=s;this.yearsEl=this.el.childNodes[0];this.updateYears()},_initEvents:function(){mini.on(this.el,"click",this.__OnClick,this)},updateYears:function(){var e="";for(var t=this.startYear,i=this.startYear+20;t<i;t++){var n=t;var s=this._OnDrawDate(n);var r="";if(this.selectYear==t)r="mini-calendaryear-year-selected";if(s.allowSelect){e+='<a id="'+t+'" class="mini-calendaryear-year '+r+'" href="javascript:void(0);" hideFocus onclick="return false">'+n+"</a>"}else{e+='<a id="'+t+'" class="mini-calendaryear-year mini-calendar-disabled '+r+'" href="javascript:void(0);" hideFocus onclick="return false">'+n+"</a>"}}e+='<div class="mini-calendaryear-prevYear"></div><div class="mini-calendaryear-nextYear"></div><div style="clear:both;"></div>';this.yearsEl.innerHTML=e},_OnDrawDate:function(e){var t={date:e,dateCls:"",dateStyle:"",dateHtml:e,allowSelect:true};this.fire("drawdate",t);return t},__OnClick:function(e){var t=this.viewDate;if(this.enabled==false)return;var i=e.target;var n=mini.findParent(i,"mini-calendaryear-year");if(n){this.selectYear=parseInt(n.id);this.setViewDate(this.selectYear);this.updateYears();this._OnDateClick(this.selectYear)}else if(mini.findParent(i,"mini-calendaryear-prevYear")){this.startYear=this.startYear-20;this.updateYears()}else if(mini.findParent(i,"mini-calendaryear-nextYear")){this.startYear=this.startYear+20;this.updateYears()}var s=mini.findParent(e.target,"mini-calendaryear-year");if(s&&!mini.hasClass(s,"mini-calendar-disabled")){var r=s.id.split("$");var l=parseInt(r[r.length-1])}},_OnDateClick:function(e,t){var i={year:e,action:t};this.fire("dateclick",i)},setViewDate:function(e){e=mini.parseDate(e);if(!mini.isDate(e))return;this.viewDate=e},getViewDate:function(){return this._calendar.getViewDate()},setValue:function(e){this.value=e;this.selectYear=e;this.startYear=parseInt(this.selectYear/10)*10},getValue:function(){return this.value}});mini.regClass(mini.CalendarYear,"calendaryear");mini.DataSet=function(){this._sources={};this._data={};this._links=[];this._originals={};mini.DataSet.superclass.constructor.call(this)};mini.extend(mini.DataSet,mini.Component,{add:function(e,t){if(!e||!t)return;this._sources[e]=t;this._data[e]=[];t.autoCreateNewID=true;t._originalIdField=t.getIdField();t._clearOriginals=false;t.on("addrow",this.__OnRowChanged,this);t.on("updaterow",this.__OnRowChanged,this);t.on("deleterow",this.__OnRowChanged,this);t.on("removerow",this.__OnRowChanged,this);t.on("preload",this.__OnDataPreLoad,this);t.on("selectionchanged",this.__OnDataSelectionChanged,this)},addLink:function(e,t,i){if(!e||!t||!i)return;if(!this._sources[e]||!this._sources[t])return;var n={parentName:e,childName:t,parentField:i};this._links.push(n)},clearData:function(){this._data={};this._originals={};for(var e in this._sources){this._data=[]}},getData:function(){return this._data},_getNameByListControl:function(e){for(var t in this._sources){var i=this._sources[t];if(i==e)return t}},_getRecord:function(e,t,i){var n=this._data[e];if(!n)return false;for(var s=0,r=n.length;s<r;s++){var l=n[s];if(l[i]==t[i])return l}return null},__OnRowChanged:function(e){var t=e.type;var i=e.record;var n=this._getNameByListControl(e.sender);var s=this._getRecord(n,i,e.sender.getIdField());var r=this._data[n];if(s){var r=this._data[n];r.remove(s)}if(t=="removerow"&&i._state=="added"){}else{r.push(i)}this._originals[n]=e.sender._originals;if(i._state=="added"){var l=this._getParentSource(e.sender);if(l){var o=l.getSelected();if(o){i._parentId=o[l.getIdField()]}else{r.remove(i)}}}},__OnDataPreLoad:function(e){var t=e.sender;var i=this._getNameByListControl(t);var n=e.sender.getIdField();var s=this._data[i];var r={};for(var l=0,o=s.length;l<o;l++){var a=s[l];r[a[n]]=a}var h=this._originals[i];if(h){t._originals=h}var u=e.data||[];for(var l=0,o=u.length;l<o;l++){var a=u[l];var d=r[a[n]];if(d){delete d._uid;mini.copyTo(a,d)}}var c=this._getParentSource(t);if(t.getPageIndex&&t.getPageIndex()==0){var f=[];for(var l=0,o=s.length;l<o;l++){var a=s[l];if(a._state=="added"){if(c){var m=c.getSelected();if(m&&m[c.getIdField()]==a._parentId){f.push(a)}}else{f.push(a)}}}f.reverse();u.insertRange(0,f)}var p=[];for(var l=u.length-1;l>=0;l--){var a=u[l];var d=r[a[n]];if(d&&d._state=="removed"){u.removeAt(l);p.push(d)}}},_getParentSource:function(e){var t=this._getNameByListControl(e);for(var i=0,n=this._links.length;i<n;i++){var s=this._links[i];if(s.childName==t){return this._sources[s.parentName]}}},_getLinks:function(e){var t=this._getNameByListControl(e);var i=[];for(var n=0,s=this._links.length;n<s;n++){var r=this._links[n];if(r.parentName==t){i.push(r)}}return i},__OnDataSelectionChanged:function(e){var t=e.sender;var i=t.getSelected();var n=this._getLinks(t);for(var s=0,r=n.length;s<r;s++){var l=n[s];var o=this._sources[l.childName];if(i){var a={};a[l.parentField]=i[t.getIdField()];o.load(a)}else{o.loadData([])}}}});mini.regClass(mini.DataSet,"dataset");mini.FileUpload=function(e){this.postParam={};mini.FileUpload.superclass.constructor.call(this,e);this.on("validation",this.__OnValidation,this)};mini.extend(mini.FileUpload,mini.ButtonEdit,{width:180,buttonText:"浏览...",_buttonWidth:56,limitTypeErrorText:"上传文件格式为：",readOnly:true,_cellSpacing:0,limitSize:"",limitType:"",typesDescription:"上传文件格式",uploadLimit:0,queueLimit:"",flashUrl:"",uploadUrl:"",showUploadProgress:true,usequerystring:false,postParam:null,uploadOnSelect:false,uiCls:"mini-fileupload",_create:function(){mini.FileUpload.superclass._create.call(this);mini.addClass(this.el,"mini-htmlfile");this._progressbarEl=mini.append(this._borderEl,'<div id="'+this._id+'$progressbar"  class="mini-fileupload-progressbar"><div id="'+this._id+'$complete" class="mini-fileupload-complete"></div></div>');this._completeEl=this._progressbarEl.firstChild;this._uploadId=this.uid+"$button_placeholder";this._fileEl=mini.append(this.el,'<span id="'+this._uploadId+'"></span>');this.uploadEl=this._fileEl;mini.on(this._borderEl,"mousemove",this.__OnMouseMove,this)},_getButtonHtml:function(){var e="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" "+"onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+e+">"+this.buttonText+"</span>"},destroy:function(e){if(this._innerEl){mini.clearEvent(this._innerEl);this._innerEl=null}mini.FileUpload.superclass.destroy.call(this,e)},doLayout:function(){mini.FileUpload.superclass.doLayout.call(this);if(this.swfUpload){var e=this.swfUpload.movieElement;e.style.width=this._borderEl.style.width}},flashChecker:function(){var e=0;var t=0;if(document.all){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(i){e=1;VSwf=i.GetVariable("$version");t=parseInt(VSwf.split(" ")[1].split(",")[0])}}catch(n){}}else{if(navigator.plugins&&navigator.plugins.length>0){var i=navigator.plugins["Shockwave Flash"];if(i){e=1;var s=i.description.split(" ");for(var r=0;r<s.length;++r){if(isNaN(parseInt(s[r])))continue;t=parseInt(s[r])}}}}return{hasFlash:e,version:t}},__OnMouseMove:function(e){if(this.enabled==false)return;var t=this;if(!this.swfUpload){if(!this.flashChecker().hasFlash){alert("请安装Flash Player。");return}var i=new SWFUpload({file_post_name:this.name,upload_url:t.uploadUrl,flash_url:t.flashUrl,file_size_limit:t.limitSize,file_types:t.limitType,file_types_description:t.typesDescription,file_upload_limit:parseInt(t.uploadLimit),file_queue_limit:t.queueLimit,use_query_string:t.usequerystring,file_queued_handler:mini.createDelegate(this.__on_file_queued,this),file_queue_error_handler:mini.createDelegate(this.__on_file_queued_error,this),upload_error_handler:mini.createDelegate(this.__on_upload_error,this),upload_success_handler:mini.createDelegate(this.__on_upload_success,this),upload_complete_handler:mini.createDelegate(this.__on_upload_complete,this),upload_progress_handler:mini.createDelegate(this.__on_upload_progress,this),button_placeholder_id:this._uploadId,button_width:1e3,button_height:50,button_window_mode:"transparent",button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,debug:false});i.flashReady();this.swfUpload=i;var n=this.swfUpload.movieElement;n.style.zIndex=1e3;n.style.position="absolute";n.style.left="0px";n.style.top="0px";n.style.width="100%";n.style.height="50px"}},setLimitSize:function(e){this.limitSize=e},addPostParam:function(e){mini.copyTo(this.postParam,e)},getPostParam:function(){return this.postParam},setLimitType:function(e){this.limitType=e;if(this.swfUpload)this.swfUpload.setFileTypes(this.limitType,this.typesDescription)},getLimitType:function(){return this.limitType},setTypesDescription:function(e){this.typesDescription=e;if(this.swfUpload)this.swfUpload.setFileTypes(this.limitType,this.typesDescription)},getTypesDescription:function(){return this.typesDescription},setButtonText:function(e){this.buttonText=e;this._buttonEl.innerHTML=e},getButtonText:function(){return this.buttonText},setUploadLimit:function(e){this.uploadLimit=e},setQueueLimit:function(e){this.queueLimit=e},setUseQueryString:function(e){this.usequerystring=e},setFlashUrl:function(e){this.flashUrl=e},setUploadUrl:function(e){if(this.swfUpload){this.swfUpload.setUploadURL(e)}this.uploadUrl=e},getUploadUrl:function(){return this.uploadUrl},setPostParam:function(e){if(this.swfUpload){this.swfUpload.setPostParams(e)}this.postParam=e},setName:function(e){this.name=e},startUpload:function(e){var t={cancel:false};this.fire("beforeupload",t);if(t.cancel==true)return;if(this.swfUpload){this.swfUpload.setPostParams(this.postParam);var i=this.swfUpload.getStats();var n=this.swfUpload.getFile(i.files_queued+i.successful_uploads+i.upload_errors+i.queue_errors-1);this.swfUpload.startUpload(n.id)}},setShowUploadProgress:function(e){this.showUploadProgress=e;this._progressbarEl.style.display=e?"block":"none"},getShowUploadProgress:function(){return this.showUploadProgress},__on_upload_progress:function(e,t,i){if(this.showUploadProgress){var n=mini.getWidth(this._progressbarEl);var s=n*t/i;mini.setWidth(this._completeEl,s)}this._progressbarEl.style.display=this.showUploadProgress?"block":"none";var r={file:e,complete:t,total:i};this.fire("uploadprogress",r)},__on_file_queued:function(e){var t={file:e};if(this.uploadOnSelect){this.startUpload()}this.setText(e.name);this.setValue(e.name);this.fire("fileselect",t)},__on_file_queued_error:function(e,t,i){switch(t){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:mini.alert("上传文件太大, 文件名: "+e.name+", File size: "+e.size);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:mini.alert("文件大小为0, 文件名: "+e.name);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:mini.alert("文件类型不符, 文件名: "+e.name);break;default:break}},__on_upload_success:function(e,t){var i={file:e,serverData:t};this.fire("uploadsuccess",i);this._progressbarEl.style.display="none"},__on_upload_error:function(e,t,i){if(i=="File Cancelled")return;this._progressbarEl.style.display="none";var n={file:e,code:t,message:i};this.fire("uploaderror",n)},__on_upload_complete:function(e){this._progressbarEl.style.display="none";this.fire("uploadcomplete",e)},__fileError:function(){},setValue:function(e,t){mini.FileUpload.superclass.setValue.call(this,e,t);mini.FileUpload.superclass.setText.call(this,e)},getAttrs:function(e){var t=mini.FileUpload.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["limitType","limitSize","flashUrl","uploadUrl","uploadLimit","buttonText","showUploadProgress","onuploadsuccess","onuploaderror","onuploadcomplete","onfileselect","onuploadprogress","usequerystring"]);mini._ParseBool(e,t,["uploadOnSelect"]);return t}});mini.regClass(mini.FileUpload,"fileupload");mini.Fit=function(){mini.Fit.superclass.constructor.call(this)};mini.extend(mini.Fit,mini.Container,{style:"",_clearBorder:false,uiCls:"mini-fit",_create:function(){this.el=document.createElement("div");this.el.className="mini-fit";this._bodyEl=this.el},_initEvents:function(){},isFixedSize:function(){return false},doLayout:function(){if(!this.canLayout())return;var e=this.el.parentNode;var t=mini.getChildNodes(e);if(e==document.body){this.el.style.height="0px"}var i=mini.getHeight(e,true);for(var n=0,s=t.length;n<s;n++){var r=t[n];var l=r.tagName?r.tagName.toLowerCase():"";if(r==this.el||(l=="style"||l=="script"))continue;var o=mini.getStyle(r,"position");if(o=="absolute"||o=="fixed")continue;var a=mini.getHeight(r);var h=mini.getMargins(r);i=i-a-h.top-h.bottom}var u=mini.getBorders(this.el);var d=mini.getPaddings(this.el);var h=mini.getMargins(this.el);i=i-h.top-h.bottom;if(jQuery.boxModel){i=i-d.top-d.bottom-u.top-u.bottom}if(i<0)i=0;this.el.style.height=i+"px";try{t=mini.getChildNodes(this.el);for(var n=0,s=t.length;n<s;n++){var r=t[n];mini.layout(r)}}catch(c){}},set_bodyParent:function(e){if(!e)return;var t=this._bodyEl;var i=e;while(i.firstChild){try{t.appendChild(i.firstChild)}catch(n){}}this.doLayout()},getAttrs:function(e){var t=mini.Fit.superclass.getAttrs.call(this,e);t._bodyParent=e;return t}});mini.regClass(mini.Fit,"fit");mini.Form=function(e){this.el=mini.byId(e);if(!this.el)throw new Error("form element not null");mini.Form.superclass.constructor.call(this)};mini.extend(mini.Form,mini.Component,{el:null,getFields:function(){if(!this.el)return[];var e=mini.findControls(function(e){if(!e.el||e.formField!=true)return false;if(mini.isAncestor(this.el,e.el))return true;return false},this);return e},getFieldsMap:function(){var e=this.getFields();var t={};for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s.name)t[s.name]=s}return t},getField:function(e){if(!this.el)return null;return mini.getbyName(e,this.el)},getData:function(e,t,i){if(mini.isNull(t))t=true;var n=e?"getFormValue":"getValue";var s=this.getFields();var r={};var l={};for(var o=0,a=s.length;o<a;o++){var h=s[o];var u=h[n];if(!u)continue;if(h.name){l[h.name]=h.name;if(t==true){mini._setMap(h.name,u.call(h),r)}else{r[h.name]=u.call(h)}}if(h.textName&&h.getText){if(t==true){r[h.textName]=h.getText()}else{mini._setMap(h.textName,h.getText(),r)}}}if(i){var d=jQuery(this.el).find(":input:hidden");for(var c=0;c<d.length;c++){var f=mini.getAttr(d[c],"name");var m=d[c].value;if(!f||l[f])continue;if(t==true){if(!l[f])mini._setMap(f,d[c].value,r)}else{r[f]=m}}}return r},getSearchData:function(){var e=this.getData();var t=this.getFields();var i=[];for(var n=0,s=t.length;n<s;n++){var r={};var l=t[n];r.property=l.name;r.value=e[l.name];r.operator=l.operator||"EQ";i.push(r)}var o={};o.filters=i;return o},setData:function(e,t,i,n){if(mini.isNull(i))i=true;if(typeof e!="object")e={};var s=this.getFieldsMap();for(var r in s){var l=s[r];if(!l)continue;if(l.setValue){var o=e[r];if(i==true){o=mini._getMap(r,e)}if(o===undefined&&!t)continue;if(o===null)o="";l.setValue(o,n)}if(l.setText&&l.textName){var a=e[l.textName];if(i==true){a=mini._getMap(l.textName,e)}if(mini.isNull(a))a="";l.setText(a)}}},getChanges:function(e,t){var i=this.getFields();var n=e?"getFormValue":"getValue";var s={};var r={};var l,o;for(var a=0,h=i.length;a<h;a++){var u=i[a];var d=u[n];var c=u["getValue"];var f=u["getDefaultValue"];if(!d||!f||!c)continue;l=f.call(u);o=c.call(u);if(u.uiCls=="mini-datepicker"){if(!l&&!o){continue}else if(l&&o){l=mini.parseDate(l);if(o-l==0)continue}}else if(u.uiCls=="mini-timespinner"){if(!l&&!o){continue}if(l&&o){l=mini.parseTime(l,u.format);if(mini.formatDate(o,"H:mm:ss")==mini.formatDate(l,"H:mm:ss")){continue}}}else{if(m(l)==m(o))continue}if(u.name){r[u.name]=u.name;if(t==true){mini._setMap(u.name,d.call(u),s)}else{s[u.name]=d.call(u)}}if(u.textName&&u.getText){if(t==true){s[u.textName]=u.getText()}else{mini._setMap(u.textName,u.getText(),s)}}}function m(e){if(e=="")return null;return e}return s},reset:function(){var e=this.getFields();for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n.destroyed||!n.setValue)continue;if(n.setText&&n._clearText!==false){n.setText("")}n.setValue(n.defaultValue,false)}this.setIsValid(true)},clear:function(){var e=this.getFields();for(var t=0,i=e.length;t<i;t++){var n=e[t];if(!n.setValue)continue;if(n.setText&&n._clearText!==false){
    n.setText("")}n.setValue("",false)}this.setIsValid(true)},validate:function(e,t){var i=this.getFields();for(var n=0,s=i.length;n<s;n++){var r=i[n];if(!r.validate)continue;if(t===undefined)t=false;if(r.isDisplay&&r.isDisplay()||t){var l=r.validate();if(l==false&&e===false){break}}}return this.isValid()},setIsValid:function(e){var t=this.getFields();for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.destroyed||!s.setIsValid)continue;s.setIsValid(e)}},isValid:function(e){var t=this.getFields();for(var i=0,n=t.length;i<n;i++){var s=t[i];if(!s.isValid)continue;if(e===undefined)e=false;if(s.isDisplay&&s.isDisplay()||e)if(s.isValid()==false){$(s._textEl).focus();return false}}return true},getErrorTexts:function(){var e=[];var t=this.getErrors();for(var i=0,n=t.length;i<n;i++){var s=t[i];e.push(s.errorText)}return e},getErrors:function(){var e=[];var t=this.getFields();for(var i=0,n=t.length;i<n;i++){var s=t[i];if(!s.isValid)continue;if(s.isValid()==false){e.push(s)}}return e},mask:function(e){if(typeof e=="string")e={html:e};e=e||{};e.el=this.el;if(!e.cls)e.cls=this._maskCls;mini.mask(e)},unmask:function(){mini.unmask(this.el)},_maskCls:"mini-mask-loading",loadingMsg:"数据加载中，请稍后...",loading:function(e){this.mask(e||this.loadingMsg)},__OnValueChanged:function(e){this._changed=true},_changed:false,setChanged:function(e){this._changed=e;var t=this.getFields();for(var i=0,n=t.length;i<n;i++){var s=t[i];s.on("valuechanged",this.__OnValueChanged,this)}},isChanged:function(){return this._changed},setEnabled:function(e){var t=this.getFields();for(var i=0,n=t.length;i<n;i++){var s=t[i];s.setEnabled(e)}},setEnterKeyNext:function(){var e=this.getFields();function t(t){function i(t){var i=t.sender;var n=1;var s=e.indexOf(i);r(s);function r(t){var i=e[t+1];if(i){if(i.uiCls=="mini-textbox"||i.uiCls=="mini-textarea"||i.uiCls=="mini-password"||i.uiCls=="mini-treeselect"||i.uiCls=="mini-combobox"&&i.name!="pagesize"||i.uiCls=="mini-datepicker"||i.uiCls=="mini-monthpicker"||i.uiCls=="mini-yearpicker"||i.uiCls=="mini-timespinner"||i.uiCls=="mini-spinner"||i.uiCls=="mini-checkbox"||i.uiCls=="mini-radiobuttonlist"||i.uiCls=="mini-checkboxlist"||i.uiCls=="mini-autocomplete"){if(i.isShowPopup&&i.isShowPopup())return;i.focus();if(i.showPopup&&i.uiCls!="mini-autocomplete"){setTimeout(function(){i.showPopup()},1)}}else{t++;r(t)}}}}t.on("enter",i)}for(var i=0,n=e.length;i<n;i++){var s=e[i];t(s)}}});mini=mini||{};mini.Hidden=function(){mini.Hidden.superclass.constructor.call(this)};mini.extend(mini.Hidden,mini.Control,{_clearBorder:false,formField:true,value:"",uiCls:"mini-hidden",_create:function(){this.el=document.createElement("input");this.el.type="hidden";this.el.className="mini-hidden"},setName:function(e){this.name=e;this.el.name=e},setValue:function(e){if(e===null||e===undefined)e="";this.value=e;if(mini.isDate(e)){var t=e.getFullYear();var i=e.getMonth()+1;var n=e.getDate();i=i<10?"0"+i:i;n=n<10?"0"+n:n;this.el.value=t+"-"+i+"-"+n}else{this.el.value=e}},getValue:function(){return this.value},getFormValue:function(){return this.el.value}});mini.regClass(mini.Hidden,"hidden");mini.HtmlFile=function(){mini.HtmlFile.superclass.constructor.call(this);this.on("validation",this.__OnValidation,this)};mini.extend(mini.HtmlFile,mini.ButtonEdit,{width:180,buttonText:"浏览...",_buttonWidth:56,limitType:"",limitTypeErrorText:"上传文件格式为：",allowInput:false,readOnly:true,_cellSpacing:0,showToolTip:true,uiCls:"mini-htmlfile",_create:function(){mini.HtmlFile.superclass._create.call(this);this._fileEl=mini.append(this.el,'<input type="file" hideFocus class="mini-htmlfile-file" name="'+this.name+'" ContentEditable=false/>');mini.on(this._fileEl,"change",this.__OnFileChange,this)},set:function(e){var t=!(e.showToolTip===false);e.showToolTip=false;mini.HtmlFile.superclass.set.call(this,e);this.showToolTip=t;if(this.showToolTip){this.tooltip=new mini.ButtonEditTip(this._fileEl,this.el)}},_getButtonHtml:function(){var e="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" "+"onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+e+">"+this.buttonText+"</span>"},__OnFileChange:function(e){this.value=this._textEl.value=this._fileEl.value;this._OnValueChanged();e={htmlEvent:e};this.fire("fileselect",e)},__OnMouseMove:function(e){this.tooltip.fire("mousemove");return;var t=e.pageX,i=e.pageY;var n=mini.getBox(this.el);t=t-n.x-5;i=i-n.y-5;if(this.enabled==false){t=-20;i=-20}this._fileEl.style.display="";this._fileEl.style.left=t+"px";this._fileEl.style.top=i+"px"},__OnValidation:function(e){if(!this.limitType)return;var t=e.value.split(".");var i="*."+t[t.length-1];var n=this.limitType.split(";");if(n.length>0&&n.indexOf(i)==-1){e.errorText=this.limitTypeErrorText+this.limitType;e.isValid=false}},setName:function(e){this.name=e;mini.setAttr(this._fileEl,"name",this.name)},getValue:function(){return this._textEl.value},setButtonText:function(e){this.buttonText=e},getButtonText:function(){return this.buttonText},setLimitType:function(e){this.limitType=e},getLimitType:function(){return this.limitType},getAttrs:function(e){var t=mini.HtmlFile.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["limitType","buttonText","limitTypeErrorText","onfileselect"]);return t}});mini.regClass(mini.HtmlFile,"htmlfile");mini.Include=function(){mini.Include.superclass.constructor.call(this)};mini.extend(mini.Include,mini.Control,{url:"",uiCls:"mini-include",_create:function(){this.el=document.createElement("div");this.el.className="mini-include"},_initEvents:function(){},doLayout:function(){if(!this.canLayout())return;var e=this.el.childNodes;if(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];mini.layout(n)}}},setUrl:function(e){this.url=this.parseUrl(e);mini.update({url:this.url,el:this.el,async:this.async});this.doLayout()},getUrl:function(e){return this.url},getAttrs:function(e){var t=mini.Include.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["url"]);return t}});mini.regClass(mini.Include,"include");mini.Layout=function(){this.regions=[];this.regionMap={};mini.Layout.superclass.constructor.call(this)};mini.extend(mini.Layout,mini.Control,{regions:[],splitSize:5,collapseWidth:28,collapseHeight:25,regionWidth:150,regionHeight:80,regionMinWidth:50,regionMinHeight:25,regionMaxWidth:2e3,regionMaxHeight:2e3,uiCls:"mini-layout",destroy:function(e){mini.clearEvent(document);if(this._borderEl){mini.clearEvent(this._borderEl);this._borderEl.parentNode.removeChild(this._borderEl);this._borderEl=null}if(this.drag){mini.clearEvent(this.drag);this.drag.destroy(e);this.drag=null}var t=this;$.each(this.regions,function(){t._destroyRegionEl(this)});delete this.regions;delete this.regionMap;mini.Layout.superclass.destroy.call(this,e)},_create:function(){this.el=document.createElement("div");this.el.className="mini-layout";this.el.innerHTML='<div class="mini-layout-border"></div>';this._borderEl=this.el.firstChild;this.doUpdate()},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(document,"mousedown",this.__OnDocMouseDown,this)},this)},getRegionEl:function(e){var e=this.getRegion(e);if(!e)return null;return e._el},getRegionHeaderEl:function(e){var e=this.getRegion(e);if(!e)return null;return e._header},getRegionBodyEl:function(e){var e=this.getRegion(e);if(!e)return null;return e._body},getRegionSplitEl:function(e){var e=this.getRegion(e);if(!e)return null;return e._split},getRegionProxyEl:function(e){var e=this.getRegion(e);if(!e)return null;return e._proxy},getRegionBox:function(e){var t=this.getRegionEl(e);if(t)return mini.getBox(t);return null},getRegion:function(e){if(typeof e=="string")return this.regionMap[e];return e},_getButton:function(e,t){var i=e.buttons;for(var n=0,s=i.length;n<s;n++){var r=i[n];if(r.name==t)return r}},_createRegion:function(e){var t=mini.copyTo({region:"",title:"",iconCls:"",iconStyle:"",showCloseButton:false,showCollapseButton:true,buttons:[{name:"close",cls:"mini-tools-close",html:"",visible:false},{name:"collapse",cls:"mini-tools-collapse",html:"",visible:true}],showSplitIcon:false,showSplit:true,showHeader:true,splitSize:this.splitSize,collapseSize:this.collapseWidth,width:this.regionWidth,height:this.regionHeight,minWidth:this.regionMinWidth,minHeight:this.regionMinHeight,maxWidth:this.regionMaxWidth,maxHeight:this.regionMaxHeight,allowResize:true,cls:"",style:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,expanded:true},e);return t},_CreateRegionEl:function(e){var e=this.getRegion(e);if(!e)return;mini.append(this._borderEl,'<div id="'+e.region+'" class="mini-layout-region"><div class="mini-layout-region-header" style="'+e.headerStyle+'"></div><div class="mini-layout-region-body '+e.bodyCls+'" style="'+e.bodyStyle+'"></div></div>');e._el=this._borderEl.lastChild;e._header=e._el.firstChild;e._body=e._el.lastChild;mini.on(e._body,"scroll",function(){$("body").trigger("mousedown")},this);if(e.cls)mini.addClass(e._el,e.cls);if(e.style)mini.setStyle(e._el,e.style);mini.addClass(e._el,"mini-layout-region-"+e.region);if(e.region!="center"){mini.append(this._borderEl,'<div uid="'+this.uid+'" id="'+e.region+'" class="mini-layout-split"><div class="mini-layout-spliticon"></div></div>');e._split=this._borderEl.lastChild;mini.addClass(e._split,"mini-layout-split-"+e.region)}if(e.region!="center"){mini.append(this._borderEl,'<div id="'+e.region+'" class="mini-layout-proxy"></div>');e._proxy=this._borderEl.lastChild;mini.addClass(e._proxy,"mini-layout-proxy-"+e.region)}},_destroyRegionEl:function(e){if(!e)return;if(e._header){mini.clearEvent(e._header);e._header.parentNode.removeChild(e._header);e._header=null}if(e._body){mini.clearEvent(e._body);e._body.parentNode.removeChild(e._body);e._body=null}if(e._el){mini.clearEvent(e._el);e._el.parentNode.removeChild(e._el);e._el=null}if(e._split){mini.clearEvent(e._split);e._split.parentNode.removeChild(e._split);e._split=null}if(e._proxy){mini.clearEvent(e._proxy);e._proxy.parentNode.removeChild(e._proxy);e._proxy=null}mini.clearEvent(e);e=null},setRegionControls:function(e,t){var e=this.getRegion(e);if(!e)return;var i=this.getRegionBodyEl(e);__mini_setControls(t,i,this)},setRegions:function(e){if(!mini.isArray(e))return;for(var t=0,i=e.length;t<i;t++){this.addRegion(e[t])}},addRegion:function(e,t){var i=e;e=this._createRegion(e);if(!e.region)e.region="center";e.region=e.region.toLowerCase();if(e.region=="center"&&i&&!i.showHeader){e.showHeader=false}if(e.region=="north"||e.region=="south"){if(!i.collapseSize){e.collapseSize=this.collapseHeight}}this._measureRegion(e);if(typeof t!="number")t=this.regions.length;var n=this.regionMap[e.region];if(n){return}this.regions.insert(t,e);this.regionMap[e.region]=e;this._CreateRegionEl(e);var s=this.getRegionBodyEl(e);var r=e.body;delete e.body;if(r){if(!mini.isArray(r))r=[r];for(var l=0,o=r.length;l<o;l++){mini.append(s,r[l])}}if(e.bodyParent){var a=e.bodyParent;while(a.firstChild){s.appendChild(a.firstChild)}}delete e.bodyParent;if(e.controls){this.setRegionControls(e,e.controls);delete e.controls}this.doUpdate()},removeRegion:function(e){var e=this.getRegion(e);if(!e)return;this.regions.remove(e);delete this.regionMap[e.region];jQuery(e._el).remove();jQuery(e._split).remove();jQuery(e._proxy).remove();this.doUpdate()},moveRegion:function(e,t){var e=this.getRegion(e);if(!e)return;var i=this.regions[t];if(!i||i==e)return;this.regions.remove(e);var t=this.region.indexOf(i);this.regions.insert(t,e);this.doUpdate()},_measureRegion:function(e){var t=this._getButton(e,"close");t.visible=e.showCloseButton;var t=this._getButton(e,"collapse");t.visible=e.showCollapseButton;if(e.width<e.minWidth)e.width=e.minWidth;if(e.width>e.maxWidth)e.width=e.maxWidth;if(e.height<e.minHeight)e.height=e.minHeight;if(e.height>e.maxHeight)e.height=e.maxHeight},updateRegion:function(e,t){e=this.getRegion(e);if(!e)return;if(t)delete t.region;mini.copyTo(e,t);this._measureRegion(e);this.doUpdate()},expandRegion:function(e){e=this.getRegion(e);if(!e)return;e.expanded=true;this.doUpdate()},collapseRegion:function(e){e=this.getRegion(e);if(!e)return;e.expanded=false;this.doUpdate()},toggleRegion:function(e){e=this.getRegion(e);if(!e)return;if(e.expanded){this.collapseRegion(e)}else{this.expandRegion(e)}},showRegion:function(e){e=this.getRegion(e);if(!e)return;e.visible=true;this.doUpdate()},hideRegion:function(e){e=this.getRegion(e);if(!e)return;e.visible=false;this.doUpdate()},isExpandRegion:function(e){e=this.getRegion(e);if(!e)return null;return this.region.expanded},isVisibleRegion:function(e){e=this.getRegion(e);if(!e)return null;return this.region.visible},_tryToggleRegion:function(e){e=this.getRegion(e);var t={region:e,cancel:false};if(e.expanded){this.fire("BeforeCollapse",t);if(t.cancel==false){this.collapseRegion(e)}}else{this.fire("BeforeExpand",t);if(t.cancel==false){this.expandRegion(e)}}},_getProxyElByEvent:function(e){var t=mini.findParent(e.target,"mini-layout-proxy");return t},_getRegionElByEvent:function(e){var t=mini.findParent(e.target,"mini-layout-region");return t},__OnClick:function(e){if(this._inAniming)return;var t=this._getProxyElByEvent(e);if(t){var i=t.id;var n=mini.findParent(e.target,"mini-tools-collapse");if(n){this._tryToggleRegion(i)}else{this._VirtualToggle(i)}}var s=this._getRegionElByEvent(e);if(s&&mini.findParent(e.target,"mini-layout-region-header")){var i=s.id;var n=mini.findParent(e.target,"mini-tools-collapse");if(n){this._tryToggleRegion(i)}var r=mini.findParent(e.target,"mini-tools-close");if(r){this.updateRegion(i,{visible:false})}}if(mini.hasClass(e.target,"mini-layout-spliticon")){var i=e.target.parentNode.id;this._tryToggleRegion(i)}},_OnButtonClick:function(e,t,i){this.fire("buttonclick",{htmlEvent:i,region:e,button:t,index:this.buttons.indexOf(t),name:t.name})},_OnButtonMouseDown:function(e,t,i){this.fire("buttonmousedown",{htmlEvent:i,region:e,button:t,index:this.buttons.indexOf(t),name:t.name})},hoverProxyEl:null,__OnMouseOver:function(e){var t=this._getProxyElByEvent(e);if(t){mini.addClass(t,"mini-layout-proxy-hover");this.hoverProxyEl=t}},__OnMouseOut:function(e){if(this.hoverProxyEl){mini.removeClass(this.hoverProxyEl,"mini-layout-proxy-hover")}this.hoverProxyEl=null},onButtonClick:function(e,t){this.on("buttonclick",e,t)},onButtonMouseDown:function(e,t){this.on("buttonmousedown",e,t)}});mini.copyTo(mini.Layout.prototype,{_createHeader:function(e,t){var i='<div class="mini-tools">';if(t){i+='<span class="mini-tools-collapse"></span>'}else{for(var n=e.buttons.length-1;n>=0;n--){var s=e.buttons[n];i+='<span class="'+s.cls+'" style="';i+=s.style+";"+(s.visible?"":"display:none;")+'">'+s.html+"</span>"}}i+="</div>";i+='<div class="mini-layout-region-icon '+e.iconCls+'" style="'+e.iconStyle+";"+(e.iconStyle||e.iconCls?"":"display:none;")+'"></div>';i+='<div class="mini-layout-region-title">'+e.title+"</div>";return i},doUpdate:function(){for(var e=0,t=this.regions.length;e<t;e++){var i=this.regions[e];var n=i.region;var s=i._el,r=i._split,l=i._proxy;if(i.cls)mini.addClass(s,i.cls);i._header.style.display=i.showHeader?"":"none";i._header.innerHTML=this._createHeader(i);if(i._proxy)i._proxy.innerHTML=this._createHeader(i,true);if(r){mini.removeClass(r,"mini-layout-split-nodrag");if(i.expanded==false||!i.allowResize){mini.addClass(r,"mini-layout-split-nodrag")}}}this.doLayout()},doLayout:function(){if(!this.canLayout()){return}if(this._inAniming){return}var e=mini.getHeight(this.el,true);var t=mini.getWidth(this.el,true);var i={x:0,y:0,width:t,height:e};var n=this.regions.clone();var s=this.getRegion("center");n.remove(s);if(s){n.push(s)}for(var r=0,l=n.length;r<l;r++){var o=n[r];o._Expanded=false;mini.removeClass(o._el,"mini-layout-popup");var a=o.region;var h=o._el,u=o._split,d=o._proxy;if(o.visible==false){h.style.display="none";if(a!="center")u.style.display=d.style.display="none";continue}h.style.display="";if(a!="center")u.style.display=d.style.display="";var c=i.x,f=i.y,t=i.width,e=i.height;var m=o.width,p=o.height;if(!o.expanded){if(a=="west"||a=="east"){m=o.collapseSize;mini.setWidth(h,o.width)}else if(a=="north"||a=="south"){p=o.collapseSize;mini.setHeight(h,o.height)}}switch(a){case"north":e=p;i.y+=p;i.height-=p;break;case"south":e=p;f=i.y+i.height-p;i.height-=p;break;case"west":t=m;i.x+=m;i.width-=m;break;case"east":t=m;c=i.x+i.width-m;i.width-=m;break;case"center":break;default:continue}if(t<0)t=0;if(e<0)e=0;if(a=="west"||a=="east"){mini.setHeight(h,e)}if(a=="north"||a=="south"){mini.setWidth(h,t)}var g="left:"+c+"px;top:"+f+"px;";var v=h;if(!o.expanded){v=d;h.style.top="-100px";h.style.left="-1500px"}else{if(d){d.style.left="-1500px";d.style.top="-100px"}}v.style.left=c+"px";v.style.top=f+"px";mini.setWidth(v,t);mini.setHeight(v,e);if(isIE6){mini.setWidth(o._body,t)}var _=jQuery(o._el).height();var y=o.showHeader?jQuery(o._header).outerHeight():0;mini.setHeight(o._body,_-y);if(a=="center")continue;m=p=o.splitSize;var c=i.x,f=i.y,t=i.width,e=i.height;switch(a){case"north":e=p;i.y+=p;i.height-=p;break;case"south":e=p;f=i.y+i.height-p;i.height-=p;break;case"west":t=m;i.x+=m;i.width-=m;break;case"east":t=m;c=i.x+i.width-m;i.width-=m;break;case"center":break}if(t<0)t=0;if(e<0)e=0;u.style.left=c+"px";u.style.top=f+"px";mini.setWidth(u,t);mini.setHeight(u,e);if(o.showSplit&&o.expanded&&o.allowResize==true){mini.removeClass(u,"mini-layout-split-nodrag")}else{mini.addClass(u,"mini-layout-split-nodrag")}u.firstChild.style.display=o.showSplitIcon?"block":"none";if(o.expanded){mini.removeClass(u.firstChild,"mini-layout-spliticon-collapse")}else{mini.addClass(u.firstChild,"mini-layout-spliticon-collapse")}}mini.layout(this._borderEl);this.fire("layout")},__OnMouseDown:function(e){if(this._inAniming)return;if(mini.findParent(e.target,"mini-layout-split")){var t=jQuery(e.target).attr("uid");if(t!=this.uid)return;var i=this.getRegion(e.target.id);if(i.expanded==false||!i.allowResize||!i.showSplit)return;this.dragRegion=i;var n=this._getDrag();n.start(e)}},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(e){this._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask"></div>');this._dragProxy=mini.append(document.body,'<div class="mini-proxy"></div>');this._dragProxy.style.cursor="n-resize";if(this.dragRegion.region=="west"||this.dragRegion.region=="east"){this._dragProxy.style.cursor="w-resize"}this.splitBox=mini.getBox(this.dragRegion._split);mini.setBox(this._dragProxy,this.splitBox);this.elBox=mini.getBox(this.el,true)},_OnDragMove:function(e){var t=e.now[0]-e.init[0];var i=this.splitBox.x+t;var n=e.now[1]-e.init[1];var s=this.splitBox.y+n;var r=i+this.splitBox.width;var l=s+this.splitBox.height;var o=this.getRegion("west"),a=this.getRegion("east"),h=this.getRegion("north"),u=this.getRegion("south"),d=this.getRegion("center");var c=o&&o.visible?o.width:0;var f=a&&a.visible?a.width:0;var m=h&&h.visible?h.height:0;var p=u&&u.visible?u.height:0;var g=o&&o.showSplit?mini.getWidth(o._split):0;var v=a&&a.showSplit?mini.getWidth(a._split):0;var _=h&&h.showSplit?mini.getHeight(h._split):0;var y=u&&u.showSplit?mini.getHeight(u._split):0;var w=this.dragRegion,C=w.region;if(C=="west"){var x=this.elBox.width-f-v-g-d.minWidth;if(i-this.elBox.x>x)i=x+this.elBox.x;if(i-this.elBox.x<w.minWidth)i=w.minWidth+this.elBox.x;if(i-this.elBox.x>w.maxWidth)i=w.maxWidth+this.elBox.x;mini.setX(this._dragProxy,i)}else if(C=="east"){var x=this.elBox.width-c-g-v-d.minWidth;if(this.elBox.right-(i+this.splitBox.width)>x){i=this.elBox.right-x-this.splitBox.width}if(this.elBox.right-(i+this.splitBox.width)<w.minWidth){i=this.elBox.right-w.minWidth-this.splitBox.width}if(this.elBox.right-(i+this.splitBox.width)>w.maxWidth){i=this.elBox.right-w.maxWidth-this.splitBox.width}mini.setX(this._dragProxy,i)}else if(C=="north"){var b=this.elBox.height-p-y-_-d.minHeight;if(s-this.elBox.y>b)s=b+this.elBox.y;if(s-this.elBox.y<w.minHeight)s=w.minHeight+this.elBox.y;if(s-this.elBox.y>w.maxHeight)s=w.maxHeight+this.elBox.y;mini.setY(this._dragProxy,s)}else if(C=="south"){var b=this.elBox.height-m-_-y-d.minHeight;if(this.elBox.bottom-(s+this.splitBox.height)>b){s=this.elBox.bottom-b-this.splitBox.height}if(this.elBox.bottom-(s+this.splitBox.height)<w.minHeight){s=this.elBox.bottom-w.minHeight-this.splitBox.height}if(this.elBox.bottom-(s+this.splitBox.height)>w.maxHeight){s=this.elBox.bottom-w.maxHeight-this.splitBox.height}mini.setY(this._dragProxy,s)}},_OnDragStop:function(e){var t=mini.getBox(this._dragProxy);var i=this.dragRegion,n=i.region;if(n=="west"){var s=t.x-this.elBox.x;this.updateRegion(i,{width:s})}else if(n=="east"){var s=this.elBox.right-t.right;this.updateRegion(i,{width:s})}else if(n=="north"){var r=t.y-this.elBox.y;this.updateRegion(i,{height:r})}else if(n=="south"){var r=this.elBox.bottom-t.bottom;this.updateRegion(i,{height:r})}jQuery(this._dragProxy).remove();this._dragProxy=null;this.elBox=this.handlerBox=null;jQuery(this._maskProxy).remove();this._maskProxy=null},_VirtualToggle:function(e){e=this.getRegion(e);if(e._Expanded===true){this._VirtualCollapse(e)}else{this._VirtualExpand(e)}},_VirtualExpand:function(e){if(this._inAniming)return;this.doLayout();var t=e.region,i=e._el;e._Expanded=true;mini.addClass(i,"mini-layout-popup");var n=mini.getBox(e._proxy);var s=mini.getBox(e._el);var r={};if(t=="east"){var l=n.x;var o=n.y;var a=n.height;mini.setHeight(i,a);mini.setX(i,l);i.style.top=e._proxy.style.top;var h=parseInt(i.style.left);r={left:h-s.width}}else if(t=="west"){var l=n.right-s.width;var o=n.y;var a=n.height;mini.setHeight(i,a);mini.setX(i,l);i.style.top=e._proxy.style.top;var h=parseInt(i.style.left);r={left:h+s.width}}else if(t=="north"){var l=n.x;var o=n.bottom-s.height;var u=n.width;mini.setWidth(i,u);mini.setXY(i,l,o);var d=parseInt(i.style.top);r={top:d+s.height}}else if(t=="south"){var l=n.x;var o=n.y;var u=n.width;mini.setWidth(i,u);mini.setXY(i,l,o);var d=parseInt(i.style.top);r={top:d-s.height}}mini.addClass(e._proxy,"mini-layout-maxZIndex");this._inAniming=true;var c=this;var f=jQuery(i);f.animate(r,250,function(){mini.removeClass(e._proxy,"mini-layout-maxZIndex");c._inAniming=false})},_VirtualCollapse:function(e){if(this._inAniming)return;e._Expanded=false;var t=e.region,i=e._el;var n=mini.getBox(i);var s={};if(t=="east"){var r=parseInt(i.style.left);s={left:r+n.width}}else if(t=="west"){var r=parseInt(i.style.left);s={left:r-n.width}}else if(t=="north"){var l=parseInt(i.style.top);s={top:l-n.height}}else if(t=="south"){var l=parseInt(i.style.top);s={top:l+n.height}}mini.addClass(e._proxy,"mini-layout-maxZIndex");this._inAniming=true;var o=this;var a=jQuery(i);a.animate(s,250,function(){mini.removeClass(e._proxy,"mini-layout-maxZIndex");o._inAniming=false;o.doLayout()})},__OnDocMouseDown:function(e){if(this._inAniming)return;for(var t=0,i=this.regions.length;t<i;t++){var n=this.regions[t];if(!n._Expanded)continue;if(mini.isAncestor(n._el,e.target)||mini.isAncestor(n._proxy,e.target)){}else{this._VirtualCollapse(n)}}},getAttrs:function(e){var t=mini.Layout.superclass.getAttrs.call(this,e);var i=jQuery(e);var n=parseInt(i.attr("splitSize"));if(!isNaN(n)){t.splitSize=n}var s=[];var r=mini.getChildNodes(e);for(var l=0,o=r.length;l<o;l++){var a=r[l];var h={};s.push(h);h.cls=a.className;h.style=a.style.cssText;mini._ParseString(a,h,["region","title","iconCls","iconStyle","cls","headerCls","headerStyle","bodyCls","bodyStyle"]);mini._ParseBool(a,h,["allowResize","visible","showCloseButton","showCollapseButton","showSplit","showHeader","expanded","showSplitIcon"]);mini._ParseInt(a,h,["splitSize","collapseSize","width","height","minWidth","minHeight","maxWidth","maxHeight"]);h.bodyParent=a}t.regions=s;return t}});mini.regClass(mini.Layout,"layout");mini.ListBox=function(){mini.ListBox.superclass.constructor.call(this)};mini.extend(mini.ListBox,mini.ListControl,{formField:true,width:200,columns:null,columnWidth:80,showNullItem:false,nullItemText:"",showEmpty:false,emptyText:"",showCheckBox:false,showAllCheckBox:true,multiSelect:false,_itemCls:"mini-listbox-item",_itemHoverCls:"mini-listbox-item-hover",_itemSelectedCls:"mini-listbox-item-selected",uiCls:"mini-listbox",_create:function(){var e=this.el=document.createElement("div");this.el.className="mini-listbox";this.el.innerHTML='<div class="mini-listbox-border"><div class="mini-listbox-header"></div><div class="mini-listbox-view"></div><input type="hidden"/></div><div class="mini-errorIcon"></div>';this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewEl=this._borderEl.childNodes[1];this._valueEl=this._borderEl.childNodes[2];this._errorIconEl=this.el.lastChild;this._scrollViewEl=this._viewEl;this._viewEl.innerHTML='<div class="mini-listbox-content"></div>'},destroy:function(e){if(this._viewEl){this._viewEl.onscroll=null;mini.clearEvent(this._viewEl);this._borderEl.removeChild(this._viewEl);this._scrollViewEl=null;this._viewEl=null}if(this._headerEl){mini.clearEvent(this._headerEl);this._borderEl.removeChild(this._headerEl);this._headerEl=null}if(this._valueEl){mini.clearEvent(this._valueEl);this._borderEl.removeChild(this._valueEl);this._valueEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this.el.removeChild(this._borderEl);this._borderEl=null}if(this._errorIconEl){mini.clearEvent(this._errorIconEl);this.el.removeChild(this._errorIconEl);this._errorIconEl=null}delete this.data;delete this.columns;mini.ListBox.superclass.destroy.call(this,e)},_initEvents:function(){mini.ListBox.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this._viewEl,"scroll",this.__OnScroll,this)},this)},setColumns:function(e){if(!mini.isArray(e))e=[];this.columns=e;for(var t=0,i=this.columns.length;t<i;t++){var n=this.columns[t];if(n.type){if(!mini.isNull(n.header)&&typeof n.header!=="function"){if(n.header.trim()==""){delete n.header}}var s=mini._getColumn(n.type);if(s){var r=mini.copyTo({},n);mini.copyTo(n,s);mini.copyTo(n,r)}}var l=parseInt(n.width);if(mini.isNumber(l)&&String(l)==n.width)n.width=l+"px";if(mini.isNull(n.width))n.width=this.columnWidth+"px"}this.doUpdate()},getColumns:function(){return this.columns},__OnMouseMove:function(e){mini.ListBox.superclass.__OnMouseMove.call(this,e);var t=e.target;if(e.target.parentNode.tagName=="TD"){t=e.target.parentNode}if(t.tagName!="TD"){return}if(t.scrollWidth>t.clientWidth){var i=t.innerText||t.textContent||"";t.title=i.trim()}else{t.title=""}},__OnMouseOut:function(e){mini.ListBox.superclass.__OnMouseOut.call(this,e);var t=e.target;if(e.target.parentNode.tagName=="TD"){t=e.target.parentNode}t.title=""},doUpdate:function(){if(this._allowUpdate===false)return;var e=this.columns&&this.columns.length>0;if(e){mini.addClass(this.el,"mini-listbox-showColumns")}else{mini.removeClass(this.el,"mini-listbox-showColumns")}this._headerEl.style.display=e?"":"none";var t=[];if(e&&this.showColumns){t[t.length]='<table class="mini-listbox-headerInner" cellspacing="0" cellpadding="0"><tr>';var i=this.uid+"$ck$all";t[t.length]='<td class="mini-listbox-checkbox"><input type="checkbox" id="'+i+'"></td>';for(var n=0,s=this.columns.length;n<s;n++){var r=this.columns[n];var l=r.header;if(mini.isNull(l))l="&nbsp;";var o=r.width;if(mini.isNumber(o))o=o+"px";t[t.length]='<td class="';if(r.headerCls)t[t.length]=r.headerCls;t[t.length]='" style="';if(r.headerStyle)t[t.length]=r.headerStyle+";";if(o){t[t.length]="width:"+o+";"}if(r.headerAlign){t[t.length]="text-align:"+r.headerAlign+";"}t[t.length]='">';t[t.length]=l;t[t.length]="</td>"}t[t.length]="</tr></table>"}this._headerEl.innerHTML=t.join("");var t=[];var a=this.data;t[t.length]='<table class="mini-listbox-items" cellspacing="0" cellpadding="0">';if(this.showEmpty&&a.length==0){t[t.length]='<tr><td colspan="20">'+this.emptyText+"</td></tr>"}else{this._doNullItem();for(var h=0,u=a.length;h<u;h++){var d=a[h];var c=-1;var f=" ";var m=-1;var p=" ";t[t.length]='<tr id="';t[t.length]=this._createItemId(h);t[t.length]='" index="';t[t.length]=h;t[t.length]='" class="mini-listbox-item ';if(d.enabled===false){t[t.length]=" mini-disabled "}c=t.length;t[t.length]=f;t[t.length]='" style="';m=t.length;t[t.length]=p;t[t.length]='">';var g=this._createCheckId(h);var v=this.name;var _=this.getItemValue(d);var y="";if(d.enabled===false){y="disabled"}t[t.length]='<td class="mini-listbox-checkbox"><input '+y+' id="'+g+'" type="checkbox" ></td>';if(e){for(var n=0,s=this.columns.length;n<s;n++){var r=this.columns[n];var w=this._OnDrawCell(d,h,r);var o=r.width;if(typeof o=="number")o=o+"px";t[t.length]='<td class="';if(w.cellCls)t[t.length]=w.cellCls;t[t.length]='" style="';if(w.cellStyle)t[t.length]=w.cellStyle+";";if(o){t[t.length]="width:"+o+";"}if(r.align){t[t.length]="text-align:"+r.align+";"}t[t.length]='">';t[t.length]=w.cellHtml;t[t.length]="</td>";if(w.rowCls)f=w.rowCls;if(w.rowStyle)p=w.rowStyle}}else{var w=this._OnDrawCell(d,h,null);t[t.length]='<td class="';if(w.cellCls)t[t.length]=w.cellCls;t[t.length]='" style="';if(w.cellStyle)t[t.length]=w.cellStyle;t[t.length]='">';t[t.length]=w.cellHtml;t[t.length]="</td>";if(w.rowCls)f=w.rowCls;if(w.rowStyle)p=w.rowStyle}t[c]=f;t[m]=p;t[t.length]="</tr>"}}t[t.length]="</table>";var C=t.join("");this._viewEl.firstChild.innerHTML=C;this._doSelects();this.doLayout()},doLayout:function(){if(!this.canLayout())return;if(this.columns&&this.columns.length>0){mini.addClass(this.el,"mini-listbox-showcolumns")}else{mini.removeClass(this.el,"mini-listbox-showcolumns")}if(this.showCheckBox){mini.removeClass(this.el,"mini-listbox-hideCheckBox")}else{mini.addClass(this.el,"mini-listbox-hideCheckBox")}var e=this.uid+"$ck$all";var t=document.getElementById(e);if(t)t.style.display=this.showAllCheckBox?"":"none";var i=this.isAutoHeight();h=this.getHeight(true);a=this.getWidth(true);var n=a;var s=this._viewEl;s.style.width=a+"px";if(!i){var r=mini.getHeight(this._headerEl);h=h-r;s.style.height=h+"px"}else{s.style.height="auto"}if(isIE){var l=this._headerEl.firstChild,o=this._viewEl.firstChild.firstChild;if(this._viewEl.offsetHeight>=this._viewEl.scrollHeight){o.style.width="100%";if(l)l.style.width="100%"}else{var a=parseInt(o.parentNode.offsetWidth-17)+"px";if(l)l.style.width=a}}if(this._viewEl.offsetHeight<this._viewEl.scrollHeight){this._headerEl.style.width=n-17+"px"}else{this._headerEl.style.width="100%"}},setShowCheckBox:function(e){this.showCheckBox=e;this.doLayout()},getShowCheckBox:function(){return this.showCheckBox},setShowAllCheckBox:function(e){this.showAllCheckBox=e;this.doLayout()},getShowAllCheckBox:function(){return this.showAllCheckBox},setShowColumns:function(e){this.showColumns=e;this.doUpdate()},getShowColumns:function(){return this.showColumns},setShowNullItem:function(e){if(this.showNullItem!=e){this.showNullItem=e;this._doNullItem();this.doUpdate()}},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(e){if(this.nullItemText!=e){this.nullItemText=e;this._doNullItem();this.doUpdate()}},getNullItemText:function(){return this.nullItemText},_doNullItem:function(){for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];if(i.__NullItem){this.data.removeAt(e);break}}if(this.showNullItem){var i={__NullItem:true};i[this.textField]=this.nullItemText;i[this.valueField]="";this.data.insert(0,i)}},_OnDrawCell:function(e,t,i){var n=i?e[i.field]:this.getItemText(e);var s={sender:this,index:t,rowIndex:t,record:e,item:e,column:i,field:i?i.field:null,value:n,cellHtml:n,rowCls:null,cellCls:i?i.cellCls||"":"",rowStyle:null,cellStyle:i?i.cellStyle||"":""};var r=this.columns&&this.columns.length>0;if(!r){if(t==0&&this.showNullItem){s.cellHtml=this.nullItemText}}s.cellHtml=mini.htmlEncode(s.cellHtml);if(i){if(i.dateFormat){if(mini.isDate(s.value))s.cellHtml=mini.formatDate(n,i.dateFormat);else s.cellHtml=n;
}var l=i.renderer;if(l){fn=typeof l=="function"?l:window[l];if(fn){s.cellHtml=fn.call(i,s)}}}this.fire("drawcell",s);if(s.cellHtml===null||s.cellHtml===undefined||s.cellHtml==="")s.cellHtml="&nbsp;";return s},__OnScroll:function(e){this._headerEl.scrollLeft=this._viewEl.scrollLeft},__OnClick:function(e){var t=this.uid+"$ck$all";if(e.target.id==t){var i=document.getElementById(t);if(i){var n=i.checked;var s=this.getValue();if(n){this.selectAll()}else{this.deselectAll()}this._OnSelectionChanged();if(s!=this.getValue()){this._OnValueChanged();this.fire("itemclick",{htmlEvent:e})}}return}this._fireEvent(e,"Click")},getAttrs:function(e){var t=mini.ListBox.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["nullItemText","ondrawcell"]);mini._ParseBool(e,t,["showCheckBox","showAllCheckBox","showNullItem","showColumns"]);if(e.nodeName.toLowerCase()!="select"){var i=mini.getChildNodes(e);for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=jQuery(r).attr("property");if(!l)continue;l=l.toLowerCase();if(l=="columns"){t.columns=mini._ParseColumns(r)}else if(l=="data"){t.data=r.innerHTML}}}return t}});mini.regClass(mini.ListBox,"listbox");mini.Popup=function(){mini.Popup.superclass.constructor.call(this);this.setVisible(false);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Popup,mini.Container,{_clearBorder:false,uiCls:"mini-popup",_create:function(){var e=this.el=document.createElement("div");this.el.className="mini-popup";this._contentEl=this.el},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},doLayout:function(){if(!this.canLayout())return;mini.Popup.superclass.doLayout.call(this);this._doShadow();var e=this.el.childNodes;if(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];mini.layout(n)}}},destroy:function(e){if(this.el){this.el.onmouseover=null}this._contentEl=null;mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);if(this._modalEl){this._modalEl.parentNode.removeChild(this._modalEl);this._modalEl=null}if(this.shadowEl){this.shadowEl.parentNode.removeChild(this.shadowEl);this.shadowEl=null}if(this.popupEl){this._unbindPopupEl();this.popupEl=null}mini.Popup.superclass.destroy.call(this,e)},setWidth:function(e){if(parseInt(e)==e)e+="px";this.width=e;if(e.indexOf("px")!=-1){if(isIE){var t=mini.getBorders(this.el);if(!t.left)e=e.substring(0,e.indexOf("px"))-2+"px"}mini.setWidth(this.el,e)}else{this.el.style.width=e}this._sizeChaned()},setHeight:function(e){if(parseInt(e)==e)e+="px";this.height=e;if(e.indexOf("px")!=-1){mini.setHeight(this.el,e)}else{this.el.style.height=e}this._sizeChaned()},setBody:function(e){if(!e)return;if(!mini.isArray(e))e=[e];for(var t=0,i=e.length;t<i;t++){mini.append(this._contentEl,e[t])}},getAttrs:function(e){var t=mini.Popup.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["popupEl","popupCls","showAction","hideAction","xAlign","yAlign","modalStyle","onbeforeopen","open","onbeforeclose","onclose"]);mini._ParseBool(e,t,["showModal","showShadow","allowDrag","allowResize"]);mini._ParseInt(e,t,["showDelay","hideDelay","xOffset","yOffset","minWidth","minHeight","maxWidth","maxHeight"]);var i=mini.getChildNodes(e,true);t.body=i;return t}});mini.regClass(mini.Popup,"popup");mini.Popup_prototype={isPopup:false,popupEl:null,popupCls:"",showAction:"mouseover",hideAction:"outerclick",showDelay:300,hideDelay:500,xAlign:"left",yAlign:"below",xOffset:0,yOffset:0,minWidth:50,minHeight:25,maxWidth:2e3,maxHeight:2e3,showModal:false,showShadow:true,modalStyle:"opacity:0.2",_dragCls:"mini-popup-drag",_resizeCls:"mini-popup-resize",allowDrag:false,allowResize:false,_unbindPopupEl:function(){if(!this.popupEl)return;mini.un(this.popupEl,"click",this.__OnLeftClick,this);mini.un(this.popupEl,"contextmenu",this.__OnRightClick,this);mini.un(this.popupEl,"mouseover",this.__OnMouseOver,this)},_bindPopupEl:function(){if(!this.popupEl)return;mini.on(this.popupEl,"click",this.__OnLeftClick,this);mini.on(this.popupEl,"contextmenu",this.__OnRightClick,this);mini.on(this.popupEl,"mouseover",this.__OnMouseOver,this)},_doShim:function(){if(!mini.isIE||!mini_useShims)return;if(!this._shimEl){var e="<iframe frameborder='0' style='position: absolute; z-index: -1; width: 0; height: 0; top: 0;left:0;scrolling:no;'></iframe>";this._shimEl=mini.append(document.body,e)}function t(){this._shimEl.style.display="";var e=mini.getBox(this.el);var t=this._shimEl.style;t.width=e.width+"px";t.height=e.height+"px";t.left=e.x+"px";t.top=e.y+"px";var i=mini.getStyle(this.el,"zIndex");if(!isNaN(i)){this._shimEl.style.zIndex=i-3}}this._shimEl.style.display="none";if(this._doShimTimer){clearTimeout(this._doShimTimer);this._doShimTimer=null}var i=this;this._doShimTimer=setTimeout(function(){i._doShimTimer=null;t.call(i)},20)},doShow:function(e){var t={popupEl:this.popupEl,htmlEvent:e,cancel:false};this.fire("BeforeOpen",t);if(t.cancel==true)return;this.fire("opening",t);if(t.cancel==true)return;if(!this.popupEl){this.show()}else{var i={};if(e)i.xy=[e.pageX,e.pageY];this.showAtEl(this.popupEl,i)}},doHide:function(e){var t={popupEl:this.popupEl,htmlEvent:e,cancel:false};this.fire("BeforeClose",t);if(t.cancel==true)return;this.close()},show:function(e,t){this.showAtPos(e,t)},showAtPos:function(e,t){this.render(document.body);if(!e)e="center";if(!t)t="middle";this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this._measureSize();var i=mini.getViewportBox();var n=mini.getBox(this.el);if(e=="left")e=0;if(e=="center")e=i.width/2-n.width/2;if(e=="right")e=i.width-n.width;if(t=="top")t=0;if(t=="middle")t=i.y+i.height/2-n.height/2;if(t=="bottom")t=i.height-n.height;if(e+n.width>i.right)e=i.right-n.width;if(t+n.height>i.bottom)t=i.bottom-n.height-20;this._Show(e,t)},_doModal:function(){jQuery(this._modalEl).remove();if(!this.showModal)return;if(this.visible==false)return;var e=document.documentElement;var t=parseInt(Math.max(document.body.scrollWidth,e?e.scrollWidth:0));var i=parseInt(Math.max(document.body.scrollHeight,e?e.scrollHeight:0));var n=mini.getViewportBox();var s=n.height;if(s<i)s=i;var r=n.width;if(r<t)r=t;this._modalEl=mini.append(document.body,'<div class="mini-modal"></div>');this._modalEl.style.height=s+"px";this._modalEl.style.width=r+"px";this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1;mini.setStyle(this._modalEl,this.modalStyle)},_doShadow:function(){if(!this.shadowEl){this.shadowEl=mini.append(document.body,'<div class="mini-shadow"></div>')}this.shadowEl.style.display=this.showShadow?"":"none";if(this.showShadow){function e(){this.shadowEl.style.display="";var e=mini.getBox(this.el);var t=this.shadowEl.style;t.width=e.width+"px";t.height=e.height+"px";t.left=e.x+"px";t.top=e.y+"px";var i=mini.getStyle(this.el,"zIndex");if(!isNaN(i)){this.shadowEl.style.zIndex=i-2}}this.shadowEl.style.display="none";if(this._doShadowTimer){clearTimeout(this._doShadowTimer);this._doShadowTimer=null}var t=this;this._doShadowTimer=setTimeout(function(){t._doShadowTimer=null;e.call(t)},20)}},_measureSize:function(){this.el.style.display="";var e=mini.getBox(this.el);if(e.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);e=mini.getBox(this.el)}if(e.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);e=mini.getBox(this.el)}if(e.width<this.minWidth){mini.setWidth(this.el,this.minWidth);e=mini.getBox(this.el)}if(e.height<this.minHeight){mini.setHeight(this.el,this.minHeight);e=mini.getBox(this.el)}},showAtEl:function(e,t){e=mini.byId(e);if(!e)return;if(!this.isRender()||this.el.parentNode!=document.body){this.render(document.body)}var i={xAlign:this.xAlign,yAlign:this.yAlign,xOffset:this.xOffset,yOffset:this.yOffset,popupCls:this.popupCls};mini.copyTo(i,t);mini.addClass(e,i.popupCls);e.popupCls=i.popupCls;this._popupEl=e;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var n=mini.getViewportBox();var s=mini.getBox(this.el);var r=mini.getBox(e);var l=i.xy;var o=i.xAlign,a=i.yAlign;var h=n.width/2-s.width/2,u=0;if(l){h=l[0];u=l[1]}switch(i.xAlign){case"outleft":h=r.x-s.width;break;case"left":h=r.x;break;case"center":h=r.x+r.width/2-s.width/2;break;case"right":h=r.right-s.width;break;case"outright":h=r.right;break;default:break}switch(i.yAlign){case"above":u=r.y-s.height;break;case"top":u=r.y;break;case"middle":u=r.y+r.height/2-s.height/2;break;case"bottom":u=r.bottom-s.height;break;case"below":u=r.bottom;break;default:break}h=parseInt(h);u=parseInt(u);if(i.outYAlign||i.outXAlign){if(i.outYAlign=="above"){if(u+s.height>n.bottom){u=r.y-s.height;if(u<0){u=r.y-this.minHeight;this.setHeight(this.minHeight)}}}if(i.outXAlign=="outleft"){if(h+s.width>n.right){var d=r.x-n.x;var c=n.right-r.right;if(d>c){h=r.x-s.width}}}if(i.outXAlign=="right"){if(h+s.width>n.right){h=r.right-s.width}}this._Show(h,u)}else{this.showAtPos(h+i.xOffset,u+i.yOffset)}},_Show:function(e,t){this.el.style.display="";this.el.style.zIndex=mini.getMaxZIndex();mini.setX(this.el,e);mini.setY(this.el,t);this.setVisible(true);if(this.hideAction=="mouseout"){mini.on(document,"mousemove",this.__OnBodyMouseMove,this)}var i=this;this._doShadow();this._doModal();this._doShim();mini.layoutIFrames(this.el);this.isPopup=true;mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini.on(window,"resize",this.__OnWindowResize,this);this.fire("Open")},open:function(){this.show()},close:function(){this.hide()},hide:function(){if(!this.el)return;if(this.popupEl)mini.removeClass(this.popupEl,this.popupEl.popupCls);if(this._popupEl)mini.removeClass(this._popupEl,this._popupEl.popupCls);this._popupEl=null;jQuery(this._modalEl).remove();if(this.shadowEl)this.shadowEl.style.display="none";if(this._shimEl)this._shimEl.style.display="none";mini.un(document,"mousemove",this.__OnBodyMouseMove,this);mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);this.setVisible(false);this.isPopup=false;this.fire("Close")},setPopupEl:function(e){e=mini.byId(e);if(!e)return;this._unbindPopupEl();this.popupEl=e;this._bindPopupEl()},setPopupCls:function(e){this.popupCls=e},setShowAction:function(e){this.showAction=e},setHideAction:function(e){this.hideAction=e},setShowDelay:function(e){this.showDelay=e},setHideDelay:function(e){this.hideDelay=e},setXAlign:function(e){this.xAlign=e},setYAlign:function(e){this.yAlign=e},setxOffset:function(e){e=parseInt(e);if(isNaN(e))e=0;this.xOffset=e},setyOffset:function(e){e=parseInt(e);if(isNaN(e))e=0;this.yOffset=e},setShowModal:function(e){this.showModal=e},setShowShadow:function(e){this.showShadow=e},setMinWidth:function(e){if(isNaN(e))return;this.minWidth=e},setMinHeight:function(e){if(isNaN(e))return;this.minHeight=e},setMaxWidth:function(e){if(isNaN(e))return;this.maxWidth=e},setMaxHeight:function(e){if(isNaN(e))return;this.maxHeight=e},setAllowDrag:function(e){this.allowDrag=e;mini.removeClass(this.el,this._dragCls);if(e){mini.addClass(this.el,this._dragCls)}},setAllowResize:function(e){this.allowResize=e;mini.removeClass(this.el,this._resizeCls);if(e){mini.addClass(this.el,this._resizeCls)}},__OnLeftClick:function(e){if(this._inAniming)return;if(this.showAction!="leftclick")return;var t=jQuery(this.popupEl).attr("allowPopup");if(String(t)=="false")return;this.doShow(e)},__OnRightClick:function(e){if(this._inAniming)return;if(this.showAction!="rightclick")return;var t=jQuery(this.popupEl).attr("allowPopup");if(String(t)=="false")return;e.preventDefault();this.doShow(e)},__OnMouseOver:function(e){if(this._inAniming)return;if(this.showAction!="mouseover")return;var t=jQuery(this.popupEl).attr("allowPopup");if(String(t)=="false")return;clearTimeout(this._hideTimer);this._hideTimer=null;if(this.isPopup)return;var i=this;this._showTimer=setTimeout(function(){i.doShow(e)},this.showDelay)},__OnBodyMouseMove:function(e){if(this.hideAction!="mouseout")return;this._tryHide(e)},__OnBodyMouseDown:function(e){if(this.hideAction!="outerclick")return;if(!this.isPopup)return;if(this.within(e)||this.popupEl&&mini.isAncestor(this.popupEl,e.target)){}else{this.doHide(e)}},_tryHide:function(e){if(mini.isAncestor(this.el,e.target)||this.popupEl&&mini.isAncestor(this.popupEl,e.target)){}else{clearTimeout(this._showTimer);this._showTimer=null;if(this._hideTimer)return;var t=this;this._hideTimer=setTimeout(function(){t.doHide(e)},this.hideDelay)}},__OnWindowResize:function(e){if(this.isDisplay()&&!mini.isIE6){this._doModal()}},within:function(e){if(mini.isAncestor(this.el,e.target))return true;var t=mini.getChildControls(this);for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.within(e))return true}return false}};mini.copyTo(mini.Popup.prototype,mini.Popup_prototype);mini.OutlookBar=function(){this._initGroups();mini.OutlookBar.superclass.constructor.call(this)};mini.extend(mini.OutlookBar,mini.Control,{width:180,expandOnLoad:true,activeIndex:-1,autoCollapse:false,groupCls:"",groupStyle:"",groupHeaderCls:"",groupHeaderStyle:"",groupBodyCls:"",groupBodyStyle:"",groupHoverCls:"",groupActiveCls:"",allowAnim:true,set:function(e){if(typeof e=="string"){return this}var t=this._allowLayout;this._allowLayout=false;var i=e.activeIndex;delete e.activeIndex;mini.OutlookBar.superclass.set.call(this,e);if(mini.isNumber(i)){this.setActiveIndex(i)}this._allowLayout=t;this.doLayout();return this},uiCls:"mini-outlookbar",_create:function(){this.el=document.createElement("div");this.el.className="mini-outlookbar";this.el.innerHTML='<div class="mini-outlookbar-border"></div>';this._borderEl=this.el.firstChild},destroy:function(e){if(this._borderEl){mini.clearEvent(this._borderEl);this.el.removeChild(this._borderEl);this._borderEl=null}mini.OutlookBar.superclass.destroy.call(this,e)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this)},this)},_createGroupId:function(e){return this.uid+"$"+e._id},_GroupId:1,_initGroups:function(){this.groups=[]},_createGroupEl:function(e){var t=this._createGroupId(e);var i='<div id="'+t+'" class="mini-outlookbar-group '+e.cls+'" style="'+e.style+'">'+'<div class="mini-outlookbar-groupHeader '+e.headerCls+'" style="'+e.headerStyle+';"></div>'+'<div class="mini-outlookbar-groupBody '+e.bodyCls+'" style="'+e.bodyStyle+';"></div>'+"</div>";var n=mini.append(this._borderEl,i);var s=n.lastChild;var r=e.body;delete e.body;if(r){if(!mini.isArray(r))r=[r];for(var l=0,o=r.length;l<o;l++){var a=r[l];mini.append(s,a)}r.length=0}if(e.bodyParent){var h=e.bodyParent;while(h.firstChild){s.appendChild(h.firstChild)}}delete e.bodyParent;return n},createGroup:function(e){var t=mini.copyTo({_id:this._GroupId++,name:"",title:"",cls:"",style:"",iconCls:"",iconStyle:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,enabled:true,showCollapseButton:true,expanded:this.expandOnLoad},e);return t},setGroups:function(e){if(!mini.isArray(e))return;this.removeAll();for(var t=0,i=e.length;t<i;t++){this.addGroup(e[t])}},getGroups:function(){return this.groups},addGroup:function(e,t){if(typeof e=="string"){e={title:e}}e=this.createGroup(e);if(typeof t!="number")t=this.groups.length;this.groups.insert(t,e);var i=this._createGroupEl(e);e._el=i;var t=this.groups.indexOf(e);var n=this.groups[t+1];if(n){var s=this.getGroupEl(n);jQuery(s).before(i)}this.doUpdate();return e},updateGroup:function(e,t){var e=this.getGroup(e);if(!e)return;mini.copyTo(e,t);this.doUpdate()},removeGroup:function(e){e=this.getGroup(e);if(!e)return;var t=this.getGroupEl(e);if(t)t.parentNode.removeChild(t);this.groups.remove(e);this.doUpdate()},removeAll:function(){for(var e=this.groups.length-1;e>=0;e--){this.removeGroup(e)}},moveGroup:function(e,t){e=this.getGroup(e);if(!e)return;target=this.getGroup(t);var i=this.getGroupEl(e);this.groups.remove(e);if(target){t=this.groups.indexOf(target);this.groups.insert(t,e);var n=this.getGroupEl(target);jQuery(n).before(i)}else{this.groups.add(e);this._borderEl.appendChild(i)}this.doUpdate()},doUpdate:function(){for(var e=0,t=this.groups.length;e<t;e++){var i=this.groups[e];var n=i._el;var s=n.firstChild;var r=n.lastChild;var l='<div class="mini-outlookbar-icon '+i.iconCls+'" style="'+i.iconStyle+';"></div>';var o="";if(i.showCollapseButton){o+='<div class="mini-tools"><span class="mini-tools-collapse"></span></div>'}o+=(i.iconStyle||i.iconCls?l:"")+'<div class="mini-outlookbar-groupTitle">'+i.title+'</div><div style="clear:both;"></div>';s.innerHTML=o;if(i.enabled){mini.removeClass(n,"mini-disabled")}else{mini.addClass(n,"mini-disabled")}mini.addClass(n,i.cls);mini.setStyle(n,i.style);mini.addClass(r,i.bodyCls);mini.setStyle(r,i.bodyStyle);mini.addClass(s,i.headerCls);mini.setStyle(s,i.headerStyle);mini.removeClass(n,"mini-outlookbar-firstGroup");mini.removeClass(n,"mini-outlookbar-lastGroup");if(e==0){mini.addClass(n,"mini-outlookbar-firstGroup")}if(e==t-1){mini.addClass(n,"mini-outlookbar-lastGroup")}}this.doLayout()},doLayout:function(){if(!this.canLayout())return;if(this._inAniming)return;this._doLayoutInner();for(var e=0,t=this.groups.length;e<t;e++){var i=this.groups[e];var n=i._el;var s=n.lastChild;if(i.expanded){mini.addClass(n,"mini-outlookbar-expand");mini.removeClass(n,"mini-outlookbar-collapse")}else{mini.removeClass(n,"mini-outlookbar-expand");mini.addClass(n,"mini-outlookbar-collapse")}s.style.height="auto";s.style.display=i.expanded?"block":"none";n.style.display=i.visible?"":"none";if(!isIE||isIE6){var r=mini.getWidth(n,true);var l=mini.getPaddings(s);var o=mini.getBorders(s);if(jQuery.boxModel){r=r-l.left-l.right-o.left-o.right}s.style.width=r+"px"}}var a=this.isAutoHeight();var h=this.getActiveGroup();if(!a&&this.autoCollapse&&h){var n=this.getGroupEl(this.activeIndex);n.lastChild.style.height=this._getFillGroupBodyHeight()+"px"}else{}if(isIE){var l=mini.getPaddings(this.el.parentNode);if(this._borderEl.offsetHeight>this.el.parentNode.offsetHeight-l.top-l.bottom){this.el.style.width=this.el.parentNode.clientWidth-20+"px"}else{this.el.style.width=this.width}}mini.layout(this._borderEl)},_doLayoutInner:function(){if(this.isAutoHeight()){this._borderEl.style.height="auto"}else{var e=this.getHeight(true);if(!jQuery.boxModel){var t=mini.getBorders(this._borderEl);e=e+t.top+t.bottom}if(e<0)e=0;this._borderEl.style.height=e+"px"}},_getFillGroupBodyHeight:function(){var e=jQuery(this.el).height();var t=mini.getBorders(this._borderEl);e=e-t.top-t.bottom;var i=this.getActiveGroup();var n=0;for(var s=0,r=this.groups.length;s<r;s++){var l=this.groups[s];var o=this.getGroupEl(l);if(l.visible==false||l==i)continue;var a=o.lastChild.style.display;o.lastChild.style.display="none";var h=jQuery(o).outerHeight();o.lastChild.style.display=a;var u=mini.getMargins(o);h=h+u.top+u.bottom;n+=h}e=e-n;var d=this.getGroupEl(this.activeIndex);if(!d)return 0;e=e-jQuery(d.firstChild).outerHeight();if(jQuery.boxModel){var c=mini.getPaddings(d.lastChild);var f=mini.getBorders(d.lastChild);e=e-c.top-c.bottom-f.top-f.bottom}var c=mini.getPaddings(d);var f=mini.getBorders(d);var u=mini.getMargins(d);e=e-u.top-u.bottom;e=e-c.top-c.bottom-f.top-f.bottom;if(e<0)e=0;return e},getGroup:function(e){if(typeof e=="object")return e;if(typeof e=="number"){return this.groups[e]}else{for(var t=0,i=this.groups.length;t<i;t++){var n=this.groups[t];if(n.name==e)return n}}},_getGroupById:function(e){for(var t=0,i=this.groups.length;t<i;t++){var n=this.groups[t];if(n._id==e)return n}},getGroupEl:function(e){var t=this.getGroup(e);if(!t)return null;return t._el},getGroupBodyEl:function(e){var t=this.getGroupEl(e);if(t)return t.lastChild;return null},setAutoCollapse:function(e){this.autoCollapse=e},getAutoCollapse:function(){return this.autoCollapse},setExpandOnLoad:function(e){this.expandOnLoad=e},getExpandOnLoad:function(){return this.expandOnLoad},setActiveIndex:function(e){var t=this.getGroup(e);var i=this.getGroup(this.activeIndex);var n=t!=i;if(t){this.activeIndex=this.groups.indexOf(t)}else{this.activeIndex=-1}var t=this.getGroup(this.activeIndex);if(t){var s=this.allowAnim;this.allowAnim=false;this.expandGroup(t);this.allowAnim=s}},getActiveIndex:function(){return this.activeIndex},getActiveGroup:function(){return this.getGroup(this.activeIndex)},showGroup:function(e){e=this.getGroup(e);if(!e||e.visible==true)return;e.visible=true;this.doUpdate()},hideGroup:function(e){e=this.getGroup(e);if(!e||e.visible==false)return;e.visible=false;this.doUpdate()},toggleGroup:function(e){e=this.getGroup(e);if(!e)return;this._allowLayout=false;if(e.expanded){this.collapseGroup(e)}else{this.expandGroup(e)}this._allowLayout=true;this.doLayout()},collapseGroup:function(e){e=this.getGroup(e);if(!e)return;var t=e.expanded;var i=0;if(this.autoCollapse&&!this.isAutoHeight()){i=this._getFillGroupBodyHeight()}var n=false;e.expanded=false;var s=this.groups.indexOf(e);if(s==this.activeIndex){this.activeIndex=-1;n=true}var r=this.getGroupBodyEl(e);if(this.allowAnim&&t){this._inAniming=true;r.style.display="block";r.style.height="auto";if(this.autoCollapse&&!this.isAutoHeight()){r.style.height=i+"px"}var l={height:"1px"};mini.addClass(r,"mini-outlookbar-overflow");var o=this;var a=jQuery(r);a.animate(l,180,function(){o._inAniming=false;mini.removeClass(r,"mini-outlookbar-overflow");o.doLayout()})}else{this.doLayout()}var h={group:e,index:this.groups.indexOf(e),name:e.name};this.fire("Collapse",h);if(n){this.fire("activechanged")}},expandGroup:function(e){e=this.getGroup(e);if(!e)return;var t=e.expanded;e.expanded=true;this.activeIndex=this.groups.indexOf(e);fire=true;if(this.autoCollapse){for(var i=0,n=this.groups.length;i<n;i++){var s=this.groups[i];if(s.expanded&&s!=e){this.collapseGroup(s)}}}var r=this.getGroupBodyEl(e);if(this.allowAnim&&t==false){this._inAniming=true;r.style.display="block";if(this.autoCollapse&&!this.isAutoHeight()){var l=this._getFillGroupBodyHeight();r.style.height=l+"px"}else{r.style.height="auto"}var o=mini.getHeight(r);r.style.height="1px";var a={height:o+"px"};var h=r.style.overflow;r.style.overflow="hidden";mini.addClass(r,"mini-outlookbar-overflow");var u=this;var d=jQuery(r);d.animate(a,180,function(){r.style.overflow=h;mini.removeClass(r,"mini-outlookbar-overflow");u._inAniming=false;u.doLayout()})}else{this.doLayout()}var c={group:e,index:this.groups.indexOf(e),name:e.name};this.fire("Expand",c);if(fire){this.fire("activechanged")}},_tryToggleGroup:function(e){e=this.getGroup(e);var t={group:e,groupIndex:this.groups.indexOf(e),groupName:e.name,cancel:false};if(e.expanded){this.fire("BeforeCollapse",t);if(t.cancel==false){this.collapseGroup(e)}}else{this.fire("BeforeExpand",t);if(t.cancel==false){this.expandGroup(e)}}},_getGroupByEvent:function(e){var t=mini.findParent(e.target,"mini-outlookbar-group");if(!t)return null;var i=t.id.split("$");var n=i[i.length-1];return this._getGroupById(n)},__OnClick:function(e){if(this._inAniming)return;var t=mini.findParent(e.target,"mini-outlookbar-groupHeader");if(!t)return;var i=this._getGroupByEvent(e);if(!i)return;this._tryToggleGroup(i)},parseGroups:function(e){var t=[];for(var i=0,n=e.length;i<n;i++){var s=e[i];var r={};t.push(r);r.style=s.style.cssText;mini._ParseString(s,r,["name","title","cls","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle"]);mini._ParseBool(s,r,["visible","enabled","showCollapseButton","expanded"]);r.bodyParent=s}return t},getAttrs:function(e){var t=mini.OutlookBar.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["onactivechanged","oncollapse","onexpand"]);mini._ParseBool(e,t,["autoCollapse","allowAnim","expandOnLoad"]);mini._ParseInt(e,t,["activeIndex"]);var i=mini.getChildNodes(e);t.groups=this.parseGroups(i);return t}});mini.regClass(mini.OutlookBar,"outlookbar");mini.MenuItem=function(){mini.MenuItem.superclass.constructor.call(this)};mini.extend(mini.MenuItem,mini.Control,{text:"",iconCls:"",iconStyle:"",iconPosition:"left",showIcon:true,showAllow:true,checked:false,checkOnClick:false,groupName:"",_hoverCls:"mini-menuitem-hover",_pressedCls:"mini-menuitem-pressed",_checkedCls:"mini-menuitem-checked",_clearBorder:false,menu:null,uiCls:"mini-menuitem",_create:function(){var e=this.el=document.createElement("div");this.el.className="mini-menuitem";this.el.innerHTML='<div class="mini-menuitem-inner"><div class="mini-menuitem-icon"></div><div class="mini-menuitem-text"></div><div class="mini-menuitem-allow"></div></div>';this._innerEl=this.el.firstChild;this._iconEl=this._innerEl.firstChild;this._textEl=this._innerEl.childNodes[1];this.allowEl=this._innerEl.lastChild},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited)return;this._inputEventsInited=true;mini_onOne(this.el,"click",this.__OnClick,this);mini_onOne(this.el,"mouseup",this.__OnMouseUp,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this)},destroy:function(e){if(this.el){this.el.onmouseover=null}this.menu=this._innerEl=this._iconEl=this._textEl=this.allowEl=null;mini.MenuItem.superclass.destroy.call(this,e)},within:function(e){if(mini.isAncestor(this.el,e.target))return true;if(this.menu&&this.menu.within(e))return true;return false},_doUpdateIcon:function(){var e=this.iconStyle||this.iconCls||this.checkOnClick;if(this._iconEl){mini.setStyle(this._iconEl,this.iconStyle);mini.addClass(this._iconEl,this.iconCls);this._iconEl.style.display=e?"block":"none"}if(this.iconPosition=="top"){mini.addClass(this.el,"mini-menuitem-icontop")}else{mini.removeClass(this.el,"mini-menuitem-icontop")}},doUpdate:function(){if(this._textEl)this._textEl.innerHTML=this.text;this._doUpdateIcon();if(this.checked){mini.addClass(this.el,this._checkedCls)}else{mini.removeClass(this.el,this._checkedCls)}if(this.allowEl){if(this.menu&&this.menu.items.length>0){this.allowEl.style.display="block"}else{this.allowEl.style.display="none"}}},setText:function(e){this.text=e;if(this._textEl)this._textEl.innerHTML=this.text},getText:function(){return this.text},setIconCls:function(e){mini.removeClass(this._iconEl,this.iconCls);this.iconCls=e;this._doUpdateIcon()},getIconCls:function(){return this.iconCls},setIconStyle:function(e){this.iconStyle=e;this._doUpdateIcon()},getIconStyle:function(){return this.iconStyle},setIconPosition:function(e){this.iconPosition=e;this._doUpdateIcon()},getIconPosition:function(){return this.iconPosition},setCheckOnClick:function(e){this.checkOnClick=e;if(e){mini.addClass(this.el,"mini-menuitem-showcheck")}else{mini.removeClass(this.el,"mini-menuitem-showcheck")}this.doUpdate()},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(e){if(this.checked!=e){this.checked=e;this.doUpdate();this.fire("checkedchanged")}},getChecked:function(){return this.checked},setGroupName:function(e){if(this.groupName!=e){this.groupName=e}},getGroupName:function(){return this.groupName},setChildren:function(e){this.setMenu(e)},setMenu:function(e){if(mini.isArray(e)){e={type:"menu",items:e}}if(this.menu!==e){this.menu=mini.getAndCreate(e);this.menu.hide();this.menu.ownerItem=this;this.doUpdate();this.menu.on("itemschanged",this.__OnItemsChanged,this)}},getMenu:function(){return this.menu},getMenuItems:function(){return this.menu.items},showMenu:function(){if(this.menu&&this.menu.isDisplay()==false){this.menu.setHideAction("outerclick");var e={xAlign:"outright",yAlign:"top",outXAlign:"outleft",popupCls:"mini-menu-popup"};if(this.ownerMenu&&this.ownerMenu.vertical==false){e.xAlign="left";e.yAlign="below";e.outXAlign=null}this.menu.showAtEl(this.el,e)}},hideMenu:function(){if(this.menu)this.menu.hide()},hide:function(){this.hideMenu();this.setVisible(false)},__OnItemsChanged:function(e){this.doUpdate()},getTopMenu:function(){if(this.ownerMenu){if(this.ownerMenu.ownerItem)return this.ownerMenu.ownerItem.getTopMenu();else return this.ownerMenu}return null},__OnClick:function(e){if(this.isReadOnly())return;if(this.checkOnClick){if(this.ownerMenu&&this.groupName){var t=this.ownerMenu.getGroupItems(this.groupName);if(t.length>0){if(this.checked==false){for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s!=this){s.setChecked(false)}}this.setChecked(true)}}else{this.setChecked(!this.checked)}}else{this.setChecked(!this.checked)}}this.fire("click");var r=this.getTopMenu();if(r){r._OnItemClick(this,e)}},__OnMouseUp:function(e){if(this.isReadOnly())return;if(this.ownerMenu){var t=this;setTimeout(function(){if(t.isDisplay()){t.ownerMenu.showItemMenu(t)}},1)}},__OnMouseOver:function(e){if(this.isReadOnly())return;this._initInputEvents();mini.addClass(this.el,this._hoverCls);this.el.title=this.text;if(this._textEl.scrollWidth>this._textEl.clientWidth){this.el.title=this.text}else{this.el.title=""}if(this.ownerMenu){if(this.ownerMenu.isVertical()==true){this.ownerMenu.showItemMenu(this)}else if(this.ownerMenu.hasShowItemMenu()){this.ownerMenu.showItemMenu(this)}}},__OnMouseOut:function(e){mini.removeClass(this.el,this._hoverCls)},onClick:function(e,t){this.on("click",e,t)},onCheckedChanged:function(e,t){this.on("checkedchanged",e,t)},getAttrs:function(e){var t=mini.MenuItem.superclass.getAttrs.call(this,e);var i=jQuery(e);t.text=e.innerHTML;mini._ParseString(e,t,["text","iconCls","iconStyle","iconPosition","groupName","onclick","oncheckedchanged"]);mini._ParseBool(e,t,["checkOnClick","checked"]);return t}});mini.regClass(mini.MenuItem,"menuitem");mini.MenuButton=function(){mini.MenuButton.superclass.constructor.call(this)};mini.extend(mini.MenuButton,mini.Button,{uiCls:"mini-menubutton",allowCls:"mini-button-menu",setMenu:function(e){if(mini.isArray(e)){e={type:"menu",items:e}}if(typeof e=="string"){var t=mini.byId(e);if(!t)return;mini.parse(e);e=mini.get(e)}if(this.menu!==e){this.menu=mini.getAndCreate(e);this.menu.setPopupEl(this.el);this.menu.setPopupCls("mini-button-popup");this.menu.setShowAction("leftclick");this.menu.setHideAction("outerclick");this.menu.setXAlign("left");this.menu.setYAlign("below");this.menu.hide();this.menu.owner=this}},setEnabled:function(e){this.enabled=e;if(e){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}jQuery(this.el).attr("allowPopup",!!e)}});mini.regClass(mini.MenuButton,"menubutton");mini.Menu=function(){this.items=[];mini.Menu.superclass.constructor.call(this)};mini.extend(mini.Menu,mini.Control);mini.copyTo(mini.Menu.prototype,mini.Popup_prototype);var mini_Popup_prototype_hide=mini.Popup_prototype.hide;mini.copyTo(mini.Menu.prototype,{height:"auto",width:"auto",minWidth:140,vertical:true,allowSelectItem:false,_selectedItem:null,_itemSelectedCls:"mini-menuitem-selected",textField:"text",resultAsTree:false,idField:"id",parentField:"pid",itemsField:"children",showNavArrow:true,_clearBorder:false,showAction:"none",hideAction:"outerclick",getbyName:function(e){for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];if(n.name==e){return n}if(n.menu){var s=n.menu.getbyName(e);if(s)return s}}return null},set:function(e){if(typeof e=="string"){return this}var t=e.url;delete e.url;mini.Menu.superclass.set.call(this,e);if(t){this.setUrl(t)}return this},uiCls:"mini-menu",_create:function(){this.el=document.createElement("div");this.el.className="mini-menu";this.el.innerHTML='<div class="mini-menu-border"><a class="mini-menu-topArrow" href="#" onclick="return false"></a><div class="mini-menu-inner"></div><a class="mini-menu-bottomArrow" href="#" onclick="return false"></a></div>';this._borderEl=this.el.firstChild;this._topArrowEl=this._borderEl.childNodes[0];this._bottomArrowEl=this._borderEl.childNodes[2];this._innerEl=this._borderEl.childNodes[1];this._innerEl.innerHTML='<div class="mini-menu-float"></div><div class="mini-menu-toolbar"></div><div style="clear:both;"></div>';this._contentEl=this._innerEl.firstChild;this._toolbarEl=this._innerEl.childNodes[1];if(this.isVertical()==false)mini.addClass(this.el,"mini-menu-horizontal")},destroy:function(e){if(this._topArrowEl){this._topArrowEl.onmousedown=this._bottomArrowEl.onmousedown=null;
}this._popupEl=this.popupEl=this._borderEl=this._innerEl=this._contentEl=null;this._topArrowEl=this._bottomArrowEl=null;this.owner=null;mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);this.el.onmouseover=null;this.el.oncontextmenu=null;mini.Menu.superclass.destroy.call(this,e)},_disableContextMenu:false,_initEvents:function(){mini._BindEvents(function(){mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);if(this._disableContextMenu){mini_onOne(this.el,"contextmenu",function(e){e.preventDefault()},this)}mini_onOne(this._topArrowEl,"mousedown",this.__OnTopMouseDown,this);mini_onOne(this._bottomArrowEl,"mousedown",this.__OnBottomMouseDown,this)},this)},within:function(e){if(mini.isAncestor(this.el,e.target))return true;for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];if(n.within(e))return true}return false},setVertical:function(e){this.vertical=e;if(!e){mini.addClass(this.el,"mini-menu-horizontal")}else{mini.removeClass(this.el,"mini-menu-horizontal")}},getVertical:function(){return this.vertical},isVertical:function(){return this.vertical},show:function(){this.setVisible(true)},hide:function(){this.hideItems();mini_Popup_prototype_hide.call(this)},hideItems:function(){for(var e=0,t=this.items.length;e<t;e++){var i=this.items[e];i.hideMenu()}},showItemMenu:function(e){for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];if(n==e){n.showMenu()}else{n.hideMenu()}}},hasShowItemMenu:function(){for(var e=0,t=this.items.length;e<t;e++){var i=this.items[e];if(i&&i.menu&&i.menu.isPopup){return true}}return false},showAllItems:function(e){if(!e)return;e.show();e.enable();var t=e.getMenuItems();t=mini.isNull(e)?this.getItems():t;i(t);function i(e){for(var t=0;t<e.length;t++){var n=e[t];n.show();n.enable();if(n.menu&&n.menu.items){var s=n.menu.items;i(s)}}}},hideAllItems:function(e){if(!e)return;e.hide();var t=e.getMenuItems();t=mini.isNull(e)?this.getItems():t;i(t);function i(e){for(var t=0;t<e.length;t++){var n=e[t];n.hide();if(n.menu&&n.menu.items){var s=n.menu.items;i(s)}}}},setData:function(e){if(!mini.isArray(e))e=[];this.setItems(e)},getData:function(){return this.getItems()},setItems:function(e){if(!mini.isArray(e))e=[];this.removeAll();var t=new Date;for(var i=0,n=e.length;i<n;i++){this.addItem(e[i])}},getItems:function(){return this.items},addItem:function(e){if(e=="-"||e=="|"||e.type=="separator"){mini.append(this._contentEl,'<span class="mini-separator"></span>');return}if(!mini.isControl(e)&&!mini.getClass(e.type)){e.type="menuitem"}e=mini.getAndCreate(e);this.items.push(e);this._contentEl.appendChild(e.el);e.ownerMenu=this;this.fire("itemschanged")},removeItem:function(e){e=mini.get(e);if(!e)return;this.items.remove(e);this._contentEl.removeChild(e.el);this.fire("itemschanged")},removeItemAt:function(e){var t=this.items[e];this.removeItem(t)},removeAll:function(){var e=this.items.clone();for(var t=e.length-1;t>=0;t--){this.removeItem(e[t])}this._contentEl.innerHTML=""},getGroupItems:function(e){if(!e)return[];var t=[];for(var i=0,n=this.items.length;i<n;i++){var s=this.items[i];if(s.groupName==e)t.push(s)}return t},getItem:function(e){if(typeof e=="number")return this.items[e];if(typeof e=="string"){for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];if(n.id==e)return n}return null}if(e&&this.items.indexOf(e)!=-1)return e;return null},setAllowSelectItem:function(e){this.allowSelectItem=e},getAllowSelectItem:function(){return this.allowSelectItem},setSelectedItem:function(e){e=this.getItem(e);this._OnItemSelect(e)},getSelectedItem:function(e){return this._selectedItem},setShowNavArrow:function(e){this.showNavArrow=e},getShowNavArrow:function(){return this.showNavArrow},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},setResultAsTree:function(e){this.resultAsTree=e},getResultAsTree:function(){return this.resultAsTree},setIdField:function(e){this.idField=e},getIdField:function(){return this.idField},setParentField:function(e){this.parentField=e},getParentField:function(){return this.parentField},doLayout:function(){if(!this.canLayout())return;if(!this.isAutoHeight()){var e=mini.getHeight(this.el,true);mini.setHeight(this._borderEl,e);this._topArrowEl.style.display=this._bottomArrowEl.style.display="none";this._contentEl.style.height="auto";if(this.showNavArrow&&this._borderEl.scrollHeight>this._borderEl.clientHeight){this._topArrowEl.style.display=this._bottomArrowEl.style.display="block";e=mini.getHeight(this._borderEl,true);var t=mini.getHeight(this._topArrowEl);var i=mini.getHeight(this._bottomArrowEl);var n=e-t-i;if(n<0)n=0;mini.setHeight(this._contentEl,n)}else{this._contentEl.style.height="auto"}}else{this._borderEl.style.height="auto";this._contentEl.style.height="auto"}},_measureSize:function(){if(this.height=="auto"){this.el.style.height="auto";this._borderEl.style.height="auto";this._contentEl.style.height="auto";this._topArrowEl.style.display=this._bottomArrowEl.style.display="none";var e=mini.getViewportBox();var t=mini.getBox(this.el);this.maxHeight=e.height-25;if(this.ownerItem){var t=mini.getBox(this.ownerItem.el);var i=t.top;var n=e.height-t.bottom;var s=i>n?i:n;s-=10;this.maxHeight=s}}this.el.style.display="";var t=mini.getBox(this.el);if(t.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);t=mini.getBox(this.el)}if(t.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);t=mini.getBox(this.el)}if(t.width<this.minWidth){mini.setWidth(this.el,this.minWidth);t=mini.getBox(this.el)}if(t.height<this.minHeight){mini.setHeight(this.el,this.minHeight);t=mini.getBox(this.el)}},url:"",_doLoad:function(){var e=mini.getData(this.url);if(this.dataField){e=mini._getMap(this.dataField,e)}if(!e)e=[];if(this.resultAsTree==false){e=mini.arrayToTree(e,this.itemsField,this.idField,this.parentField)}var t=mini.treeToArray(e,this.itemsField,this.idField,this.parentField);for(var i=0,n=t.length;i<n;i++){var s=t[i];s.text=mini._getMap(this.textField,s);if(mini.isNull(s.text))s.text=""}var r=new Date;this.setItems(e);this.fire("load")},loadList:function(e,t,i){if(!e)return;t=t||this.idField;i=i||this.parentField;for(var n=0,s=e.length;n<s;n++){var r=e[n];r.text=mini._getMap(this.textField,r);if(mini.isNull(r.text))r.text=""}var l=mini.arrayToTree(e,this.itemsField,t,i);this.load(l)},load:function(e){if(typeof e=="string"){this.setUrl(e)}else{this.setItems(e)}},setUrl:function(e){this.url=this.parseUrl(e);this._doLoad()},getUrl:function(){return this.url},hideOnClick:true,setHideOnClick:function(e){this.hideOnClick=e},getHideOnClick:function(){return this.hideOnClick},_OnItemClick:function(e,t){var i={item:e,isLeaf:!e.menu,htmlEvent:t};if(this.hideOnClick){if(this.isPopup){this.hide()}else{this.hideItems()}}if(this.allowSelectItem&&this._selectedItem!=e){this.setSelectedItem(e)}this.fire("itemclick",i);if(this.ownerItem){}},_OnItemSelect:function(e){if(this._selectedItem){this._selectedItem.removeCls(this._itemSelectedCls)}this._selectedItem=e;if(this._selectedItem){this._selectedItem.addCls(this._itemSelectedCls)}var t={item:this._selectedItem};this.fire("itemselect",t)},onItemClick:function(e,t){this.on("itemclick",e,t)},onItemSelect:function(e,t){this.on("itemselect",e,t)},__OnTopMouseDown:function(e){this._startScrollMove(-20)},__OnBottomMouseDown:function(e){this._startScrollMove(20)},_startScrollMove:function(e){clearInterval(this._scrollTimer);var t=function(){clearInterval(i._scrollTimer);mini.un(document,"mouseup",t)};mini.on(document,"mouseup",t);var i=this;this._scrollTimer=setInterval(function(){i._contentEl.scrollTop+=e},50)},setToolbar:function(e){__mini_setControls(e,this._toolbarEl,this)},parseItems:function(e){var t=[];for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s.className=="separator"){t.add("-");continue}var r=mini.getChildNodes(s);var l=r[0];var o=r[1];var a=new mini.MenuItem;if(!o){mini.applyTo.call(a,s);t.add(a);continue}mini.applyTo.call(a,l);a.render(document.body);var h=new mini.Menu;mini.applyTo.call(h,o);a.setMenu(h);h.render(document.body);t.add(a)}return t.clone()},getAttrs:function(e){var t=mini.Menu.superclass.getAttrs.call(this,e);var i=jQuery(e);mini._ParseString(e,t,["popupEl","popupCls","showAction","hideAction","xAlign","yAlign","modalStyle","onbeforeopen","open","onbeforeclose","onclose","url","onitemclick","onitemselect","textField","idField","parentField"]);mini._ParseBool(e,t,["resultAsTree","hideOnClick","showNavArrow"]);var n=mini.getChildNodes(e);for(var s=n.length-1;s>=0;s--){var r=n[s];var l=jQuery(r).attr("property");if(!l)continue;l=l.toLowerCase();if(l=="toolbar"){t.toolbar=r;r.parentNode.removeChild(r)}}var n=mini.getChildNodes(e);var o=this.parseItems(n);if(o.length>0){t.items=o}var a=i.attr("vertical");if(a){t.vertical=a=="true"?true:false}var h=i.attr("allowSelectItem");if(h){t.allowSelectItem=h=="true"?true:false}return t}});mini.regClass(mini.Menu,"menu");mini.MenuBar=function(){mini.MenuBar.superclass.constructor.call(this)};mini.extend(mini.MenuBar,mini.Menu,{uiCls:"mini-menubar",vertical:false,setVertical:function(e){this.vertical=false}});mini.regClass(mini.MenuBar,"menubar");mini.OutlookMenu=function(){mini.OutlookMenu.superclass.constructor.call(this);this.data=[]};mini.extend(mini.OutlookMenu,mini.OutlookBar,{url:"",textField:"text",iconField:"iconCls",urlField:"url",resultAsTree:false,itemsField:"children",idField:"id",parentField:"pid",style:"width:100%;height:100%;",set:function(e){if(typeof e=="string"){return this}var t=e.url;delete e.url;var i=e.activeIndex;delete e.activeIndex;mini.OutlookMenu.superclass.set.call(this,e);if(t){this.setUrl(t)}if(mini.isNumber(i)){this.setActiveIndex(i)}return this},uiCls:"mini-outlookmenu",destroy:function(e){if(this._menus){var t=this._menus.clone();for(var i=0,n=t.length;i<n;i++){var s=t[i];s.destroy()}this._menus.length=0}mini.OutlookMenu.superclass.destroy.call(this,e)},_doParseFields:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];n.text=n[this.textField];n.url=n[this.urlField];n.iconCls=n[this.iconField]}},_doLoad:function(){var e=[];try{e=mini.getData(this.url)}catch(t){if(mini_debugger==true){alert("outlooktree json is error.")}}if(this.dataField){e=mini._getMap(this.dataField,e)}if(!e)e=[];if(this.resultAsTree==false){e=mini.arrayToTree(e,this.itemsField,this.idField,this.parentField)}var i=mini.treeToArray(e,this.itemsField,this.idField,this.parentField);this._doParseFields(i);this.createNavBarMenu(e);this.fire("load")},loadList:function(e,t,i){t=t||this.idField;i=i||this.parentField;this._doParseFields(e);var n=mini.arrayToTree(e,this.nodesField,t,i);this.load(n)},load:function(e){if(typeof e=="string"){this.setUrl(e)}else{if(this.resultAsTree==false){e=mini.arrayToTree(e,this.itemsField,this.idField,this.parentField)}var t=mini.treeToArray(e,this.itemsField,this.idField,this.parentField);this._doParseFields(t);this.createNavBarMenu(e)}},setData:function(e){this.load(e)},setUrl:function(e){this.url=this.parseUrl(e);this._doLoad()},getUrl:function(){return this.url},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},setIconField:function(e){this.iconField=e},getIconField:function(){return this.iconField},setUrlField:function(e){this.urlField=e},getUrlField:function(){return this.urlField},setResultAsTree:function(e){this.resultAsTree=e},getResultAsTree:function(){return this.resultAsTree},setNodesField:function(e){this.nodesField=e},getNodesField:function(){return this.nodesField},setIdField:function(e){this.idField=e},getIdField:function(){return this.idField},setParentField:function(e){this.parentField=e},getParentField:function(){return this.parentField},_selected:null,getSelected:function(){return this._selected},selectNode:function(e){e=this.getNode(e);if(!e)return;var t=this._getOwnerMenu(e);if(!t)return;this.expandGroup(t._ownerGroup);setTimeout(function(){try{t.setSelectedItem(e)}catch(i){}},100)},findNodes:function(e,t){var i=[];t=t||this;for(var n=0,s=this._menus.length;n<s;n++){var r=this._menus[n].getItems();var l=[];for(var o=0,a=r.length;o<a;o++){var h=r[o];if(e&&e.call(t,h)===true){l.push(h)}}i.addRange(l)}return i},getNode:function(e){for(var t=0,i=this._menus.length;t<i;t++){var n=this._menus[t];var s=n.getItem(e);if(s)return s}return null},getList:function(){var e=[];for(var t=0,i=this._menus.length;t<i;t++){var n=this._menus[t];var s=n.getItems();e.addRange(s)}return e},_getOwnerMenu:function(e){if(!e)return;for(var t=0,i=this._menus.length;t<i;t++){var n=this._menus[t];var s=n.getItem(e);if(s)return n}},getAttrs:function(e){var t=mini.OutlookMenu.superclass.getAttrs.call(this,e);t.text=e.innerHTML;mini._ParseString(e,t,["url","textField","urlField","idField","parentField","itemsField","iconField","onitemclick","onitemselect"]);mini._ParseBool(e,t,["resultAsTree"]);return t},autoCollapse:true,activeIndex:0,createNavBarMenu:function(e){if(!mini.isArray(e))e=[];this.data=e;var t=[];for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var r={};r.title=s.text;r.iconCls=s.iconCls;t.push(r);r._children=s[this.itemsField]}this.setGroups(t);if(this.getExpandOnLoad())this.setActiveIndex(this.activeIndex);this._menus=[];for(var i=0,n=this.groups.length;i<n;i++){var r=this.groups[i];var l=this.getGroupBodyEl(r);var o=new mini.Menu;o._ownerGroup=r;o.set({showNavArrow:false,style:"width:100%;height:100%;border:0;background:none",borderStyle:"border:0",allowSelectItem:true,items:r._children});o.render(l);o.on("itemclick",this.__OnItemClick,this);o.on("itemselect",this.__OnItemSelect,this);this._menus.push(o);delete r._children}},__OnItemClick:function(e){var t={item:e.item,htmlEvent:e.htmlEvent};this.fire("itemclick",t)},__OnItemSelect:function(e){if(!e.item)return;for(var t=0,i=this._menus.length;t<i;t++){var n=this._menus[t];if(n!=e.sender){n.setSelectedItem(null)}}var s={item:e.item,htmlEvent:e.htmlEvent};this._selected=e.item;this.fire("itemselect",s)}});mini.regClass(mini.OutlookMenu,"outlookmenu");mini.ContextMenu=function(){mini.ContextMenu.superclass.constructor.call(this)};mini.extend(mini.ContextMenu,mini.Menu,{uiCls:"mini-contextmenu",vertical:true,visible:false,_disableContextMenu:true,setVertical:function(e){this.vertical=true}});mini.regClass(mini.ContextMenu,"contextmenu");mini.DataBinding=function(){this._bindFields=[];this._bindForms=[];mini.DataBinding.superclass.constructor.call(this)};mini.extend(mini.DataBinding,mini.Component,{bindField:function(e,t,i,n,s){e=mini.get(e);t=mini.get(t);if(!e||!t||!i)return;var r={control:e,source:t,field:i,convert:s,mode:n};this._bindFields.push(r);t.on("currentchanged",this.__OnCurrentChanged,this);e.on("valuechanged",this.__OnValueChanged,this)},bindForm:function(e,t,i,n){e=mini.byId(e);t=mini.get(t);if(!e||!t)return;var e=new mini.Form(e);var s=e.getFields();for(var r=0,l=s.length;r<l;r++){var o=s[r];this.bindField(o,t,o.getName(),i,n)}},__OnCurrentChanged:function(e){if(this._doSetting)return;this._doSetting=true;var t=e.sender;var i=e.record;for(var n=0,s=this._bindFields.length;n<s;n++){var r=this._bindFields[n];if(r.source!=t)continue;var l=r.control;var o=r.field;if(l.setValue){if(i){var a=i[o];l.setValue(a)}else{l.setValue("")}}if(l.setText&&l.textName){if(i){l.setText(i[l.textName])}else{l.setText("")}}}var h=this;setTimeout(function(){h._doSetting=false},10)},__OnValueChanged:function(e){if(this._doSetting)return;this._doSetting=true;var t=e.sender;var i=t.getValue();for(var n=0,s=this._bindFields.length;n<s;n++){var r=this._bindFields[n];if(r.control!=t||r.mode===false)continue;var l=r.source;var o=l.getCurrent();if(!o)continue;var a={};a[r.field]=i;if(t.getText&&t.textName){a[t.textName]=t.getText()}l.updateRow(o,a)}var h=this;setTimeout(function(){h._doSetting=false},10)}});mini.regClass(mini.DataBinding,"databinding");mini.MessageBox={alertTitle:"提醒",confirmTitle:"确认",prompTitle:"输入",prompMessage:"请输入内容：",buttonText:{ok:"确定",cancel:"取消",yes:"是",no:"否"},show:function(e){e=mini.copyTo({width:"auto",height:"auto",showModal:true,minWidth:150,maxWidth:800,minHeight:100,maxHeight:350,showHeader:true,title:"",titleIcon:"",iconCls:"",iconStyle:"",message:"",html:"",spaceStyle:"margin-right:15px",showCloseButton:true,buttons:null,buttonWidth:58,callback:null},e);var t=e.callback;var i=new mini.Window;i.setShowModal(e.showModal);i.setShowFooter(true);i.setTitle(e.title||"");i.setIconCls(e.titleIcon);i.setShowHeader(e.showHeader);i.setCls("mini-messagebox");i.setShowCloseButton(e.showCloseButton);var n=i.uid+"$table",s=i.uid+"$content";var r='<div class="'+e.iconCls+'" style="'+e.iconStyle+'"></div>';var l='<table class="mini-messagebox-table" id="'+n+'" style="" cellspacing="0" cellpadding="0"><tr><td>'+r+'</td><td id="'+s+'" class="mini-messagebox-content-text">'+(e.message||"")+"</td></tr></table>";var o='<div class="mini-messagebox-content"></div>';i._bodyEl.innerHTML=o;i._footerEl.innerHTML='<div class="mini-messagebox-buttons"></div>';var a=i._bodyEl.firstChild;if(e.html){if(typeof e.html=="string"){a.innerHTML=e.html}else if(mini.isElement(e.html)){a.appendChild(e.html)}}else{a.innerHTML=l}i._Buttons=[];var h=i._footerEl.firstChild;if(e.buttons&&e.buttons.length>0){for(var u=0,d=e.buttons.length;u<d;u++){var c=e.buttons[u];var f=mini.MessageBox.buttonText[c];if(!f)f=c;var m=new mini.Button;m.setText(f);m.setWidth(e.buttonWidth);m.render(h);m.action=c;m.on("click",function(e){var n=e.sender;if(t)t(n.action);if(mini)mini.MessageBox.hide(i)});if(u!=d-1){m.setStyle(e.spaceStyle)}i._Buttons.push(m)}}else{h.style.display="none"}i.setMinWidth(e.minWidth);i.setMinHeight(e.minHeight);i.setMaxWidth(e.maxWidth);i.setMaxHeight(e.maxHeight);i.setWidth(e.width);i.setHeight(e.height);i.show();var p=i.getWidth();i.setWidth(p);var g=i.getHeight();i.setHeight(g);var v=document.getElementById(n);if(v){v.style.width="100%"}var _=document.getElementById(s);if(_){_.style.width="100%"}var y=i._Buttons[0];if(y){setTimeout(function(){y.focus()},100)}else{i.focus()}i.on("beforebuttonclick",function(e){if(t)t("close");e.cancel=true;mini.MessageBox.hide(i)});mini.on(i.el,"keydown",function(e){if(e.keyCode==27){if(t)t("close");e.cancel=true;mini.MessageBox.hide(i)}});return i.uid},hide:function(e){if(!e)return;var t=typeof e=="object"?e:mini.getbyUID(e);if(!t)return;for(var i=0,n=t._Buttons.length;i<n;i++){var s=t._Buttons[i];s.destroy()}t._Buttons=null;t.destroy()},alert:function(e,t,i){return mini.MessageBox.show($.extend({maxWidth:400,minWidth:250,buttons:["ok"],title:mini.MessageBox.alertTitle,iconCls:"mini-messagebox-warning"},$.isPlainObject(e)?e:{message:e,title:t||mini.MessageBox.alertTitle,callback:i}))},confirm:function(e,t,i){return mini.MessageBox.show({maxWidth:400,minWidth:250,title:t||mini.MessageBox.confirmTitle,buttons:["ok","cancel"],message:e,iconCls:"mini-messagebox-question",callback:i})},prompt:function(e,t,i,n){var s="prompt$"+(new Date).getTime();var r=e||mini.MessageBox.promptMessage;var l=jQuery("<div></div>");var o;var a;if(n){o=new mini.TextArea;o.setWidth("230");o.setHeight("70");a="190"}else{o=new mini.TextBox;o.setWidth("230");a="140";r=r+"<br/>"}var h=mini.MessageBox.show({title:t||mini.MessageBox.promptTitle,buttons:["ok","cancel"],width:280,height:a,html:'<div id="pzf" style="overflow:auto;padding:5px;padding-left:10px;">'+r+"</div>",callback:function(e){if(i)i(e,o.getValue())}});o.render(jQuery("#pzf")[0]);o.focus();return h},loading:function(e,t){return mini.MessageBox.show({maxWidth:400,minHeight:50,title:t,showCloseButton:false,message:e,iconCls:"mini-messagebox-waiting"})},showTips:function(e){var t=jQuery;e=t.extend({content:"",state:"",x:"center",y:"top",offset:[10,10],fixed:true,timeout:2e3},e);var i="mini-tips-"+e.state;var n='<div class="mini-tips '+i+'">'+e.content+"</div>";var s=t(n).appendTo(document.body);e.el=s[0];e.timeoutHandler=function(){s.slideUp();setTimeout(function(){s.remove()},2e3)};mini.showAt(e);s.hide().slideDown()}};mini.alert=mini.MessageBox.alert;mini.confirm=mini.MessageBox.confirm;mini.prompt=mini.MessageBox.prompt;mini.loading=mini.MessageBox.loading;mini.showMessageBox=mini.MessageBox.show;mini.hideMessageBox=mini.MessageBox.hide;mini.showTips=mini.MessageBox.showTips;mini.NavBar=function(){mini.NavBar.superclass.constructor.call(this)};mini.extend(mini.NavBar,mini.OutlookBar,{uiCls:"mini-navbar"});mini.regClass(mini.NavBar,"navbar");mini.NavBarMenu=function(){mini.NavBarMenu.superclass.constructor.call(this)};mini.extend(mini.NavBarMenu,mini.OutlookMenu,{uiCls:"mini-navbarmenu"});mini.regClass(mini.NavBarMenu,"navbarmenu");mini.Panel=function(){this._initButtons();mini.Panel.superclass.constructor.call(this);if(this.url)this.setUrl(this.url);this._contentEl=this._bodyEl;this._doVisibleEls();this._Resizer=new mini._Resizer(this);this._doTools()};mini.extend(mini.Panel,mini.Container,{width:250,title:"",iconCls:"",iconStyle:"",allowResize:false,url:"",refreshOnExpand:false,maskOnLoad:true,showCollapseButton:false,showCloseButton:false,closeAction:"display",showHeader:true,showToolbar:false,showFooter:false,headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",footerCls:"",footerStyle:"",toolbarCls:"",toolbarStyle:"",minWidth:180,minHeight:100,maxWidth:5e3,maxHeight:3e3,set:function(e){if(typeof e=="string"){return this}var t=this._allowLayout;this._allowLayout=false;var i=e.toolbar;delete e.toolbar;var n=e.footer;delete e.footer;var s=e.url;delete e.url;mini.Panel.superclass.set.call(this,e);if(i){this.setToolbar(i)}if(n){this.setFooter(n)}if(s){this.setUrl(s)}this._allowLayout=t;this.doLayout();return this},uiCls:"mini-panel",_create:function(){this.el=document.createElement("div");this.el.className="mini-panel";var e='<div class="mini-panel-border">'+'<div class="mini-panel-header" ><div class="mini-panel-header-inner" ><span class="mini-panel-icon"></span><div class="mini-panel-title" ></div><div class="mini-tools" ></div></div></div>'+'<div class="mini-panel-viewport">'+'<div class="mini-panel-toolbar"></div>'+'<div class="mini-panel-body" ></div>'+'<div class="mini-panel-footer"></div>'+'<div class="mini-resizer-trigger"></div>'+"</div>"+"</div>";this.el.innerHTML=e;this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewportEl=this._borderEl.lastChild;this._toolbarEl=mini.byClass("mini-panel-toolbar",this.el);this._bodyEl=mini.byClass("mini-panel-body",this.el);this._footerEl=mini.byClass("mini-panel-footer",this.el);this._resizeGridEl=mini.byClass("mini-resizer-trigger",this.el);var t=mini.byClass("mini-panel-header-inner",this.el);this._iconEl=mini.byClass("mini-panel-icon",this.el);this._titleEl=mini.byClass("mini-panel-title",this.el);this._toolsEl=mini.byClass("mini-tools",this.el);mini.setStyle(this._bodyEl,this.bodyStyle);this._doTitle()},destroy:function(e){this._doRemoveIFrame();this._iframeEl=null;if(this._headerEl){mini.clearEvent(this._headerEl);this._borderEl.removeChild(this._headerEl);this._headerEl=null}if(this._viewportEl){mini.clearEvent(this._viewportEl);this._borderEl.removeChild(this._viewportEl);this._viewportEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this.el.removeChild(this._borderEl);this._borderEl=null}if(this._toolbarEl){$(this._toolbarEl).remove();this._toolbarEl=null}if(this._bodyEl){$(this._bodyEl).remove();this._bodyEl=null}if(this._footerEl){$(this._footerEl).remove();this._footerEl=null}if(this._resizeGridEl){$(this._resizeGridEl).remove();this._resizeGridEl=null}if(this._iconEl){$(this._iconEl).remove();this._iconEl=null}if(this._titleEl){$(this._titleEl).remove();this._titleEl=null}if(this._toolsEl){$(this._toolsEl).remove();this._toolsEl=null}mini.Panel.superclass.destroy.call(this,e)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this)},this)},_doVisibleEls:function(){this._headerEl.style.display=this.showHeader?"":"none";this._toolbarEl.style.display=this.showToolbar?"":"none";this._footerEl.style.display=this.showFooter?"":"none"},doLayout:function(){if(!this.canLayout())return;this._resizeGridEl.style.display=this.allowResize?"":"none";var e=this.isAutoHeight();var t=this.isAutoWidth();var i=mini.getWidth(this._viewportEl,true);var n=i;if(!e){var s=this.getViewportHeight();mini.setHeight(this._viewportEl,s);var r=this.getBodyHeight(true);mini.setHeight(this._bodyEl,r)}else{this._viewportEl.style.height="auto";this._bodyEl.style.height="auto"}mini.layout(this._borderEl);this.fire("layout")},deferLayout:function(e){if(!e)e=10;if(this._layoutTimer)return;var t=this;this._layoutTimer=setTimeout(function(){t._layoutTimer=null;t.doLayout()},e)},_stopLayout:function(){clearTimeout(this._layoutTimer);this._layoutTimer=null},getViewportWidth:function(e){return mini.getWidth(this._viewportEl,e)},getViewportHeight:function(e){var t=this.getHeight(true)-this.getHeaderHeight();if(e){var i=mini.getPaddings(this._viewportEl);var n=mini.getBorders(this._viewportEl);var s=mini.getMargins(this._viewportEl);if(jQuery.boxModel){t=t-i.top-i.bottom-n.top-n.bottom}t=t-s.top-s.bottom}return t},getBodyHeight:function(e){var t=this.getViewportHeight();var t=t-this.getToolbarHeight()-this.getFooterHeight();if(e){var i=mini.getPaddings(this._viewportEl);var n=mini.getBorders(this._viewportEl);var s=mini.getMargins(this._viewportEl);if(jQuery.boxModel){t=t-i.top-i.bottom-n.top-n.bottom}t=t-s.top-s.bottom}if(t<0)t=0;return t},getHeaderHeight:function(){var e=this.showHeader?jQuery(this._headerEl).outerHeight():0;return e},getToolbarHeight:function(){var e=this.showToolbar?jQuery(this._toolbarEl).outerHeight():0;return e},getFooterHeight:function(){var e=this.showFooter?jQuery(this._footerEl).outerHeight():0;return e},setHeaderStyle:function(e){this.headerStyle=e;mini.setStyle(this._headerEl,e);this.doLayout()},getHeaderStyle:function(){return this.headerStyle},setBodyStyle:function(e){this.bodyStyle=e;mini.setStyle(this._bodyEl,e);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setToolbarStyle:function(e){this.toolbarStyle=e;mini.setStyle(this._toolbarEl,e);this.doLayout()},getToolbarStyle:function(){return this.toolbarStyle},setFooterStyle:function(e){this.footerStyle=e;mini.setStyle(this._footerEl,e);this.doLayout()},getFooterStyle:function(){return this.footerStyle},setHeaderCls:function(e){jQuery(this._headerEl).removeClass(this.headerCls);jQuery(this._headerEl).addClass(e);this.headerCls=e;this.doLayout()},getHeaderCls:function(){return this.headerCls},setBodyCls:function(e){jQuery(this._bodyEl).removeClass(this.bodyCls);jQuery(this._bodyEl).addClass(e);this.bodyCls=e;this.doLayout()},getBodyCls:function(){return this.bodyCls},setToolbarCls:function(e){jQuery(this._toolbarEl).removeClass(this.toolbarCls);jQuery(this._toolbarEl).addClass(e);this.toolbarCls=e;this.doLayout()},getToolbarCls:function(){return this.toolbarCls},setFooterCls:function(e){jQuery(this._footerEl).removeClass(this.footerCls);jQuery(this._footerEl).addClass(e);this.footerCls=e;this.doLayout()},getFooterCls:function(){return this.footerCls},_doTitle:function(){this._titleEl.innerHTML=this.title;this._iconEl.style.display=this.iconCls||this.iconStyle?"inline":"none";this._iconEl.className="mini-panel-icon "+this.iconCls;mini.setStyle(this._iconEl,this.iconStyle)},setTitle:function(e){this.title=e;this._doTitle()},getTitle:function(){return this.title},setIconCls:function(e){this.iconCls=e;this._doTitle()},getIconCls:function(){return this.iconCls},_doTools:function(){var e="";for(var t=this.buttons.length-1;t>=0;t--){var i=this.buttons[t];e+='<span id="'+t+'" class="'+i.cls+" "+(i.enabled?"":"mini-disabled")+'" style="'+i.style+";"+(i.visible?"":"display:none;")+'"></span>'}this._toolsEl.innerHTML=e},setShowCloseButton:function(e){this.showCloseButton=e;var t=this.getButton("close");t.visible=e;this._doTools()},getShowCloseButton:function(){return this.showCloseButton},setCloseAction:function(e){this.closeAction=e},getCloseAction:function(){return this.closeAction},setShowCollapseButton:function(e){this.showCollapseButton=e;var t=this.getButton("collapse");t.visible=e;this._doTools()},getShowCollapseButton:function(){return this.showCollapseButton},setShowHeader:function(e){this.showHeader=e;this._doVisibleEls();this.deferLayout()},getShowHeader:function(){return this.showHeader},setShowToolbar:function(e){this.showToolbar=e;this._doVisibleEls();this.deferLayout()},getShowToolbar:function(){return this.showToolbar},setShowFooter:function(e){this.showFooter=e;this._doVisibleEls();this.deferLayout()},getShowFooter:function(){return this.showFooter},__OnClick:function(e){if(mini.isAncestor(this._headerEl,e.target)){var t=mini.findParent(e.target,"mini-tools");if(t){var i=this.getButton(parseInt(e.target.id));if(i){this._OnButtonClick(i,e)}}}},_OnButtonClick:function(e,t){var i={button:e,index:this.buttons.indexOf(e),name:e.name.toLowerCase(),htmlEvent:t,cancel:false};this.fire("beforebuttonclick",i);try{if(i.name=="close"&&this.closeAction=="destroy"&&this._iframeEl&&this._iframeEl.contentWindow){var n=true;if(this._iframeEl.contentWindow.CloseWindow){n=this._iframeEl.contentWindow.CloseWindow("close")}else if(this._iframeEl.contentWindow.CloseOwnerWindow){n=this._iframeEl.contentWindow.CloseOwnerWindow("close")}if(n===false){i.cancel=true}}}catch(s){}if(i.cancel==true)return i;this.fire("buttonclick",i);if(i.name=="close"){if(this.closeAction=="destroy"){this.__HideAction="close";this.destroy()}else{this.hide()}}if(i.name=="collapse"){this.toggle();if(this.refreshOnExpand&&this.expanded&&this.url){this.reload()}}return i},onButtonClick:function(e,t){this.on("buttonclick",e,t)},_initButtons:function(){this.buttons=[];var e=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(e);var t=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(t)},createButton:function(e){var t=mini.copyTo({name:"",cls:"",style:"",visible:true,enabled:true,html:""},e);return t},addButton:function(e,t){if(typeof e=="string"){e={iconCls:e}}e=this.createButton(e);if(typeof t!="number")t=this.buttons.length;this.buttons.insert(t,e);this._doTools()},updateButton:function(e,t){var i=this.getButton(e);if(!i)return;mini.copyTo(i,t);this._doTools()},removeButton:function(e){var t=this.getButton(e);if(!t)return;this.buttons.remove(t);this._doTools()},getButton:function(e){if(typeof e=="number"){return this.buttons[e]}else{for(var t=0,i=this.buttons.length;t<i;t++){var n=this.buttons[t];if(n.name==e)return n}}},setBody:function(e){__mini_setControls(e,this._bodyEl,this)},set_bodyParent:function(e){},setToolbar:function(e){__mini_setControls(e,this._toolbarEl,this)},setFooter:function(e){__mini_setControls(e,this._footerEl,this)},getHeaderEl:function(){return this._headerEl},getToolbarEl:function(){return this._toolbarEl},getBodyEl:function(){return this._bodyEl},getFooterEl:function(){return this._footerEl},getIFrameEl:function(e){return this._iframeEl},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(e){if(this._iframeEl){var t=this._iframeEl;if(t._ondestroy)t._ondestroy();try{this._iframeEl.parentNode.removeChild(this._iframeEl);this._iframeEl.removeNode(true)}catch(i){}}this._iframeEl=null;if(e===true){mini.removeChilds(this._bodyEl)}},_deferLoadingTime:80,_doLoad:function(){this._doRemoveIFrame(true);var e=new Date;var t=this;this.loadedUrl=this.url;if(this.maskOnLoad)this.loading();jQuery(this._bodyEl).css("overflow","hidden");var i=mini.createIFrame(this.url,function(i,n){var s=e-new Date+t._deferLoadingTime;if(s<0)s=0;setTimeout(function(){t.unmask()},s);try{t._iframeEl.contentWindow.Owner=t.Owner;t._iframeEl.contentWindow.CloseOwnerWindow=function(e){t.__HideAction=e;var i=true;if(t.__onDestroy)i=t.__onDestroy(e);if(i===false){return false}var n={iframe:t._iframeEl,action:e};t.fire("unload",n);setTimeout(function(){t.destroy()},10)}}catch(r){}if(t.__onLoad)t.__onLoad();var r={
    iframe:t._iframeEl};t.fire("load",r)});this._bodyEl.appendChild(i);this._iframeEl=i},load:function(e,t,i){this.setUrl(e,t,i)},reload:function(){this.setUrl(this.parseUrl(this.url))},setUrl:function(e,t,i){this.url=e;this.__onLoad=t;this.__onDestroy=i;if(this.expanded){this._doLoad()}},getUrl:function(){return this.url},setRefreshOnExpand:function(e){this.refreshOnExpand=e},getRefreshOnExpand:function(){return this.refreshOnExpand},setMaskOnLoad:function(e){this.maskOnLoad=e},getMaskOnLoad:function(e){return this.maskOnLoad},setAllowResize:function(e){if(this.allowResize!=e){this.allowResize=e;this.doLayout()}},getAllowResize:function(){return this.allowResize},expanded:true,setExpanded:function(e){if(this.expanded!=e){this.expanded=e;if(this.expanded){this.expand()}else{this.collapse()}}},toggle:function(){if(this.expanded){this.collapse()}else{this.expand()}},collapse:function(){this.expanded=false;this._height=this.el.style.height;this.el.style.height="auto";this._viewportEl.style.display="none";mini.addClass(this.el,"mini-panel-collapse");this.doLayout()},expand:function(){this.expanded=true;this.el.style.height=this._height;this._viewportEl.style.display="block";delete this._height;mini.removeClass(this.el,"mini-panel-collapse");if(this.url&&this.url!=this.loadedUrl){this._doLoad()}this.doLayout()},getAttrs:function(e){var t=mini.Panel.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["title","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle","footerCls","footerStyle","toolbarCls","toolbarStyle","footer","toolbar","url","closeAction","loadingMsg","onbeforebuttonclick","onbuttonclick","onload"]);mini._ParseBool(e,t,["allowResize","showCloseButton","showHeader","showToolbar","showFooter","showCollapseButton","refreshOnExpand","maskOnLoad","expanded"]);var i=mini.getChildNodes(e,true);for(var n=i.length-1;n>=0;n--){var s=i[n];var r=jQuery(s).attr("property");if(!r)continue;r=r.toLowerCase();if(r=="toolbar"){t.toolbar=s}else if(r=="footer"){t.footer=s}}t.body=i;return t}});mini.regClass(mini.Panel,"panel");mini=mini||{};mini.TextBox=function(){mini.TextBox.superclass.constructor.call(this)};mini.extend(mini.TextBox,mini.ValidatorBase,{name:"",formField:true,selectOnFocus:false,minWidth:10,minHeight:15,maxLength:5e3,emptyText:"",text:"",value:"",defaultValue:"",width:125,height:21,_emptyCls:"mini-textbox-empty",_focusCls:"mini-textbox-focus",_disabledCls:"mini-textbox-disabled",uiCls:"mini-textbox",_InputType:"text",autoUnEscape:true,_create:function(){var e='<input type="'+this._InputType+'" class="mini-textbox-input" autocomplete="off"/>';if(this._InputType=="textarea"){e='<textarea class="mini-textbox-input" autocomplete="off"/></textarea>'}e='<span class="mini-textbox-border">'+e+"</span>";e+='<input type="hidden"/>';this.el=document.createElement("span");this.el.className="mini-textbox";this.el.innerHTML=e;this._borderEl=this.el.firstChild;this._textEl=this._borderEl.firstChild;this._valueEl=this.el.lastChild;this._doEmpty()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this._textEl,"drop",this.__OnDropText,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this._textEl,"paste",this.__OnPaste,this);var e=this.value;this.value="";this.setValue(e)},this);this.on("validation",this.__OnValidation,this)},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited)return;this._inputEventsInited=true;mini.on(this._textEl,"blur",this.__OnBlur,this);mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this);mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this);mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this)},destroy:function(e){if(this.el){this.el.onmousedown=null}if(this._textEl){this._textEl.ondrop=null;this._textEl.onchange=null;this._textEl.onfocus=null;this._textEl.placeholder=null;this._textEl.onpropertychange=null;if(this._textEl._placeholder_label){this._textEl._placeholder_label.onmousedown=null;this._textEl._placeholder_label.parentNode.removeChild(this._textEl._placeholder_label);this._textEl._placeholder_label=null}mini.clearEvent(this._textEl);this._textEl.parentNode.removeChild(this._textEl);this._textEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this._borderEl.parentNode.removeChild(this._borderEl);this._borderEl=null}if(this._valueEl){mini.clearEvent(this._valueEl);this._valueEl.parentNode.removeChild(this._valueEl);this._valueEl=null}if(this._errorIconEl){mini.clearEvent(this._errorIconEl);this._errorIconEl.parentNode.removeChild(this._errorIconEl);this._errorIconEl=null}mini.TextBox.superclass.destroy.call(this,e)},doLayout:function(){},setHeight:function(e){if(parseInt(e)==e)e+="px";this.height=e;if(this._InputType=="textarea"){this.el.style.height=e;this.doLayout()}},setName:function(e){if(this.name!=e){this.name=e;if(this._valueEl)mini.setAttr(this._valueEl,"name",this.name)}},setValue:function(e,t){if(e===null||e===undefined)e="";e=String(e);if(this.autoUnEscape){e=mini.htmlDecode(e)}if(e.length>this.maxLength){e=e.substring(0,this.maxLength);this._textEl.value=e}if(this.value!==e){this.value=e;this._valueEl.value=this._textEl.value=e;this._doEmpty();if(t===undefined)t=true;if(t)this._OnValueChanged()}},getValue:function(){return this.value},getFormValue:function(){var e=this.value;if(e===null||e===undefined)e="";return String(e)},setAllowInput:function(e){if(this.allowInput!=e){this.allowInput=e;this.doUpdate()}},getAllowInput:function(){return this.allowInput},_placeholdered:false,_doEmpty:function(){this._textEl.placeholder=this.emptyText;if(this.emptyText){mini._placeholder(this._textEl)}},setEmptyText:function(e){if(this.emptyText!=e){this.emptyText=e;this._doEmpty()}},getEmptyText:function(){return this.emptyText},setMaxLength:function(e){this.maxLength=e;mini.setAttr(this._textEl,"maxLength",e);if(this._InputType=="textarea"&&mini.isIE){mini.on(this._textEl,"keypress",this.__OnMaxLengthKeyUp,this)}},__OnMaxLengthKeyUp:function(e){if(this._textEl.value.length>=this.maxLength){e.preventDefault()}},getMaxLength:function(){return this.maxLength},setReadOnly:function(e){if(this.readOnly!=e){this.readOnly=e;this.doUpdate()}},setEnabled:function(e){if(this.enabled!=e){this.enabled=e;this.doUpdate();this._tryValidate()}},doUpdate:function(){if(this.enabled){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}if(this.isReadOnly()||this.allowInput==false){this._textEl.readOnly=true;mini.addClass(this.el,"mini-textbox-readOnly")}else{this._textEl.readOnly=false;mini.removeClass(this.el,"mini-textbox-readOnly")}if(this.required){this.addCls(this._requiredCls)}else{this.removeCls(this._requiredCls)}if(this.enabled){this._textEl.disabled=false}else{this._textEl.disabled=true}},focus:function(){try{this._textEl.focus()}catch(e){}},blur:function(){try{this._textEl.blur()}catch(e){}},selectText:function(){var e=this;function t(){try{e._textEl.select()}catch(t){}}t();setTimeout(function(){t()},30)},getTextEl:function(){return this._textEl},getInputText:function(){return this._textEl.value},setInputText:function(e){return this._textEl.value=e},setSelectOnFocus:function(e){this.selectOnFocus=e},getSelectOnFocus:function(e){return this.selectOnFocus},_errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){this._errorIconEl=mini.append(this.el,'<span class="mini-errorIcon"></span>')}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){var e=this._errorIconEl;jQuery(e).remove()}this._errorIconEl=null},__OnMouseDown:function(e){var t=this;if(!mini.isAncestor(this._textEl,e.target)){setTimeout(function(){t.focus();mini.selectRange(t._textEl,1e3,1e3)},1)}else{setTimeout(function(){try{t._textEl.focus()}catch(e){}},1)}},__OnPaste:function(e){var t=this;setTimeout(function(){t.fire("paste",{htmlEvent:e,inputText:t.getInputText()})},1)},__OnInputTextChanged:function(e,t){var i=this.value;this.setValue(this._textEl.value);if(i!==this.getValue()||t===true){}},__OnDropText:function(e){var t=this;setTimeout(function(){t.__OnInputTextChanged(e)},0)},__OnInputKeyDown:function(e){var t={htmlEvent:e};this.fire("keydown",t);if(t.cancel){return false}if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==13||e.keyCode==9){if(this._InputType=="textarea"&&e.keyCode==13){}else{this.__OnInputTextChanged(null,true);if(e.keyCode==13){var i=this;i.fire("enter",t)}}}},__OnInputKeyUp:function(e){var t={htmlEvent:e};this.fire("keyup",t);if(t.cancel){return false}},__OnInputKeyPress:function(e){var t={htmlEvent:e};this.fire("keypress",t);if(t.cancel){return false}},__OnFocus:function(e){this.doUpdate();if(this.isReadOnly()){return}this._focused=true;this.addCls(this._focusCls);this._initInputEvents();if(this.selectOnFocus){this.selectText()}this.fire("focus",{htmlEvent:e})},__OnBlur:function(e){this._focused=false;var t=this;setTimeout(function(){if(t._focused==false){t.removeCls(t._focusCls)}},2);this.fire("blur",{htmlEvent:e});if(this.validateOnLeave){this._tryValidate()}},inputStyle:"",setInputStyle:function(e){this.inputStyle=e;mini.setStyle(this._textEl,e)},getAttrs:function(e){var t=mini.TextBox.superclass.getAttrs.call(this,e);var i=jQuery(e);mini._ParseString(e,t,["value","text","emptyText","inputStyle","onenter","onkeydown","onkeyup","onkeypress","onpaste","maxLengthErrorText","minLengthErrorText","onfocus","onblur","vtype","emailErrorText","urlErrorText","floatErrorText","intErrorText","dateErrorText","minErrorText","maxErrorText","rangeLengthErrorText","rangeErrorText","rangeCharErrorText"]);if(isIE7){if(jQuery(e).attr("width"))t.width=jQuery(e).attr("width")}mini._ParseBool(e,t,["allowInput","selectOnFocus"]);mini._ParseInt(e,t,["maxLength","minLength","minHeight","minWidth"]);return t},vtype:"",setVtype:function(e){this.vtype=e},getVtype:function(){return this.vtype},__OnValidation:function(e){if(e.isValid==false)return;mini._ValidateVType(this.vtype,e.value,e,this)},setEmailErrorText:function(e){this.emailErrorText=e},getEmailErrorText:function(){return this.emailErrorText},setUrlErrorText:function(e){this.urlErrorText=e},getUrlErrorText:function(){return this.urlErrorText},setFloatErrorText:function(e){this.floatErrorText=e},getFloatErrorText:function(){return this.floatErrorText},setIntErrorText:function(e){this.intErrorText=e},getIntErrorText:function(){return this.intErrorText},setDateErrorText:function(e){this.dateErrorText=e},getDateErrorText:function(){return this.dateErrorText},setMaxLengthErrorText:function(e){this.maxLengthErrorText=e},getMaxLengthErrorText:function(){return this.maxLengthErrorText},setMinLengthErrorText:function(e){this.minLengthErrorText=e},getMinLengthErrorText:function(){return this.minLengthErrorText},setMaxErrorText:function(e){this.maxErrorText=e},getMaxErrorText:function(){return this.maxErrorText},setMinErrorText:function(e){this.minErrorText=e},getMinErrorText:function(){return this.minErrorText},setRangeLengthErrorText:function(e){this.rangeLengthErrorText=e},getRangeLengthErrorText:function(){return this.rangeLengthErrorText},setRangeCharErrorText:function(e){this.rangeCharErrorText=e},getRangeCharErrorText:function(){return this.rangeCharErrorText},setRangeErrorText:function(e){this.rangeErrorText=e},getRangeErrorText:function(){return this.rangeErrorText}});mini.regClass(mini.TextBox,"textbox");mini.MoneyBox=function(){mini.MoneyBox.superclass.constructor.call(this)};mini.extend(mini.MoneyBox,mini.TextBox,{digit:2,minValue:NaN,maxValue:NaN,nullValue:"",uiCls:"mini-moneybox",setText:function(e){e=this._formatText(e);this.text=e;this._textEl.value=e},setValue:function(e,t){if(e===""||e===null||e===undefined)e=this.nullValue;e=String(e);if(e.length>this.maxLength){e=e.substring(0,this.maxLength)}if(this.value!==e){e=this._formatText(e).replace(/\,/g,"");e=this._ValueLimit(e);this.value=e;this._valueEl.value=this.value;this.setText(e);this._doEmpty();if(t===undefined)t=true;if(t)this._OnValueChanged()}},_formatText:function(e){return mini.util.StringUtil.formatMoney(e,this.digit)},_ValueLimit:function(e){if(isNaN(this.minValue)&&isNaN(this.maxValue))return e;if(this.minValue>this.maxValue){return e}if(!isNaN(this.minValue)&&e<this.minValue){e=this.minValue}if(!isNaN(this.maxValue)&&e>this.maxValue){e=this.maxValue}return e},getAttrs:function(e){var t=mini.MoneyBox.superclass.getAttrs.call(this,e);mini._ParseInt(e,t,["digit","minValue","maxValue"]);return t}});mini.regClass(mini.MoneyBox,"moneybox");mini=mini||{};mini.Password=function(){mini.Password.superclass.constructor.call(this)};mini.extend(mini.Password,mini.TextBox,{uiCls:"mini-password",_InputType:"password"});mini.regClass(mini.Password,"password");mini=mini||{};mini.PopupEdit=function(){mini.PopupEdit.superclass.constructor.call(this);this._createPopup();this.el.className+=" mini-popupedit"};mini.extend(mini.PopupEdit,mini.ButtonEdit,{uiCls:"mini-popupedit",popup:null,popupCls:"mini-buttonedit-popup",_hoverCls:"mini-buttonedit-hover",_pressedCls:"mini-buttonedit-pressed",destroy:function(e){if(this.isShowPopup()){this.hidePopup()}if(this.el){this.el.onmouseover=null;this.el.onmouseout=null}if(this._popupInner){this._popupInner.owner=null;this._popupInner=null}if(this.popup){mini.clearEvent(this.popup.el);mini.clearEvent(this.popup);this.popup.owner=null;this.popup.destroy(e);this.popup=null}this._clickTarget=null;mini.un(document,"mouseup",this.__OnDocMouseUp,this);mini.PopupEdit.superclass.destroy.call(this,e)},_initEvents:function(){mini.PopupEdit.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this)},this)},_initButtons:function(){this.buttons=[];var e=this.createButton({cls:"mini-buttonedit-popup",iconCls:"mini-buttonedit-icons-popup",name:"popup"});this.buttons.push(e)},__OnBlur:function(e){this._focused=false;if(this._clickTarget&&mini.isAncestor(this.el,this._clickTarget))return;if(this.isShowPopup())return;mini.PopupEdit.superclass.__OnBlur.call(this,e)},__OnMouseOver:function(e){if(this.isReadOnly()||this.allowInput)return;if(mini.findParent(e.target,"mini-buttonedit-border")){this.addCls(this._hoverCls)}},__OnMouseOut:function(e){if(this.isReadOnly()||this.allowInput)return;this.removeCls(this._hoverCls)},__OnMouseDown:function(e){if(this.isReadOnly())return;mini.PopupEdit.superclass.__OnMouseDown.call(this,e);if(this.allowInput==false&&mini.findParent(e.target,"mini-buttonedit-border")){mini.addClass(this.el,this._pressedCls);mini.on(document,"mouseup",this.__OnDocMouseUp,this)}},__OnInputKeyDown:function(e){this.fire("keydown",{htmlEvent:e});if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==9){this.hidePopup();return}if(e.keyCode==27){this.hidePopup();return}if(e.keyCode==13){this.fire("enter")}if(this.isShowPopup()){if(e.keyCode==13||e.keyCode==27){e.stopPropagation()}}},within:function(e){if(mini.isAncestor(this.el,e.target))return true;if(this.popup.within(e))return true;return false},popupWidth:"100%",popupMinWidth:50,popupMaxWidth:2e3,popupHeight:"",popupMinHeight:100,popupMaxHeight:2e3,setPopup:function(e){if(typeof e=="string"){mini.parse(e);e=mini.get(e)}var t=mini.getAndCreate(e);if(!t)return;t.setVisible(true);t.render(this.popup._contentEl);t.owner=this;t.on("beforebuttonclick",this.__OnPopupButtonClick,this)},getPopup:function(){if(!this.popup){this._createPopup()}return this.popup},_createPopup:function(){this.popup=new mini.Popup;this.popup.setShowAction("none");this.popup.setHideAction("outerclick");this.popup.setPopupEl(this.el);this.popup.on("BeforeClose",this.__OnPopupBeforeClose,this);this.popup.on("close",this.__OnPopupClose,this);mini.on(this.popup.el,"keydown",this.__OnPopupKeyDown,this)},__OnPopupClose:function(e){},__OnPopupBeforeClose:function(e){if(this.within(e.htmlEvent))e.cancel=true},__OnPopupKeyDown:function(e){},showPopup:function(){var e={cancel:false};this.fire("beforeshowpopup",e);if(e.cancel==true)return false;var t=this.getPopup();this._syncShowPopup();t.on("Close",this.__OnPopupHide,this);this.fire("showpopup")},doLayout:function(){mini.PopupEdit.superclass.doLayout.call(this);if(this.isShowPopup()){}},_syncShowPopup:function(){var e=this.getPopup();if(this._popupInner&&this._popupInner.el.parentNode!=this.popup._contentEl){this.popup._contentEl.appendChild(this._popupInner.el);this._popupInner.setVisible(true)}var t=this.getBox();var i=this.popupWidth;if(this.popupWidth){if(typeof this.popupWidth=="string"&&this.popupWidth.indexOf("%")!=-1){i=parseInt(t.width*this.popupWidth.substring(0,this.popupWidth.length-1)/100)}}e.setWidth(i);var n=parseInt(this.popupHeight);if(!isNaN(n)){e.setHeight(n)}else{e.setHeight("auto")}e.setMinWidth(this.popupMinWidth);e.setMinHeight(this.popupMinHeight);e.setMaxWidth(this.popupMaxWidth);e.setMaxHeight(this.popupMaxHeight);e.showAtEl(this.el,{xAlign:"left",yAlign:"below",outYAlign:"above",outXAlign:"right",popupCls:this.popupCls})},__OnPopupHide:function(e){this.__doFocusCls();this.fire("hidepopup")},hidePopup:function(){if(this.isShowPopup()){var e=this.getPopup();e.close()}},isShowPopup:function(){if(this.popup&&this.popup.isDisplay())return true;else return false},setPopupWidth:function(e){this.popupWidth=e},setPopupMaxWidth:function(e){this.popupMaxWidth=e},setPopupMinWidth:function(e){this.popupMinWidth=e},getPopupWidth:function(e){return this.popupWidth},getPopupMaxWidth:function(e){return this.popupMaxWidth},getPopupMinWidth:function(e){return this.popupMinWidth},setPopupHeight:function(e){this.popupHeight=e},setPopupMaxHeight:function(e){this.popupMaxHeight=e},setPopupMinHeight:function(e){this.popupMinHeight=e},getPopupHeight:function(e){return this.popupHeight},getPopupMaxHeight:function(e){return this.popupMaxHeight},getPopupMinHeight:function(e){return this.popupMinHeight},__OnClick:function(e){if(this.isReadOnly())return;if(mini.isAncestor(this._buttonEl,e.target)){this._OnButtonClick(e)}if(mini.findParent(e.target,this._closeCls)){if(this.isShowPopup()){this.hidePopup()}this.fire("closeclick",{htmlEvent:e});return}if(this.allowInput==false||mini.isAncestor(this._buttonEl,e.target)){if(this.isShowPopup()){this.hidePopup()}else{var t=this;setTimeout(function(){t.showPopup();t.focus()},1)}}},__OnPopupButtonClick:function(e){if(e.name=="close")this.hidePopup();e.cancel=true},getAttrs:function(e){var t=mini.PopupEdit.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["popupWidth","popupHeight","popup","onshowpopup","onhidepopup","onbeforeshowpopup"]);mini._ParseInt(e,t,["popupMinWidth","popupMaxWidth","popupMinHeight","popupMaxHeight"]);return t}});mini.regClass(mini.PopupEdit,"popupedit");mini.DatePicker=function(){mini.DatePicker.superclass.constructor.call(this);mini.addClass(this.el,"mini-datepicker");this.on("validation",this.__OnValidation,this)};mini.extend(mini.DatePicker,mini.PopupEdit,{valueFormat:"",format:"yyyy-MM-dd",maxDate:null,minDate:null,popupWidth:"",viewDate:new Date,showTime:false,timeFormat:"H:mm",showTodayButton:true,showClearButton:true,showOkButton:false,uiCls:"mini-datepicker",_getCalendar:function(){if(!mini.DatePicker._Calendar){var e=mini.DatePicker._Calendar=new mini.Calendar;e.setStyle("border:0;")}return mini.DatePicker._Calendar},_createPopup:function(){mini.DatePicker.superclass._createPopup.call(this);this._calendar=this._getCalendar()},__OnPopupClose:function(e){if(this._calendar){this._calendar.hideMenu()}},destroy:function(e){delete this._calendar;mini.DatePicker.superclass.destroy.call(this,e)},_monthPicker:false,showPopup:function(){this._calendar=this._getCalendar();this._calendar.beginUpdate();this._calendar._allowLayout=false;if(this._calendar.el.parentNode!=this.popup._contentEl){this._calendar.render(this.popup._contentEl)}this._calendar.set({monthPicker:this._monthPicker,showTime:this.showTime,timeFormat:this.timeFormat,showClearButton:this.showClearButton,showTodayButton:this.showTodayButton,showOkButton:this.showOkButton});this._calendar.setValue(this.value);if(this.value){this._calendar.setViewDate(this.value)}else{this._calendar.setViewDate(this.viewDate)}if(mini.DatePicker.superclass.showPopup.call(this)===false)return;function e(){this._calendar.hideMenu();if(this._calendar._target){var e=this._calendar._target;this._calendar.un("timechanged",e.__OnTimeChanged,e);this._calendar.un("dateclick",e.__OnDateClick,e);this._calendar.un("drawdate",e.__OnDrawDate,e)}this._calendar.on("timechanged",this.__OnTimeChanged,this);this._calendar.on("dateclick",this.__OnDateClick,this);this._calendar.on("drawdate",this.__OnDrawDate,this);this._calendar.endUpdate();this._calendar._allowLayout=true;this._calendar.doLayout();this._calendar.focus();this._calendar._target=this}var t=this;e.call(t)},hidePopup:function(){mini.DatePicker.superclass.hidePopup.call(this);if(this._calendar){this._calendar.un("timechanged",this.__OnTimeChanged,this);this._calendar.un("dateclick",this.__OnDateClick,this);this._calendar.un("drawdate",this.__OnDrawDate,this)}},within:function(e){if(mini.isAncestor(this.el,e.target))return true;if(this._calendar.within(e))return true;return false},__OnPopupKeyDown:function(e){if(e.keyCode==13){this.__OnDateClick()}if(e.keyCode==27){this.hidePopup();this.focus()}},minDateErrorText:"日期不能早于指定日期",maxDateErrorText:"日期不能晚于指定日期",__OnValidation:function(e){if(e.isValid==false)return;var t=this.value;if(!mini.isDate(t))return;var i=mini.parseDate(this.maxDate);var n=mini.parseDate(this.minDate);var s=this.maxDateErrorText||mini.VTypes.maxDateErrorText;var r=this.minDateErrorText||mini.VTypes.minDateErrorText;if(mini.isDate(i)){if(t.getTime()>i.getTime()){e.isValid=false;e.errorText=String.format(s,mini.formatDate(i,this.format))}}if(mini.isDate(n)){if(t.getTime()<n.getTime()){e.isValid=false;e.errorText=String.format(r,mini.formatDate(n,this.format))}}},__OnDrawDate:function(e){var t=e.date;var i=mini.parseDate(this.maxDate);var n=mini.parseDate(this.minDate);if(mini.isDate(i)){if(t.getTime()>i.getTime()){e.allowSelect=false}}if(mini.isDate(n)){if(t.getTime()<n.getTime()){e.allowSelect=false}}this.fire("drawdate",e)},__OnDateClick:function(e){if(this.showOkButton&&e.action!="ok")return;var t=this._calendar.getValue();var i=this.getFormValue("U");this.setValue(t);this.hidePopup();this.focus()},__OnTimeChanged:function(e){if(this.showOkButton)return;var t=this._calendar.getValue();this.setValue(t)},setFormat:function(e){if(typeof e!="string")return;if(this.format!=e){this.format=e;this._textEl.value=this._valueEl.value=this.getFormValue()}},getFormat:function(){return this.format},setValueFormat:function(e){if(typeof e!="string")return;if(this.valueFormat!=e){this.valueFormat=e}},getValueFormat:function(){return this.valueFormat},setValue:function(e,t){e=mini.parseDate(e);if(mini.isNull(e))e="";if(mini.isDate(e))e=new Date(e.getTime());if(!mini.isEquals(this.value,e)){this.value=e;this.text=this._textEl.value=this._valueEl.value=this.getFormValue();if(t===undefined)t=true;if(t)this._OnValueChanged()}},nullValue:"",setNullValue:function(e){if(e=="null")e=null;this.nullValue=e},getNullValue:function(){return this.nullValue},getValue:function(){if(!mini.isDate(this.value))return this.nullValue;var e=this.value;if(this.valueFormat){e=mini.formatDate(e,this.valueFormat)}return e},getFormValue:function(e){if(!mini.isDate(this.value))return"";e=e||this.format;return mini.formatDate(this.value,e)},setViewDate:function(e){e=mini.parseDate(e);if(!mini.isDate(e))return;this.viewDate=e},getViewDate:function(){return this._calendar.getViewDate()},setShowTime:function(e){if(this.showTime!=e){this.showTime=e}},getShowTime:function(){return this.showTime},setTimeFormat:function(e){if(this.timeFormat!=e){this.timeFormat=e}},getTimeFormat:function(){return this.timeFormat},setShowTodayButton:function(e){this.showTodayButton=e},getShowTodayButton:function(){return this.showTodayButton},setShowClearButton:function(e){this.showClearButton=e},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(e){this.showOkButton=e},getShowOkButton:function(){return this.showOkButton},setMaxDate:function(e){this.maxDate=e;this._calendar.maxDate=e},getMaxDate:function(){return this.maxDate},setMinDate:function(e){this.minDate=e;this._calendar.minDate=e},getMinDate:function(){return this.minDate},setMaxDateErrorText:function(e){this.maxDateErrorText=e},getMaxDateErrorText:function(){return this.maxDateErrorText},setMinDateErrorText:function(e){this.minDateErrorText=e},getMinDateErrorText:function(){return this.minDateErrorText},__OnInputTextChanged:function(e){var t=this._textEl.value;var i=mini.parseDate(t);if(!i||isNaN(i)||i.getFullYear()==1970){i=null}var n=this.getFormValue("U");this.setValue(i);if(i==null)this._textEl.value=""},__OnInputKeyDown:function(e){var t={htmlEvent:e};this.fire("keydown",t);if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==9){if(this.isShowPopup()){this.hidePopup()}return}if(this.isReadOnly())return;switch(e.keyCode){case 27:e.preventDefault();if(this.isShowPopup()){e.stopPropagation()}this.hidePopup();break;case 9:case 13:if(this.isShowPopup()){e.preventDefault();e.stopPropagation();this.hidePopup()}else{this.__OnInputTextChanged(null);var i=this;setTimeout(function(){i.fire("enter",t)},10)}break;case 37:break;case 38:e.preventDefault();break;case 39:break;case 40:e.preventDefault();this.showPopup();break;default:break}},getAttrs:function(e){var t=mini.DatePicker.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["format","viewDate","timeFormat","ondrawdate","minDate","maxDate","valueFormat","nullValue","minDateErrorText","maxDateErrorText"]);mini._ParseBool(e,t,["showTime","showTodayButton","showClearButton","showOkButton"]);return t}});mini.regClass(mini.DatePicker,"datepicker");mini.MonthPicker=function(){mini.MonthPicker.superclass.constructor.call(this)};mini.extend(mini.MonthPicker,mini.DatePicker,{uiCls:"mini-monthpicker",valueFormat:"",format:"yyyy-MM",_monthPicker:true});mini.regClass(mini.MonthPicker,"monthpicker");mini.YearPicker=function(){mini.YearPicker.superclass.constructor.call(this);mini.addClass(this.el,"mini-datepicker");this.on("validation",this.__OnValidation,this)};mini.extend(mini.YearPicker,mini.PopupEdit,{uiCls:"mini-yearpicker",format:"yyyy",valueFormat:"",maxYear:null,minYear:null,viewDate:new Date,popupWidth:"",_getCalendar:function(){if(!mini.YearPicker._Calendar){var e=mini.YearPicker._Calendar=new mini.CalendarYear;e.setStyle("border:0;")}return mini.YearPicker._Calendar},_createPopup:function(){mini.YearPicker.superclass._createPopup.call(this);this._calendar=this._getCalendar()},destroy:function(e){delete this._calendar;mini.YearPicker.superclass.destroy.call(this,e)},showPopup:function(){this._calendar=this._getCalendar();this._calendar.beginUpdate();this._calendar._allowLayout=false;if(this._calendar.el.parentNode!=this.popup._contentEl){this._calendar.render(this.popup._contentEl)}if(mini.YearPicker.superclass.showPopup.call(this)===false)return;function e(){if(!this._checkYear(this.value)){this._calendar.setValue(mini.formatDate(new Date,"yyyy"));this._calendar.updateYears()}else{this._calendar.setValue(this.value);this._calendar.updateYears()}if(this._calendar._target){var e=this._calendar._target;this._calendar.un("dateclick",e.__OnDateClick,e);this._calendar.un("drawdate",e.__OnDrawDate,e);this._calendar.updateYears()}this._calendar.on("dateclick",this.__OnDateClick,this);this._calendar.on("drawdate",this.__OnDrawDate,this);this._calendar.updateYears();this._calendar.endUpdate();this._calendar._allowLayout=true;this._calendar.focus();this._calendar._target=this}var t=this;e.call(t)},hidePopup:function(){mini.YearPicker.superclass.hidePopup.call(this);this._calendar.un("dateclick",this.__OnDateClick,this);this._calendar.un("drawdate",this.__OnDrawDate,this)},setValue:function(e,t){if(this.value!=e){this.value=e;this.text=this._textEl.value=this._valueEl.value=this.value;this._calendar.setValue(this.value);this._calendar.updateYears();if(t!==false)this._OnValueChanged()}},__OnDateClick:function(e){if(this.showOkButton&&e.action!="ok")return;var t=this._calendar.getValue();if(e.year>this.getMaxYear()&&null!=this.getMaxYear()){return false}if(e.year<this.getMinYear()&&null!=this.getMinYear()){return false}this.setValue(e.year);this.hidePopup();this.focus()},maxYearErrorText:"",minYearErrorText:"",__OnValidation:function(e){if(e.isValid==false)return;if(this.value=="")return;if(!this._checkYear(this.value)){e.isValid=false;e.errorText="格式错误"}if(this._checkYear(this.maxYear)){if(this.value>this.maxYear){e.isValid=false;e.errorText=String.format(this.maxYearErrorText,this.maxYear)}}if(this._checkYear(this.minYear)){if(this.value<this.minYear){e.isValid=false;e.errorText=String.format(this.minYearErrorText,this.minYear)}}},__OnDrawDate:function(e){if(this._checkYear(this.maxYear)){if(e.date>this.maxYear){e.allowSelect=false}}if(this._checkYear(this.minYear)){if(e.date<this.minYear){e.allowSelect=false}}this.fire("drawdate",e)},_checkYear:function(e){var t=/^[1-9]\d{3}$/;return t.test(e)},setFormat:function(e){if(typeof e!="string")return;if(this.format!=e){this.format=e;this._textEl.value=this._valueEl.value=this.getFormValue()}},getFormat:function(){return this.format},setValueFormat:function(e){if(typeof e!="string")return;if(this.valueFormat!=e){this.valueFormat=e}},getValueFormat:function(){return this.valueFormat},setViewDate:function(e){e=mini.parseDate(e);if(!mini.isDate(e))return;this.viewDate=e},getViewDate:function(){return this._calendar.getViewDate()},setMaxYear:function(e){this.maxYear=e},getMaxYear:function(){return this.maxYear},setMinYear:function(e){this.minYear=e},getMinYear:function(){return this.minYear},setMaxYearErrorText:function(e){this.maxYearErrorText=e},getMinYearErrorText:function(){return this.minYearErrorText},getAttrs:function(e){var t=mini.YearPicker.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["format","viewDate","timeFormat","ondrawdate","minYear","maxYear","valueFormat","maxYearErrorText","minYearErrorText"]);return t}});mini.regClass(mini.YearPicker,"yearpicker");mini.ComboBox=function(){this.data=[];this.columns=[];mini.ComboBox.superclass.constructor.call(this);var e=this;if(isFirefox){this._textEl.oninput=function(){e._tryQuery()}}};mini.extend(mini.ComboBox,mini.PopupEdit,{text:"",value:"",valueField:"id",textField:"text",delimiter:",",multiSelect:false,data:[],url:"",columns:[],allowInput:false,valueFromSelect:false,popupMaxHeight:200,set:function(e){if(typeof e=="string"){return this}var t=e.value;delete e.value;var i=e.url;delete e.url;var n=e.data;delete e.data;if(!e.onvaluechanged)this.defaultValueTriggerChange=false;mini.ComboBox.superclass.set.call(this,e);this._listbox._autoLoad=this._autoLoad=e.autoLoad!==false;this._listbox.cache=this.cache=e.cache||this.cache;this._listbox.set($.extend(e||{},{enabled:true,required:false,id:e.id?e.id+"_popup":undefined}));if(!mini.isNull(n)){this.setData(n);e.data=n}else if(!mini.isNull(i)){this.setUrl(i);e.url=i}else if(!mini.isNull(e.code)){this.url=e.url=mini.globalOpts.codeUrl+this.code;if(!e.lazy){this.setUrl(this.url)}}if(!mini.isNull(t)){this.setValue(t,this.defaultValueTriggerChange);e.value=t}this._url=this.url;return this},uiCls:"mini-combobox",destroy:function(e){if(this._listbox){mini.clearEvent(this._listbox);this._listbox.destroy(e);this._listbox=null}delete this.data;delete this.columns;mini.ComboBox.superclass.destroy.call(this,e)},_createPopup:function(){mini.ComboBox.superclass._createPopup.call(this);this._listbox=new mini.ListBox;this._listbox.setBorderStyle("border:0;");this._listbox.setStyle("width:100%;height:auto;");this._listbox.render(this.popup._contentEl);this._listbox.on("itemclick",this.__OnItemClick,this);this._listbox.on("drawcell",this.__OnItemDrawCell,this);var e=this;this._listbox.on("beforeload",function(t){
    e.fire("beforeload",t)},this);this._listbox.on("load",function(t){e.fire("load",t)},this);this._listbox.on("loaderror",function(t){e.fire("loaderror",t)},this)},setVisible:function(e){mini.ComboBox.superclass.setVisible.call(this,e);this._listbox.setVisible(e)},showPopup:function(){this._listbox.setHeight("auto");if(mini.ComboBox.superclass.showPopup.call(this)===false)return;var e=this.popup.el.style.height;if(e==""||e=="auto"){this._listbox.setHeight("auto")}else{this._listbox.setHeight("100%")}this._listbox.setValue(this.value)},select:function(e){this._listbox.deselectAll();e=this.getItem(e);if(e){this._listbox.select(e);this.__OnItemClick();this._listbox.setValue("")}},getItem:function(e){return typeof e=="object"?e:this.data[e]},indexOf:function(e){return this.data.indexOf(e)},getAt:function(e){return this.data[e]},load:function(e,t){if(typeof e=="string"){this.setUrl(e,t)}else{this.setData(e)}},setData:function(data){if(typeof data=="string"){data=eval("("+data+")")}if(!mini.isArray(data))data=[];this._listbox.setData(mini.clone(data));this.data=this._listbox.data;if(this.valueFromSelect){this.setValue(this.tempvalue,false)}else{var vts=this._listbox.getValueAndText(this.value);this.text=this._textEl.value=vts[1]}},getData:function(){return this.data},setUrl:function(e,t){this.getPopup();this._listbox.setUrl(this.parseUrl(e),t);this.url=this._listbox.url;this.data=this._listbox.data;var i=this._listbox.getValueAndText(this.value);this.text=this._textEl.value=i[1]},getUrl:function(){return this.url},setValueField:function(e){this.valueField=e;if(this._listbox){this._listbox.setValueField(e)}},getValueField:function(){return this.valueField},setTextField:function(e){if(this._listbox)this._listbox.setTextField(e);this.textField=e},getTextField:function(){return this.textField},setDisplayField:function(e){this.setTextField(e)},setDataField:function(e){if(this._listbox)this._listbox.setDataField(e);this.dataField=e},setValue:function(e,t){var i=this.value;var n=this._listbox.getValueAndText(e);if(this.valueFromSelect){this.value=n[0];this.tempvalue=e}else this.value=e;this._valueEl.value=this.value;this.setText(n[1]);if(!mini.isEquals(i,this.value)){if(t===undefined)t=true;if(t)this._OnValueChanged()}},setText:function(e){if(mini.isEquals(this.emptyText,e)){mini.ComboBox.superclass.setText.call(this,"")}else{mini.ComboBox.superclass.setText.call(this,e)}},setMultiSelect:function(e){if(this.multiSelect!=e){this.multiSelect=e;if(this._listbox){this._listbox.setMultiSelect(e);this._listbox.setShowCheckBox(e)}}},getMultiSelect:function(){return this.multiSelect},setColumns:function(e){if(!mini.isArray(e))e=[];this.columns=e;this._listbox.setColumns(e)},getColumns:function(){return this.columns},showNullItem:false,setShowNullItem:function(e){this.showNullItem=e;this._listbox.setShowNullItem(e)},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(e){if(this.nullItemText!=e){this.nullItemText=e;this.emptyText=e;this._listbox.setNullItemText(e)}},getNullItemText:function(){return this.nullItemText},setValueFromSelect:function(e){this.valueFromSelect=e},getValueFromSelect:function(){return this.valueFromSelect},_OnValueChanged:function(){if(this.validateOnChanged){this.validate()}var e=this.getValue();var t=this.getSelecteds();var i=t[0];var n=this;n.fire("valuechanged",{value:e,selecteds:t,selected:i})},getSelecteds:function(){return this._listbox.findItems(this.value)},getSelected:function(){return this.getSelecteds()[0]},__OnItemDrawCell:function(e){this.fire("drawcell",e)},__OnItemClick:function(e){var t=this._listbox.getSelecteds();var i=this._listbox.getValueAndText(t);var n=this.getValue();this.setValue(i[0]);if(e){if(!this.multiSelect){this.hidePopup()}this.focus();this.fire("itemclick",{item:e.item})}},__OnInputKeyDown:function(e){this.fire("keydown",{htmlEvent:e});if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==9){this.hidePopup();return}if(this.isReadOnly())return;switch(e.keyCode){case 27:e.preventDefault();if(this.isShowPopup()){e.stopPropagation()}this.hidePopup();break;case 13:if(this.isShowPopup()){e.preventDefault();e.stopPropagation();var t=this._listbox.getFocusedIndex();if(t!=-1){var i=this._listbox.getAt(t);if(this.multiSelect){}else{this._listbox.deselectAll();this._listbox.select(i)}var n=this._listbox.getSelecteds();var s=this._listbox.getValueAndText(n);this.setValue(s[0]);this.setText(s[1])}this.hidePopup()}else{this.fire("enter")}break;case 37:break;case 38:e.preventDefault();var t=this._listbox.getFocusedIndex();if(t==-1){t=0;if(!this.multiSelect){var i=this._listbox.findItems(this.value)[0];if(i){t=this._listbox.indexOf(i)}}}if(this.isShowPopup()){if(!this.multiSelect){t-=1;if(t<0)t=0;this._listbox._focusItem(t,true)}}break;case 39:break;case 40:e.preventDefault();var t=this._listbox.getFocusedIndex();if(t==-1){t=0;if(!this.multiSelect){var i=this._listbox.findItems(this.value)[0];if(i){t=this._listbox.indexOf(i)}}}if(this.isShowPopup()){if(!this.multiSelect){t+=1;if(t>this._listbox.getCount()-1)t=this._listbox.getCount()-1;this._listbox._focusItem(t,true)}}else{this.showPopup();if(!this.multiSelect){this._listbox._focusItem(t,true)}}break;default:this._tryQuery(this._textEl.value);break}},__OnInputKeyUp:function(e){this.fire("keyup",{htmlEvent:e})},__OnInputKeyPress:function(e){this.fire("keypress",{htmlEvent:e})},_tryQuery:function(e){var t=this;setTimeout(function(){var i=t._textEl.value;if(i!=e){t._doQuery(i)}},10)},_doQuery:function(e){if(this.multiSelect==true)return;var t=[];for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var r=mini._getMap(this.textField,s);var l=mini._getMap(this.valueField,s);if(typeof r=="string"){r=r.toUpperCase();l=l.toUpperCase();e=e.toUpperCase();if(r.indexOf(e)!=-1||l.indexOf(e)!=-1){t.push(s)}}}this._listbox.setData(t);this._filtered=true;if(e!==""||this.isShowPopup()){this.showPopup();var o=0;if(this._listbox.getShowNullItem())o=1;var a=this;a._listbox._focusItem(o,true)}},__OnPopupHide:function(e){if(this._filtered){this._filtered=false;if(this._listbox.el){this._listbox.setData(this.data)}}this.fire("hidepopup")},findItems:function(e){return this._listbox.findItems(e)},__OnInputTextChanged:function(e){if(this.multiSelect==false){var t=this._textEl.value;var i=this.getData();var n=null;for(var s=0,r=i.length;s<r;s++){var l=i[s];var o=l[this.textField];if(o==t){n=l;break}}if(n){this._listbox.setValue(n?n[this.valueField]:"");var a=this._listbox.getValue();var h=this._listbox.getValueAndText(a);var u=this.getValue();this.setValue(a);this.setText(h[1])}else{if(this.valueFromSelect){this.setValue("");this.setText("")}else{this.setValue(t);this.setText(t)}}}},getAttrs:function(e){var t=mini.ComboBox.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["url","data","textField","valueField","displayField","nullItemText","ondrawcell","onbeforeload","onload","onloaderror","onitemclick"]);mini._ParseBool(e,t,["multiSelect","showNullItem","valueFromSelect"]);if(t.displayField)t.textField=t.displayField;var i=t.valueField||this.valueField;var n=t.textField||this.textField;if(e.nodeName.toLowerCase()=="select"){var s=[];for(var r=0,l=e.length;r<l;r++){var o=e.options[r];var a={};a[n]=o.text;a[i]=o.value;s.push(a)}if(s.length>0){t.data=s}}else{var h=mini.getChildNodes(e);for(var r=0,l=h.length;r<l;r++){var u=h[r];var d=jQuery(u).attr("property");if(!d)continue;d=d.toLowerCase();if(d=="columns"){t.columns=mini._ParseColumns(u)}else if(d=="data"){t.data=u.innerHTML}}}return t}});mini.regClass(mini.ComboBox,"combobox");mini.AutoComplete=function(){mini.AutoComplete.superclass.constructor.call(this);var e=this;e._ValueChangeTimer=null;this._buttonEl.style.display="none";this._doInputLayout()};mini.extend(mini.AutoComplete,mini.ComboBox,{url:"",allowInput:true,delay:150,searchField:"key",minChars:0,_buttonWidth:0,uiCls:"mini-autocomplete",setUrl:function(e){this.url=this.parseUrl(e)},setValue:function(e){if(mini.isNull(e))e="";var t=this.value;this.value=e;if(!mini.isEquals(t,this.value)){this.value=e;this._valueEl.value=this.value;var i=this._listbox.getValueAndText(e);if(i[0]&&i[1]){this.setText(i[1])}this._OnValueChanged()}},setText:function(e){if(mini.isNull(e))e="";if(this.text!=e){this.text=e;this._LastInputText=e}this._textEl.value=this.text},__OnItemClick:function(e){var t=this._listbox.getSelecteds();var i=this._listbox.getValueAndText(t);var n=this.getValue();this.setValue(i[0]);this.setText(i[1]);if(e){if(!this.multiSelect){this.hidePopup()}this.focus();this.fire("itemclick",{item:e.item})}},setMinChars:function(e){this.minChars=e},getMinChars:function(){return this.minChars},setSearchField:function(e){this.searchField=e},getSearchField:function(){return this.searchField},popupLoadingText:"<span class='mini-textboxlist-popup-loading'>Loading...</span>",popupErrorText:"<span class='mini-textboxlist-popup-error'>Error</span>",popupEmptyText:"<span class='mini-textboxlist-popup-noresult'>No Result</span>",showPopup:function(e){var t=this.getPopup();var i=this._listbox;i.showEmpty=true;i.emptyText=this.popupEmptyText;if(e=="loading"){i.emptyText=this.popupLoadingText;this._listbox.setData([])}else if(e=="error"){i.emptyText=this.popupLoadingText;this._listbox.setData([])}this._listbox.doUpdate();mini.AutoComplete.superclass.showPopup.call(this)},__OnInputKeyDown:function(e){this.fire("keydown",{htmlEvent:e});if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==9){this.hidePopup();return}if(this.isReadOnly())return;switch(e.keyCode){case 27:if(this.isShowPopup()){e.stopPropagation()}this.hidePopup();break;case 13:if(this.isShowPopup()){e.preventDefault();e.stopPropagation();var t=this._listbox.getFocusedIndex();if(t!=-1){var i=this._listbox.getAt(t);var n=this._listbox.getValueAndText([i]);var s=n[0];this.setText(n[1]);if(mini.isFirefox){this.blur();this.focus()}this.setValue(s,false);this.hidePopup()}}else{this.fire("enter")}break;case 37:break;case 38:var t=this._listbox.getFocusedIndex();if(t==-1){t=0;if(!this.multiSelect){var i=this._listbox.findItems(this.value)[0];if(i){t=this._listbox.indexOf(i)}}}if(this.isShowPopup()){if(!this.multiSelect){t-=1;if(t<0)t=0;this._listbox._focusItem(t,true)}}break;case 39:break;case 40:var t=this._listbox.getFocusedIndex();if(this.isShowPopup()){if(!this.multiSelect){t+=1;if(t>this._listbox.getCount()-1)t=this._listbox.getCount()-1;this._listbox._focusItem(t,true)}}else{this._tryQuery(this._textEl.value)}break;default:this._tryQuery(this._textEl.value);break}},doQuery:function(){this._tryQuery()},_tryQuery:function(e){var t=this;if(this._queryTimer){clearTimeout(this._queryTimer);this._queryTimer=null}this._queryTimer=setTimeout(function(){var e=t._textEl.value;t._doQuery(e)},this.delay);this.showPopup("loading")},_doQuery:function(e){if(!this.url)return;if(this._ajaxer){this._ajaxer.abort()}var t=this.url;var i="post";if(t){if(t.indexOf(".txt")!=-1||t.indexOf(".json")!=-1){i="get"}}var n={};n[this.searchField]=e;var s={url:t,async:true,params:n,data:n,type:i,cache:false,cancel:false};this.fire("beforeload",s);if(s.data!=s.params&&s.params!=n){s.data=s.params}if(s.cancel)return;var r=sf=this;mini.copyTo(s,{success:function(e){try{var t=mini.decode(e)}catch(i){throw new Error("autocomplete json is error")}if(sf.dataField){t=mini._getMap(sf.dataField,t)}if(!t)t=[];r._listbox.setData(t);r.showPopup();r._listbox._focusItem(0,true);r.data=t;r.fire("load",{data:t})},error:function(e,t,i){r.showPopup("error")}});this._ajaxer=mini.ajax(s)},getAttrs:function(e){var t=mini.AutoComplete.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["searchField"]);return t}});mini.regClass(mini.AutoComplete,"autocomplete");mini.Lookup=function(){this.data=[];mini.Lookup.superclass.constructor.call(this);mini.on(this._textEl,"mouseup",this.__OnMouseUp,this);this.on("showpopup",this.__OnShowPopup,this)};mini.extend(mini.Lookup,mini.PopupEdit,{allowInput:true,valueField:"id",textField:"text",delimiter:",",multiSelect:false,data:[],grid:null,uiCls:"mini-lookup",destroy:function(e){if(this.grid){this.grid.un("rowclick",this.__OnGridRowClickChanged,this);this.grid.un("load",this.__OnGridLoad,this);this.grid=null}mini.Lookup.superclass.destroy.call(this,e)},setMultiSelect:function(e){this.multiSelect=e;if(this.grid)this.grid.setMultiSelect(e)},setGrid:function(e){if(typeof e=="string"){mini.parse(e);e=mini.get(e)}this.grid=mini.getAndCreate(e);if(this.grid){this.grid.setMultiSelect(this.multiSelect);this.grid.setCheckSelectOnLoad(false);this.grid.on("rowclick",this.__OnGridRowClickChanged,this);this.grid.on("load",this.__OnGridLoad,this);this.grid.on("checkall",this.__OnGridRowClickChanged,this)}},getGrid:function(){return this.grid},setValueField:function(e){this.valueField=e},getValueField:function(){return this.valueField},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},deselectAll:function(){this.data=[];this.setValue("");this.setText("");if(this.grid)this.grid.deselectAll()},getItemValue:function(e){return String(e[this.valueField])},getItemText:function(e){var t=e[this.textField];return mini.isNull(t)?"":String(t)},getValueAndText:function(e){if(mini.isNull(e))e=[];var t=[];var i=[];for(var n=0,s=e.length;n<s;n++){var r=e[n];if(r){t.push(this.getItemValue(r));i.push(this.getItemText(r))}}return[t.join(this.delimiter),i.join(this.delimiter)]},_createData:function(){if(typeof this.value!="string")this.value="";if(typeof this.text!="string")this.text="";var e=[];var t=this.value.split(this.delimiter);var i=this.text.split(this.delimiter);var n=t.length;if(this.value){for(var s=0,r=n;s<r;s++){var l={};var o=t[s];var a=i[s];l[this.valueField]=o?o:"";l[this.textField]=a?a:"";e.push(l)}}this.data=e},_getValueMaps:function(e){var t={};for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=s[this.valueField];t[r]=s}return t},setValue:function(e){mini.Lookup.superclass.setValue.call(this,e);this._createData()},setText:function(e){mini.Lookup.superclass.setText.call(this,e);this._createData()},__OnGridRowClickChanged:function(e){var t=this._getValueMaps(this.grid.getData());var i=this._getValueMaps(this.grid.getSelecteds());var n=this._getValueMaps(this.data);if(this.multiSelect==false){n={};this.data=[]}var s={};for(var r in n){var l=n[r];if(t[r]){if(i[r]){}else{s[r]=l}}}for(var o=this.data.length-1;o>=0;o--){var l=this.data[o];var r=l[this.valueField];if(s[r])this.data.removeAt(o)}for(var r in i){var l=i[r];if(!n[r])this.data.push(l)}var a=this.getValueAndText(this.data);this.setValue(a[0]);this.setText(a[1]);this._OnValueChanged()},__OnGridLoad:function(e){this.__OnShowPopup(e)},__OnShowPopup:function(e){var t=String(this.value).split(this.delimiter);var i={};for(var n=0,s=t.length;n<s;n++){var r=t[n];i[r]=1}var l=this.grid.getData();var o=[];for(var n=0,s=l.length;n<s;n++){var a=l[n];var h=a[this.valueField];if(i[h])o.push(a)}this.grid.selects(o)},doUpdate:function(){mini.Lookup.superclass.doUpdate.call(this);this._textEl.readOnly=true;this.el.style.cursor="default"},__OnInputKeyDown:function(e){mini.Lookup.superclass.__OnInputKeyDown.call(this,e);switch(e.keyCode){case 46:case 8:break;case 37:break;case 39:break}},__OnMouseUp:function(e){if(this.isReadOnly())return;var t=mini.getSelectRange(this._textEl);var i=t[0],n=t[1];var s=this._findTextIndex(i)},_findTextIndex:function(e){var t=-1;if(this.text=="")return t;var i=String(this.text).split(this.delimiter);var n=0;for(var s=0,r=i.length;s<r;s++){var l=i[s];if(n<e&&e<=n+l.length){t=s;break}n=n+l.length+1}return t},getAttrs:function(e){var t=mini.Lookup.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["grid","valueField","textField"]);mini._ParseBool(e,t,["multiSelect"]);return t}});mini.regClass(mini.Lookup,"lookup");mini.Pager=function(){mini.Pager.superclass.constructor.call(this)};mini.extend(mini.Pager,mini.Control,{pageIndex:0,pageSize:10,totalCount:0,totalPage:0,showPageIndex:true,showPageSize:true,showTotalCount:true,showPageInfo:true,showReloadButton:true,_clearBorder:false,showButtonText:false,showButtonIcon:true,firstText:"首页",prevText:"上一页",nextText:"下一页",lastText:"尾页",pageInfoText:"每页 {0} 条, 共 {1} 条",sizeList:[10,20,50,100],uiCls:"mini-pager",_create:function(){this.el=document.createElement("div");this.el.className="mini-pager";var e='<div class="mini-pager-left"></div><div class="mini-pager-right"></div>';this.el.innerHTML=e;this.buttonsEl=this._leftEl=this.el.childNodes[0];this._rightEl=this.el.childNodes[1];this.sizeEl=mini.append(this.buttonsEl,'<span class="mini-pager-size"></span>');this.sizeCombo=new mini.ComboBox;this.sizeCombo.setName("pagesize");this.sizeCombo.setShowNullItem(false);this.sizeCombo.setTextField("text");this.sizeCombo.setValueField("id");this.sizeCombo.setWidth(48);this.sizeCombo.render(this.sizeEl);mini.append(this.sizeEl,'<span class="separator"></span>');this.firstButton=new mini.Button;this.firstButton.render(this.buttonsEl);this.prevButton=new mini.Button;this.prevButton.render(this.buttonsEl);this.indexEl=document.createElement("span");this.indexEl.className="mini-pager-index";this.indexEl.innerHTML='<input id="" type="text" class="mini-pager-num"/><span class="mini-pager-pages">/ 0</span>';this.buttonsEl.appendChild(this.indexEl);this.numInput=this.indexEl.firstChild;this.pagesLabel=this.indexEl.lastChild;this.nextButton=new mini.Button;this.nextButton.render(this.buttonsEl);this.lastButton=new mini.Button;this.lastButton.render(this.buttonsEl);mini.append(this.buttonsEl,'<span class="separator"></span>');this.reloadButton=new mini.Button;this.reloadButton.render(this.buttonsEl);this.firstButton.setPlain(true);this.prevButton.setPlain(true);this.nextButton.setPlain(true);this.lastButton.setPlain(true);this.reloadButton.setPlain(true);this.update()},destroy:function(e){if(this.pageSelect){mini.clearEvent(this.pageSelect);this.pageSelect=null}if(this.sizeCombo){mini.clearEvent(this.sizeCombo);this.sizeCombo.destroy(e);this.sizeCombo=null}if(this.sizeEl){mini.clearEvent(this.sizeEl);this.buttonsEl.removeChild(this.sizeEl);this.sizeEl=null}if(this.firstButton){mini.clearEvent(this.firstButton);this.firstButton.destroy(e);this.firstButton=null}if(this.prevButton){mini.clearEvent(this.prevButton);this.prevButton.destroy(e);this.prevButton=null}if(this.numInput){mini.clearEvent(this.numInput);this.indexEl.removeChild(this.numInput);this.numInput=null}if(this.pagesLabel){mini.clearEvent(this.pagesLabel);this.indexEl.removeChild(this.pagesLabel);this.pagesLabel=null}if(this.indexEl){mini.clearEvent(this.indexEl);this.buttonsEl.removeChild(this.indexEl);this.indexEl=null}if(this.nextButton){mini.clearEvent(this.nextButton);this.nextButton.destroy(e);this.nextButton=null}if(this.lastButton){mini.clearEvent(this.lastButton);this.lastButton.destroy(e);this.lastButton=null}if(this.reloadButton){mini.clearEvent(this.reloadButton);this.reloadButton.destroy(e);this.reloadButton=null}if(this.buttonsEl){mini.clearEvent(this.buttonsEl);this.el.removeChild(this.buttonsEl);this.buttonsEl=null;this._leftEl=null}if(this._rightEl){mini.clearEvent(this._rightEl);this.el.removeChild(this._rightEl);this._rightEl=null}mini.Pager.superclass.destroy.call(this,e)},_initEvents:function(){mini.Pager.superclass._initEvents.call(this);this.firstButton.on("click",function(e){this._OnPageChanged(0)},this);this.prevButton.on("click",function(e){this._OnPageChanged(this.pageIndex-1)},this);this.nextButton.on("click",function(e){this._OnPageChanged(this.pageIndex+1)},this);this.lastButton.on("click",function(e){this._OnPageChanged(this.totalPage)},this);this.reloadButton.on("click",function(e){this._OnPageChanged()},this);function e(){if(t)return;t=true;var e=parseInt(this.numInput.value);if(isNaN(e)){this.update()}else{this._OnPageChanged(e-1)}setTimeout(function(){t=false},100)}var t=false;mini.on(this.numInput,"change",function(t){e.call(this)},this);mini.on(this.numInput,"keydown",function(t){if(t.keyCode==13){e.call(this);t.stopPropagation()}},this);this.sizeCombo.on("valuechanged",this.__OnPageSelectChanged,this)},doLayout:function(){if(!this.canLayout())return;mini.layout(this._leftEl);mini.layout(this._rightEl)},setPageIndex:function(e){if(isNaN(e))return;this.pageIndex=e;this.update()},getPageIndex:function(){return this.pageIndex},setPageSize:function(e){if(isNaN(e))return;this.pageSize=e;this.update()},getPageSize:function(){return this.pageSize},setTotalCount:function(e){e=parseInt(e);if(isNaN(e))return;this.totalCount=e;this.updateTotal()},getTotalCount:function(){return this.totalCount},setSizeList:function(e){if(!mini.isArray(e))return;this.sizeList=e;this.update()},getSizeList:function(){return this.sizeList},setShowPageSize:function(e){this.showPageSize=e;this.update()},getShowPageSize:function(){return this.showPageSize},setShowPageIndex:function(e){this.showPageIndex=e;this.update()},getShowPageIndex:function(){return this.showPageIndex},setShowTotalCount:function(e){this.showTotalCount=e;this.update()},getShowTotalCount:function(){return this.showTotalCount},setShowPageInfo:function(e){this.showPageInfo=e;this.update()},getShowPageInfo:function(){return this.showPageInfo},setShowReloadButton:function(e){this.showReloadButton=e;this.update()},getShowReloadButton:function(){return this.showReloadButton},getTotalPage:function(){return this.totalPage},updateTotal:function(e,t,i){if(mini.isNumber(e))this.pageIndex=parseInt(e);if(mini.isNumber(t))this.pageSize=parseInt(t);if(mini.isNumber(i))this.totalCount=parseInt(i);this.totalPage=parseInt(this.totalCount/this.pageSize)+1;if((this.totalPage-1)*this.pageSize==this.totalCount){this.totalPage-=1}if(this.totalCount==0)this.totalPage=0;if(this.pageIndex>this.totalPage-1){this.pageIndex=this.totalPage-1}if(this.pageIndex<=0)this.pageIndex=0;if(this.totalPage<=0)this.totalPage=0;this.firstButton.enable();this.prevButton.enable();this.nextButton.enable();this.lastButton.enable();if(this.pageIndex==0){this.firstButton.disable();this.prevButton.disable()}if(this.pageIndex>=this.totalPage-1){this.nextButton.disable();this.lastButton.disable()}this.numInput.value=this.pageIndex>-1?this.pageIndex+1:0;this.pagesLabel.innerHTML="/ "+this.totalPage;var n=this.sizeList.clone();if(n.indexOf(this.pageSize)==-1){n.push(this.pageSize);n=n.sort(function(e,t){return e>t})}var s=[];for(var r=0,l=n.length;r<l;r++){var o=n[r];var a={};a.text=o;a.id=o;s.push(a)}var h=this.firstText,u=this.prevText,d=this.nextText,c=this.lastText;if(this.showButtonText==false){h=u=d=c=""}this.firstButton.setText(h);this.prevButton.setText(u);this.nextButton.setText(d);this.lastButton.setText(c);var h=this.firstText,u=this.prevText,d=this.nextText,c=this.lastText;if(this.showButtonText==true){h=u=d=c=""}this.firstButton.setTooltip(h);this.prevButton.setTooltip(u);this.nextButton.setTooltip(d);this.lastButton.setTooltip(c);this.firstButton.setIconCls(this.showButtonIcon?"mini-pager-first":"");this.prevButton.setIconCls(this.showButtonIcon?"mini-pager-prev":"");this.nextButton.setIconCls(this.showButtonIcon?"mini-pager-next":"");this.lastButton.setIconCls(this.showButtonIcon?"mini-pager-last":"");this.reloadButton.setIconCls(this.showButtonIcon?"mini-pager-reload":"");this.reloadButton.setVisible(this.showReloadButton);var f=this.reloadButton.el.previousSibling;if(f){f.style.display=this.showReloadButton?"":"none"}this._rightEl.innerHTML=String.format(this.pageInfoText,this.pageSize,this.totalCount);this.indexEl.style.display=this.showPageIndex?"":"none";this.sizeEl.style.display=this.showPageSize?"":"none";this._rightEl.style.display=this.showPageInfo?"":"none"},update:function(e,t,i,n){if(mini.isNumber(e))this.pageIndex=parseInt(e);if(mini.isNumber(t))this.pageSize=parseInt(t);if(mini.isNumber(i))this.totalCount=parseInt(i);this.totalPage=parseInt(this.totalCount/this.pageSize)+1;if((this.totalPage-1)*this.pageSize==this.totalCount){this.totalPage-=1}if(this.totalCount==0)this.totalPage=0;if(this.pageIndex>this.totalPage-1){this.pageIndex=this.totalPage-1}if(this.pageIndex<=0)this.pageIndex=0;if(this.totalPage<=0)this.totalPage=0;this.firstButton.enable();this.prevButton.enable();this.nextButton.enable();this.lastButton.enable();if(this.pageIndex==0){this.firstButton.disable();this.prevButton.disable()}if(this.pageIndex>=this.totalPage-1){this.nextButton.disable();this.lastButton.disable()}this.numInput.value=this.pageIndex>-1?this.pageIndex+1:0;this.pagesLabel.innerHTML="/ "+this.totalPage;var s=this.sizeList.clone();if(s.indexOf(this.pageSize)==-1){s.push(this.pageSize);s=s.sort(function(e,t){return e>t})}var r=[];for(var l=0,o=s.length;l<o;l++){var a=s[l];var h={};h.text=a;h.id=a;r.push(h)}this.sizeCombo.setData(r);this.sizeCombo.setValue(this.pageSize,n);var u=this.firstText,d=this.prevText,c=this.nextText,f=this.lastText;if(this.showButtonText==false){u=d=c=f=""}this.firstButton.setText(u);this.prevButton.setText(d);this.nextButton.setText(c);this.lastButton.setText(f);var u=this.firstText,d=this.prevText,c=this.nextText,f=this.lastText;if(this.showButtonText==true){u=d=c=f=""}this.firstButton.setTooltip(u);this.prevButton.setTooltip(d);this.nextButton.setTooltip(c);this.lastButton.setTooltip(f);this.firstButton.setIconCls(this.showButtonIcon?"mini-pager-first":"");this.prevButton.setIconCls(this.showButtonIcon?"mini-pager-prev":"");this.nextButton.setIconCls(this.showButtonIcon?"mini-pager-next":"");this.lastButton.setIconCls(this.showButtonIcon?"mini-pager-last":"");this.reloadButton.setIconCls(this.showButtonIcon?"mini-pager-reload":"");this.reloadButton.setVisible(this.showReloadButton);var m=this.reloadButton.el.previousSibling;if(m){m.style.display=this.showReloadButton?"":"none"}this._rightEl.innerHTML=String.format(this.pageInfoText,this.pageSize,this.totalCount);this.indexEl.style.display=this.showPageIndex?"":"none";this.sizeEl.style.display=this.showPageSize?"":"none";this._rightEl.style.display=this.showPageInfo?"":"none"},__OnPageSelectChanged:function(e){var t=parseInt(this.sizeCombo.getValue());this._OnPageChanged(0,t)},_OnPageChanged:function(e,t){var i={pageIndex:mini.isNumber(e)?e:this.pageIndex,pageSize:mini.isNumber(t)?t:this.pageSize,totalCount:this.totalCount,cancel:false,isreload:e===undefined&&t===undefined};if(i.pageIndex>this.totalPage-1){i.pageIndex=this.totalPage-1}if(i.pageIndex<0)i.pageIndex=0;this.fire("beforepagechanged",i);if(i.cancel==true){return}this.fire("pagechanged",i);this.update(i.pageIndex,i.pageSize)},onPageChanged:function(e,t){this.on("pagechanged",e,t)},getAttrs:function(el){var attrs=mini.Pager.superclass.getAttrs.call(this,el);mini._ParseString(el,attrs,["onpagechanged","sizeList","onbeforepagechanged"]);mini._ParseBool(el,attrs,["showPageIndex","showPageSize","showTotalCount","showPageInfo","showReloadButton"]);mini._ParseInt(el,attrs,["pageIndex","pageSize","totalCount"]);if(typeof attrs.sizeList=="string"){attrs.sizeList=eval(attrs.sizeList)}return attrs}});mini.regClass(mini.Pager,"pager");mini.DataGrid=function(){this.data=[];this._idRows={};this._removes=[];this._originals={};this.columns=[];this._bottomColumns=[];this._idColumns={};this._nameColumns={};this._selecteds=[];this._idSelecteds={};this._cellErrors=[];this._cellMapErrors={};mini.DataGrid.superclass.constructor.call(this);this.doUpdate();var e=this;setTimeout(function(){if(e.autoLoad){e.reload()}},1)};mini.DataGrid.RowID=0;mini.DataGrid.ColumnID=0;mini.extend(mini.DataGrid,mini.Control,{_displayStyle:"block",width:300,height:"auto",onlyCheckSelection:false,allowCellValid:false,cellEditAction:"cellclick",showEmptyText:true,dataLoaded:true,emptyText:"没有数据",showModified:true,dependMerge:false,minWidth:300,minHeight:150,maxWidth:5e3,maxHeight:3e3,_viewRegion:null,_virtualRows:50,virtualScroll:false,allowCellWrap:false,allowHeaderWrap:false,showColumnsMenu:false,bodyCls:"",bodyStyle:"",footerCls:"",footerStyle:"",pagerCls:"",pagerStyle:"",idField:"id",data:[],columns:null,allowResize:false,selectOnLoad:false,_rowIdField:"_uid",columnWidth:120,columnMinWidth:20,columnMaxWidth:2e3,fitColumns:true,autoHideRowDetail:true,showHeader:true,showFooter:true,showTop:false,showHGridLines:true,showVGridLines:true,showFilterRow:false,showSummaryRow:false,sortMode:"server",allowSortColumn:true,allowMoveColumn:true,allowResizeColumn:true,enableHotTrack:true,allowRowSelect:true,multiSelect:false,allowAlternating:false,_alternatingCls:"mini-grid-row-alt",allowUnselect:false,_frozenCls:"mini-grid-frozen",_frozenCellCls:"mini-grid-frozenCell",frozenStartColumn:-1,frozenEndColumn:-1,isFrozen:function(){return this.frozenStartColumn>=0&&this.frozenEndColumn>=this.frozenStartColumn},_rowCls:"mini-grid-row",_rowHoverCls:"mini-grid-row-hover",_rowSelectedCls:"mini-grid-row-selected",_headerCellCls:"mini-grid-headerCell",_cellCls:"mini-grid-cell",set:function(e){var t=e.columns;delete e.columns;var i=e.pageSize;delete e.pageSize;var n=e.pager;delete e.pager;if(n){this.setPager(n)}else{if(i){this.pageSize=i}this._createPager()}mini.DataGrid.superclass.set.call(this,e);if(t)this.setColumns(t);return this},uiCls:"mini-datagrid",_create:function(){var e=this.el=document.createElement("div");this.el.className="mini-grid";this.el.style.display="block";var t='<div class="mini-grid-border">'+'<div class="mini-grid-header"><div class="mini-grid-headerInner"></div></div>'+'<div class="mini-grid-filterRow"></div>'+'<div class="mini-grid-body"><div class="mini-grid-bodyInner"></div><div class="mini-grid-body-scrollHeight"></div></div>'+'<div class="mini-grid-scroller"><div></div></div>'+'<div class="mini-grid-summaryRow"></div>'+'<div class="mini-grid-footer"></div>'+'<div class="mini-resizer-trigger" style=""></div>'+'<a href="#" class="mini-grid-focus" style="position:absolute;left:-10px;top:-10px;width:0px;height:0px;outline:none;" hideFocus onclick="return false" ></a>'+"</div>";this.el.innerHTML=t;this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.childNodes[0];this._filterEl=this._borderEl.childNodes[1];this._bodyEl=this._borderEl.childNodes[2];this._bodyInnerEl=this._bodyEl.childNodes[0];this._bodyScrollEl=this._bodyEl.childNodes[1];this._headerInnerEl=this._headerEl.firstChild;this._scrollEl=this._borderEl.childNodes[3];this._summaryEl=this._borderEl.childNodes[4];this._footerEl=this._borderEl.childNodes[5];this._resizeEl=this._borderEl.childNodes[6];this._focusEl=this._borderEl.childNodes[7];this._doUpdateFilterRow();this._doUpdateSummaryRow();mini.setStyle(this._bodyEl,this.bodyStyle);mini.addClass(this._bodyEl,this.bodyCls);this._doShowRows()},destroy:function(e){this._destroyEditors();this._Resizer.destroy(e);this._Splitter.destroy(e);this._ColumnMove.destroy(e);this._Select.destroy(e);this._CellTip.destroy(e);this._Sort.destroy(e);this._ColumnsMenu.destroy(e);if(this._scrollEl){mini.clearEvent(this._scrollEl);this._borderEl.removeChild(this._scrollEl);this._scrollEl=null}if(this._summaryEl){mini.clearEvent(this._summaryEl);this._borderEl.removeChild(this._summaryEl);this._summaryEl=null}if(this.pager){mini.clearEvent(this.pager);this.pager.destroy(e);this.pager=null}if(this._footerEl){mini.clearEvent(this._footerEl);this._borderEl.removeChild(this._footerEl);this._footerEl=null}if(this._resizeEl){mini.clearEvent(this._resizeEl);this._borderEl.removeChild(this._resizeEl);this._resizeEl=null}if(this._focusEl){mini.clearEvent(this._focusEl);this._borderEl.removeChild(this._focusEl);this._focusEl=null}if(this._bodyInnerEl){mini.clearEvent(this._bodyInnerEl);this._bodyEl.removeChild(this._bodyInnerEl);this._bodyInnerEl=null}if(this._bodyScrollEl){mini.clearEvent(this._bodyScrollEl);this._bodyEl.removeChild(this._bodyScrollEl);this._bodyScrollEl=null}if(this._bodyEl){mini.clearEvent(this._bodyEl);this._borderEl.removeChild(this._bodyEl);this._bodyEl=null}if(this._filterEl){mini.clearEvent(this._filterEl);this._borderEl.removeChild(this._filterEl);this._filterEl=null}if(this._topRightCellEl){mini.clearEvent(this._topRightCellEl);this._headerInnerEl.removeChild(this._topRightCellEl);this._topRightCellEl=null;
}if(this._headerInnerEl){mini.clearEvent(this._headerInnerEl);this._headerEl.removeChild(this._headerInnerEl);this._headerInnerEl=null}if(this._headerEl){mini.clearEvent(this._headerEl);this._borderEl.removeChild(this._headerEl);this._headerEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this.el.removeChild(this._borderEl);this._borderEl=null}delete this.data;delete this._idRows;delete this._removes;delete this._originals;delete this.columns;delete this._bottomColumns;delete this._idColumns;delete this._nameColumns;delete this._selecteds;delete this._idSelecteds;delete this._cellErrors;delete this._cellMapErrors;delete this._margedCells;delete this._mergedCellMaps;delete this._groupDataView;mini.DataGrid.superclass.destroy.call(this,e)},_initEvents:function(){js_touchScroll(this._bodyEl);mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"dblclick",this.__OnDblClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"mouseup",this.__OnMouseUp,this);mini.on(this.el,"mousemove",this.__OnMouseMove,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"keydown",this.__OnKeyDown,this);mini.on(this.el,"keyup",this.__OnKeyUp,this);mini.on(this.el,"contextmenu",this.__OnContextMenu,this);mini.on(this._bodyEl,"scroll",this.__OnBodyScroll,this);mini.on(this._scrollEl,"scroll",this.__OnHScroll,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this);mini.on(document,"mousewheel",this.__OnDocumentMousewheel,this)},this);this._Resizer=new mini._Resizer(this);this._Splitter=new mini._ColumnSplitter(this);this._ColumnMove=new mini._ColumnMove(this);this._Select=new mini._GridSelect(this);this._CellTip=new mini._CellToolTip(this);this._Sort=new mini._GridSort(this);this._ColumnsMenu=new mini._ColumnsMenu(this)},_doShowRows:function(){this._resizeEl.style.display=this.allowResize?"":"none";this._footerEl.style.display=this.showFooter?"":"none";this._summaryEl.style.display=this.showSummaryRow?"":"none";this._filterEl.style.display=this.showFilterRow?"":"none";this._headerEl.style.display=this.showHeader?"":"none"},focus:function(){try{var e=this.getCurrent();if(e){var t=this._getRowEl(e);if(t){var i=mini.getBox(t);mini.setY(this._focusEl,i.top);if(isOpera){t.focus()}else if(isChrome){this.el.focus()}else if(isGecko){this.el.focus()}else{this._focusEl.focus()}}}else{this._focusEl.focus()}}catch(n){}},_createPager:function(){this.pager=new mini.Pager;this.pager.render(this._footerEl);this.pager.setPageSize(this.pageSize);this.bindPager(this.pager)},setPager:function(e){if(typeof e=="string"){var t=mini.byId(e);if(!t)return;mini.parse(e);e=mini.get(e);this.diypager=e}if(e){e.update(this.pageIndex,this.pageSize,this.totalCount);this.bindPager(e)}},bindPager:function(e){e.on("pagechanged",this.__OnPageChanged,this);this.on("load",function(t){e.update(this.pageIndex,this.pageSize,this.totalCount,false);this.totalPage=e.totalPage},this)},setIdField:function(e){this.idField=e},getIdField:function(){return this.idField},setUrl:function(e){this.url=this.parseUrl(e)},getUrl:function(e){return this.url},setAutoLoad:function(e){this.autoLoad=e},getAutoLoad:function(e){return this.autoLoad},setCheckSelectionOnly:function(e){this.onlyCheckSelection=e},getCheckSelectionOnly:function(){return this.onlyCheckSelection},accept:function(){this._canUpdateRowEl=false;var e=this.data;for(var t=0,i=e.length;t<i;t++){var n=e[t];this.acceptRecord(n)}this._canUpdateRowEl=true;this.doUpdate()},acceptRecord:function(e){e=this._getRow(e);if(!e)return;if(e._state=="removed"){this._removes.remove(e)}delete this._originals[e._uid];delete e._state;if(this._canUpdateRowEl){this._updateRowEl(e)}},_clearOriginals:true,loadData:function(e){if(!mini.isArray(e))e=[];this.data=e;if(this._clearOriginals==true){this._originals={}}this._removes=[];this._idRows={};this._selecteds=[];this._idSelecteds={};this._cellErrors=[];this._cellMapErrors={};this._margedCells=null;this._mergedCellMaps=null;this._groupDataView=null;for(var t=0,i=e.length;t<i;t++){var n=e[t];n._uid=mini.DataGrid.RowID;n._index=t;this._idRows[n._uid]=n;mini.DataGrid.RowID+=1}if(this.isVirtualScroll()){this.scrollIntoView(this._getRow(0))}this.doUpdate()},setData:function(e){this.dataLoaded=true;this.loadData(e);if(e.length==0&&this.pager){this.pageIndex=0;this.totalCount=0;var t={result:{data:e,total:e.length},data:e,total:this.totalCount,cancel:false};this.fire("load",t)}},getData:function(){return mini.clone(this.data,false)},toArray:function(){return this.data.clone()},getRange:function(e,t){if(e>t){var i=e;e=t;t=i}var n=this.data;var s=[];for(var r=e,l=t;r<=l;r++){var o=n[r];s.push(o)}return s},selectRange:function(e,t){if(!mini.isNumber(e))e=this.indexOf(e);if(!mini.isNumber(t))t=this.indexOf(t);if(mini.isNull(e)||mini.isNull(t))return;var i=this.getRange(e,t);this.selects(i)},getHeaderHeight:function(){return this.showHeader?mini.getHeight(this._headerEl):0},getFooterHeight:function(){return this.showFooter?mini.getHeight(this._footerEl):0},getFilterRowHeight:function(){return this.showFilterRow?mini.getHeight(this._filterEl):0},getSummaryRowHeight:function(){return this.showSummaryRow?mini.getHeight(this._summaryEl):0},_getScrollHeight:function(){return this.isFrozen()?mini.getHeight(this._scrollEl):0},_CreateTopTr:function(e){var t=e=="empty";var i=0;if(t&&this.showEmptyText==false)i=1;var n="";var s=this.getBottomColumns();if(t){n+='<tr style="height:'+i+'px">'}else{if(isIE){if(isIE6||isIE7||isIE8&&!mini.boxModel||isIE9&&!mini.boxModel){n+='<tr style="display:none;">'}else{n+="<tr >"}}else{n+='<tr style="height:'+i+'px">'}}for(var r=0,l=s.length;r<l;r++){var o=s[r];var a=o.width;var h=this._createColumnId(o)+"$"+e;n+='<td id="'+h+'" style="padding:0;border:0;margin:0;height:'+i+"px;";if(o.width)n+="width:"+o.width;if(r<this.frozenStartColumn||o.visible==false){n+=";display:none;"}n+='" ></td>'}n+="</tr>";return n},_doUpdateFilterRow:function(){if(this._filterEl.firstChild){this._filterEl.removeChild(this._filterEl.firstChild)}var e=this.isFrozen();var t=this.getBottomColumns();var i=[];i[i.length]='<table class="mini-grid-table" cellspacing="0" cellpadding="0">';i[i.length]=this._CreateTopTr("filter");i[i.length]="<tr >";for(var n=0,s=t.length;n<s;n++){var r=t[n];var l=this._createFilterCellId(r);i[i.length]='<td id="';i[i.length]=l;i[i.length]='" class="mini-grid-filterCell" style="';if(e&&n<this.frozenStartColumn||r.visible==false||r._hide==true){i[i.length]=";display:none;"}i[i.length]='"><span class="mini-grid-hspace"></span></td>'}i[i.length]='</tr></table><div class="mini-grid-scrollCell"></div>';this._filterEl.innerHTML=i.join("");for(var n=0,s=t.length;n<s;n++){var r=t[n];if(r.filter){var o=this.getFilterCellEl(n);r.filter.render(o)}}},_deferUpdateSummaryRow:function(){var e=this;if(this._summaryTimer)return;this._summaryTimer=setTimeout(function(){e._doUpdateSummaryRow();e._summaryTimer=null},1)},_doUpdateSummaryRow:function(){var e=this.data;if(this._summaryEl.firstChild){this._summaryEl.removeChild(this._summaryEl.firstChild)}var t=this.isFrozen();var i=this.getBottomColumns();var n=[];n[n.length]='<table class="mini-grid-table" cellspacing="0" cellpadding="0">';n[n.length]=this._CreateTopTr("summary");n[n.length]="<tr >";for(var s=0,r=i.length;s<r;s++){var l=i[s];var o=this._createSummaryCellId(l);var a=this._OnDrawSummaryCell(e,l);var h=l.dataType=="currency"||l.dataType=="percent"?"fn-ar ":"";n[n.length]='<td id="';n[n.length]=o;n[n.length]='" class="mini-grid-summaryCell '+h+a.cellCls+'" style="'+a.cellStyle+";";if(t&&s<this.frozenStartColumn||l.visible==false||l._hide==true){n[n.length]=";display:none;"}n[n.length]='"';n[n.length]=' title="'+(a.title||"")+'"';n[n.length]=">";n[n.length]=a.cellHtml;n[n.length]="</td>"}n[n.length]='</tr></table><div class="mini-grid-scrollCell"></div>';this._summaryEl.innerHTML=n.join("");this.fire("updatesummary",a)},_createHeaderText:function(e){var t=e.header;if(typeof t=="function")t=t.call(this,e);if(mini.isNull(t)||t==="")t="&nbsp;";return t},_isLastColumn:function(e){var t=this.columns[this.columns.length-1];var i=this.columns;if(!s(e,i))return true;if(n(e))return true;function n(e){var r=s(e,i);if(!r)return false;var l=s(r,i);if(!l){if(r._id==t._id)return true;return false}var o=l.columns.indexOf(r);if(o==l.columns.length-1){var a=s(r,i);if(a){if(n(r))return true}else return true}else return false}function s(e){for(var t=0;t<i.length;t++){var n=r(e,i[t]);if(n)return n}}function r(e,t){if(e._pid==t._id){return t}var i=t.columns;if(!i)return null;for(var n=0;n<i.length;n++){var s=r(e,i[n]);if(s)return s}}},_doUpdateHeader:function(e){e=e||"";var t=this.isFrozen();var i=this.getColumnRows();var n=this.getBottomColumns();var s=n.length;var r=[];r[r.length]='<table style="'+e+';display:table" class="mini-grid-table" cellspacing="0" cellpadding="0"  id="mini-grid-table-head'+this.getId()+'">';r[r.length]=this._CreateTopTr("header");for(var l=0,o=i.length;l<o;l++){var a=i[l];r[r.length]="<tr >";for(var h=0,u=a.length;h<u;h++){var d=a[h];var c=this._createHeaderText(d);var f=this._createColumnId(d);var m="";if(this.sortField==d.field){m=this.sortOrder=="asc"?"mini-grid-asc":"mini-grid-desc"}r[r.length]='<td id="';r[r.length]=f;r[r.length]='" class="mini-grid-headerCell '+m+" "+(d.headerCls||"")+" ";if(h==u-1){if(this._isLastColumn(d))r[r.length]=" mini-grid-last-column "}var p=n.indexOf(d);r[r.length]='" style="';if(t&&p!=-1&&p<this.frozenStartColumn||d.visible==false||d._hide==true){r[r.length]=";display:none;"}if(d.columns&&d.columns.length>0&&d.colspan==0){r[r.length]=";display:none;"}if(d.headerStyle){r[r.length]=d.headerStyle+";"}if(d.headerAlign){r[r.length]="text-align:"+d.headerAlign+";"}r[r.length]='" ';if(d.rowspan){r[r.length]='rowspan="'+d.rowspan+'" '}if(d.colspan){r[r.length]='colspan="'+d.colspan+'" '}r[r.length]='><div class="mini-grid-cellInner">';r[r.length]=c;if(m){r[r.length]='<span class="mini-grid-sortIcon"></span>'}r[r.length]="</div>";r[r.length]="</td>"}r[r.length]="</tr>"}r[r.length]="</table>";var g=r.join("");g='<div class="mini-grid-header">'+g+"</div>";var g='<div class="mini-grid-scrollHeaderCell"></div>';g+='<div class="mini-grid-topRightCell"></div>';this._headerInnerEl.innerHTML=r.join("")+g;this._topRightCellEl=this._headerInnerEl.lastChild;this.fire("refreshHeader")},_destroyEditors:function(){var e=mini.getChildControls(this);var t=[];for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s.el&&mini.findParent(s.el,this._rowCls)){t.push(s);s.destroy()}}},_doUpdateBody:function(){this._destroyEditors();var e=this.getBottomColumns();for(var t=0,i=e.length;t<i;t++){var n=e[t];delete n._hide}this._doUpdateHeader();var s=this.data;var r=this.isVirtualScroll();var l=this._markRegion();var o=[];var a=this.isAutoHeight();var h=0;if(r){h=l.top}if(a){o[o.length]='<table class="mini-grid-table" cellspacing="0" cellpadding="0" id="mini-grid-table-body'+this.getId()+'">'}else{o[o.length]='<table style="position:absolute;top:'+h+'px;left:0;" class="mini-grid-table" cellspacing="0" cellpadding="0" id="mini-grid-table-body'+this.getId()+'">'}o[o.length]=this._CreateTopTr("body");if(s.length>0){if(this.isGrouping()){var u=0;var d=this._getGroupDataView();var c=this.getVisibleColumns();for(var f=0,m=d.length;f<m;f++){var p=d[f];var g=this.uid+"$group$"+p.id;var v=this._OnDrawGroup(p);o[o.length]='<tr id="'+g+'" class="mini-grid-groupRow">';if(this.__fzhj){var _={};for(var y=0,w=p.rows.length;y<w;y++){for(var C in this.__fzhj){if(!this.__fzhj[C]){this.__fzhj[C]=function(e,t){return e+t}}_[C]=this.__fzhj[C](_[C]||0,p.rows[y][C],p)}}var x=0,b=this.columns.length;for(;x<b;x++){if(this.columns[x].field==this._groupField){o.push('<td class="mini-grid-groupCell"><div class="mini-grid-groupHeader">');o[o.length]='<div class="mini-grid-group-ecicon"></div>';o[o.length]='<div class="mini-grid-groupTitle">'+v.cellHtml+"</div>";o[o.length]="</div></td>"}else{o.push('<td class="mini-grid-groupCell">'+(_[this.columns[x].field]||"")+"</td>")}}}else{o.push('<td class="mini-grid-groupCell" colspan="'+c.length+'"><div class="mini-grid-groupHeader">');o[o.length]='<div class="mini-grid-group-ecicon"></div>';o[o.length]='<div class="mini-grid-groupTitle">'+v.cellHtml+"</div>";o[o.length]="</div></td>"}o.push("</tr>");var E=p.rows;for(var t=0,i=E.length;t<i;t++){var T=E[t];this._createRow(T,o,u++)}if(this.showGroupSummary){}}}else{if(r){var S=l.start,I=l.end;for(var t=S,i=I;t<i;t++){var T=s[t];this._createRow(T,o,t)}}else{for(var t=0,i=s.length;t<i;t++){var T=s[t];this._createRow(T,o,t)}}}}else{if(this.showEmptyText&&(this._resultObject||this.dataLoaded)){o[o.length]='<tr ><td class="mini-grid-emptyText" colspan="'+this.getVisibleColumns().length+'">'+this.emptyText+"</td></tr>"}}o[o.length]="</table>";if(this._bodyInnerEl.firstChild){this._bodyInnerEl.removeChild(this._bodyInnerEl.firstChild)}this._bodyInnerEl.innerHTML=o.join("");if(r){this._rowHeight=23;try{var k=this._bodyInnerEl.firstChild.rows[1];if(k)this._rowHeight=k.offsetHeight}catch(N){}var O=this._rowHeight*this.data.length;this._bodyScrollEl.style.display="block";this._bodyScrollEl.style.height=O+"px"}else{this._bodyScrollEl.style.display="none"}},showNewRow:true,_createRow:function(e,t,i){if(!mini.isNumber(i))i=this.indexOf(e);var n=i==this.data.length-1;var s=this.isFrozen();var r=!t;if(!t)t=[];var l=this.getBottomColumns();var o=-1;var a=" ";var h=-1;var u=" ";t[t.length]='<tr id="';t[t.length]=this._createRowId(e);t[t.length]='" class="mini-grid-row ';if(this.isSelected(e)){t[t.length]=this._rowSelectedCls;t[t.length]=" "}if(e._state=="deleted")t[t.length]="mini-grid-deleteRow ";if(e._state=="added"&&this.showNewRow)t[t.length]="mini-grid-newRow ";if(this.allowAlternating&&i%2==1){t[t.length]=this._alternatingCls;t[t.length]=" "}o=t.length;t[t.length]=a;t[t.length]='" style="';h=t.length;t[t.length]=u;t[t.length]='">';var d=l.length-1;for(var c=0,f=d;c<=f;c++){var m=l[c];var p=m.field?this._HasRowModified(e,m.field):false;var g=this.getCellError(e,m);var v=this._OnDrawCell(e,m,i,c);var _=this._createCellId(e,m);t[t.length]='<td id="';t[t.length]=_;t[t.length]='" class="mini-grid-cell ';if(v.cellCls)t[t.length]=v.cellCls;if(g)t[t.length]=" mini-grid-cell-error ";if(this._currentCell&&this._currentCell[0]==e&&this._currentCell[1]==m){t[t.length]=" ";t[t.length]=this._cellSelectedCls}if(n){t[t.length]=" mini-grid-last-row "}if(c==d){t[t.length]=" mini-grid-last-column "}if(s&&this.frozenStartColumn<=c&&c<=this.frozenEndColumn){t[t.length]=" ";t[t.length]=this._frozenCellCls+" "}t[t.length]='" style="';if(m.align){t[t.length]="text-align:";t[t.length]=m.align;t[t.length]=";"}if(v.allowCellWrap){t[t.length]="white-space:normal;text-overflow:normal;word-break:break-all;"}if(v.cellStyle){t[t.length]=v.cellStyle;t[t.length]=";"}if(s&&c<this.frozenStartColumn||m.visible==false||m._hide==true){t[t.length]="display:none;"}if(v.visible==false){t[t.length]="display:none;"}t[t.length]='" ';if(v.rowSpan){t[t.length]='rowspan="'+v.rowSpan+'"'}if(v.colSpan){t[t.length]='colspan="'+v.colSpan+'"'}t[t.length]=">";if(p&&this.showModified){t[t.length]='<div class="mini-grid-cell-inner mini-grid-cell-dirty" style="';t[t.length]='">'}t[t.length]=v.cellHtml;if(p){t[t.length]="</div>"}t[t.length]="</td>";if(v.rowCls)a=v.rowCls;if(v.rowStyle)u=v.rowStyle}t[o]=a;t[h]=u;t[t.length]="</tr>";if(r){return t.join("")}},isVirtualScroll:function(){return this.virtualScroll&&this.isAutoHeight()==false&&this.isGrouping()==false},getScrollLeft:function(){return this.isFrozen()?this._scrollEl.scrollLeft:this._bodyEl.scrollLeft},doUpdate:function(){var e=new Date;if(this._allowUpdate===false)return;if(this.isAutoHeight()==true){this.addCls("mini-grid-auto")}else{this.removeCls("mini-grid-auto")}if(this._doUpdateSummaryRow)this._doUpdateSummaryRow();this._doUpdateBody();if(this.isFrozen()){var t=this;t.__OnHScroll()}else{}this.doLayout()},_fixIE:function(){if(isIE){this._borderEl.style.display="none";h=this.getHeight(true);w=this.getWidth(true);this._borderEl.style.display=""}},_deferLayout:function(){var e=this;if(this._layoutTimer)return;this._layoutTimer=setTimeout(function(){e.doLayout();e._layoutTimer=null},1)},doLayout:function(){if(!this.canLayout())return;this._filterEl.scrollLeft=this._summaryEl.scrollLeft=this._headerInnerEl.scrollLeft=this._bodyEl.scrollLeft;var e=new Date;var t=this.isFrozen();var i=this._headerInnerEl.firstChild,n=this._bodyInnerEl.firstChild;var s=this._filterEl.firstChild,r=this._summaryEl.firstChild;var l=this.isAutoHeight();h=this.getHeight(true);p=this.getWidth(true);var o=this.data;var a=p;if(a<17)a=17;if(h<0)h=0;var u=a,d=2e3;if(!l){h=h-this.getHeaderHeight()-this.getFooterHeight()-this.getFilterRowHeight()-this.getSummaryRowHeight()-this._getScrollHeight();if(h<0)h=0;this._bodyEl.style.height=h+"px";d=h}else{this._bodyEl.style.height="auto"}var c=this._bodyEl.scrollHeight;var f=this._bodyEl.clientHeight;if(this.isFitColumns()){var m=this.getMaxColumnLevel();if(f>=c||l){var p=u+"px";i.style.width=p;n.style.width=p;s.style.width=p;r.style.width=p;this._topRightCellEl.style.borderLeftWidth="0px";if(mini.isIE8&&this.data.length>0)mini.addClass(this._bodyEl,"mini-grid-hidden-y")}else{var p=parseInt(u-18);if(p<0)p=0;p=p+"px";i.style.width=p;n.style.width=p;s.style.width=p;r.style.width=p;if(m>0){this._topRightCellEl.style.borderLeftWidth="1px"}if(mini.isIE8&&this.data.length>0)mini.removeClass(this._bodyEl,"mini-grid-hidden-y")}if(o.length==0){n.style.height="1px";if(this._bodyEl.scrollWidth>this._bodyEl.clientWidth){n.style.height="1px"}else{n.style.height="auto"}}if(l){if(u>=this._bodyEl.scrollWidth-1){this._bodyEl.style.height="auto"}else{this._bodyEl.style.height=n.offsetHeight+17+"px"}}if(l&&t){this._bodyEl.style.height="auto"}}else{i.style.width=n.style.width="0px";s.style.width=r.style.width="0px";if(f>=c||l){if(mini.isIE8&&this.data.length>0)mini.addClass(this._bodyEl,"mini-grid-hidden-y")}else{if(mini.isIE8&&this.data.length>0)mini.removeClass(this._bodyEl,"mini-grid-hidden-y")}if(o.length==0){n.style.height="1px";if(this._bodyEl.scrollWidth>this._bodyEl.clientWidth){n.style.height="1px"}else{n.style.height="auto"}}}if(this.isFitColumns()){if(f<c){var p=a-18;if(p<0)p=0}else{this._headerInnerEl.style.width="100%";this._filterEl.style.width="100%";this._summaryEl.style.width="100%";this._footerEl.style.width="auto"}}else{this._headerInnerEl.style.width="100%";this._filterEl.style.width="100%";this._summaryEl.style.width="100%";this._footerEl.style.width="auto"}if(this.isFrozen()){if(f<this._bodyEl.scrollHeight){this._scrollEl.style.width=a-17+"px"}else{this._scrollEl.style.width=a+"px"}if(this._bodyEl.offsetWidth<n.offsetWidth||this.isFrozen()){this._scrollEl.firstChild.style.width=this._getColumnsScrollWidth()+"px";i.style.width=n.style.width="0px";s.style.width=r.style.width="0px"}else{this._scrollEl.firstChild.style.width="0px"}}if(this.data.length==0){this._doInnerLayout()}else{var g=this;if(!this._innerLayoutTimer){this._innerLayoutTimer=setTimeout(function(){g._doInnerLayout();g._innerLayoutTimer=null},10)}}this._doLayoutTopRightCell();this.fire("layout");if(this.isFrozen()){if(this._scrollEl.scrollLeft!=this.__frozenScrollLeft){this._doScrollFrozen()}}},_doLayoutTopRightCell:function(){var e=this._headerInnerEl.firstChild;var t=e.offsetWidth+1;var i=e.offsetHeight-1;if(i<0)i=0;this._topRightCellEl.style.left=t+"px";this._topRightCellEl.style.height=i+"px"},_doInnerLayout:function(){this._doLayoutDetailRows();this._doLayoutEditingRows();mini.layout(this._filterEl);mini.layout(this._summaryEl);mini.layout(this._footerEl);mini.repaint(this.el);this._doLayouted=true},setFitColumns:function(e){this.fitColumns=e;if(this.fitColumns){mini.removeClass(this.el,"mini-grid-fixcolumns")}else{mini.addClass(this.el,"mini-grid-fixcolumns")}this.doLayout()},getFitColumns:function(e){return this.fitColumns},isFitColumns:function(){return this.fitColumns&&!this.isFrozen()},_getColumnsScrollWidth:function(){if(this._bodyEl.offsetWidth<this._bodyInnerEl.firstChild.offsetWidth||this.isFrozen()){var e=0;var t=this.getBottomColumns();for(var i=0,n=t.length;i<n;i++){var s=t[i];e+=this.getColumnWidth(s)}return e}else{return 0}},_createRowId:function(e){return this.uid+"$"+e._uid},_createCellId:function(e,t){return this.uid+"$"+e._uid+"$"+t._id},_createFilterCellId:function(e){return this.uid+"$filter$"+e._id},_createSummaryCellId:function(e){return this.uid+"$summary$"+e._id},_createRowDetailId:function(e){return this.uid+"$detail$"+e._uid},_getHeaderScrollEl:function(){return this._headerInnerEl},getFilterCellEl:function(e){e=this.getColumn(e);if(!e)return null;return mini.byId(this._createFilterCellId(e),this.el)},getSummaryCellEl:function(e){e=this.getColumn(e);if(!e)return null;return mini.byId(this._createSummaryCellId(e),this.el)},_getRowEl:function(e){e=this._getRow(e);if(!e)return null;var t=this._createRowId(e);return mini.byId(t,this.el)},getCellBox:function(e,t){e=this._getRow(e);t=this.getColumn(t);if(!e||!t)return null;var i=this._getCellEl(e,t);if(!i)return null;return mini.getBox(i)},getRowBox:function(e){var t=this._getRowEl(e);if(t)return mini.getBox(t);return null},getRowsBox:function(){var e=[];var t=this.data;var i=0;for(var n=0,s=t.length;n<s;n++){var r=t[n];var l=this._createRowId(r);var o=document.getElementById(l);if(o){var a=o.offsetHeight;e[n]={top:i,height:a,bottom:i+a};i+=a}}return e},setColumnWidth:function(e,t){e=this.getColumn(e);if(!e)return;if(mini.isNumber(t))t+="px";e.width=t;var i=this._createColumnId(e)+"$header";var n=this._createColumnId(e)+"$body";var s=this._createColumnId(e)+"$filter";var r=this._createColumnId(e)+"$summary";var l=document.getElementById(i);var o=document.getElementById(n);var a=document.getElementById(s);var h=document.getElementById(r);if(l)l.style.width=t;if(o)o.style.width=t;if(a)a.style.width=t;if(h)h.style.width=t;this.doLayout();this.fire("columnschanged")},getColumnWidth:function(e){e=this.getColumn(e);if(!e)return 0;if(e.visible==false)return 0;var t=0;var i=this._createColumnId(e)+"$body";var n=document.getElementById(i);if(n){var s=n.style.display;n.style.display="";t=mini.getWidth(n);n.style.display=s}return t},_doVisibleColumn:function(e,t){var i=document.getElementById(this._createColumnId(e));if(i)i.style.display=t?"":"none";var n=document.getElementById(this._createFilterCellId(e));if(n)n.style.display=t?"":"none";var s=document.getElementById(this._createSummaryCellId(e));if(s)s.style.display=t?"":"none";var r=this._createColumnId(e)+"$header";var l=this._createColumnId(e)+"$body";var o=this._createColumnId(e)+"$filter";var a=this._createColumnId(e)+"$summary";var h=document.getElementById(r);if(h)h.style.display=t?"":"none";var u=document.getElementById(o);if(u)u.style.display=t?"":"none";var d=document.getElementById(a);if(d)d.style.display=t?"":"none";if(c){if(t&&c.style.display=="")return;if(!t&&c.style.display=="none")return}var c=document.getElementById(l);if(c)c.style.display=t?"":"none";var f=this.data;if(this.isVirtualScroll()){var m=this._markRegion();var p=m.start,g=m.end;for(var v=p,_=g;v<_;v++){var y=f[v];var w=this._createCellId(y,e);var C=document.getElementById(w);if(C){C.style.display=t?"":"none"}}}else{for(var v=0,_=this.data.length;v<_;v++){var y=this.data[v];var w=this._createCellId(y,e);var C=document.getElementById(w);if(C){C.style.display=t?"":"none"}}}},_doClassColumn:function(e,t,i){var n=this.data;if(this.isVirtualScroll()){var s=this._markRegion();var r=s.start,l=s.end;for(var o=r,a=l;o<a;o++){var h=n[o];var u=this._createCellId(h,e);var d=document.getElementById(u);if(d){if(i){mini.addClass(d,t)}else{mini.removeClass(d,t)}}}}else{for(var o=0,a=this.data.length;o<a;o++){var h=this.data[o];var u=this._createCellId(h,e);var d=document.getElementById(u);if(d){if(i){mini.addClass(d,t)}else{mini.removeClass(d,t)}}}}},__doFrozen:function(){this._scrollEl.scrollLeft=this._headerInnerEl.scrollLeft=this._bodyEl.scrollLeft=0;var e=this.isFrozen();if(e){mini.addClass(this.el,this._frozenCls)}else{mini.removeClass(this.el,this._frozenCls)}var t=this.getBottomColumns();var i=this._filterEl.firstChild,n=this._summaryEl.firstChild;if(e){i.style.height=jQuery(i).outerHeight()+"px";n.style.height=jQuery(n).outerHeight()+"px"}else{i.style.height="auto";n.style.height="auto"}if(this.isFrozen()){for(var s=0,r=t.length;s<r;s++){var l=t[s];if(this.frozenStartColumn<=s&&s<=this.frozenEndColumn){this._doClassColumn(l,this._frozenCellCls,true)}else{this._doClassColumn(l,this._frozenCellCls,false)}}this._doFixRowsHeight(true)}else{for(var s=0,r=t.length;s<r;s++){var l=t[s];delete l._hide;if(l.visible){this._doVisibleColumn(l,true)}this._doClassColumn(l,this._frozenCellCls,false)}this._doUpdateHeader();this._doFixRowsHeight(false)}this.doLayout();this._fixIE()},_deferFrozen:function(){this._headerTableHeight=mini.getHeight(this._headerInnerEl.firstChild);var e=this;if(this._deferFrozenTimer)clearTimeout(this._deferFrozenTimer);this._deferFrozenTimer=setTimeout(function(){e.__doFrozen()},1)},setFrozenStartColumn:function(e){var t=new Date;e=parseInt(e);if(isNaN(e))return;this.frozenStartColumn=e;this._deferFrozen()},getFrozenStartColumn:function(){return this.frozenStartColumn},setFrozenEndColumn:function(e){e=parseInt(e);if(isNaN(e))return;this.frozenEndColumn=e;this._deferFrozen()},getFrozenEndColumn:function(){return this.frozenEndColumn},unFrozenColumns:function(){this.setFrozenStartColumn(-1);this.setFrozenEndColumn(-1)},frozenColumns:function(e,t){this.unFrozenColumns();this.setFrozenStartColumn(e);this.setFrozenEndColumn(t)},_rowHeight:23,_markRegion:function(){var e=this._getViewNowRegion();var t=this._rowHeight;var i=this._bodyEl.scrollTop;var n=e.start,s=e.end;for(var r=0,l=this.data.length;r<l;r+=this._virtualRows){var o=r+this._virtualRows;if(r<=n&&n<o){n=r}if(r<s&&s<=o){s=o}}if(s>this.data.length)s=this.data.length;var a=n*t;this._viewRegion={start:n,end:s,top:a};return this._viewRegion},_getViewNowRegion:function(){var e=this._rowHeight;var t=this._bodyEl.scrollTop;var i=this._bodyEl.offsetHeight;var n=parseInt(t/e);var s=parseInt((t+i)/e)+1;var r={start:n,end:s};return r},_canVirtualUpdate:function(){if(!this._viewRegion)return true;var e=this._getViewNowRegion();if(this._viewRegion.start<=e.start&&e.end<=this._viewRegion.end)return false;return true},_tryUpdateScroll:function(){var e=this._canVirtualUpdate();if(e){this.doUpdate()}},__OnBodyScroll:function(e){this._filterEl.scrollLeft=this._summaryEl.scrollLeft=this._headerInnerEl.scrollLeft=this._bodyEl.scrollLeft;var t=this;setTimeout(function(){t._headerInnerEl.scrollLeft=t._bodyEl.scrollLeft},10);if(this.isVirtualScroll()){var t=this;if(this._scrollTopTimer){clearTimeout(this._scrollTopTimer)}this._scrollTopTimer=setTimeout(function(){t._scrollTopTimer=null;t._tryUpdateScroll()},100)}},__OnHScroll:function(e){var t=this;if(this._HScrollTimer)return;this._HScrollTimer=setTimeout(function(){t._doScrollFrozen();t._HScrollTimer=null},30)},_doScrollFrozen:function(){if(!this.isFrozen())return;var e=this.getBottomColumns();var t=this._scrollEl.scrollLeft;this.__frozenScrollLeft=t;var i=this.frozenEndColumn;var n=0;for(var s=i+1,r=e.length;s<r;s++){var l=e[s];if(!l.visible){continue}var o=this.getColumnWidth(l);if(t<=n)break;i=s;n+=o}if(this._lastStartColumn===i){return}this._lastStartColumn=i;for(var s=0,r=e.length;s<r;s++){var l=e[s];delete l._hide;if(this.frozenEndColumn<s&&s<=i){l._hide=true}}for(var s=0,r=e.length;s<r;s++){var l=e[s];if(s<this.frozenStartColumn||s>this.frozenEndColumn&&s<i||l.visible==false){this._doVisibleColumn(l,false)}else{this._doVisibleColumn(l,true)}}var a="width:100%;";if(this._scrollEl.offsetWidth<this._scrollEl.scrollWidth||!this.isFitColumns()){a="width:0px"}this._doUpdateHeader(a);var h=this._headerTableHeight;if(mini.isIE9)h-=1;mini.setHeight(this._headerInnerEl.firstChild,h);for(var s=this.frozenEndColumn+1,r=e.length;s<r;s++){var l=e[s];if(!l.visible)continue;if(s<=i){this._doVisibleColumn(l,false)}else{this._doVisibleColumn(l,true)}}this._doUpdateDetailColSpan();this._doMargeCells();this._doLayoutTopRightCell();this.fire("layout")},_doFixRowsHeight:function(e){var t=this.data;for(var i=0,n=t.length;i<n;i++){var s=t[i];var r=this._getRowEl(s);if(r){if(e){var l=0;r.style.height=l+"px"}else{r.style.height=""}}}},_doGridLines:function(){if(this.showVGridLines){mini.removeClass(this.el,"mini-grid-hideVLine")}else{mini.addClass(this.el,"mini-grid-hideVLine")}if(this.showHGridLines){mini.removeClass(this.el,"mini-grid-hideHLine")}else{mini.addClass(this.el,"mini-grid-hideHLine")}},setShowHGridLines:function(e){if(this.showHGridLines!=e){this.showHGridLines=e;this._doGridLines();this.doLayout()}},getShowHGridLines:function(){return this.showHGridLines},setShowVGridLines:function(e){if(this.showVGridLines!=e){this.showVGridLines=e;this._doGridLines();this.doLayout()}},getShowVGridLines:function(){return this.showVGridLines},setShowFilterRow:function(e){if(this.showFilterRow!=e){this.showFilterRow=e;this._doShowRows();this.doLayout()}},getShowFilterRow:function(){return this.showFilterRow},setShowSummaryRow:function(e){if(this.showSummaryRow!=e){this.showSummaryRow=e;this._doShowRows();this.doLayout()}},getShowSummaryRow:function(){return this.showSummaryRow},_doAlternating:function(){if(this.allowAlternating==false)return;var e=this.data;for(var t=0,i=e.length;t<i;t++){var n=e[t];var s=this._getRowEl(n);if(s){if(this.allowAlternating&&t%2==1){mini.addClass(s,this._alternatingCls)}else{mini.removeClass(s,this._alternatingCls)}}}},setAllowAlternating:function(e){if(this.allowAlternating!=e){this.allowAlternating=e;this._doAlternating()}},getAllowAlternating:function(){return this.allowAlternating},setEnableHotTrack:function(e){if(this.enableHotTrack!=e){this.enableHotTrack=e}},getEnableHotTrack:function(){return this.enableHotTrack},setShowLoading:function(e){this.showLoading=e},setAllowCellWrap:function(e){if(this.allowCellWrap!=e){this.allowCellWrap=e}},getAllowCellWrap:function(){return this.allowCellWrap},setAllowHeaderWrap:function(e){this.allowHeaderWrap=e;mini.removeClass(this.el,"mini-grid-headerWrap");if(e){mini.addClass(this.el,"mini-grid-headerWrap")}},getAllowHeaderWrap:function(){return this.allowHeaderWrap},setShowColumnsMenu:function(e){this.showColumnsMenu=e},getShowColumnsMenu:function(){return this.showColumnsMenu},setEditNextOnEnterKey:function(e){this.editNextOnEnterKey=e},getEditNextOnEnterKey:function(){return this.editNextOnEnterKey},setEditOnTabKey:function(e){this.editOnTabKey=e},getEditOnTabKey:function(){return this.editOnTabKey},setVirtualScroll:function(e){if(this.virtualScroll!=e){this.virtualScroll=e}},getVirtualScroll:function(){return this.virtualScroll},setScrollTop:function(e){this.scrollTop=e;this._bodyEl.scrollTop=e},getScrollTop:function(){return this._bodyEl.scrollTop},setBodyStyle:function(e){this.bodyStyle=e;mini.setStyle(this._bodyEl,e)},getBodyStyle:function(){return this.bodyStyle},setBodyCls:function(e){this.bodyCls=e;mini.addClass(this._bodyEl,e)},getBodyCls:function(){return this.bodyCls},setFooterStyle:function(e){this.footerStyle=e;mini.setStyle(this._footerEl,e)},getFooterStyle:function(){return this.footerStyle},setFooterCls:function(e){this.footerCls=e;mini.addClass(this._footerEl,e)},getFooterCls:function(){return this.footerCls},setShowHeader:function(e){this.showHeader=e;this._doShowRows();this.doLayout()},setShowPager:function(e){this.setShowFooter(e)},getShowPager:function(){return this.showFooter},setShowFooter:function(e){this.showFooter=e;this._doShowRows();this.doLayout()},getShowFooter:function(){return this.showFooter},setAutoHideRowDetail:function(e){this.autoHideRowDetail=e},setSortMode:function(e){this.sortMode=e},getSortMode:function(){return this.sortMode},setAllowSortColumn:function(e){this.allowSortColumn=e},getAllowSortColumn:function(){return this.allowSortColumn},setAllowMoveColumn:function(e){this.allowMoveColumn=e;
},getAllowMoveColumn:function(){return this.allowMoveColumn},setAllowResizeColumn:function(e){this.allowResizeColumn=e},getAllowResizeColumn:function(){return this.allowResizeColumn},setSelectOnLoad:function(e){this.selectOnLoad=e},getSelectOnLoad:function(){return this.selectOnLoad},setAllowResize:function(e){this.allowResize=e;this._resizeEl.style.display=this.allowResize?"":"none"},getAllowResize:function(){return this.allowResize},setShowEmptyText:function(e){this.showEmptyText=e},getShowEmptyText:function(){return this.showEmptyText},setEmptyText:function(e){this.emptyText=e},getEmptyText:function(){return this.emptyText},setShowModified:function(e){this.showModified=e},getShowModified:function(){return this.showModified},setShowNewRow:function(e){this.showNewRow=e},getShowNewRow:function(){return this.showNewRow},setCellEditAction:function(e){this.cellEditAction=e},getCellEditAction:function(){return this.cellEditAction},setAllowCellValid:function(e){this.allowCellValid=e},getAllowCellValid:function(){return this.allowCellValid},__allowLayout:true,showAllRowDetail:function(){this.__allowLayout=false;for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];this.showRowDetail(i)}this.__allowLayout=true;this.doLayout()},hideAllRowDetail:function(){this.__allowLayout=false;for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];if(this.isShowRowDetail(i)){this.hideRowDetail(i)}}this.__allowLayout=true;this.doLayout()},showRowDetail:function(e){e=this._getRow(e);if(!e)return;var t=this.getRowDetailEl(e);t.style.display="";e._showDetail=true;var i=this._getRowEl(e);mini.addClass(i,"mini-grid-expandRow");this.fire("showrowdetail",{record:e});if(this.__allowLayout){this.doLayout()}var n=this},hideRowDetail:function(e){e=this._getRow(e);if(!e)return;var t=this._createRowDetailId(e);var i=document.getElementById(t);if(i){i.style.display="none"}delete e._showDetail;var n=this._getRowEl(e);mini.removeClass(n,"mini-grid-expandRow");this.fire("hiderowdetail",{record:e});if(this.__allowLayout){this.doLayout()}},toggleRowDetail:function(e){e=this._getRow(e);if(!e)return;if(grid.isShowRowDetail(e)){grid.hideRowDetail(e)}else{grid.showRowDetail(e)}},isShowRowDetail:function(e){e=this._getRow(e);if(!e)return false;return!!e._showDetail},getRowDetailEl:function(e){e=this._getRow(e);if(!e)return null;var t=this._createRowDetailId(e);var i=document.getElementById(t);if(!i){i=this._createRowDetail(e)}return i},getRowDetailCellEl:function(e){var t=this.getRowDetailEl(e);if(t)return t.cells[0]},_createRowDetail:function(e){var t=this._getRowEl(e);var i=this._createRowDetailId(e);var n=this.getBottomColumns().length;jQuery(t).after('<tr id="'+i+'" class="mini-grid-detailRow"><td class="mini-grid-detailCell" colspan="'+n+'"></td></tr>');this._doUpdateDetailColSpan();return document.getElementById(i)},_getColSpan:function(){var e=this._bodyInnerEl.firstChild.getElementsByTagName("tr")[0];var t=e.getElementsByTagName("td");var i=0;for(var n=0,s=t.length;n<s;n++){var r=t[n];if(r.style.display!="none"){i++}}return i},_doUpdateDetailColSpan:function(){var e=jQuery(".mini-grid-detailRow",this.el);var t=this._getColSpan();for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=s.firstChild;r.colSpan=t}},_doLayoutDetailRows:function(){for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];if(i._showDetail==true){var n=this._createRowDetailId(i);var s=document.getElementById(n);if(s){mini.layout(s)}}}},_doLayoutEditingRows:function(){for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];if(i._editing==true){var n=this._getRowEl(i);if(n){mini.layout(n)}}}},__OnPageChanged:function(e){this.pageSize=e.pageSize;this.fire("pagechanged",e);e.cancel=true;this.gotoPage(e.pageIndex,e.pageSize,e.totalCount)},setShowReloadButton:function(e){this.pager.setShowReloadButton(e)},getShowReloadButton:function(){return this.pager.getShowReloadButton()},setShowPageInfo:function(e){this.pager.setShowPageInfo(e)},getShowPageInfo:function(){return this.pager.getShowPageInfo()},setSizeList:function(e){if(!mini.isArray(e))return;this.pager.setSizeList(e)},getSizeList:function(){return this.pager.getSizeList()},setPageSize:function(e){e=parseInt(e);if(isNaN(e))return;this.pageSize=e;if(this.pager)this.pager.update(this.pageIndex,this.pageSize,this.totalCount);if(this.diypager)this.diypager.update(this.pageIndex,this.pageSize,this.totalCount)},getPageSize:function(){return this.pageSize},setPageIndex:function(e){e=parseInt(e);if(isNaN(e))return;this.pageIndex=e;if(this.pager)this.pager.update(this.pageIndex,this.pageSize,this.totalCount);if(this.diypager)this.diypager.update(this.pageIndex,this.pageSize,this.totalCount)},getPageIndex:function(){return this.pageIndex},setShowPageSize:function(e){this.showPageSize=e;this.pager.setShowPageSize(e)},getShowPageSize:function(){return this.showPageSize},setShowPageIndex:function(e){this.showPageIndex=e;this.pager.setShowPageIndex(e)},getShowPageIndex:function(){return this.showPageIndex},setShowTotalCount:function(e){this.showTotalCount=e;this.pager.setShowTotalCount(e)},getShowTotalCount:function(){return this.showTotalCount},setPageIndexField:function(e){this.pageIndexField=e},getPageIndexField:function(){return this.pageIndexField},setPageSizeField:function(e){this.pageSizeField=e},getPageSizeField:function(){return this.pageSizeField},setSortFieldField:function(e){this.sortFieldField=e},getSortFieldField:function(){return this.sortFieldField},setSortOrderField:function(e){this.sortOrderField=e},getSortOrderField:function(){return this.sortOrderField},setTotalField:function(e){this.totalField=e},getTotalField:function(){return this.totalField},setDependMerge:function(e){this.dependMerge=e},getDependMerge:function(){return this.dependMerge},setDataField:function(e){this.dataField=e},getDataField:function(){return this.dataField},getSortField:function(){return this.sortField},getSortOrder:function(){return this.sortOrder},pageIndex:0,pageSize:10,totalCount:0,totalPage:0,showPageInfo:true,pageIndexField:"pageIndex",pageSizeField:"pageSize",sortFieldField:"sortField",sortOrderField:"sortOrder",totalField:"total",showPageSize:true,showPageIndex:true,showTotalCount:true,setTotalCount:function(e){this.totalCount=e;this.pager.setTotalCount(e);if(this.diypager)this.diypager.setTotalCount(e)},getTotalCount:function(){return this.totalCount},getTotalPage:function(){return this.totalPage},sortField:"",sortOrder:"",url:"",autoLoad:false,loadParams:null,ajaxAsync:true,ajaxMethod:"post",ajaxTimeout:3e4,showLoading:true,resultAsData:false,checkSelectOnLoad:true,setCheckSelectOnLoad:function(e){this.checkSelectOnLoad=e},getCheckSelectOnLoad:function(){return this.checkSelectOnLoad},totalField:"total",dataField:"data",_getFromData:function(e){return e.data},getResultObject:function(){return this._resultObject?this._resultObject:{}},_doLoad:function(params,success,fail){try{var url=eval(this.url);if(url!=undefined){this.url=url}}catch(e){console&&console.log(e)}if(!this.url){return}params=params||{};if(mini.isNull(params.pageIndex))params.pageIndex=0;if(mini.isNull(params.pageSize))params.pageSize=this.pageSize;params.sortField=this.sortField;params.sortOrder=this.sortOrder;if(this.sortMode!="server"){params.sortField=this.sortField="";params.sortOrder=this.sortOrder=""}this.loadParams=params;var o={};o[this.pageIndexField]=params.pageIndex;o[this.pageSizeField]=params.pageSize;if(params.sortField)o[this.sortFieldField]=params.sortField;if(params.sortOrder)o[this.sortOrderField]=params.sortOrder;o.orders=[];o.orders.push({property:params.sortField,direction:params.sortOrder?params.sortOrder.toUpperCase():"ASC"});mini.copyTo(params,o);var url=this.url;var ajaxMethod=this.ajaxMethod;if(url){if(url.indexOf(".txt")!=-1||url.indexOf(".json")!=-1){ajaxMethod="get"}}else{ajaxMethod="get"}var e={url:url,async:this.ajaxAsync,type:ajaxMethod,data:params,params:params,timeout:this.ajaxTimeout,cache:false,cancel:false,isMini:true,isjson:true};this.fire("beforeload",e);if(e.data!=e.params&&e.params!=params){e.data=e.params}if(e.cancel==true){params.pageIndex=this.getPageIndex();params.pageSize=this.getPageSize();return}if(this.showLoading){this.loading()}this._selectedValue=this._selected?this._selected[this.idField]:null;var sf=me=this;var url=e.url;mini.copyTo(e,{success:function(e,t,i){var n=null;try{n=mini.decode(e)}catch(s){if(mini_debugger==true){alert(url+"\ndatagrid json is error.")}}if(n&&!mini.isArray(n)){n.total=parseInt(mini._getMap(me.totalField,n));n.data=mini._getMap(me.dataField,n)}else{if(n==null){n={};n.data=[];n.total=0}else if(mini.isArray(n)){var r={};r.data=n;r.total=n.length;n=r}}if(!n.data)n.data=[];if(!n.total)n.total=0;var l=sf.getPageIndex();if(l>0&&n.total>0&&n.data.length==0){l-=1;sf.gotoPage(l);return}sf._resultObject=n;sf.unmask();if(mini.isNumber(n.error)&&n.error!=0){var o={errorCode:n.error,xmlHttp:i,errorMsg:n.message,result:n};sf.fire("loaderror",o);if(fail){fail.call(sf,o)}return}var a=n.total;var h=sf._getFromData(n);if(mini.isNumber(params.pageIndex))sf.pageIndex=params.pageIndex;if(mini.isNumber(params.pageSize))sf.pageSize=params.pageSize;if(mini.isNumber(a))sf.totalCount=a;var s={result:n,data:h,total:a,cancel:false,xmlHttp:i};sf.fire("preload",s);if(s.cancel==true)return;var u=sf._allowLayout;sf._allowLayout=false;sf.loadData(s.data);if(sf._selectedValue&&sf.checkSelectOnLoad){var d=sf.getRowById(sf._selectedValue);if(d){sf.select(d)}else{sf.deselectAll()}}else if(sf._selected){sf.deselectAll()}if(sf.getSelected()==null&&sf.selectOnLoad&&sf.data.length>0){sf.select(0)}if(sf.collapseGroupOnLoad){sf.collapseGroups()}sf._allowLayout=u;sf.doLayout();sf.fire("load",s);if(success)success.call(sf,s)},error:function(e,t,i){var n={xmlHttp:e,errorMsg:e.responseText,errorCode:e.status};if(mini_debugger==true){alert(url+"\n"+n.errorCode+"\n"+n.errorMsg)}sf.fire("loaderror",n);sf.unmask();if(fail){fail.call(sf,n)}}});this._ajaxer=mini.ajax(e)},load:function(e,t,i){if(this._loadTimer)clearTimeout(this._loadTimer);var n=this;var s=mini.byClass("mini-grid-emptyText",this.el);if(s)s.style.display="none";this.cancelEdit();this.loadParams=e||{};if(this.ajaxAsync){this._loadTimer=setTimeout(function(){n._doLoad(e,t,i)},1)}else{n._doLoad(e,t,i)}},reload:function(e,t){this.accept();this.load(this.loadParams,e,t)},gotoPage:function(e,t,i){var n=this.loadParams||{};if(mini.isNumber(e)){n.pageIndex=e;n.pageNumber=e}if(mini.isNumber(t))n.pageSize=t;if(mini.isNumber(i))n.totalCount=i;this.load(n)},sortBy:function(e,t){this.sortField=e;this.sortOrder=t=="asc"?"asc":"desc";if(this.sortMode=="server"&&this.url&&this.data.length>0){var i=this.loadParams||{};i.sortField=e;i.sortOrder=t;i.pageIndex=this.pageIndex;var n=this;this.load(i,function(){n.fire("sort")})}else{var s=this.data.clone();var r=this._getSortFnByField(e);if(!r)return;var l=[];for(var o=s.length-1;o>=0;o--){var a=s[o];var h=mini._getMap(e,a);if(mini.isNull(h)||h===""){l.insert(0,a);s.removeAt(o)}}s=s.clone();mini.sort(s,r,this);s.insertRange(0,l);if(this.sortOrder=="desc"){s.reverse()}this.data=s;this.doUpdate();this.fire("sort")}},clearSort:function(){this.sortField="";this.sortOrder="";this.reload()},_getSortFnByField:function(e){if(!e)return null;var t="string";var i=null;var n=this.getBottomColumns();for(var s=0,r=n.length;s<r;s++){var l=n[s];if(l.field==e){if(l.dataType)t=l.dataType.toLowerCase();break}}var o=mini.sortTypes[t];if(!o)o=mini.sortTypes["string"];function a(t,i){var n=mini._getMap(e,t),s=mini._getMap(e,i);var r=o(n);var l=o(s);if(r>l)return 1;else if(r==l)return 0;else return-1}i=a;return i},allowCellSelect:false,allowCellEdit:false,_cellSelectedCls:"mini-grid-cell-selected",_currentCell:null,_editingCell:null,_editingControl:null,_editWrap:null,_doCurrentCell:function(e){if(this._currentCell){var t=this._currentCell[0],i=this._currentCell[1];var n=this._getCellEl(t,i);if(n){if(e){mini.addClass(n,this._cellSelectedCls)}else{mini.removeClass(n,this._cellSelectedCls)}}}},setCurrentCell:function(e){if(this._currentCell!=e){this._doCurrentCell(false);this._currentCell=e;if(e){var t=this._getRow(e[0]);var i=this.getColumn(e[1]);if(t&&i){this._currentCell=[t,i]}else{this._currentCell=null}}this._doCurrentCell(true);if(e){if(this.isFrozen()){this.scrollIntoView(e[0])}else{this.scrollIntoView(e[0])}}this.fire("currentcellchanged")}},getCurrentCell:function(){var e=this._currentCell;if(e){if(this.data.indexOf(e[0])==-1){this._currentCell=null;e=null}}return e},setAllowCellSelect:function(e){this.allowCellSelect=e},getAllowCellSelect:function(e){return this.allowCellSelect},setAllowCellEdit:function(e){this.allowCellEdit=e},getAllowCellEdit:function(e){return this.allowCellEdit},beginEditCell:function(e,t){e=this._getRow(e);t=this.getColumn(t);var i=[e,t];if(e&&t){this.setCurrentCell(i)}var i=this.getCurrentCell();if(this._editingCell&&i){if(this._editingCell[0]==i[0]&&this._editingCell[1]==i[1])return}if(this._editingCell)this.commitEdit();if(i){var e=i[0],t=i[1];var n=this._OnCellBeginEdit(e,t,this.getCellEditor(t));if(n!==false){this.scrollIntoView(e,t);this._editingCell=i;this._OnCellShowingEdit(e,t)}}},isEditingCell:function(e){return this._editingCell&&this._editingCell[0]==e[0]&&this._editingCell[1]==e[1]},cancelEdit:function(){if(this.allowCellEdit){if(this._editingCell){this._OnCellEndEdit()}}else{if(this.isEditing()){this._allowLayout=false;var e=this.data.clone();for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n._editing==true)this.cancelEditRow(t)}this._allowLayout=true;this.doLayout()}}},commitEdit:function(){if(this.allowCellEdit){if(this._editingCell){this._OnCellCommitEdit(this._editingCell[0],this._editingCell[1]);this._OnCellEndEdit()}}else{if(this.isEditing()){this._allowLayout=false;var e=this.data.clone();for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n._editing==true)this.commitEditRow(t)}this._allowLayout=true;this.doLayout()}}},getCellEditor:function(e,t){e=this.getColumn(e);if(!e)return;if(this.allowCellEdit){var i=e.__editor;if(!i)i=mini.getAndCreate(e.editor);if(i&&i!=e.editor){e.editor=i}return i}else{t=this._getRow(t);e=this.getColumn(e);if(!t)t=this.getEditingRow();if(!t||!e)return null;var n=this.uid+"$"+t._uid+"$"+e._id+"$editor";return mini.get(n)}},_OnCellBeginEdit:function(e,t,i){var n=mini._getMap(t.field,e);var s={sender:this,rowIndex:this.data.indexOf(e),row:e,record:e,column:t,field:t.field,editor:i,value:n,cancel:false};this.fire("cellbeginedit",s);if(!mini.isNull(t.defaultValue)&&(mini.isNull(s.value)||s.value==="")){var r=t.defaultValue;var l=mini.clone({d:r});s.value=l.d}var i=s.editor;n=s.value;if(s.cancel){return false}if(!i)return false;if(mini.isNull(n))n="";if(i.setValue){i.setValue(n)}i.ownerRowID=e._uid;if(t.displayField&&i.setText){var o=mini._getMap(t.displayField,e);if(!mini.isNull(t.defaultText)&&(mini.isNull(o)||o==="")){var l=mini.clone({d:t.defaultText});o=l.d}i.setText(o)}if(this.allowCellEdit){this._editingControl=s.editor}return true},_OnCellCommitEdit:function(e,t,i,n){var s={sender:this,record:e,rowIndex:this.data.indexOf(e),row:e,column:t,field:t.field,editor:n?n:this.getCellEditor(t),value:mini.isNull(i)?"":i,text:"",cancel:false};if(s.editor&&s.editor.getValue){if(s.editor.getFormValue){s.value=s.editor.getFormValue()}else{s.value=s.editor.getValue()}}if(s.editor&&s.editor.getText){s.text=s.editor.getText()}var r=e[t.field],l=s.value;if(mini.isEquals(r,l))return s;this.fire("cellcommitedit",s);if(s.cancel==false){if(this.allowCellEdit){var o={};mini._setMap(t.field,s.value,o);if(t.displayField){mini._setMap(t.displayField,s.text,o)}this.updateRow(e,o);if(this._mergedCellMaps){var a=this.getBottomColumns();var h=e._index;var u=a.indexOf(t);if(this._mergedCellMaps[h+":"+u]){for(var d=h+1;d<this.data.length;d++){if(this._mergedCellMaps[d+":"+u]==true)this.updateRow(this._getRow(d),o);else break}}}}}return s},_OnCellEndEdit:function(){if(!this._editingCell)return;var e=this._editingCell[0];var t=this._editingCell[1];var i={sender:this,record:e,rowIndex:this.data.indexOf(e),row:e,column:t,field:t.field,editor:this._editingControl,value:e[t.field]};this.fire("cellendedit",i);if(this.allowCellEdit){var n=i.editor;if(n&&n.setIsValid){n.setIsValid(true)}if(this._editWrap)this._editWrap.style.display="none";var s=this._editWrap.childNodes;for(var r=s.length-1;r>=0;r--){var l=s[r];this._editWrap.removeChild(l)}if(n&&n.hidePopup){n.hidePopup()}if(n&&n.setValue){n.setValue("")}this._editingControl=null;this._editingCell=null;if(this.allowCellValid){this.validateCell(e,t)}}},_OnCellShowingEdit:function(e,t){if(!this._editingControl)return false;var i=this.getCellBox(e,t);var n=mini.getViewportBox().width;if(i.right>n){i.width=n-i.left;if(i.width<10)i.width=10;i.right=i.left+i.width}var s={sender:this,rowIndex:this.data.indexOf(e),record:e,row:e,column:t,field:t.field,cellBox:i,editor:this._editingControl};this.fire("cellshowingedit",s);var r=s.editor;if(r&&r.setIsValid){r.setIsValid(true)}var l=this._getCellEl(e,t);var o=this._getEditWrap(i,l);this._editWrap.style.zIndex=mini.getMaxZIndex();if(r.render){r.render(this._editWrap);setTimeout(function(){r.focus();if(r.selectText)r.selectText();if(r.type=="radiobuttonlist"){var e=r.getValue();r.setValue("");r.setValue(e)}},50);if(r.setVisible)r.setVisible(true)}else if(r.el){this._editWrap.appendChild(r.el);setTimeout(function(){try{r.el.focus()}catch(e){}},50)}if(r.setWidth){var a=i.width;if(a<20)a=20;r.setWidth(a)}if(r.setHeight&&r.type=="textarea"){var h=i.height-1;if(r.minHeight&&h<r.minHeight)h=r.minHeight;r.setHeight(h)}if(r.setWidth&&r.type=="textarea"){var a=i.width-1;if(r.minWidth&&a<r.minWidth)a=r.minWidth;r.setWidth(a)}mini.on(document,"mousedown",this.__OnBodyMouseDown,this);if(t.autoShowPopup&&r.showPopup){r.showPopup()}},__OnBodyMouseDown:function(e){if(this._editingControl){var t=this._getCellByEvent(e);if(this._editingCell&&t){if(this._editingCell[0]==t.record&&this._editingCell[1]==t.column){return false}}var i=false;if(this._editingControl.within)i=this._editingControl.within(e);else i=mini.isAncestor(this._editWrap,e.target);if(i==false){var n=this;if(mini.isAncestor(this._bodyEl,e.target)==false){setTimeout(function(){n.commitEdit()},1)}else{var s=n._editingCell;setTimeout(function(){var e=n._editingCell;if(s==e){n.commitEdit()}},70)}mini.un(document,"mousedown",this.__OnBodyMouseDown,this)}}},_getEditWrap:function(e,t){if(!this._editWrap){this._editWrap=mini.append(document.body,'<div class="mini-grid-editwrap" style="position:absolute;"></div>');mini.on(this._editWrap,"keydown",this.___OnEditControlKeyDown,this)}var i=$(t).css("line-height");if(i.indexOf("px"))i=i.substr(0,i.length-2);var n=e.y+(e.height-i)/2;this._editWrap.style.zIndex=1e9;this._editWrap.style.display="block";mini.setXY(this._editWrap,e.x,n);mini.setWidth(this._editWrap,e.width);mini.setHeight(this._editWrap,i);var s=mini.getViewportBox().width;if(e.x>s)mini.setX(this._editWrap,-1e3);return this._editWrap},___OnEditControlKeyDown:function(e){var t=this._editingControl;if(e.keyCode==13&&t&&t.type=="textarea"){return}if(e.keyCode==13){var i=this._editingCell;if(i&&i[1]&&i[1].enterCommit===false)return;this.commitEdit();this.focus();if(this.editNextOnEnterKey){this.fire("celleditenter",{record:i[0]});this._beginEditNextCell(e.shiftKey==false)}else{}}else if(e.keyCode==27){this.cancelEdit();this.focus()}else if(e.keyCode==9){this.commitEdit();if(this.editOnTabKey){e.preventDefault();this.commitEdit();this._beginEditNextCell(e.shiftKey==false)}else{}}},editNextOnEnterKey:false,editOnTabKey:true,createOnEnter:false,_beginEditNextCell:function(e){var t=this;var i=this.getCurrentCell();if(!i)return;this.focus();var n=t.getBottomVisibleColumns();var s=i?i[1]:null,r=i?i[0]:null;var l=n.indexOf(s);var o=t.indexOf(r);var a=t.data.length;if(e===false){l-=1;s=n[l];if(!s){s=n[n.length-1];r=t.getAt(o-1);if(!r){return}}}else{l+=1;s=n[l];if(!s){s=n[0];r=t.getAt(o+1);if(!r){if(this.createOnEnter){r={};this.addRow(r)}else{return}}}}var i=[r,s];t.setCurrentCell(i);if(!t.onlyCheckSelection){if(t.getCurrent()!=r){t.deselectAll();t.setCurrent(r)}}t.scrollIntoView(r,s);t.beginEditCell()},getEditorOwnerRow:function(e){var t=e.ownerRowID;return this.getRowByUID(t)},beginEditRow:function(row){if(this.allowCellEdit)return;var sss=new Date;row=this._getRow(row);if(!row)return;var rowEl=this._getRowEl(row);if(!rowEl)return;row._editing=true;var s=this._createRow(row);var rowEl=this._getRowEl(row);jQuery(rowEl).before(s);rowEl.parentNode.removeChild(rowEl);var rowEl=this._getRowEl(row);mini.addClass(rowEl,"mini-grid-rowEdit");var columns=this.getBottomColumns();for(var i=0,l=columns.length;i<l;i++){var column=columns[i];var value=row[column.field];var cellId=this._createCellId(row,columns[i]);var cellEl=document.getElementById(cellId);if(!cellEl)continue;if(typeof column.editor=="string"){column.editor=eval("("+column.editor+")")}var editorConfig=mini.copyTo({},column.editor);editorConfig.id=this.uid+"$"+row._uid+"$"+column._id+"$editor";var editor=mini.create(editorConfig);if(this._OnCellBeginEdit(row,column,editor)){if(editor){mini.addClass(cellEl,"mini-grid-cellEdit");cellEl.innerHTML="";cellEl.appendChild(editor.el);mini.addClass(editor.el,"mini-grid-editor");if(editor.type=="radiobuttonlist"){var value=editor.getValue();editor.setValue("");editor.setValue(value)}}}}this.doLayout()},cancelEditRow:function(e){if(this.allowCellEdit)return;e=this._getRow(e);if(!e||!e._editing)return;delete e._editing;var t=this._getRowEl(e);var i=this.getBottomColumns();for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=this._createCellId(e,i[n]);var o=document.getElementById(l);var a=o.firstChild;var h=mini.get(a);if(!h)continue;h.destroy()}var u=this._createRow(e);jQuery(t).before(u);t.parentNode.removeChild(t);this.doLayout()},commitEditRow:function(e){if(this.allowCellEdit)return;e=this._getRow(e);if(!e||!e._editing)return;var t=this.getEditRowData(e);this._canUpdateRowEl=false;this.updateRow(e,t);this._canUpdateRowEl=true;this.cancelEditRow(e)},isEditing:function(){for(var e=0,t=this.data.length;e<t;e++){var i=this.data[e];if(i._editing==true)return true}return false},isEditingRow:function(e){e=this._getRow(e);if(!e)return false;return!!e._editing},isNewRow:function(e){return e._state=="added"},getEditingRows:function(){var e=[];for(var t=0,i=this.data.length;t<i;t++){var n=this.data[t];if(n._editing==true)e.push(n)}return e},getEditingRow:function(){var e=this.getEditingRows();return e[0]},getEditData:function(e){var t=[];for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];if(s._editing==true){var r=this.getEditRowData(i,e);r._index=i;t.push(r)}}return t},getEditRowData:function(e,t){e=this._getRow(e);if(!e||!e._editing)return null;var i={};var n=this.getBottomColumns();for(var s=0,r=n.length;s<r;s++){var l=n[s];var o=this._createCellId(e,n[s]);var a=document.getElementById(o);var h=null;if(l.type=="checkboxcolumn"||l.type=="radiobuttoncolumn"){var u=l.getCheckBoxEl(e);var d=u.checked?l.trueValue:l.falseValue;h=this._OnCellCommitEdit(e,l,d)}else{var c=a.firstChild;var f=mini.get(c);if(!f)continue;h=this._OnCellCommitEdit(e,l,null,f)}mini._setMap(l.field,h.value,i);if(l.displayField){mini._setMap(l.displayField,h.text,i)}}mini._setMap(this.idField,e[this.idField],i);if(t){var m=mini.copyTo({},e);i=mini.copyTo(m,i)}return i},getChanges:function(e,t){var i=[];if(!e||e=="removed"){i.addRange(this._removes)}for(var n=0,s=this.data.length;n<s;n++){var r=this.data[n];if(r._state&&(!e||e==r._state)){i.push(r)}}if(t){for(var n=0,s=i.length;n<s;n++){var r=i[n];if(r._state=="modified"){var l={};l[this.idField]=r[this.idField];for(var o in r){var a=this._HasRowModified(r,o);if(a){l[o]=r[o]}}i[n]=l}}}return i},isChanged:function(){var e=this.getChanges();return e.length>0},_originalIdField:"_uid",_getOriginal:function(e){var t=e[this._originalIdField];var i=this._originals[t];if(!i){i=this._originals[t]={}}return i},_HasRowModified:function(e,t){var i=this._originals[e[this._originalIdField]];if(!i)return false;if(mini.isNull(t))return false;return i.hasOwnProperty(t)},_doUpdateRow:function(e,t){var i=false;for(var n in t){var s=t[n];var r=mini._getMap(n,e);if(mini.isEquals(r,s))continue;mini._setMap(n,s,e);if(e._state!="added"){e._state="modified";var l=this._getOriginal(e);if(!l.hasOwnProperty(n)){l[n]=r}}i=true}return i},_canUpdateRowEl:true,_updateRowEl:function(e){var t=this;var i=t._createRow(e);var n=t._getRowEl(e);jQuery(n).before(i);n.parentNode.removeChild(n)},updateSummary:function(){this._doUpdateSummaryRow()},updateRow:function(e,t,i){e=this._getRow(e);if(!e||!t)return;if(typeof t=="string"){var n={};n[t]=i;t=n}var s=this._doUpdateRow(e,t);if(s==false)return;if(this._canUpdateRowEl){this._updateRowEl(e)}if(e._state=="modified"){this.fire("updaterow",{record:e,row:e})}if(e==this.getSelected()){this._OnCurrentChanged(e)}this._doMargeCells();this._deferUpdateSummaryRow();this._deferLayout()},deleteRows:function(e){if(!mini.isArray(e))return;e=e.clone();for(var t=0,i=e.length;t<i;t++){this.deleteRow(e[t])}},deleteRow:function(e){e=this._getRow(e);if(!e||e._state=="deleted")return;if(e._state=="added"){this.removeRow(e,true)}else{if(this.isEditingRow(e))this.cancelEditRow(e);e._state="deleted";var t=this._getRowEl(e);mini.addClass(t,"mini-grid-deleteRow");this.fire("deleterow",{record:e,row:e})}this._doUpdateSummaryRow()},removeRows:function(e,t){if(!mini.isArray(e))return;e=e.clone();for(var i=0,n=e.length;i<n;i++){this.removeRow(e[i],t)}},removeSelected:function(){var e=this.getSelected();if(e){this.removeRow(e,true)}},removeRow:function(e,t){e=this._getRow(e);if(!e)return;var i=e==this.getSelected();var n=this.isSelected(e);var s=this.data.indexOf(e);this.data.remove(e);if(e._state!="added"){e._state="removed";this._removes.push(e);delete this._originals[e[this._originalIdField]]}delete this._idRows[e._uid];var r=this._createRow(e);var l=this._getRowEl(e);if(l)l.parentNode.removeChild(l);var o=this._createRowDetailId(e);var a=document.getElementById(o);if(a){a.parentNode.removeChild(a)}if(n&&t){var h=this.getAt(s);if(!h)h=this.getAt(s-1);this.deselectAll();this.select(h)}this._checkSelecteds();this._removeRowError(e);this.fire("removerow",{record:e,row:e});if(i){this._OnCurrentChanged(e)}this._doAlternating();this._deferLayout();this._deferUpdateMergeCells();this._deferUpdateSummaryRow()},autoCreateNewID:false,addRows:function(e,t){if(!mini.isArray(e))return;e=e.clone();for(var i=0,n=e.length;i<n;i++){this.addRow(e[i],t);if(!mini.isNull(t)&&mini.isNumber(t))t++}},addRow:function(e,t){if(mini.isNull(t))t=this.data.length;t=this.indexOf(t);var i=this._getRow(t);this.data.insert(t,e);if(!e[this.idField]){if(this.autoCreateNewID){e[this.idField]=UUID()}var n={row:e,record:e};this.fire("beforeaddrow",n)}e._state="added";delete this._idRows[e._uid];e._uid=mini.DataGrid.RowID++;this._idRows[e._uid]=e;var s=this._createRow(e);if(i){var r=this._getRowEl(i);jQuery(r).before(s)}else{mini.append(this._bodyInnerEl.firstChild,s)}this._doAlternating();this._deferLayout();this.fire("addrow",{record:e,row:e});var l=jQuery(".mini-grid-emptyText",this._bodyEl)[0];if(l){mini.removeNode(l.parentNode)}this._deferUpdateMergeCells();this._deferUpdateSummaryRow()},moveRow:function(e,t){e=this._getRow(e);if(!e)return;if(t<0)return;if(t>this.data.length)return;var i=this._getRow(t);if(e==i)return;this.data.remove(e);var n=this._getRowEl(e);if(i){t=this.data.indexOf(i);this.data.insert(t,e);var s=this._getRowEl(i);jQuery(s).before(n)}else{this.data.insert(this.data.length,e);var r=this._bodyInnerEl.firstChild;mini.append(r.firstChild||r,n)}this._doAlternating();this._deferLayout();this.scrollIntoView(e);this.fire("moverow",{record:e,row:e,index:t});this._doMargeCells()},moveUp:function(e){if(!mini.isArray(e))return;var t=this;e=e.sort(function(e,i){var n=t.indexOf(e);var s=t.indexOf(i);if(n>s)return 1;return-1});for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=this.indexOf(s);this.moveRow(s,r-1)}},moveDown:function(e){if(!mini.isArray(e))return;var t=this;e=e.sort(function(e,i){var n=t.indexOf(e);var s=t.indexOf(i);if(n>s)return 1;return-1});e.reverse();for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=this.indexOf(s);this.moveRow(s,r+2)}},clearRows:function(){this.data=[];this.doUpdate()},indexOf:function(e){if(typeof e=="number")return e;if(this.isGrouping()){var t=this._getGroupDataView();return t.data.indexOf(e)}else{return this.data.indexOf(e)}},getAt:function(e){if(this.isGrouping()){var t=this._getGroupDataView();return t.data[e]}else{return this.data[e]}},getRow:function(e){if(e==null)return null;var t=typeof e;if(t=="number")return this.data[e];else if(t=="object"){if(e._index==undefined)return e;return this.data[e._index]}else return this.getRowById(e)},_getRow:function(e){var t=typeof e;if(t=="number")return this.data[e];else if(t=="object")return e;else return this.getRowById(e)},getRowByValue:function(e){for(var t=0,i=this.data.length;t<i;t++){var n=this.data[t];if(n[this.idField]==e)return n}},getRowById:function(e){return this.getRowByValue(e)},getRowByUID:function(e){return this._idRows[e]},findRows:function(e){var t=[];if(e){for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var r=e(s);if(r===true)t.push(s);if(r===1)break}}return t},findRow:function(e){if(e){for(var t=0,i=this.data.length;t<i;t++){var n=this.data[t];if(e(n)===true)return n}}},collapseGroupOnLoad:false,setCollapseGroupOnLoad:function(e){this.collapseGroupOnLoad=e},getCollapseGroupOnLoad:function(){return this.collapseGroupOnLoad},showGroupSummary:false,setShowGroupSummary:function(e){this.showGroupSummary=e},getShowGroupSummary:function(){return this.showGroupSummary},collapseGroups:function(){if(!this._groupDataView)return;for(var e=0,t=this._groupDataView.length;e<t;e++){var i=this._groupDataView[e];this._CollapseGroup(i)}},expandGroups:function(){if(!this._groupDataView)return;for(var e=0,t=this._groupDataView.length;e<t;e++){var i=this._groupDataView[e];this._ExpandGroup(i)}},_CollapseGroup:function(e){var t=e.rows;for(var i=0,n=t.length;i<n;i++){var s=t[i];var r=this._getRowEl(s);if(r)r.style.display="none";var r=this.getRowDetailEl(s);if(r)r.style.display="none"}e.expanded=false;var l=this.uid+"$group$"+e.id;var o=document.getElementById(l);if(o)mini.addClass(o,"mini-grid-group-collapse");this.doLayout()},_ExpandGroup:function(e){var t=e.rows;for(var i=0,n=t.length;i<n;i++){var s=t[i];var r=this._getRowEl(s);if(r)r.style.display="";var r=this.getRowDetailEl(s);if(r)r.style.display=s._showDetail?"":"none"}e.expanded=true;var l=this.uid+"$group$"+e.id;var o=document.getElementById(l);if(o)mini.removeClass(o,"mini-grid-group-collapse");this.doLayout()},_GroupID:1,_groupField:"",_groupDir:"",groupBy:function(e,t,i){if(!e)return;this._groupField=e;if(typeof t=="string")t=t.toLowerCase();this._groupDir=t;this.__fzhj=i;this._groupDataView=null;this.doUpdate()},clearGroup:function(){this._groupField="";this._groupDir="";this._groupDataView=null;this.doUpdate()},getGroupField:function(){return this._groupField},getGroupDir:function(){return this._groupDir},isGrouping:function(){return this._groupField!=""},_getGroupDataView:function(){if(this.isGrouping()==false)return null;if(!this._groupDataView){var e=this._groupField,t=this._groupDir;var i=this.data.clone();if(typeof t=="function"){mini.sort(i,t)}else{mini.sort(i,function(t,i){var n=t[e];var s=i[e];if(n>s)return 1;else return 0},this);if(t=="desc")i.reverse()}var n=[];var s={};for(var r=0,l=i.length;r<l;r++){var o=i[r];var a=o[e];var h=mini.isDate(a)?a.getTime():a;var u=s[h];if(!u){u=s[h]={};u.header=e;u.field=e;u.dir=t;u.value=a;u.rows=[];n.push(u);u.id=this._GroupID++}u.rows.push(o)}this._groupDataView=n;var i=[];for(var r=0,l=n.length;r<l;r++){i.addRange(n[r].rows)}this._groupDataView.data=i}return this._groupDataView},_getGroupByID:function(e){if(!this._groupDataView)return null;var t=this._groupDataView;for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.id==e)return s}},_OnDrawGroup:function(e){var t={group:e,rows:e.rows,field:e.field,dir:e.dir,value:e.value,cellHtml:e.header+" : "+e.value
};this.fire("drawgroup",t);return t},onDrawGroupHeader:function(e,t){this.on("drawgroupheader",e,t)},onDrawGroupSummary:function(e,t){this.on("drawgroupsummary",e,t)},mergeColumns:function(e){if(e&&mini.isArray(e)==false)e=[e];this.mergeColumnsData=e;var t=this;var i=t.getBottomColumns();if(!e)e=i;var n=t.data.clone();n.push({});var s=[];var r;var l;if(this.dependMerge)e=d(e);for(var o=0,a=e.length;o<a;o++){var h=e[o];h=t.getColumn(h);if(!h)continue;var u;if(this.dependMerge){if(o==0)u=c(h);else{u=f(h,r,l)}r=u;l=h}else{u=c(h)}if(u)s.addRange(u)}t.mergeCells(s);function d(e){var t=[];for(var n=0;n<i.length;n++){for(var s=0;s<e.length;s++){if(i[n].name==e[s])t.push(e[s])}}return t}function c(e){if(!e.field)return;var t=[];var s=-1,r=1,l=i.indexOf(e);var o=null;for(var a=0,h=n.length;a<h;a++){var u=n[a];var d=u[e.field];if(s==-1||d!=o){if(r>1){var c={rowIndex:s,columnIndex:l,rowSpan:r,colSpan:1};t.push(c)}s=a;r=1;o=d}else{r++}}return t}function f(e,t,s){if(!e.field)return;var r=[];var l=-1,o=1,a=i.indexOf(e),h=i.indexOf(s);var u=null;for(var d=0,c=t.length;d<c;d++){var f=m(e,t[d],n);if(f)r.addRange(f)}return r;function m(e,t,n){var s=[];var r=-1,l=1,o=i.indexOf(e);var a=null;for(var h=0,u=t.rowSpan;h<=u;h++){var d=n[t.rowIndex+h];var c=d[e.field];if(r==-1||c!=a||h==u){if(l>1){var f={rowIndex:r,columnIndex:o,rowSpan:l,colSpan:1};s.push(f)}r=t.rowIndex+h;l=1;a=c}else{l++}}return s}}},mergeCells:function(e){if(!mini.isArray(e))return;this._margedCells=e;this._doMargeCells();var t=this._mergedCellMaps={};function i(e,i,n,s,r){for(var l=e,o=e+n;l<o;l++){for(var a=i,h=i+s;a<h;a++){if(l==e&&a==i){t[l+":"+a]=r}else{t[l+":"+a]=true}}}}var e=this._margedCells;if(e){for(var n=0,s=e.length;n<s;n++){var r=e[n];if(!r.rowSpan)r.rowSpan=1;if(!r.colSpan)r.colSpan=1;i(r.rowIndex,r.columnIndex,r.rowSpan,r.colSpan,r)}}},margeCells:function(e){this.mergeCells(e)},_isCellVisible:function(e,t){if(!this._mergedCellMaps)return true;var i=this._mergedCellMaps[e+":"+t];return!(i===true)},_deferUpdateMergeCells:function(){var e=this;if(this._mergeTimer)return;this._mergeTimer=setTimeout(function(){e._doUpdateMergeCells();e._mergeTimer=null},1)},_doUpdateMergeCells:function(){var e=this._margedCells;if(!e)return;function t(e){var t={};for(var i=0,n=e.length;i<n;i++){var s=e[i];if(t[s.columnIndex]){t[s.columnIndex].push(s)}else{t[s.columnIndex]=[];t[s.columnIndex].push(s)}}return t}var i=t(e);this._clearMergeCell(i);this.mergeColumns(this.mergeColumnsData);this._doUpdateBody()},_clearMergeCell:function(e){var t=[];for(rowIndex in e){for(var i=0,n=this.getData().length;i<n;i++){var s={rowIndex:i,columnIndex:rowIndex,rowSpan:1,colSpan:1};t.push(s)}}this.mergeCells(t)},_doMargeCells:function(){function e(){var e=this._margedCells;if(!e)return;for(var t=0,i=e.length;t<i;t++){var n=e[t];if(!n.rowSpan)n.rowSpan=1;if(!n.colSpan)n.colSpan=1;var s=this._getCellEls(n.rowIndex,n.columnIndex,n.rowSpan,n.colSpan);for(var r=0,l=s.length;r<l;r++){var o=s[r];if(r!=0){o.style.display="none"}else{o.rowSpan=n.rowSpan;o.colSpan=n.colSpan}}}}e.call(this)},_getCellEls:function(e,t,i,n){var s=[];if(!mini.isNumber(e))return[];if(!mini.isNumber(t))return[];var r=this.getBottomColumns();var l=this.data;for(var o=e,a=e+i;o<a;o++){for(var h=t,u=t+n;h<u;h++){var d=this._getCellEl(o,h);if(d)s.push(d)}}return s},_selected:null,_selecteds:[],_checkSelecteds:function(){var e=this._selecteds;for(var t=e.length-1;t>=0;t--){var i=e[t];if(!!this._idRows[i._uid]==false){e.removeAt(t);delete this._idSelecteds[i._uid]}}if(this._selected){if(!!this._idSelecteds[this._selected._uid]==false){this._selected=null}}},setAllowUnselect:function(e){this.allowUnselect=e},getAllowUnselect:function(e){return this.allowUnselect},setAllowRowSelect:function(e){this.allowRowSelect=e},getAllowRowSelect:function(e){return this.allowRowSelect},setMultiSelect:function(e){if(this.multiSelect!=e){this.multiSelect=e;this._doUpdateHeader()}},getMultiSelect:function(){return this.multiSelect},_getSelectAllCheckState:function(){var e=this.data;var t=true;if(e.length==0){t=false;return t}var i=0;for(var n=0,s=e.length;n<s;n++){var r=e[n];if(this.isSelected(r)){i++}else{}}if(e.length==i){t=true}else if(i==0){t=false}else{t="has"}return t},_fireSelect:function(e,t){var i={record:e,cancel:false};this.fire(t,i);return!i.cancel},isSelected:function(e){e=this._getRow(e);if(!e)return false;return!!this._idSelecteds[e._uid]},getSelecteds:function(){this._checkSelecteds();return this._selecteds.clone()},setCurrent:function(e){this.setSelected(e)},getCurrent:function(){return this.getSelected()},getSelected:function(){this._checkSelecteds();return this._selected},scrollIntoView:function(e,t){try{if(t){var i=this._getCellEl(e,t);mini.scrollIntoView(i,this._bodyEl,true)}else{var n=this._getRowEl(e);mini.scrollIntoView(n,this._bodyEl,false)}}catch(s){}},setSelected:function(e){if(e||e===0){this.select(e)}else{this.deselect(this._selected)}if(this._selected){this.scrollIntoView(this._selected)}this._blurRow()},select:function(e,t){if(this.multiSelect==false){this.deselectAll()}e=this._getRow(e);if(!e)return;this._selected=e;this.selects([e],t)},deselect:function(e,t){e=this._getRow(e);if(!e)return;this.deselects([e],t)},selectAll:function(e){var t=this.data.clone();this.selects(t,e)},deselectAll:function(e){var t=this._selecteds.clone();this._selected=null;this.deselects(t,e)},clearSelect:function(e){this.deselectAll(e)},selects:function(e,t){if(!e||e.length==0)return;var i=new Date;e=e.clone();for(var n=e.length-1;n>=0;n--){var s=this._getRow(e[n]);if(s){e[n]=s}else{e.removeAt(n)}}var r={};var l=this.data;for(var n=0,o=l.length;n<o;n++){var a=this._getRow(l[n]);var h=a[this.idField];if(h){r[a[this.idField]]=a}}var u=[];for(var n=0,o=e.length;n<o;n++){var s=e[n];var d=this._idRows[s._uid];if(!d){s=r[s[this.idField]]}if(s)u.push(s)}e=u;e=e.clone();this._doSelects(e,true);for(var n=0,o=e.length;n<o;n++){var s=e[n];if(!this.isSelected(s)){if(t!==false){if(!this._fireSelect(s,"beforeselect"))continue}this._selecteds.push(s);this._idSelecteds[s._uid]=s;if(t!==false){this.fire("select",{record:s})}}}this._OnSelectionChanged()},deselects:function(e,t){if(!e)e=[];e=e.clone();for(var i=e.length-1;i>=0;i--){var n=this._getRow(e[i]);if(n){e[i]=n}else{e.removeAt(i)}}e=e.clone();for(var i=e.length-1;i>=0;i--){var n=e[i];if(this.isSelected(n)){if(t!==false){if(!this._fireSelect(n,"beforedeselect"))continue}this._doSelects([n],false);var s=0;for(var r=0;r<this._selecteds.length;r++){if(this._selecteds[r]._uid===n._uid)s=r}if(s>=0){this._selecteds.splice(s,1)}delete this._idSelecteds[n._uid];if(t!==false){this.fire("deselect",{record:n})}}}if(e.indexOf(this._selected)!=-1)this._selected=null;this._OnSelectionChanged()},_doSelects:function(e,t){var i=new Date;for(var n=0,s=e.length;n<s;n++){var r=e[n];if(t){this.addRowCls(r,this._rowSelectedCls)}else{this.removeRowCls(r,this._rowSelectedCls)}}},_OnSelectionChanged:function(){if(this._selectionTimer){clearTimeout(this._selectionTimer)}var e=this;this._selectionTimer=setTimeout(function(){var t={selecteds:e.getSelecteds(),selected:e.getSelected()};e.fire("SelectionChanged",t);e._OnCurrentChanged(t.selected)},1)},_OnCurrentChanged:function(e){if(this._currentTimer){clearTimeout(this._currentTimer)}var t=this;this._currentTimer=setTimeout(function(){var i={record:e,row:e};t.fire("CurrentChanged",i);t._currentTimer=null},1)},addRowCls:function(e,t){var i=this._getRowEl(e);if(i)mini.addClass(i,t)},removeRowCls:function(e,t){var i=this._getRowEl(e);if(i)mini.removeClass(i,t)},_focusRow:function(e,t){e=this._getRow(e);if(!e||e==this._focusedRow){return}var i=this._getRowEl(e);if(t&&i){this.scrollIntoView(e)}if(this._focusedRow==e)return;this._blurRow();this._focusedRow=e;mini.addClass(i,this._rowHoverCls)},_blurRow:function(){if(!this._focusedRow)return;var e=this._getRowEl(this._focusedRow);if(e){mini.removeClass(e,this._rowHoverCls)}this._focusedRow=null},_getRecordByEvent:function(e){var t=mini.findParent(e.target,this._rowCls);if(!t)return null;var i=t.id.split("$");var n=i[i.length-1];return this.getRowByUID(n)},__OnDocumentMousewheel:function(e,t){if(this.allowCellEdit&&this._editingControl&&!$(e.target).parents(".mini-popup").length){this._editingControl.__OnInputTextChanged();this.commitEdit()}},__OnMousewheel:function(e,t){var i=jQuery(this._bodyEl).css("overflow-y");if(i=="hidden"){var n=e.wheelDelta||-e.detail*24;var s=this._bodyEl.scrollTop;s-=n;this._bodyEl.scrollTop=s;if(s==this._bodyEl.scrollTop){e.preventDefault()}else{}var e={scrollTop:this._bodyEl.scrollTop,direction:"vertical"};this.fire("scroll",e)}},__OnClick:function(e){var t=mini.findParent(e.target,"mini-grid-groupRow");if(t){var i=t.id.split("$");var n=i[i.length-1];var s=this._getGroupByID(n);if(s){var r=!(s.expanded===false?false:true);if(r)this._ExpandGroup(s);else this._CollapseGroup(s)}}else{this._fireEvent(e,"Click")}},_tryFocus:function(e){if(!e.target.tagName)return false;var t=e.target.tagName.toLowerCase();if(t=="input"||t=="textarea"||t=="select")return;if(!mini.findParent(e.target,"mini-grid")){return}if(mini.isAncestor(this._filterEl,e.target)||mini.isAncestor(this._summaryEl,e.target)||mini.isAncestor(this._footerEl,e.target)||mini.findParent(e.target,"mini-grid-rowEdit")||mini.findParent(e.target,"mini-grid-detailRow")){}else{var i=this}},__OnDblClick:function(e){this._fireEvent(e,"Dblclick")},__OnMouseDown:function(e){this._fireEvent(e,"MouseDown");this._tryFocus(e)},__OnMouseUp:function(e){if(mini.isAncestor(this.el,e.target)){this._tryFocus(e);this._fireEvent(e,"MouseUp")}},__OnMouseMove:function(e){this._fireEvent(e,"MouseMove")},__OnMouseOver:function(e){this._fireEvent(e,"MouseOver")},__OnMouseOut:function(e){this._fireEvent(e,"MouseOut")},__OnKeyDown:function(e){this._fireEvent(e,"KeyDown")},__OnKeyUp:function(e){this._fireEvent(e,"KeyUp")},__OnContextMenu:function(e){this._fireEvent(e,"ContextMenu")},_fireEvent:function(e,t){if(!this.enabled)return;var i=this._getCellByEvent(e);var n=i.record,s=i.column;if(n){var r={record:n,row:n,htmlEvent:e};var l=this["_OnRow"+t];if(l){l.call(this,r)}else{this.fire("row"+t,r)}}if(s){var r={column:s,field:s.field,htmlEvent:e};var l=this["_OnColumn"+t];if(l){l.call(this,r)}else{this.fire("column"+t,r)}}if(n&&s){var r={sender:this,record:n,row:n,column:s,field:s.field,htmlEvent:e};var l=this["_OnCell"+t];if(l){l.call(this,r)}else{this.fire("cell"+t,r)}if(s["onCell"+t]){s["onCell"+t].call(s,r)}}if(!n&&s){var r={column:s,htmlEvent:e};var l=this["_OnHeaderCell"+t];if(l){l.call(this,r)}else{var o="onheadercell"+t.toLowerCase();if(s[o]){r.sender=this;s[o](r)}this.fire("headercell"+t,r)}}if(!n)this._blurRow()},_OnDrawCell:function(e,t,i,n){var s=mini._getMap(t.field,e);var r={sender:this,rowIndex:i,columnIndex:n,record:e,row:e,column:t,field:t.field,value:s,cellHtml:s,rowCls:null,cellCls:t.cellCls||"",rowStyle:null,cellStyle:t.cellStyle||"",allowCellWrap:this.allowCellWrap,autoEscape:t.autoEscape};r.visible=this._isCellVisible(i,n);if(r.visible==true&&this._mergedCellMaps){var l=this._mergedCellMaps[i+":"+n];if(l){r.rowSpan=l.rowSpan;r.colSpan=l.colSpan}}if(t.dateFormat){if(mini.isDate(r.value)){r.cellHtml=mini.formatDate(s,t.dateFormat)}else if(mini.isNull(s)||s===""){r.cellHtml=s}else{var o=new Date(s.split(".")[0].replace(/-/g,"/"));r.cellHtml=mini.formatDate(o,t.dateFormat)}}if(t.dataType=="currency"){if(mini.isNull(s)||s===""){r.cellHtml=t.emptyText||""}else{r.cellHtml=mini.util.StringUtil.formatMoney(r.cellHtml,t.digit,t.currencyUnit)}}if(t.dataType=="percent"){if(mini.isNull(s)||s===""){r.cellHtml=t.emptyText||""}else{var a=parseInt(t.decimalPlaces);if(isNaN(a))a=2;r.cellHtml=mini.formatPercent(r.value,t.showPercent,a)}}if(t.displayField){r.cellHtml=e[t.displayField]}if(r.autoEscape==true){r.cellHtml=mini.htmlEncode(r.cellHtml)}var h=t.renderer;if(h){fn=typeof h=="function"?h:mini._getFunctoin(h);if(fn){r.cellHtml=fn.call(t,r)}}this.fire("drawcell",r);if(r.cellHtml&&!!r.cellHtml.unshift&&r.cellHtml.length==0){r.cellHtml="&nbsp;"}if(r.cellHtml===null||r.cellHtml===undefined||r.cellHtml==="")r.cellHtml="&nbsp;";return r},_OnDrawSummaryCell:function(e,t){var i={result:this.getResultObject(),sender:this,data:e,column:t,field:t.field,value:"",cellHtml:"",cellCls:t.cellCls||"",cellStyle:t.cellStyle||"",allowCellWrap:this.allowCellWrap};if(t.summaryType){var n=mini.summaryTypes[t.summaryType];if(n){i.value=n(e,t.field)}}var s=i.value;i.cellHtml=i.value;if(i.value&&parseInt(i.value)!=i.value&&i.value.toFixed){decimalPlaces=parseInt(t.decimalPlaces);if(isNaN(decimalPlaces))decimalPlaces=2;i.cellHtml=parseFloat(i.value.toFixed(decimalPlaces))}if(t.dateFormat){if(mini.isDate(i.value)){i.cellHtml=mini.formatDate(s,t.dateFormat)}else i.cellHtml=s}if(t.dataType=="currency"){i.cellHtml=mini.util.StringUtil.formatMoney(i.cellHtml,t.digit,t.currencyUnit)}var r=t.summaryRenderer;if(r){n=typeof r=="function"?r:window[r];if(n){i.cellHtml=n.call(t,i)}}else{i.title=i.cellHtml}t.summaryValue=i.value;this.fire("drawsummarycell",i);if(i.cellHtml===null||i.cellHtml===undefined||i.cellHtml==="")i.cellHtml="&nbsp;";return i},_OnDrawGroupSummaryCell:function(e,t){var i={sender:this,data:e,column:t,field:t.field,value:"",cellHtml:"",cellCls:t.cellCls||"",cellStyle:t.cellStyle||"",allowCellWrap:this.allowCellWrap};if(t.groupSummaryType){var n=mini.groupSummaryType[t.summaryType];if(n){i.value=n(e,t.field)}}i.cellHtml=i.value;var s=t.groupSummaryRenderer;if(s){n=typeof s=="function"?s:window[s];if(n){i.cellHtml=n.call(t,i)}}this.fire("drawgroupsummarycell",i);if(i.cellHtml===null||i.cellHtml===undefined||i.cellHtml==="")i.cellHtml="&nbsp;";return i},_OnCellMouseDown:function(e){var t=e.record;this.fire("cellmousedown",e)},_OnRowMouseOut:function(e){if(!this.enabled)return;if(mini.isAncestor(this.el,e.target))return},_OnRowMouseMove:function(e){record=e.record;if(!this.enabled||record.enabled===false||this.enableHotTrack==false)return;this.fire("rowmousemove",e);var t=this;t._focusRow(record)},_OnHeaderCellClick:function(e){e.sender=this;var t=e.column;if(!mini.hasClass(e.htmlEvent.target,"mini-grid-splitter")){if(this.allowSortColumn&&this.isEditing()==false){if(!t.columns||t.columns.length==0){if(t.field&&t.allowSort!==false){var i="asc";if(this.sortField==t.field){i=this.sortOrder=="asc"?"desc":"asc"}this.sortBy(t.field,i)}}}this.fire("headercellclick",e)}},__OnHtmlContextMenu:function(e){var t={popupEl:this.el,htmlEvent:e,cancel:false};if(mini.isAncestor(this._headerEl,e.target)){if(this.headerContextMenu){this.headerContextMenu.fire("BeforeOpen",t);if(t.cancel==true)return;this.headerContextMenu.fire("opening",t);if(t.cancel==true)return;this.headerContextMenu.showAtPos(e.pageX,e.pageY);this.headerContextMenu.fire("Open",t)}}else{var i=mini.findParent(e.target,"mini-grid-detailRow");if(i&&mini.isAncestor(this.el,i))return;if(this.contextMenu){this.contextMenu.fire("BeforeOpen",t);if(t.cancel==true)return;this.contextMenu.fire("opening",t);if(t.cancel==true)return;this.contextMenu.showAtPos(e.pageX,e.pageY);this.contextMenu.fire("Open",t)}}return false},headerContextMenu:null,setHeaderContextMenu:function(e){var t=this._getContextMenu(e);if(!t)return;if(this.headerContextMenu!==t){this.headerContextMenu=t;this.headerContextMenu.owner=this;mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this)}},getHeaderContextMenu:function(){return this.headerContextMenu},columnsMenu:null,createColumnsMenu:function(){if(!this.columnsMenu){this.columnsMenu=mini.create({type:"menu",items:[{type:"menuitem",text:"Sort Asc"},{type:"menuitem",text:"Sort Desc"},"-",{type:"menuitem",text:"Columns",name:"columns",items:[]}]})}var e=[];return this.columnsMenu},_doShowColumnsMenu:function(e){var t=this.createColumnsMenu();var i=this._getColumnEl(e);var n=mini.getBox(i);t.showAtPos(n.right-17,n.bottom)},onRowDblClick:function(e,t){this.on("rowdblclick",e,t)},onRowClick:function(e,t){this.on("rowclick",e,t)},onRowMouseDown:function(e,t){this.on("rowmousedown",e,t)},onRowContextMenu:function(e,t){this.on("rowcontextmenu",e,t)},onCellClick:function(e,t){this.on("cellclick",e,t)},onCellMouseDown:function(e,t){this.on("cellmousedown",e,t)},onCellContextMenu:function(e,t){this.on("cellcontextmenu",e,t)},onBeforeLoad:function(e,t){this.on("beforeload",e,t)},onLoad:function(e,t){this.on("load",e,t)},onLoadError:function(e,t){this.on("loaderror",e,t)},onPreLoad:function(e,t){this.on("preload",e,t)},onDrawCell:function(e,t){this.on("drawcell",e,t)},onCellBeginEdit:function(e,t){this.on("cellbeginedit",e,t)},getAttrs:function(el){var attrs=mini.DataGrid.superclass.getAttrs.call(this,el);var cs=mini.getChildNodes(el);for(var i=0,l=cs.length;i<l;i++){var node=cs[i];var property=jQuery(node).attr("property");if(!property)continue;property=property.toLowerCase();if(property=="columns"){attrs.columns=mini._ParseColumns(node)}else if(property=="data"){attrs.data=node.innerHTML}}mini._ParseString(el,attrs,["url","sizeList","bodyCls","bodyStyle","footerCls","footerStyle","pagerCls","pagerStyle","onheadercellclick","onheadercellmousedown","onheadercellcontextmenu","oncelleditenter","onrowdblclick","onselect","ondeselect","onbeforeselect","onbeforedeselect","onrowclick","onrowmousedown","onrowcontextmenu","oncellclick","oncellmousedown","oncellcontextmenu","oncelldblclick","onbeforeload","onpreload","onloaderror","onload","ondrawcell","oncellbeginedit","onselectionchanged","onshowrowdetail","onhiderowdetail","idField","valueField","ajaxMethod","ondrawgroup","pager","oncellcommitedit","oncellendedit","headerContextMenu","loadingMsg","emptyText","cellEditAction","sortMode","oncellvalidation","onsort","pageIndexField","pageSizeField","sortFieldField","sortOrderField","totalField","dataField","ondrawsummarycell","ondrawgroupsummarycell","onresize","oncolumnschanged","onpagechanged"]);mini._ParseBool(el,attrs,["showHeader","showPager","showFooter","showTop","allowSortColumn","allowMoveColumn","allowResizeColumn","showHGridLines","showVGridLines","showFilterRow","showSummaryRow","showFooter","showTop","fitColumns","showLoading","multiSelect","allowAlternating","resultAsData","allowRowSelect","allowUnselect","enableHotTrack","showPageIndex","showPageSize","showTotalCount","checkSelectionOnly","checkSelectOnLoad","allowResize","autoLoad","autoHideRowDetail","allowCellSelect","allowCellEdit","allowCellWrap","allowHeaderWrap","selectOnLoad","virtualScroll","collapseGroupOnLoad","showGroupSummary","showEmptyText","allowCellValid","showModified","showColumnsMenu","showPageInfo","showReloadButton","showNewRow","editNextOnEnterKey","createOnEnter","dependMerge"]);mini._ParseInt(el,attrs,["columnWidth","frozenStartColumn","frozenEndColumn","pageIndex","pageSize","ajaxTimeout"]);if(typeof attrs.sizeList=="string"){attrs.sizeList=eval(attrs.sizeList)}if(!attrs.idField&&attrs.valueField){attrs.idField=attrs.valueField}return attrs}});mini.regClass(mini.DataGrid,"datagrid");mini_Column_Prototype={_getColumnEl:function(e){e=this.getColumn(e);if(!e)return null;var t=this._createColumnId(e);return document.getElementById(t)},_getCellEl:function(e,t){e=this._getRow?this._getRow(e):this.getNode(e);t=this.getColumn(t);if(!e||!t)return null;var i=this._createCellId(e,t);return document.getElementById(i)},getCellEl:function(e,t){this._getCellEl(e,t)},_getCellByEvent:function(e){var t=this._getRecordByEvent?this._getRecordByEvent(e):this._getNodeByEvent(e);var i=this._getColumnByEvent(e);return{record:t,column:i}},_getColumnByEvent:function(e){var t=mini.findParent(e.target,this._cellCls);if(!t)t=mini.findParent(e.target,this._headerCellCls);if(t){var i=t.id.split("$");var n=i[i.length-1];return this._getColumnById(n)}return null},_createColumnId:function(e){return this.uid+"$column$"+e._id},getColumnBox:function(e){var t=this._createColumnId(e);var i=document.getElementById(t);if(i){var n=mini.getBox(i);n.x-=1;n.left=n.x;n.right=n.x+n.width;return n}},setColumns:function(value){if(!mini.isArray(value))value=[];this.columns=value;this._idColumns={};this._nameColumns={};this._bottomColumns=[];this.maxColumnLevel=0;var level=0;function init(column,index,parentColumn){if(column.type){if(!mini.isNull(column.header)&&typeof column.header!=="function"){if(column.header.trim()==""){delete column.header}}var col=mini._getColumn(column.type);if(col){var _column=mini.copyTo({},column);mini.copyTo(column,col);mini.copyTo(column,_column)}}var width=parseInt(column.width);if(mini.isNumber(width)&&String(width)==column.width)column.width=width+"px";if(mini.isNull(column.width))column.width=this.columnWidth+"px";column.visible=column.visible!==false;column.allowResize=column.allowResize!==false;column.allowMove=column.allowMove!==false;column.allowSort=column.allowSort===true;column.allowDrag=!!column.allowDrag;column.readOnly=!!column.readOnly;column.autoEscape=!!column.autoEscape;if(!column._id)column._id=mini.DataGrid.ColumnID++;column._gridUID=this.uid;column._rowIdField=this._rowIdField;column._pid=parentColumn==this?-1:parentColumn._id;this._idColumns[column._id]=column;if(column.name)this._nameColumns[column.name]=column;if(!column.columns||column.columns.length==0){column.align=column.align||(column.dataType=="currency"||column.dataType=="percent"?"right":"");this._bottomColumns.push(column)}column.level=level;level+=1;this.eachColumns(column,init,this);level-=1;if(column.level>this.maxColumnLevel)this.maxColumnLevel=column.level;if(typeof column.editor=="string"){var cls=mini.getClass(column.editor);if(cls){column.editor={type:column.editor}}else{column.editor=eval("("+column.editor+")")}}if(typeof column.filter=="string"){column.filter=eval("("+column.filter+")")}if(column.filter&&!column.filter.el){column.filter=mini.create(column.filter)}if(typeof column.init=="function"&&column.inited!=true){column.init(this)}column.inited=true}this.eachColumns(this,init,this);if(this._doUpdateFilterRow)this._doUpdateFilterRow();this.doUpdate();this.fire("columnschanged")},getColumns:function(){return this.columns},getBottomColumns:function(){return this._bottomColumns},getVisibleColumns:function(){var e=this.getBottomColumns();var t=[];for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s.visible)t.push(s)}return t},getBottomVisibleColumns:function(){var e=[];for(var t=0,i=this._bottomColumns.length;t<i;t++){var n=this._bottomColumns[t];if(this.isVisibleColumn(n))e.push(n)}return e},eachColumns:function(e,t,i){var n=e.columns;if(n){var s=n.clone();for(var r=0,l=s.length;r<l;r++){var o=s[r];if(t.call(i,o,r,e)===false)break}}},getColumn:function(e){var t=typeof e;if(t=="number")return this.getBottomColumns()[e];else if(t=="object")return e;else{return this._nameColumns[e]}},getColumnByField:function(e){if(!e)return;var t=this.getBottomColumns();for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.field==e)return s}return s},_getColumnById:function(e){return this._idColumns[e]},getParentColumn:function(e){e=this.getColumn(e);var t=e._pid;if(t==-1)return this;return this._idColumns[t]},getAncestorColumns:function(e){var t=[];while(1){var i=this.getParentColumn(e);if(!i||i==this)break;t[t.length]=i;e=i}t.reverse();return t},isAncestorColumn:function(e,t){if(e==t)return true;if(!e||!t)return false;var i=this.getAncestorColumns(t);for(var n=0,s=i.length;n<s;n++){if(i[n]==e)return true}return false},isVisibleColumn:function(e){e=this.getColumn(e);var t=this.getAncestorColumns(e);for(var i=0,n=t.length;i<n;i++){if(t[i].visible==false)return false}return true},updateColumn:function(e,t){e=this.getColumn(e);if(!e)return;mini.copyTo(e,t);this.setColumns(this.columns)},removeColumn:function(e){e=this.getColumn(e);var t=this.getParentColumn(e);if(e&&t){t.columns.remove(e);this.setColumns(this.columns)}return e},moveColumn:function(e,t,i){e=this.getColumn(e);t=this.getColumn(t);if(!e||!t||!i||e==t)return;if(this.isAncestorColumn(e,t)){return}var n=this.getParentColumn(e);if(n){n.columns.remove(e)}var s=t;var r=i;if(r=="before"){s=this.getParentColumn(t);r=s.columns.indexOf(t)}else if(r=="after"){s=this.getParentColumn(t);r=s.columns.indexOf(t)+1}else if(r=="add"||r=="append"){if(!s.columns)s.columns=[];r=s.columns.length}else if(!mini.isNumber(r)){return}s.columns.insert(r,e);this.setColumns(this.columns)},hideColumns:function(e){if(this.allowCellEdit){this.commitEdit()}for(var t=0,i=e.length;t<i;t++){var n=this.getColumn(e[t]);if(!n)continue;n.visible=false}this.setColumns(this.columns)},showColumns:function(e){if(this.allowCellEdit){this.commitEdit()}for(var t=0,i=e.length;t<i;t++){var n=this.getColumn(e[t]);if(!n)continue;n.visible=true}this.setColumns(this.columns)},hideColumn:function(e){e=this.getColumn(e);if(!e)return;if(this.allowCellEdit){this.commitEdit()}e.visible=false;this.setColumns(this.columns)},showColumn:function(e){e=this.getColumn(e);if(!e)return;if(this.allowCellEdit){this.commitEdit()}e.visible=true;this.setColumns(this.columns)},getColumnRows:function(){var e=this.getMaxColumnLevel();var t=[];for(var i=0,n=e;i<=n;i++){t.push([])}function s(e){var t=mini.treeToArray(e.columns,"columns");var i=0;for(var n=0,s=t.length;n<s;n++){var r=t[n];if(r.visible!=true||r._hide==true)continue;if(!r.columns||r.columns.length==0){i+=1}}return i}var r=mini.treeToArray(this.columns,"columns");for(var i=0,n=r.length;i<n;i++){var l=r[i];var o=t[l.level];if(l.columns&&l.columns.length>0){l.colspan=s(l)}if((!l.columns||l.columns.length==0)&&l.level<e){l.rowspan=e-l.level+1}o.push(l)}return t},getMaxColumnLevel:function(){return this.maxColumnLevel},getPrint:function(e){var t=new mini.DataGrid_Print(this,e);return t}};mini.copyTo(mini.DataGrid.prototype,mini_Column_Prototype);mini._GridSort=function(e){this.grid=e;mini.on(e._headerEl,"mousemove",this.__OnGridHeaderMouseMove,this);mini.on(e._headerEl,"mouseout",this.__OnGridHeaderMouseOut,this)};mini._GridSort.prototype={destroy:function(e){if(this._focusedColumnEl){mini.clearEvent(this._focusedColumnEl);var t=this._focusedColumnEl.parentNode;if(t)t.removeChild(this._focusedColumnEl);this._focusedColumnEl=null}},__OnGridHeaderMouseOut:function(e){if(this._focusedColumnEl){mini.removeClass(this._focusedColumnEl,"mini-grid-headerCell-hover")}},__OnGridHeaderMouseMove:function(e){var t=mini.findParent(e.target,"mini-grid-headerCell");if(t){mini.addClass(t,"mini-grid-headerCell-hover");this._focusedColumnEl=t}},__onGridHeaderCellClick:function(e){}};mini._ColumnSplitter=function(e){this.grid=e;mini.on(this.grid.el,"mousedown",this.__onGridMouseDown,this);e.on("layout",this.__OnGridLayout,this)};mini._ColumnSplitter.prototype={destroy:function(e){if(this.splittersEl){mini.clearEvent(this.splittersEl);mini.removeNode(this.splittersEl);this.splittersEl=null}if(this.drag){this.drag.destroy();this.drag=null}},__OnGridLayout:function(e){if(this.splittersEl)mini.removeNode(this.splittersEl);if(this.splitterTimer)return;var t=this.grid;if(t.isDisplay()==false)return;var i=this;this.splitterTimer=setTimeout(function(){var e=t.getBottomColumns();var n=e.length;var s=mini.getBox(t._headerEl,true);var r=t.getScrollLeft();var l=[];for(var o=0,a=e.length;o<a;o++){var h=e[o];var u=t.getColumnBox(h);if(!u)break;var d=u.top-s.top;var c=u.right-s.left-2;var f=u.height;if(t.isFrozen&&t.isFrozen()){if(o>=t.frozenStartColumn){}}else{c+=r}var m=t.getParentColumn(h);if(m&&m.columns){if(m.columns[m.columns.length-1]==h){if(f+5<s.height){d=0;f=s.height}}}if(t.allowResizeColumn&&h.allowResize){l[l.length]='<div id="'+h._id+'" class="mini-grid-splitter" style="left:'+(c-1)+"px;top:"+d+"px;height:"+f+'px;"></div>'}}var p=l.join("");i.splittersEl=document.createElement("div");i.splittersEl.className="mini-grid-splitters";i.splittersEl.innerHTML=p;var g=t._getHeaderScrollEl();g.appendChild(i.splittersEl);i.splitterTimer=null},100)},__onGridMouseDown:function(e){var t=this.grid;var i=e.target;if(mini.hasClass(i,"mini-grid-splitter")){var n=t._idColumns[i.id];if(t.allowResizeColumn&&n&&n.allowResize){this.splitterColumn=n;this.getDrag().start(e)}}},getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(e){var t=this.grid;var i=t.getColumnBox(this.splitterColumn);this.columnBox=i;this._dragProxy=mini.append(document.body,'<div class="mini-grid-proxy"></div>');var n=t.getBox(true);n.x=i.x;n.width=i.width;n.right=i.right;mini.setBox(this._dragProxy,n)},_OnDragMove:function(e){var t=this.grid;var i=mini.copyTo({},this.columnBox);var n=i.width+(e.now[0]-e.init[0]);if(n<t.columnMinWidth)n=t.columnMinWidth;if(n>t.columnMaxWidth)n=t.columnMaxWidth;mini.setWidth(this._dragProxy,n)},_OnDragStop:function(e){this.columnBox=null;var t=this.grid;var i=mini.getBox(this._dragProxy);var n=this;var s=t.allowSortColumn;t.allowSortColumn=false;setTimeout(function(){jQuery(n._dragProxy).remove();n._dragProxy=null;t.allowSortColumn=s},10);var r=this.splitterColumn;var l=parseInt(r.width);if(l+"%"!=r.width){var o=t.getColumnWidth(r);var a=parseInt(l/o*i.width);t.setColumnWidth(r,a)}}};mini._ColumnMove=function(e){this.grid=e;mini.on(this.grid.el,"mousedown",this.__onGridMouseDown,this)};mini._ColumnMove.prototype={destroy:function(e){if(this.drag){this.drag.destroy();this.drag=null}},__onGridMouseDown:function(e){var t=this.grid;if(t.isEditing&&t.isEditing())return;if(mini.hasClass(e.target,"mini-grid-splitter"))return;if(e.button==mini.MouseButton.Right)return;var i=mini.findParent(e.target,t._headerCellCls);if(i){this._remove();var n=t._getColumnByEvent(e);if(t.allowMoveColumn&&n&&n.allowMove){this.dragColumn=n;this._columnEl=i;this.getDrag().start(e)}}},getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:false,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(e){function t(e){var t=e.header;if(typeof t=="function")t=t.call(i,e);if(mini.isNull(t)||t==="")t="&nbsp;";return t}var i=this.grid;this._dragProxy=mini.append(document.body,'<div class="mini-grid-columnproxy"></div>');this._dragProxy.innerHTML='<div class="mini-grid-columnproxy-inner" style="height:26px;">'+t(this.dragColumn)+"</div>";mini.setXY(this._dragProxy,e.now[0]+15,e.now[1]+18);mini.addClass(this._dragProxy,"mini-grid-no");this.moveTop=mini.append(document.body,'<div class="mini-grid-movetop"></div>');this.moveBottom=mini.append(document.body,'<div class="mini-grid-movebottom"></div>')},_OnDragMove:function(e){var t=this.grid;var i=e.now[0];mini.setXY(this._dragProxy,i+15,e.now[1]+18);this.targetColumn=this.insertAction=null;var n=mini.findParent(e.event.target,t._headerCellCls);if(n){var s=t._getColumnByEvent(e.event);if(s&&s!=this.dragColumn){var r=t.getParentColumn(this.dragColumn);var l=t.getParentColumn(s);if(r==l){this.targetColumn=s;this.insertAction="before";var o=t.getColumnBox(this.targetColumn);if(i>o.x+o.width/2){this.insertAction="after"}}}}if(this.targetColumn){mini.addClass(this._dragProxy,"mini-grid-ok");mini.removeClass(this._dragProxy,"mini-grid-no");var a=t.getColumnBox(this.targetColumn);this.moveTop.style.display="block";this.moveBottom.style.display="block";if(this.insertAction=="before"){mini.setXY(this.moveTop,a.x-4,a.y-9);mini.setXY(this.moveBottom,a.x-4,a.bottom)}else{mini.setXY(this.moveTop,a.right-4,a.y-9);mini.setXY(this.moveBottom,a.right-4,a.bottom)}}else{mini.removeClass(this._dragProxy,"mini-grid-ok");mini.addClass(this._dragProxy,"mini-grid-no");this.moveTop.style.display="none";this.moveBottom.style.display="none"}},_remove:function(){var e=this.grid;mini.removeNode(this._dragProxy);mini.removeNode(this.moveTop);mini.removeNode(this.moveBottom);this._dragProxy=this.moveTop=this.moveBottom=this.dragColumn=this.targetColumn=null},_OnDragStop:function(e){var t=this.grid;t.moveColumn(this.dragColumn,this.targetColumn,this.insertAction);this._remove()}};mini._GridSelect=function(e){this.grid=e;this.grid.on("cellmousedown",this.__onGridCellMouseDown,this);
    this.grid.on("cellclick",this.__onGridCellClick,this);this.grid.on("celldblclick",this.__onGridCellClick,this);mini.on(this.grid.el,"keydown",this.__OnGridKeyDown,this)};mini._GridSelect.prototype={destroy:function(e){delete this.currentRecord},__OnGridKeyDown:function(e){var t=this.grid;if(mini.isAncestor(t._filterEl,e.target)||mini.isAncestor(t._summaryEl,e.target)||mini.isAncestor(t._footerEl,e.target)||mini.findParent(e.target,"mini-grid-detailRow")||mini.findParent(e.target,"mini-grid-rowEdit")){return}var i=t.getCurrentCell();if(e.shiftKey||e.ctrlKey||e.altKey){return}if(e.keyCode==37||e.keyCode==38||e.keyCode==39||e.keyCode==40){e.preventDefault()}var n=t.getBottomVisibleColumns();var s=i?i[1]:null,r=i?i[0]:null;if(!i)r=t.getCurrent();var l=n.indexOf(s);var o=t.indexOf(r);var a=t.getData().length;switch(e.keyCode){case 9:if(t.allowCellEdit&&t.editOnTabKey){e.preventDefault();t._beginEditNextCell(e.shiftKey==false);return}break;case 27:break;case 13:if(t.allowCellEdit&&t.editNextOnEnterKey){if(t.isEditingCell(i)||!s.editor){t._beginEditNextCell(e.shiftKey==false);return}}if(t.allowCellEdit&&i&&!s.readOnly){t.beginEditCell()}break;case 37:if(s){if(l>0){l-=1}}else{l=0}break;case 38:if(r){if(o>0)o-=1}else{o=0}if(o!=0&&t.isVirtualScroll()){if(t._viewRegion.start>o){t._bodyEl.scrollTop-=t._rowHeight;t._tryUpdateScroll()}}break;case 39:if(s){if(l<n.length-1){l+=1}}else{l=0}break;case 40:if(r){if(o<a-1)o+=1}else{o=0}if(t.isVirtualScroll()){if(t._viewRegion.end<o){t._bodyEl.scrollTop+=t._rowHeight;t._tryUpdateScroll()}}break;default:break}s=n[l];r=t.getAt(o);if(s&&r&&t.allowCellSelect){var i=[r,s];t.setCurrentCell(i);t.scrollIntoView(r,s)}if(!t.onlyCheckSelection){if(r&&t.allowRowSelect){t.deselectAll();t.setCurrent(r)}}},__onGridCellClick:function(e){var t=this.grid;if(t.allowCellEdit==false)return;if(this.grid.cellEditAction!=e.type)return;var i=e.record,n=e.column;if(!n.readOnly&&!this.grid.isReadOnly()){if(e.htmlEvent.shiftKey||e.htmlEvent.ctrlKey){}else{this.grid.beginEditCell()}}},__onGridCellMouseDown:function(e){var t=this;t.__doSelect(e)},__doSelect:function(e){var t=e.record,i=e.column;var n=this.grid;if(this.grid.allowCellSelect){var s=[t,i];this.grid.setCurrentCell(s)}if(n.onlyCheckSelection&&!i._multiRowSelect)return;if(n.allowRowSelect){if(n.multiSelect){this.grid.el.onselectstart=function(){};if(e.htmlEvent.shiftKey){this.grid.el.onselectstart=function(){return false};e.htmlEvent.preventDefault();if(!this.currentRecord){this.grid.select(t);this.currentRecord=this.grid.getSelected()}else{if(this.currentRecord._index==t._index){return}var r=this.currentRecord._index;var l=t._index;if(this.currentRecord._index>t._index){r=t._index;l=this.currentRecord._index}for(var o=r;o<=l;o++){if(!n.isSelected(o)){n.select(o)}}}}else{this.grid.el.onselectstart=function(){};if(e.htmlEvent.ctrlKey){this.grid.el.onselectstart=function(){return false};try{e.htmlEvent.preventDefault()}catch(a){}}if(e.column._multiRowSelect===true||e.htmlEvent.ctrlKey||n.allowUnselect){if(n.isSelected(t)){n.deselect(t)}else{n.select(t)}}else{if(n.isSelected(t)){}else{n.deselectAll();n.select(t)}}this.currentRecord=this.grid.getSelected()}}else{if(!n.isSelected(t)){n.deselectAll();n.select(t)}else{if(e.htmlEvent.ctrlKey){n.deselectAll()}}}}}};mini._CellToolTip=function(e){this.grid=e;mini.on(this.grid.el,"mousemove",this.__onGridMouseMove,this);mini.on(this.grid.el,"mouseout",this.__onGridMouseOut,this)};mini._CellToolTip.prototype={destroy:function(e){},__onGridMouseMove:function(e){var t=this.grid;var i=t._getCellByEvent(e);var n=t._getCellEl(i.record,i.column);var s=t.getCellError(i.record,i.column);if(n){if(s){n.title=s.errorText;return}if(n.firstChild){if(mini.hasClass(n.firstChild,"mini-grid-cell-inner")||mini.hasClass(n.firstChild,"mini-treegrid-treecolumn-inner")){n=n.firstChild}}if(i.column.showTitle!==false){var r=n.innerText||n.textContent||"";n.title=r.trim()}}},__onGridMouseOut:function(e){var t=this.grid;var i=t._getCellByEvent(e);var n=t._getCellEl(i.record,i.column);if(n){n.title=""}}};mini._ColumnsMenu=function(e){this.grid=e;this.menu=this.createMenu();mini.on(e.el,"contextmenu",this.__OnContextMenu,this)};mini._ColumnsMenu.prototype={destroy:function(e){if(this.arrowEl){mini.clearEvent(this.arrowEl);this.arrowEl.parentNode.removeChild(this.arrowEl);this.arrowEl=null}},createMenu:function(){var e=mini.create({type:"menu",hideOnClick:false});e.on("itemclick",this.__OnItemClick,this);return e},updateMenu:function(){var e=this.grid,t=this.menu;var i=e.getBottomColumns();var n=[];for(var s=0,r=i.length;s<r;s++){var l=i[s];var o={};o.checked=l.visible;o.checkOnClick=true;o.text=e._createHeaderText(l);if(o.text=="&nbsp;"){if(l.type=="indexcolumn")o.text="序号";if(l.type=="checkcolumn")o.text="选择"}n.push(o);o._column=l}t.setItems(n)},__OnContextMenu:function(e){var t=this.grid;if(t.showColumnsMenu==false)return;if(mini.isAncestor(t._headerEl,e.target)==false)return;this.updateMenu();this.menu.showAtPos(e.pageX,e.pageY);return false},__OnItemClick:function(e){var t=this.grid,i=this.menu;var n=t.getBottomColumns();var s=i.getItems();var r=e.item,l=r._column;var o=0;for(var a=0,h=s.length;a<h;a++){var u=s[a];if(u.getChecked())o++}if(o<1){r.setChecked(true)}var d=r.getChecked();if(d)t.showColumn(l);else t.hideColumn(l)}};mini_CellValidator_Prototype={getCellErrors:function(){var e=this._cellErrors.clone();var t=this.data;for(var i=0,n=e.length;i<n;i++){var s=e[i];var r=s.record;var l=s.column;if(t.indexOf(r)==-1){var o=r[this._rowIdField]+"$"+l._id;delete this._cellMapErrors[o];this._cellErrors.remove(s)}}return this._cellErrors},getCellError:function(e,t){e=this.getNode?this.getNode(e):this._getRow(e);t=this.getColumn(t);if(!e||!t)return;var i=e[this._rowIdField]+"$"+t._id;return this._cellMapErrors[i]},isValid:function(){return this.getCellErrors().length==0},validate:function(){var e=this.data;for(var t=0,i=e.length;t<i;t++){var n=e[t];this.validateRow(n)}},validateRow:function(e){var t=this.getBottomColumns();for(var i=0,n=t.length;i<n;i++){var s=t[i];this.validateCell(e,s)}},validateCell:function(e,t){e=this.getNode?this.getNode(e):this._getRow(e);t=this.getColumn(t);if(!e||!t)return;var i={record:e,row:e,node:e,column:t,field:t.field,value:e[t.field],isValid:true,errorText:""};if(t.vtype){mini._ValidateVType(t.vtype,i.value,i,t)}if(i.isValid==true&&t.unique&&t.field){var n={};var s=this.data,r=t.field;for(var l=0,o=s.length;l<o;l++){var a=s[l];var h=a[r];if(mini.isNull(h)||h===""){}else{var u=n[h];if(u&&a==e){i.isValid=false;i.errorText=mini._getErrorText(t,"uniqueErrorText");this.setCellIsValid(u,t,i.isValid,i.errorText);break}n[h]=a}}}this.fire("cellvalidation",i);this.setCellIsValid(e,t,i.isValid,i.errorText)},setIsValid:function(e){if(e){var t=this._cellErrors.clone();for(var i=0,n=t.length;i<n;i++){var s=t[i];this.setCellIsValid(s.record,s.column,true)}}},_removeRowError:function(e){var t=this.getColumns();for(var i=0,n=t.length;i<n;i++){var s=t[i];var r=e[this._rowIdField]+"$"+s._id;var l=this._cellMapErrors[r];if(l){delete this._cellMapErrors[r];this._cellErrors.remove(l)}}},setCellIsValid:function(e,t,i,n){e=this.getNode?this.getNode(e):this._getRow(e);t=this.getColumn(t);if(!e||!t)return;var s=e[this._rowIdField]+"$"+t._id;var r=this._getCellEl(e,t);var l=this._cellMapErrors[s];delete this._cellMapErrors[s];this._cellErrors.remove(l);if(i===true){if(r&&l){mini.removeClass(r,"mini-grid-cell-error")}}else{l={record:e,column:t,isValid:i,errorText:n};this._cellMapErrors[s]=l;this._cellErrors.add(l);if(r){mini.addClass(r,"mini-grid-cell-error")}}}};mini.copyTo(mini.DataGrid.prototype,mini_CellValidator_Prototype);mini.DataGrid_Print=function(e,t){this.grid=e;this.config=mini.copyTo({printColumn:null,columnWidth:null},t)};mini.DataGrid_Print.prototype={getHtml:function(){var e='<table class="datagrid-print-table">'+this._createHead()+this._createBody()+"</table>";return e},setColumn:function(e){this.config.printColumn=e},setColumnWidth:function(e){this.config.columnWidth=e},_createHead:function(){var e="#mini-grid-table-head"+this.grid.getId();this.$printHeadTable=$(e).clone();this._removeHeanUnUseable();var t=this.$printHeadTable.html();return t},_createBody:function(){var e="#mini-grid-table-body"+this.grid.getId();this.$printBodyTable=$(e).clone();this._removeBodyUnUseable();var t=this.$printBodyTable.html();return t},_removeBodyUnUseable:function(){this.$printBodyTable.find("tr:first").remove();this.$printBodyTable.find("td").each(function(){$(this).removeAttr("id");$(this).removeAttr("class");$(this).removeAttr("style")});this.$printBodyTable.find("tr").each(function(){$(this).removeAttr("id");$(this).removeAttr("class");$(this).removeAttr("style")})},_removeHeanUnUseable:function(){this.$printHeadTable.find("tr:first").remove();this.$printHeadTable.find("td").each(function(){$(this).removeAttr("id");$(this).removeAttr("class");$(this).removeAttr("style")});this.$printHeadTable.find("tr").each(function(){$(this).removeAttr("id");$(this).removeAttr("class");$(this).removeAttr("style")})}};mini.RadioButtonList=function(){mini.RadioButtonList.superclass.constructor.call(this)};mini.extend(mini.RadioButtonList,mini.CheckBoxList,{multiSelect:false,_itemCls:"mini-radiobuttonlist-item",_itemHoverCls:"mini-radiobuttonlist-item-hover",_itemSelectedCls:"mini-radiobuttonlist-item-selected",_tableCls:"mini-radiobuttonlist-table",_tdCls:"mini-radiobuttonlist-td",_checkType:"radio",uiCls:"mini-radiobuttonlist"});mini.regClass(mini.RadioButtonList,"radiobuttonlist");mini.Spinner=function(){mini.Spinner.superclass.constructor.call(this);this.setValue(this.minValue,false)};mini.extend(mini.Spinner,mini.ButtonEdit,{value:0,minValue:0,maxValue:100,increment:1,decimalPlaces:0,changeOnMousewheel:true,allowLimitValue:true,set:function(e){if(typeof e=="string"){return this}var t=e.value;delete e.value;mini.Spinner.superclass.set.call(this,e);if(!mini.isNull(t)){this.setValue(t,this.defaultValueTriggerChange)}return this},uiCls:"mini-spinner",_getButtonHtml:function(){var e="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" "+"onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+e+'><span class="mini-buttonedit-up"><span></span></span><span class="mini-buttonedit-down"><span></span></span></span>'},_initEvents:function(){mini.Spinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this)},this)},_ValueLimit:function(){if(this.allowLimitValue==false)return;if(this.minValue>this.maxValue){this.maxValue=this.minValue+100}if(this.value<this.minValue){this.setValue(this.minValue,false)}if(this.value>this.maxValue){this.setValue(this.maxValue,false)}},getFormValue:function(){var e=this.value;e=parseFloat(e);if(isNaN(e))e=0;var t=String(e).split(".");var i=t[0],n=t[1];if(!n)n="";if(this.decimalPlaces>0){for(var s=n.length,r=this.decimalPlaces;s<r;s++){n+="0"}n="."+n}return i+n},setValue:function(e,t){e=parseFloat(e);if(isNaN(e))e=this.defaultValue;e=parseFloat(e);if(isNaN(e))e=this.minValue;e=parseFloat(e.toFixed(this.decimalPlaces));if(!mini.isEquals(this.value,e)){this.value=e;this._ValueLimit();this._valueEl.value=this.value;this.text=this._textEl.value=this.getFormValue();if(t===undefined)t=true;if(t)this._OnValueChanged()}else{this.text=this._textEl.value=this.getFormValue()}},setMaxValue:function(e){e=parseFloat(e);if(isNaN(e))return;e=parseFloat(e.toFixed(this.decimalPlaces));if(this.maxValue!=e){this.maxValue=e;this._ValueLimit()}},getMaxValue:function(e){return this.maxValue},setMinValue:function(e){e=parseFloat(e);if(isNaN(e))return;e=parseFloat(e.toFixed(this.decimalPlaces));if(this.minValue!=e){this.minValue=e;this._ValueLimit()}},getMinValue:function(e){return this.minValue},setIncrement:function(e){e=parseFloat(e);if(isNaN(e))return;if(this.increment!=e){this.increment=e}},getIncrement:function(e){return this.increment},setDecimalPlaces:function(e){e=parseInt(e);if(isNaN(e)||e<0)return;this.decimalPlaces=e},getDecimalPlaces:function(e){return this.decimalPlaces},setChangeOnMousewheel:function(e){this.changeOnMousewheel=e},getChangeOnMousewheel:function(e){return this.changeOnMousewheel},setAllowLimitValue:function(e){this.allowLimitValue=e},getAllowLimitValue:function(e){return this.allowLimitValue},_SpinTimer:null,_StartSpin:function(e,t,i){this._StopSpin();this.setValue(this.value+e,false);var n=this;var s=i;var r=new Date;this._SpinTimer=setInterval(function(){n.setValue(n.value+e,false);i--;if(i==0&&t>50){n._StartSpin(e,t-100,s+3)}var l=new Date;if(l-r>500)n._StopSpin();r=l},t);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(e){this._DownValue=this.getValue();this.__OnInputTextChanged();if(e.spinType=="up"){this._StartSpin(this.increment,230,2)}else{this._StartSpin(-this.increment,230,2)}},__OnInputKeyDown:function(e){mini.Spinner.superclass.__OnInputKeyDown.call(this,e);var t=mini.Keyboard;switch(e.keyCode){case t.Top:this.setValue(this.value+this.increment);break;case t.Bottom:this.setValue(this.value-this.increment);break}},__OnMousewheel:function(e){if(this.isReadOnly())return;if(this.changeOnMousewheel==false)return;var t=e.wheelDelta||e.originalEvent.wheelDelta;if(mini.isNull(t))t=-e.detail*24;var i=this.increment;if(t<0)i=-i;this.setValue(this.value+i);return false},_OnDocumentMouseUp:function(e){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this);if(this._DownValue!=this.getValue()){this._OnValueChanged()}},__OnInputTextChanged:function(e){var t=this.getValue();var i=parseFloat(this._textEl.value);this.setValue(i)},getAttrs:function(e){var t=mini.Spinner.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["minValue","maxValue","increment","decimalPlaces","changeOnMousewheel"]);mini._ParseBool(e,t,["allowLimitValue"]);return t}});mini.regClass(mini.Spinner,"spinner");mini.SplitButton=function(){mini.SplitButton.superclass.constructor.call(this)};mini.extend(mini.SplitButton,mini.MenuButton,{uiCls:"mini-splitbutton",allowCls:"mini-button-split"});mini.regClass(mini.SplitButton,"splitbutton");mini.Splitter=function(){this._initPanes();mini.Splitter.superclass.constructor.call(this)};mini.extend(mini.Splitter,mini.Control,{width:300,height:180,vertical:false,allowResize:true,pane1:null,pane2:null,showHandleButton:true,handlerStyle:"",handlerCls:"",handlerSize:5,uiCls:"mini-splitter",_create:function(){this.el=document.createElement("div");this.el.className="mini-splitter";this.el.innerHTML='<div class="mini-splitter-border"><div id="1" class="mini-splitter-pane mini-splitter-pane1"></div><div id="2" class="mini-splitter-pane mini-splitter-pane2"></div><div class="mini-splitter-handler"></div></div>';this._borderEl=this.el.firstChild;this._pane1El=this._borderEl.firstChild;this._pane2El=this._borderEl.childNodes[1];this._handlerEl=this._borderEl.lastChild},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this)},this)},_initPanes:function(){this.pane1={id:"",index:1,minSize:30,maxSize:3e3,size:"",showCollapseButton:false,cls:"",style:"",visible:true,expanded:true};this.pane2=mini.copyTo({},this.pane1);this.pane2.index=2},doUpdate:function(){this.doLayout()},doLayout:function(){if(!this.canLayout())return;this._handlerEl.style.cursor=this.allowResize?"":"default";mini.removeClass(this.el,"mini-splitter-vertical");if(this.vertical){mini.addClass(this.el,"mini-splitter-vertical")}mini.removeClass(this._pane1El,"mini-splitter-pane1-vertical");mini.removeClass(this._pane2El,"mini-splitter-pane2-vertical");if(this.vertical){mini.addClass(this._pane1El,"mini-splitter-pane1-vertical");mini.addClass(this._pane2El,"mini-splitter-pane2-vertical")}mini.removeClass(this._handlerEl,"mini-splitter-handler-vertical");if(this.vertical){mini.addClass(this._handlerEl,"mini-splitter-handler-vertical")}var e=this.getHeight(true);var t=this.getWidth(true);if(!jQuery.boxModel){var i=mini.getBorders(this._borderEl);e=e+i.top+i.bottom;t=t+i.left+i.right}this._borderEl.style.width=t+"px";this._borderEl.style.height=e+"px";var n=this._pane1El,s=this._pane2El;var r=jQuery(n),l=jQuery(s);n.style.display=s.style.display=this._handlerEl.style.display="";var o=this.handlerSize;this.pane1.size=String(this.pane1.size);this.pane2.size=String(this.pane2.size);var a=parseFloat(this.pane1.size),h=parseFloat(this.pane2.size);var u=isNaN(a),d=isNaN(h);var c=!isNaN(a)&&this.pane1.size.indexOf("%")!=-1;var f=!isNaN(h)&&this.pane2.size.indexOf("%")!=-1;var m=!u&&!c;var p=!d&&!f;var g=this.vertical?e-this.handlerSize:t-this.handlerSize;var v=p2Size=0;if(u||d){if(u&&d){v=parseInt(g/2);p2Size=g-v}else if(m){v=a;p2Size=g-v}else if(c){v=parseInt(g*a/100);p2Size=g-v}else if(p){p2Size=h;v=g-p2Size}else if(f){p2Size=parseInt(g*h/100);v=g-p2Size}}else if(c&&p){p2Size=h;v=g-p2Size}else if(m&&f){v=a;p2Size=g-v}else{var _=a+h;v=parseInt(g*a/_);p2Size=g-v}if(v>this.pane1.maxSize){v=this.pane1.maxSize;p2Size=g-v}if(p2Size>this.pane2.maxSize){p2Size=this.pane2.maxSize;v=g-p2Size}if(v<this.pane1.minSize){v=this.pane1.minSize;p2Size=g-v}if(p2Size<this.pane2.minSize){p2Size=this.pane2.minSize;v=g-p2Size}if(this.pane1.expanded==false){p2Size=g;v=0;n.style.display="none"}else if(this.pane2.expanded==false){v=g;p2Size=0;s.style.display="none"}if(this.pane1.visible==false){p2Size=g+o;v=o=0;n.style.display="none";this._handlerEl.style.display="none"}else if(this.pane2.visible==false){v=g+o;p2Size=o=0;s.style.display="none";this._handlerEl.style.display="none"}if(this.vertical){mini.setWidth(n,t);mini.setWidth(s,t);mini.setHeight(n,v);mini.setHeight(s,p2Size);s.style.top=v+o+"px";this._handlerEl.style.left="0px";this._handlerEl.style.top=v+"px";mini.setWidth(this._handlerEl,t);mini.setHeight(this._handlerEl,this.handlerSize);n.style.left="0px";s.style.left="0px"}else{mini.setWidth(n,v);mini.setWidth(s,p2Size);mini.setHeight(n,e);mini.setHeight(s,e);s.style.left=v+o+"px";this._handlerEl.style.top="0px";this._handlerEl.style.left=v+"px";mini.setWidth(this._handlerEl,this.handlerSize);mini.setHeight(this._handlerEl,e);n.style.top="0px";s.style.top="0px"}var y='<div class="mini-splitter-handler-buttons">';if(!this.pane1.expanded||!this.pane2.expanded){if(!this.pane1.expanded){if(this.pane1.showCollapseButton){y+='<a id="1" class="mini-splitter-pane2-button"></a>'}}else{if(this.pane2.showCollapseButton){y+='<a id="2" class="mini-splitter-pane1-button"></a>'}}}else{if(this.pane1.showCollapseButton){y+='<a id="1" class="mini-splitter-pane1-button"></a>'}if(this.allowResize){if(!this.pane1.showCollapseButton&&!this.pane2.showCollapseButton){y+='<span class="mini-splitter-resize-button"></span>'}}if(this.pane2.showCollapseButton){y+='<a id="2" class="mini-splitter-pane2-button"></a>'}}y+="</div>";this._handlerEl.innerHTML=y;var w=this._handlerEl.firstChild;w.style.display=this.showHandleButton?"":"none";var C=mini.getBox(w);if(this.vertical){w.style.marginLeft=-C.width/2+"px"}else{w.style.marginTop=-C.height/2+"px"}if(!this.pane1.visible||!this.pane2.visible||!this.pane1.expanded||!this.pane2.expanded){mini.addClass(this._handlerEl,"mini-splitter-nodrag")}else{mini.removeClass(this._handlerEl,"mini-splitter-nodrag")}mini.layout(this._borderEl);this.fire("layout")},getPaneBox:function(e){var t=this.getPaneEl(e);if(!t)return null;return mini.getBox(t)},getPane:function(e){if(e==1)return this.pane1;else if(e==2)return this.pane2;return e},setPanes:function(e){if(!mini.isArray(e))return;for(var t=0;t<2;t++){var i=e[t];this.updatePane(t+1,i)}},setPaneControls:function(e,t){var i=this.getPane(e);if(!i)return;var n=this.getPaneEl(e);__mini_setControls(t,n,this)},getPaneEl:function(e){if(e==1)return this._pane1El;return this._pane2El},updatePane:function(e,t){var i=this.getPane(e);if(!i)return;mini.copyTo(i,t);var n=this.getPaneEl(e);var s=i.body;delete i.body;if(s){if(!mini.isArray(s))s=[s];for(var r=0,l=s.length;r<l;r++){mini.append(n,s[r])}}if(i.bodyParent){var o=i.bodyParent;while(o.firstChild){n.appendChild(o.firstChild)}}delete i.bodyParent;n.id=i.id;mini.setStyle(n,i.style);mini.addClass(n,i["class"]);if(i.controls){var e=i==this.pane1?1:2;this.setPaneControls(e,i.controls);delete i.controls}this.doUpdate()},setShowHandleButton:function(e){this.showHandleButton=e;this.doUpdate()},getShowHandleButton:function(e){return this.showHandleButton},setVertical:function(e){this.vertical=e;this.doUpdate()},getVertical:function(){return this.vertical},expandPane:function(e){var t=this.getPane(e);if(!t)return;t.expanded=true;this.doUpdate();var i={pane:t,paneIndex:this.pane1==t?1:2};this.fire("expand",i)},collapsePane:function(e){var t=this.getPane(e);if(!t)return;t.expanded=false;var i=t==this.pane1?this.pane2:this.pane1;if(i.expanded==false){i.expanded=true;i.visible=true}this.doUpdate();var n={pane:t,paneIndex:this.pane1==t?1:2};this.fire("collapse",n)},togglePane:function(e){var t=this.getPane(e);if(!t)return;if(t.expanded){this.collapsePane(t)}else{this.expandPane(t)}},showPane:function(e){var t=this.getPane(e);if(!t)return;t.visible=true;this.doUpdate()},hidePane:function(e){var t=this.getPane(e);if(!t)return;t.visible=false;var i=t==this.pane1?this.pane2:this.pane1;if(i.visible==false){i.expanded=true;i.visible=true}this.doUpdate()},setAllowResize:function(e){if(this.allowResize!=e){this.allowResize=e;this.doLayout()}},getAllowResize:function(){return this.allowResize},setHandlerSize:function(e){if(this.handlerSize!=e){this.handlerSize=e;this.doLayout()}},getHandlerSize:function(){return this.handlerSize},__OnClick:function(e){var t=e.target;if(!mini.isAncestor(this._handlerEl,t))return;var i=parseInt(t.id);var n=this.getPane(i);var e={pane:n,paneIndex:i,cancel:false};if(n.expanded){this.fire("beforecollapse",e)}else{this.fire("beforeexpand",e)}if(e.cancel==true)return;if(t.className=="mini-splitter-pane1-button"){this.togglePane(i)}else if(t.className=="mini-splitter-pane2-button"){this.togglePane(i)}},_OnButtonClick:function(e,t){this.fire("buttonclick",{pane:e,index:this.pane1==e?1:2,htmlEvent:t})},onButtonClick:function(e,t){this.on("buttonclick",e,t)},__OnMouseDown:function(e){var t=e.target;if(!this.allowResize)return;if(!this.pane1.visible||!this.pane2.visible||!this.pane1.expanded||!this.pane2.expanded){return}if(mini.isAncestor(this._handlerEl,t)){if(t.className=="mini-splitter-pane1-button"||t.className=="mini-splitter-pane2-button"){}else{var i=this._getDrag();i.start(e)}}},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(e){this._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask"></div>');this._dragProxy=mini.append(document.body,'<div class="mini-proxy"></div>');this._dragProxy.style.cursor=this.vertical?"n-resize":"w-resize";this.handlerBox=mini.getBox(this._handlerEl);this.elBox=mini.getBox(this._borderEl,true);mini.setBox(this._dragProxy,this.handlerBox)},_OnDragMove:function(e){if(!this.handlerBox)return;if(!this.elBox)this.elBox=mini.getBox(this._borderEl,true);var t=this.elBox.width,i=this.elBox.height;var n=this.handlerSize;var s=this.vertical?i-this.handlerSize:t-this.handlerSize;var r=this.pane1.minSize,l=this.pane1.maxSize;var o=this.pane2.minSize,a=this.pane2.maxSize;if(this.vertical==true){var h=e.now[1]-e.init[1];var u=this.handlerBox.y+h;if(u-this.elBox.y>l)u=this.elBox.y+l;if(u+this.handlerBox.height<this.elBox.bottom-a){u=this.elBox.bottom-a-this.handlerBox.height}if(u-this.elBox.y<r)u=this.elBox.y+r;if(u+this.handlerBox.height>this.elBox.bottom-o){u=this.elBox.bottom-o-this.handlerBox.height}mini.setY(this._dragProxy,u)}else{var d=e.now[0]-e.init[0];var c=this.handlerBox.x+d;if(c-this.elBox.x>l)c=this.elBox.x+l;if(c+this.handlerBox.width<this.elBox.right-a){c=this.elBox.right-a-this.handlerBox.width}if(c-this.elBox.x<r)c=this.elBox.x+r;if(c+this.handlerBox.width>this.elBox.right-o){c=this.elBox.right-o-this.handlerBox.width}mini.setX(this._dragProxy,c)}},_OnDragStop:function(e){var t=this.elBox.width,i=this.elBox.height;var n=this.handlerSize;var s=parseFloat(this.pane1.size),r=parseFloat(this.pane2.size);var l=isNaN(s),o=isNaN(r);var a=!isNaN(s)&&this.pane1.size.indexOf("%")!=-1;var h=!isNaN(r)&&this.pane2.size.indexOf("%")!=-1;var u=!l&&!a;var d=!o&&!h;var c=this.vertical?i-this.handlerSize:t-this.handlerSize;var f=mini.getBox(this._dragProxy);var m=f.x-this.elBox.x,p=c-m;if(this.vertical){m=f.y-this.elBox.y;p=c-m}if(l||o){if(l&&o){s=parseFloat(m/c*100).toFixed(1);this.pane1.size=s+"%"}else if(u){s=m;this.pane1.size=s}else if(a){s=parseFloat(m/c*100).toFixed(1);this.pane1.size=s+"%"}else if(d){r=p;this.pane2.size=r}else if(h){r=parseFloat(p/c*100).toFixed(1);this.pane2.size=r+"%"}}else if(a&&d){this.pane2.size=p}else if(u&&h){this.pane1.size=m}else{this.pane1.size=parseFloat(m/c*100).toFixed(1);this.pane2.size=100-this.pane1.size}jQuery(this._dragProxy).remove();jQuery(this._maskProxy).remove();this._maskProxy=null;this._dragProxy=null;this.elBox=this.handlerBox=null;this.doLayout();this.fire("resize")},getAttrs:function(e){var t=mini.Splitter.superclass.getAttrs.call(this,e);mini._ParseBool(e,t,["allowResize","vertical","showHandleButton","onresize"]);mini._ParseInt(e,t,["handlerSize"]);var i=[];var n=mini.getChildNodes(e);for(var s=0,r=2;s<r;s++){var l=n[s];var o=jQuery(l);var a={};i.push(a);if(!l)continue;a.style=l.style.cssText;mini._ParseString(l,a,["cls","size","id","class"]);mini._ParseBool(l,a,["visible","expanded","showCollapseButton"]);mini._ParseInt(l,a,["minSize","maxSize","handlerSize"]);a.bodyParent=l}t.panes=i;return t}});mini.regClass(mini.Splitter,"splitter");mini.Tabs=function(){this._initTabs();mini.Tabs.superclass.constructor.call(this)};mini.extend(mini.Tabs,mini.Control,{activeIndex:-1,tabAlign:"left",tabPosition:"top",showBody:true,showHeader:true,nameField:"name",titleField:"title",urlField:"url",url:"",maskOnLoad:true,plain:true,bodyStyle:"",_tabHoverCls:"mini-tab-hover",_tabActiveCls:"mini-tab-active",set:function(e){if(typeof e=="string"){return this}var t=this._allowLayout;this._allowLayout=false;var i=e.activeIndex;delete e.activeIndex;var n=e.url;delete e.url;mini.Tabs.superclass.set.call(this,e);if(n){this.setUrl(n)}if(mini.isNumber(i)){this.setActiveIndex(i)}this._allowLayout=t;this.doLayout();return this},uiCls:"mini-tabs",_create:function(){this.el=document.createElement("div");this.el.className="mini-tabs";var e='<table class="mini-tabs-table" cellspacing="0" cellpadding="0"><tr style="width:100%;">'+"<td></td>"+'<td style="text-align:left;vertical-align:top;width:100%;"><div class="mini-tabs-bodys"></div></td>'+"<td></td>"+"</tr></table>";this.el.innerHTML=e;this._tableEl=this.el.firstChild;var t=this.el.getElementsByTagName("td");this._td1El=t[0];this._td2El=t[1];this._td3El=t[2];this._bodyEl=this._td2El.firstChild;this._borderEl=this._bodyEl;this.doUpdate()},destroy:function(e){this._tableEl=this._td1El=this._td2El=this._td3El=null;this._bodyEl=this._borderEl=this.headerEl=null;this.tabs=[];mini.Tabs.superclass.destroy.call(this,e)},_doClearElement:function(){mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");this._td1El.innerHTML="";this._td3El.innerHTML="";mini.removeChilds(this._td2El,this._bodyEl)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this)},this)},_initTabs:function(){this.tabs=[]},_TabID:1,createTab:function(e){var t=mini.copyTo({_id:this._TabID++,name:"",title:"",newLine:false,iconCls:"",iconStyle:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,enabled:true,showCloseButton:false,active:false,url:"",loaded:false,refreshOnClick:false},e);if(e){e=mini.copyTo(e,t);t=e}return t},_doLoad:function(){var e=mini.getData(this.url);if(this.dataField){e=mini._getMap(this.dataField,e)}if(!e)e=[];this.setTabs(e);this.fire("load")},load:function(e){if(typeof e=="string"){this.setUrl(e)}else{this.setTabs(e)}},setUrl:function(e){this.url=e;this._doLoad()},getUrl:function(){return this.url},setNameField:function(e){this.nameField=e},getNameField:function(){return this.nameField},setTitleField:function(e){this.titleField=e},getTitleField:function(){return this.titleField},setUrlField:function(e){this.urlField=e},getUrlField:function(){return this.urlField},setButtons:function(e){this._buttons=mini.byId(e);if(this._buttons){var t=mini.byClass("mini-tabs-buttons",this.el);if(t){t.appendChild(this._buttons);mini.parse(t);this.doLayout()}}},setTabControls:function(e,t){var e=this.getTab(e);if(!e)return;var i=this.getTabBodyEl(e);__mini_setControls(t,i,this)},setTabs:function(e){if(!mini.isArray(e))return;this.beginUpdate();this.removeAll();for(var t=0,i=e.length;t<i;t++){var n=e[t];n.title=mini._getMap(this.titleField,n);n.url=mini._getMap(this.urlField,n);n.name=mini._getMap(this.nameField,n)}for(var t=0,i=e.length;t<i;t++){this.addTab(e[t])}this.setActiveIndex(0);this.endUpdate()},getTabs:function(){return this.tabs},removeAll:function(e){var t=this.getActiveTab();if(mini.isNull(e))e=[];if(!mini.isArray(e)){e=[e]}for(var i=e.length-1;i>=0;i--){var n=this.getTab(e[i]);if(!n)e.removeAt(i);else e[i]=n}var s=this.tabs;for(var i=s.length-1;i>=0;i--){var r=s[i];if(e.indexOf(r)==-1){this.removeTab(r)}}var l=e[0];if(t!=this.getActiveTab()){if(l)this.activeTab(l)}},addTab:function(e,t){if(typeof e=="string"){e={title:e}}e=this.createTab(e);if(!e.name)e.name="";if(typeof t!="number")t=this.tabs.length;this.tabs.insert(t,e);var i=this._createTabBodyId(e);var n='<div id="'+i+'" class="mini-tabs-body '+e.bodyCls+'" style="'+e.bodyStyle+';display:none;"></div>';mini.append(this._bodyEl,n);var s=this.getTabBodyEl(e);var r=e.body;delete e.body;if(r){if(!mini.isArray(r))r=[r];for(var l=0,o=r.length;l<o;l++){mini.append(s,r[l])}}if(e.bodyParent){var a=e.bodyParent;while(a.firstChild){if(a.firstChild.nodeType==8){a.removeChild(a.firstChild)}else{s.appendChild(a.firstChild)}}}delete e.bodyParent;if(e.controls){this.setTabControls(e,e.controls);delete e.controls}this.doUpdate();return e},removeTab:function(e){e=this.getTab(e);if(!e||this.tabs.indexOf(e)==-1)return;var t=this.getActiveTab();var i=e==t;var n=this._OnTabDestroy(e);this.tabs.remove(e);this._doRemoveIFrame(e);var s=this.getTabBodyEl(e);if(s)this._bodyEl.removeChild(s);if(n&&i){for(var r=this.activeIndex;r>=0;r--){var e=this.getTab(r);if(e&&e.enabled&&e.visible){this.activeIndex=r;break}}this.doUpdate();this.setActiveIndex(this.activeIndex);this.fire("activechanged")}else{this.activeIndex=this.tabs.indexOf(t);this.doUpdate()}return e},moveTab:function(e,t){e=this.getTab(e);if(!e)return;var i=this.tabs[t];if(i==e)return;this.tabs.remove(e);var t=this.tabs.indexOf(i);if(t==-1){this.tabs.add(e)}else{this.tabs.insert(t,e)}this.doUpdate()},updateTab:function(e,t){e=this.getTab(e);if(!e)return;mini.copyTo(e,t);this.doUpdate()},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(e,t){if(e._iframeEl&&e._iframeEl.parentNode){e._iframeEl.onload=function(){};jQuery(e._iframeEl).unbind("load");e._iframeEl.src="";try{iframe.contentWindow.document.write("");iframe.contentWindow.document.close()}catch(i){}if(e._iframeEl._ondestroy)e._iframeEl._ondestroy();try{e._iframeEl.parentNode.removeChild(e._iframeEl);e._iframeEl.removeNode(true)}catch(i){}}e._iframeEl=null;e.loadedUrl=null;if(t===true){var n=this.getTabBodyEl(e);if(n){var s=mini.getChildNodes(n,true);for(var r=0,l=s.length;r<l;r++){var o=s[r];if(o&&o.parentNode)o.parentNode.removeChild(o)}}}},_deferLoadingTime:180,
    _cancelLoadTabs:function(e){var t=this.tabs;for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s!=e){if(s._loading&&s._iframeEl){s._loading=false;this._doRemoveIFrame(s,true)}}}if(e&&e==this.getActiveTab()&&e._loading){}else{this._loading=false;this.unmask()}},_doLoadTab:function(e){if(!e||e!=this.getActiveTab())return;var t=this.getTabBodyEl(e);if(!t)return;this._cancelLoadTabs();this._doRemoveIFrame(e,true);this._loading=true;e._loading=true;this.unmask();if(this.maskOnLoad)this.loading();var i=new Date;var n=this;n.isLoading=true;var s=mini.createIFrame(e.url,function(t,s){try{e._iframeEl.contentWindow.Owner=window;e._iframeEl.contentWindow.CloseOwnerWindow=function(t){e.removeAction=t;var i=true;if(e.ondestroy){if(typeof e.ondestroy=="string"){e.ondestroy=window[e.ondestroy]}if(e.ondestroy){i=e.ondestroy.call(this,r)}}if(i===false){return false}setTimeout(function(){n.removeTab(e)},10)}}catch(r){}if(e._loading!=true)return;var l=i-new Date+n._deferLoadingTime;e._loading=false;e.loadedUrl=e.url;if(l<0)l=0;setTimeout(function(){n.unmask();n.doLayout();n.isLoading=false},l);if(s){var r={sender:n,tab:e,index:n.tabs.indexOf(e),name:e.name,iframe:e._iframeEl};if(e.onload){if(typeof e.onload=="string"){e.onload=window[e.onload]}if(e.onload){e.onload.call(n,r)}}}if(n.getActiveTab()==e){n.fire("tabload",r)}});setTimeout(function(){if(e._iframeEl==s){t.appendChild(s)}},1);e._iframeEl=s},_OnTabDestroy:function(e){var t={sender:this,tab:e,index:this.tabs.indexOf(e),name:e.name,iframe:e._iframeEl,autoActive:true};this.fire("tabdestroy",t);return t.autoActive},loadTab:function(e,t,i,n){if(!e)return;t=this.getTab(t);if(!t)t=this.getActiveTab();if(!t)return;var s=this.getTabBodyEl(t);if(s){mini.addClass(s,"mini-tabs-hideOverflow")}t.url=e;delete t.loadedUrl;if(i)t.onload=i;if(n)t.ondestroy=n;var r=this;clearTimeout(this._loadTabTimer);this._loadTabTimer=null;this._loadTabTimer=setTimeout(function(){r._doLoadTab(t)},1)},reloadTab:function(e){e=this.getTab(e);if(!e)e=this.getActiveTab();if(!e)return;this.loadTab(e.url,e)},getTabRows:function(){var e=[];var t=[];for(var i=0,n=this.tabs.length;i<n;i++){var s=this.tabs[i];if(i!=0&&s.newLine){e.push(t);t=[]}t.push(s)}e.push(t);return e},doUpdate:function(){if(this._allowUpdate===false)return;if(this._buttons&&this._buttons.parentNode){this._buttons.parentNode.removeChild(this._buttons)}mini.removeClass(this.el,"mini-tabs-position-left");mini.removeClass(this.el,"mini-tabs-position-top");mini.removeClass(this.el,"mini-tabs-position-right");mini.removeClass(this.el,"mini-tabs-position-bottom");if(this.tabPosition=="bottom"){mini.addClass(this.el,"mini-tabs-position-bottom");this._doUpdateBottom()}else if(this.tabPosition=="right"){mini.addClass(this.el,"mini-tabs-position-right");this._doUpdateRight()}else if(this.tabPosition=="left"){mini.addClass(this.el,"mini-tabs-position-left");this._doUpdateLeft()}else{mini.addClass(this.el,"mini-tabs-position-top");this._doUpdateTop()}if(this._buttons){var e=mini.byClass("mini-tabs-buttons",this.el);if(e){e.appendChild(this._buttons);mini.parse(e)}}this.doLayout();this.setActiveIndex(this.activeIndex,false)},_handleIFrameOverflow:function(){var e=this.getTabBodyEl(this.activeIndex);if(e){mini.removeClass(e,"mini-tabs-hideOverflow");var t=mini.getChildNodes(e)[0];if(t&&t.tagName&&t.tagName.toUpperCase()=="IFRAME"){mini.addClass(e,"mini-tabs-hideOverflow")}}},doLayout:function(){if(!this.canLayout())return;this._headerEl.style.display=this.showHeader?"":"none";this._handleIFrameOverflow();var e=this.isAutoHeight();w=this.getHeight(true);N=this.getWidth();var t=w;var i=N;if(this.showBody){this._bodyEl.style.display=""}else{this._bodyEl.style.display="none"}if(this.plain){mini.addClass(this.el,"mini-tabs-plain")}else{mini.removeClass(this.el,"mini-tabs-plain")}if(!e&&this.showBody){var n=jQuery(this._headerEl).outerHeight();var s=jQuery(this._headerEl).outerWidth();if(this.tabPosition=="top"){n=jQuery(this._headerEl.parentNode).outerHeight()}if(this.tabPosition=="left"||this.tabPosition=="right"){N=N-s}else{w=w-n}if(jQuery.boxModel){var r=mini.getPaddings(this._bodyEl);var l=mini.getBorders(this._bodyEl);w=w-r.top-r.bottom-l.top-l.bottom;N=N-r.left-r.right-l.left-l.right}margin=mini.getMargins(this._bodyEl);w=w-margin.top-margin.bottom;N=N-margin.left-margin.right;if(w<0)w=0;if(N<0)N=0;if(this.tabPosition=="left"||this.tabPosition=="right"){var o=this._headerEl.getElementsByTagName("tr")[0];var a=o.childNodes;var h=a[0].getElementsByTagName("tr");var u=last=all=0;for(var d=0,c=h.length;d<c;d++){var o=h[d];var f=jQuery(o).outerHeight();all+=f;if(d==0)u=f;if(d==c-1)last=f}switch(this.tabAlign){case"center":var m=parseInt((t-(all-u-last))/2);for(var d=0,c=a.length;d<c;d++){a[d].firstChild.style.height=t+"px";var p=a[d].firstChild;var h=p.getElementsByTagName("tr");var g=h[0],v=h[h.length-1];g.style.height=m+"px";v.style.height=m+"px"}break;case"right":for(var d=0,c=a.length;d<c;d++){var p=a[d].firstChild;var h=p.getElementsByTagName("tr");var o=h[0];var _=t-(all-u);if(_>=0){o.style.height=_+"px"}}break;case"fit":for(var d=0,c=a.length;d<c;d++){a[d].firstChild.style.height=t+"px"}break;default:for(var d=0,c=a.length;d<c;d++){var p=a[d].firstChild;var h=p.getElementsByTagName("tr");var o=h[h.length-1];var _=t-(all-last);if(_>=0){o.style.height=_+"px"}}break}}}else{this._bodyEl.style.width="auto";this._bodyEl.style.height="auto"}var y=this.getTabBodyEl(this.activeIndex);if(y){if(!e&&this.showBody){var w=mini.getHeight(this._bodyEl,true);if(jQuery.boxModel){var r=mini.getPaddings(y);var l=mini.getBorders(y);w=w-r.top-r.bottom-l.top-l.bottom}y.style.height=w+"px"}else{y.style.height="auto"}}switch(this.tabPosition){case"bottom":var C=this._headerEl.childNodes;for(var d=0,c=C.length;d<c;d++){var p=C[d];mini.removeClass(p,"mini-tabs-header2");if(c>1&&d!=0){mini.addClass(p,"mini-tabs-header2")}}break;case"left":var a=this._headerEl.firstChild.rows[0].cells;for(var d=0,c=a.length;d<c;d++){var x=a[d];mini.removeClass(x,"mini-tabs-header2");if(c>1&&d==0){mini.addClass(x,"mini-tabs-header2")}}break;case"right":var a=this._headerEl.firstChild.rows[0].cells;for(var d=0,c=a.length;d<c;d++){var x=a[d];mini.removeClass(x,"mini-tabs-header2");if(c>1&&d!=0){mini.addClass(x,"mini-tabs-header2")}}break;default:var C=this._headerEl.childNodes;for(var d=0,c=C.length;d<c;d++){var p=C[d];mini.removeClass(p,"mini-tabs-header2");if(c>1&&d==0){mini.addClass(p,"mini-tabs-header2")}}break}mini.removeClass(this.el,"mini-tabs-scroll");var x=mini.byClass("mini-tabs-lastSpace",this.el);var b=mini.byClass("mini-tabs-buttons",this.el);var E=this._headerEl.parentNode;E.style["paddingRight"]="0px";if(this._navEl)this._navEl.style.display="none";if(b)b.style.display="none";mini.setWidth(E,i);if(this.tabPosition=="top"&&this.tabAlign=="left"){this._headerEl.style.width="auto";b.style.display="block";var T=i;var S=this._headerEl.firstChild.offsetWidth-x.offsetWidth;var I=b.firstChild?b.offsetWidth:0;if(S+I>T){this._navEl.style.display="block";this._navEl.style.right=I+"px";var k=this._navEl.offsetWidth;var N=T-I-k;mini.setWidth(this._headerEl,N)}}this._scrollToTab(this.activeIndex);this._doScrollButton();mini.layout(this._bodyEl);var O=this;var B=this.getActiveTab();if(B&&B.repaint&&y){var N=y.style.width;y.style.width="0px";setTimeout(function(){y.style.width=N},1)}this.fire("layout")},setTabAlign:function(e){this.tabAlign=e;this.doUpdate()},setTabPosition:function(e){this.tabPosition=e;this.doUpdate()},getTab:function(e){if(typeof e=="object")return e;if(typeof e=="number"){return this.tabs[e]}else{for(var t=0,i=this.tabs.length;t<i;t++){var n=this.tabs[t];if(n.name==e)return n}}},getHeaderEl:function(){return this._headerEl},getBodyEl:function(){return this._bodyEl},getTabEl:function(e){var t=this.getTab(e);if(!t)return null;var i=this._createTabId(t);var n=this.el.getElementsByTagName("*");for(var s=0,r=n.length;s<r;s++){var l=n[s];if(l.id==i)return l}return null},getTabBodyEl:function(e){var t=this.getTab(e);if(!t)return null;var i=this._createTabBodyId(t);var n=this._bodyEl.childNodes;for(var s=0,r=n.length;s<r;s++){var l=n[s];if(l.id==i)return l}return null},getTabIFrameEl:function(e){var t=this.getTab(e);if(!t)return null;return t._iframeEl},_createTabId:function(e){return this.uid+"$"+e._id},_createTabBodyId:function(e){return this.uid+"$body$"+e._id},_doScrollButton:function(){if(this.tabPosition=="top"){mini.removeClass(this._leftButtonEl,"mini-disabled");mini.removeClass(this._rightButtonEl,"mini-disabled");if(this._headerEl.scrollLeft==0){mini.addClass(this._leftButtonEl,"mini-disabled")}var e=this.getTabEl(this.tabs.length-1);if(e){var t=mini.getBox(e);var i=mini.getBox(this._headerEl);if(t.right<=i.right){mini.addClass(this._rightButtonEl,"mini-disabled")}}}},setActiveIndex:function(e,t){var i=this.getTab(e);var n=this.getTab(this.activeIndex);var s=i!=n;var r=this.getTabBodyEl(this.activeIndex);if(r)r.style.display="none";if(i){this.activeIndex=this.tabs.indexOf(i)}else{this.activeIndex=-1}var r=this.getTabBodyEl(this.activeIndex);if(r)r.style.display="";var r=this.getTabEl(n);if(r)mini.removeClass(r,this._tabActiveCls);var r=this.getTabEl(i);if(r)mini.addClass(r,this._tabActiveCls);if(r&&s){if(this.tabPosition=="bottom"){var l=mini.findParent(r,"mini-tabs-header");if(l){jQuery(this._headerEl).prepend(l)}}else if(this.tabPosition=="left"){var o=mini.findParent(r,"mini-tabs-header").parentNode;if(o){o.parentNode.appendChild(o)}}else if(this.tabPosition=="right"){var o=mini.findParent(r,"mini-tabs-header").parentNode;if(o){jQuery(o.parentNode).prepend(o)}}else{var l=mini.findParent(r,"mini-tabs-header");if(l){this._headerEl.appendChild(l)}}var a=this._headerEl.scrollLeft;this.doLayout();var h=this.getTabRows();if(h.length>1){}else{this._scrollToTab(this.activeIndex);this._doScrollButton()}for(var u=0,d=this.tabs.length;u<d;u++){var c=this.getTabEl(this.tabs[u]);if(c){mini.removeClass(c,this._tabHoverCls)}}}var f=this;if(s){var m={tab:i,index:this.tabs.indexOf(i),name:i?i.name:""};setTimeout(function(){f.fire("ActiveChanged",m)},1)}this._cancelLoadTabs(i);if(t!==false){if(i&&i.url&&!i.loadedUrl){var f=this;f.loadTab(i.url,i)}}else{}if(f.canLayout()){try{mini.layoutIFrames(f.el)}catch(m){}}},_scrollToTab:function(e){var t=this._headerEl.scrollLeft;if(this.tabPosition=="top"){this._headerEl.scrollLeft=t;var i=this.getTabEl(e);if(i){var n=this;var s=mini.getBox(i);var r=mini.getBox(n._headerEl);if(s.x<r.x){n._headerEl.scrollLeft-=r.x-s.x}else if(s.right>r.right){n._headerEl.scrollLeft+=s.right-r.right}}}},getActiveIndex:function(){return this.activeIndex},activeTab:function(e){this.setActiveIndex(e)},getActiveTab:function(){return this.getTab(this.activeIndex)},getActiveIndex:function(){return this.activeIndex},_tryActiveTab:function(e){e=this.getTab(e);if(!e)return;var t=this.tabs.indexOf(e);if(this.activeIndex==t)return;var i={tab:e,index:t,name:e.name,cancel:false};this.fire("BeforeActiveChanged",i);if(i.cancel==false){this.activeTab(e)}},setShowHeader:function(e){if(this.showHeader!=e){this.showHeader=e;this.doLayout()}},getShowHeader:function(){return this.showHeader},setShowBody:function(e){if(this.showBody!=e){this.showBody=e;this.doLayout()}},getShowBody:function(){return this.showBody},setBodyStyle:function(e){this.bodyStyle=e;mini.setStyle(this._bodyEl,e);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setMaskOnLoad:function(e){this.maskOnLoad=e},getMaskOnLoad:function(){return this.maskOnLoad},setPlain:function(e){this.plain=e;this.doLayout()},getPlain:function(){return this.plain},getTabByEvent:function(e){return this._getTabByEvent(e)},_getTabByEvent:function(e){var t=mini.findParent(e.target,"mini-tab");if(!t)return null;var i=t.id.split("$");if(i[0]!=this.uid)return null;var n=parseInt(jQuery(t).attr("index"));return this.getTab(n)},__OnClick:function(e){var t=this._getTabByEvent(e);if(!t)return;if(t.enabled){var i=this;setTimeout(function(){if(mini.findParent(e.target,"mini-tab-close")){i._OnCloseButtonClick(t,e)}else{var n=t.loadedUrl;i._tryActiveTab(t);if(t.refreshOnClick&&t.url==n){i.reloadTab(t)}}},10)}},hoverTab:null,__OnMouseOver:function(e){var t=this._getTabByEvent(e);if(t&&t.enabled){var i=this.getTabEl(t);mini.addClass(i,this._tabHoverCls);this.hoverTab=t}},__OnMouseOut:function(e){if(this.hoverTab){var t=this.getTabEl(this.hoverTab);mini.removeClass(t,this._tabHoverCls)}this.hoverTab=null},__OnMouseDown:function(e){clearInterval(this._scrollTimer);if(this.tabPosition=="top"){var t=this;var i=0,n=10;if(e.target==this._leftButtonEl){this._scrollTimer=setInterval(function(){t._headerEl.scrollLeft-=n;i++;if(i>5)n=18;if(i>10)n=25;t._doScrollButton()},25)}else if(e.target==this._rightButtonEl){this._scrollTimer=setInterval(function(){t._headerEl.scrollLeft+=n;i++;if(i>5)n=18;if(i>10)n=25;t._doScrollButton()},25)}mini.on(document,"mouseup",this.__OnDocMouseUp,this)}},__OnDocMouseUp:function(e){clearInterval(this._scrollTimer);this._scrollTimer=null;mini.un(document,"mouseup",this.__OnDocMouseUp,this)},_doUpdateTop:function(){var e=this.tabPosition=="top";var t="";if(e){t+='<div class="mini-tabs-scrollCt">';t+='<div class="mini-tabs-nav"><a class="mini-tabs-leftButton" href="javascript:void(0)" hideFocus onclick="return false"></a><a class="mini-tabs-rightButton" href="javascript:void(0)" hideFocus onclick="return false"></a></div>';t+='<div class="mini-tabs-buttons"></div>'}t+='<div class="mini-tabs-headers">';var i=this.getTabRows();for(var n=0,s=i.length;n<s;n++){var r=i[n];var l="";t+='<table class="mini-tabs-header" cellspacing="0" cellpadding="0"><tr><td class="mini-tabs-space mini-tabs-firstSpace"><div></div></td>';for(var o=0,a=r.length;o<a;o++){var h=r[o];var u=this._createTabId(h);if(!h.visible)continue;var d=this.tabs.indexOf(h);var l=h.headerCls||"";if(h.enabled==false){l+=" mini-disabled"}t+='<td id="'+u+'" index="'+d+'"  class="mini-tab '+l+'" style="'+h.headerStyle+'">';if(h.iconCls||h.iconStyle){t+='<span class="mini-tab-icon '+h.iconCls+'" style="'+h.iconStyle+'"></span>'}t+='<span class="mini-tab-text">'+h.title+"</span>";if(h.showCloseButton){var c="";if(h.enabled){c="onmouseover=\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout=\"mini.removeClass(this, 'mini-tab-close-hover')\""}t+='<span class="mini-tab-close" '+c+"></span>"}t+="</td>";if(o!=a-1){t+='<td class="mini-tabs-space2"><div></div></td>'}}t+='<td class="mini-tabs-space mini-tabs-lastSpace" ><div></div></td></tr></table>'}if(e)t+="</div>";t+="</div>";this._doClearElement();mini.prepend(this._td2El,t);var f=this._td2El;this._headerEl=f.firstChild.lastChild;if(e){this._navEl=this._headerEl.parentNode.firstChild;this._leftButtonEl=this._navEl.firstChild;this._rightButtonEl=this._navEl.childNodes[1]}switch(this.tabAlign){case"center":var m=this._headerEl.childNodes;for(var o=0,a=m.length;o<a;o++){var p=m[o];var g=p.getElementsByTagName("td");g[0].style.width="50%";g[g.length-1].style.width="50%"}break;case"right":var m=this._headerEl.childNodes;for(var o=0,a=m.length;o<a;o++){var p=m[o];var g=p.getElementsByTagName("td");g[0].style.width="100%"}break;case"fit":break;default:var m=this._headerEl.childNodes;for(var o=0,a=m.length;o<a;o++){var p=m[o];var g=p.getElementsByTagName("td");g[g.length-1].style.width="100%"}break}},_doUpdateBottom:function(){this._doUpdateTop();var e=this._td2El;mini.append(e,e.firstChild);this._headerEl=e.lastChild},_doUpdateLeft:function(){var e='<table cellspacing="0" cellpadding="0"><tr>';var t=this.getTabRows();for(var i=0,n=t.length;i<n;i++){var s=t[i];var r="";if(n>1&&i!=n-1){r="mini-tabs-header2"}e+='<td class="'+r+'"><table class="mini-tabs-header" cellspacing="0" cellpadding="0">';e+='<tr ><td class="mini-tabs-space mini-tabs-firstSpace" ><div></div></td></tr>';for(var l=0,o=s.length;l<o;l++){var a=s[l];var h=this._createTabId(a);if(!a.visible)continue;var u=this.tabs.indexOf(a);var r=a.headerCls||"";if(a.enabled==false){r+=" mini-disabled"}e+='<tr><td id="'+h+'" index="'+u+'"  class="mini-tab '+r+'" style="'+a.headerStyle+'">';if(a.iconCls||a.iconStyle){e+='<span class="mini-tab-icon '+a.iconCls+'" style="'+a.iconStyle+'"></span>'}e+='<span class="mini-tab-text">'+a.title+"</span>";if(a.showCloseButton){var d="";if(a.enabled){d="onmouseover=\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout=\"mini.removeClass(this, 'mini-tab-close-hover')\""}e+='<span class="mini-tab-close" '+d+"></span>"}e+="</td></tr>";if(l!=o-1){e+='<tr><td class="mini-tabs-space2"><div></div></td></tr>'}}e+='<tr ><td class="mini-tabs-space mini-tabs-lastSpace" ><div></div></td></tr>';e+="</table></td>"}e+="</tr ></table>";this._doClearElement();mini.addClass(this._td1El,"mini-tabs-header");mini.append(this._td1El,e);this._headerEl=this._td1El},_doUpdateRight:function(){this._doUpdateLeft();mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");mini.append(this._td3El,this._td1El.firstChild);this._headerEl=this._td3El},_OnCloseButtonClick:function(e,t){var i={tab:e,index:this.tabs.indexOf(e),name:e.name.toLowerCase(),htmlEvent:t,cancel:false};this.fire("beforecloseclick",i);if(i.cancel==true)return;try{if(e._iframeEl&&e._iframeEl.contentWindow){var n=true;if(e._iframeEl.contentWindow.CloseWindow){n=e._iframeEl.contentWindow.CloseWindow("close")}else if(e._iframeEl.contentWindow.CloseOwnerWindow){n=e._iframeEl.contentWindow.CloseOwnerWindow("close")}if(n===false){i.cancel=true}}}catch(s){}if(i.cancel==true)return;e.removeAction="close";this.removeTab(e);this.fire("closeclick",i)},onBeforeCloseClick:function(e,t){this.on("beforecloseclick",e,t)},onCloseClick:function(e,t){this.on("closeclick",e,t)},onActiveChanged:function(e,t){this.on("activechanged",e,t)},getAttrs:function(el){var attrs=mini.Tabs.superclass.getAttrs.call(this,el);mini._ParseString(el,attrs,["tabAlign","tabPosition","bodyStyle","onactivechanged","onbeforeactivechanged","url","ontabload","ontabdestroy","onbeforecloseclick","oncloseclick","titleField","urlField","nameField","loadingMsg","buttons"]);mini._ParseBool(el,attrs,["allowAnim","showBody","showHeader","maskOnLoad","plain"]);mini._ParseInt(el,attrs,["activeIndex"]);var tabs=[];var nodes=mini.getChildNodes(el);for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];var o={};tabs.push(o);o.style=node.style.cssText;mini._ParseString(node,o,["name","title","url","cls","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle","onload","ondestroy","data-options"]);mini._ParseBool(node,o,["newLine","visible","enabled","showCloseButton","refreshOnClick"]);o.bodyParent=node;var options=o["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(o,options)}}}attrs.tabs=tabs;return attrs}});mini.regClass(mini.Tabs,"tabs");mini=mini||{};mini.TextArea=function(){mini.TextArea.superclass.constructor.call(this)};mini.extend(mini.TextArea,mini.TextBox,{maxLength:1e7,width:180,height:50,minHeight:50,_InputType:"textarea",uiCls:"mini-textarea",doLayout:function(){if(!this.canLayout())return;mini.TextArea.superclass.doLayout.call(this);var e=mini.getHeight(this.el);mini.setHeight(this._borderEl,e);e-=2;if(e<0)e=0;this._textEl.style.height=e+"px"}});mini.regClass(mini.TextArea,"textarea");mini=mini||{};mini.TextBoxList=function(){mini.TextBoxList.superclass.constructor.call(this);this.data=[];this.doUpdate()};mini.extend(mini.TextBoxList,mini.ValidatorBase,{formField:true,value:"",text:"",valueField:"id",textField:"text",url:"",delay:150,allowInput:true,editIndex:0,_focusCls:"mini-textboxlist-focus",_itemHoverClass:"mini-textboxlist-item-hover",_itemSelectedClass:"mini-textboxlist-item-selected",_closeHoverClass:"mini-textboxlist-close-hover",textName:"",setTextName:function(e){this.textName=e},getTextName:function(){return this.textName},uiCls:"mini-textboxlist",_create:function(){var e='<table class="mini-textboxlist" cellpadding="0" cellspacing="0"><tr ><td class="mini-textboxlist-border"><ul></ul><a href="#"></a><input type="hidden"/></td></tr></table>';var t=document.createElement("div");t.innerHTML=e;this.el=t.firstChild;var i=this.el.getElementsByTagName("td")[0];this.ulEl=i.firstChild;this._valueEl=i.lastChild;this.focusEl=i.childNodes[1]},destroy:function(e){if(this.isShowPopup){this.hidePopup()}mini.un(document,"mousedown",this.__OnDocMouseDown,this);mini.TextBoxList.superclass.destroy.call(this,e)},_initEvents:function(){mini.TextBoxList.superclass._initEvents.call(this);mini.on(this.el,"mousemove",this.__OnMouseMove,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"keydown",this.__OnKeyDown,this);mini.on(document,"mousedown",this.__OnDocMouseDown,this)},__OnDocMouseDown:function(e){if(this.isReadOnly())return;if(this.isShowPopup){if(!mini.isAncestor(this.popup.el,e.target)){this.hidePopup()}}if(this._focused){if(this.within(e)==false){this.select(null,false);this.showInput(false);this.removeCls(this._focusCls);this._focused=false}}},errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){var e=this.el.rows[0];var t=e.insertCell(1);t.style.cssText="width:18px;vertical-align:top;";t.innerHTML='<div class="mini-errorIcon"></div>';this._errorIconEl=t.firstChild}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){jQuery(this._errorIconEl.parentNode).remove()}this._errorIconEl=null},doLayout:function(){if(this.canLayout()==false)return;mini.TextBoxList.superclass.doLayout.call(this);if(this.isReadOnly()||this.allowInput==false){this._inputEl.readOnly=true}else{this._inputEl.readOnly=false}},doUpdate:function(){if(this._ValueChangeTimer)clearInterval(this._ValueChangeTimer);if(this._inputEl)mini.un(this._inputEl,"keydown",this.__OnInputKeyDown,this);var e=[];var t=this.uid;for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var r=t+"$text$"+i;var l=mini._getMap(this.textField,s);if(mini.isNull(l))l="";e[e.length]='<li id="'+r+'" class="mini-textboxlist-item">';e[e.length]=l;e[e.length]='<span class="mini-textboxlist-close"></span></li>'}var o=t+"$input";e[e.length]='<li id="'+o+'" class="mini-textboxlist-inputLi"><input class="mini-textboxlist-input" type="text" autocomplete="off"></li>';this.ulEl.innerHTML=e.join("");this.editIndex=this.data.length;if(this.editIndex<0)this.editIndex=0;this.inputLi=this.ulEl.lastChild;this._inputEl=this.inputLi.firstChild;mini.on(this._inputEl,"keydown",this.__OnInputKeyDown,this);var a=this;this._inputEl.onkeyup=function(){a._syncInputSize()};a._ValueChangeTimer=null;a._LastInputText=a._inputEl.value;this._inputEl.onfocus=function(){a._ValueChangeTimer=setInterval(function(){if(a._LastInputText!=a._inputEl.value){a._startQuery();a._LastInputText=a._inputEl.value}},10);a.addCls(a._focusCls);a._focused=true;a.fire("focus")};this._inputEl.onblur=function(){clearInterval(a._ValueChangeTimer);a.fire("blur")}},getItemByEvent:function(e){var t=mini.findParent(e.target,"mini-textboxlist-item");if(t){var i=t.id.split("$");var n=i[i.length-1];return this.data[n]}},getItem:function(e){if(typeof e=="number")return this.data[e];if(typeof e=="object")return e},getItemEl:function(e){var t=this.data.indexOf(e);var i=this.uid+"$text$"+t;return document.getElementById(i)},hoverItem:function(e,t){if(this.isReadOnly()||this.enabled==false)return;this.blurItem();var i=this.getItemEl(e);mini.addClass(i,this._itemHoverClass);if(t&&mini.hasClass(t.target,"mini-textboxlist-close")){mini.addClass(t.target,this._closeHoverClass)}},blurItem:function(){var e=this.data.length;for(var t=0,i=e;t<i;t++){var n=this.data[t];var s=this.getItemEl(n);if(s){mini.removeClass(s,this._itemHoverClass);mini.removeClass(s.lastChild,this._closeHoverClass)}}},showInput:function(e){this.select(null);if(mini.isNumber(e)){this.editIndex=e}else{this.editIndex=this.data.length}if(this.editIndex<0)this.editIndex=0;if(this.editIndex>this.data.length)this.editIndex=this.data.length;var t=this.inputLi;t.style.display="block";if(mini.isNumber(e)&&e<this.data.length){var i=this.data[e];var n=this.getItemEl(i);jQuery(n).before(t)}else{this.ulEl.appendChild(t)}if(e!==false){setTimeout(function(){try{t.firstChild.focus();mini.selectRange(t.firstChild,100)}catch(e){}},10)}else{this.lastInputText="";this._inputEl.value=""}return t},select:function(e){e=this.getItem(e);if(this._selected){var t=this.getItemEl(this._selected);mini.removeClass(t,this._itemSelectedClass)}this._selected=e;if(this._selected){var t=this.getItemEl(this._selected);mini.addClass(t,this._itemSelectedClass)}var i=this;if(this._selected){this.focusEl.focus();var n=this;setTimeout(function(){try{n.focusEl.focus()}catch(e){}},50)}if(this._selected){i.addCls(i._focusCls);i._focused=true}},_doInsertSelectValue:function(){var e=this._listbox.getSelected();var t=this.editIndex;if(e){e=mini.clone(e);this.insertItem(t,e)}},insertItem:function(e,t){this.data.insert(e,t);var i=this.getText();var n=this.getValue();this.setValue(n,false);this.setText(i,false);this._createData();this.doUpdate();this.showInput(e+1);this._OnValueChanged()},removeItem:function(e){if(!e)return;var t=this.getItemEl(e);mini.removeNode(t);this.data.remove(e);var i=this.getText();var n=this.getValue();this.setValue(n,false);this.setText(i,false);this._OnValueChanged()},_createData:function(){var e=(this.text?this.text:"").split(",");var t=(this.value?this.value:"").split(",");if(t[0]=="")t=[];var i=t.length;this.data.length=i;for(var n=0,s=i;n<s;n++){var r=this.data[n];if(!r){r={};this.data[n]=r}var l=!mini.isNull(e[n])?e[n]:"";var o=!mini.isNull(t[n])?t[n]:"";mini._setMap(this.textField,l,r);mini._setMap(this.valueField,o,r)}this.value=this.getValue();this.text=this.getText()},getInputText:function(){return this._inputEl?this._inputEl.value:""},getText:function(){var e=[];for(var t=0,i=this.data.length;t<i;t++){var n=this.data[t];var s=mini._getMap(this.textField,n);if(mini.isNull(s))s="";s=s.replace(",","，");e.push(s)}return e.join(",")},getValue:function(){var e=[];for(var t=0,i=this.data.length;t<i;t++){var n=this.data[t];var s=mini._getMap(this.valueField,n);e.push(s)}return e.join(",")},setName:function(e){if(this.name!=e){this.name=e;this._valueEl.name=e}},setValue:function(e){if(mini.isNull(e))e="";if(this.value!=e){this.value=e;this._valueEl.value=e;this._createData();this.doUpdate()}},setText:function(e){if(mini.isNull(e))e="";if(this.text!==e){this.text=e;this._createData();this.doUpdate()}},setValueField:function(e){this.valueField=e;this._createData()},getValueField:function(){return this.valueField},setTextField:function(e){this.textField=e;this._createData()},getTextField:function(){return this.textField},setAllowInput:function(e){this.allowInput=e;this.doLayout()},getAllowInput:function(){return this.allowInput},setUrl:function(e){this.url=this.parseUrl(e)},getUrl:function(){return this.url},setPopupHeight:function(e){this.popupHeight=e},getPopupHeight:function(){return this.popupHeight},setPopupMinHeight:function(e){this.popupMinHeight=e},getPopupMinHeight:function(){return this.popupMinHeight},setPopupMaxHeight:function(e){this.popupMaxHeight=e},getPopupMaxHeight:function(){return this.popupMaxHeight},doQuery:function(){this._startQuery(true)},_syncInputSize:function(){if(this.isDisplay()==false)return;var e=this.getInputText();var t=mini.measureText(this._inputEl,e);var i=t.width>20?t.width+4:20;var n=mini.getWidth(this.el,true);if(i>n-15)i=n-15;this._inputEl.style.width=i+"px"},_startQuery:function(e){var t=this;setTimeout(function(){t._syncInputSize()},1);this.showPopup("loading");this._stopQuery();this._loading=true;this.delayTimer=setTimeout(function(){var e=t._inputEl.value;t._doQuery()},this.delay)},_doQuery:function(){if(this.isDisplay()==false)return;var e=this.getInputText();var t=this;var i=this._listbox.getData();var n={value:this.getValue(),text:this.getText()};n[this.searchField]=e;var s=this.url;var r=typeof s=="function"?s:window[s];if(typeof r=="function"){s=r(this)}if(!s)return;var l="post";if(s){if(s.indexOf(".txt")!=-1||s.indexOf(".json")!=-1){l="get"}}var o={url:s,async:true,params:n,data:n,type:l,cache:false,cancel:false};this.fire("beforeload",o);if(o.data!=o.params&&o.params!=n){o.data=o.params}if(o.cancel)return;mini.copyTo(o,{success:function(e){var i=mini.decode(e);if(t.dataField){i=mini._getMap(t.dataField,i)}if(!i)i=[];t._listbox.setData(i);t.showPopup();t._listbox._focusItem(0,true);t.fire("load");t._loading=false;if(t._selectOnLoad){t.__doSelectValue();t._selectOnLoad=null}},error:function(e,i,n){t.showPopup("error")}});t._ajaxer=mini.ajax(o)},_stopQuery:function(){if(this.delayTimer){clearTimeout(this.delayTimer);this.delayTimer=null}if(this._ajaxer){this._ajaxer.abort()}this._loading=false},within:function(e){if(mini.isAncestor(this.el,e.target))return true;if(this.showPopup&&this.popup&&this.popup.within(e))return true;return false},popupLoadingText:"<span class='mini-textboxlist-popup-loading'>Loading...</span>",popupErrorText:"<span class='mini-textboxlist-popup-error'>Error</span>",popupEmptyText:"<span class='mini-textboxlist-popup-noresult'>No Result</span>",isShowPopup:false,popupHeight:"",popupMinHeight:30,popupMaxHeight:150,_createPopup:function(){if(!this.popup){this.popup=new mini.ListBox;this.popup.addCls("mini-textboxlist-popup");this.popup.setStyle("position:absolute;left:0;top:0;");this.popup.showEmpty=true;this.popup.setValueField(this.valueField);this.popup.setTextField(this.textField);this.popup.render(document.body);this.popup.on("itemclick",function(e){this.hidePopup();this._doInsertSelectValue()},this)}this._listbox=this.popup;return this.popup},showPopup:function(e){if(this.isDisplay()==false)return;this.isShowPopup=true;var t=this._createPopup();t.el.style.zIndex=mini.getMaxZIndex();var i=this._listbox;i.emptyText=this.popupEmptyText;if(e=="loading"){i.emptyText=this.popupLoadingText;this._listbox.setData([])}else if(e=="error"){i.emptyText=this.popupLoadingText;this._listbox.setData([])}this._listbox.doUpdate();var n=this.getBox();var s=n.x,r=n.y+n.height;this.popup.el.style.display="block";mini.setXY(t.el,-1e3,-1e3);this.popup.setWidth(n.width);this.popup.setHeight(this.popupHeight);if(this.popup.getHeight()<this.popupMinHeight){this.popup.setHeight(this.popupMinHeight)}if(this.popup.getHeight()>this.popupMaxHeight){this.popup.setHeight(this.popupMaxHeight)}mini.setXY(t.el,s,r)},hidePopup:function(){this.isShowPopup=false;if(this.popup)this.popup.el.style.display="none"},__OnMouseMove:function(e){if(this.enabled==false)return;var t=this.getItemByEvent(e);if(!t){this.blurItem();return}this.hoverItem(t,e)},__OnMouseOut:function(e){this.blurItem()},__OnClick:function(e){if(this.isReadOnly()||this.enabled==false)return;if(this.enabled==false)return;var t=this.getItemByEvent(e);if(!t){if(mini.findParent(e.target,"mini-textboxlist-input")){}else{this.showInput()}return}this.focusEl.focus();this.select(t);if(e&&mini.hasClass(e.target,"mini-textboxlist-close")){this.removeItem(t)}},__OnKeyDown:function(e){if(this.isReadOnly()||this.allowInput==false)return false;var t=this.data.indexOf(this._selected);var i=this;function n(){var e=i.data[t];i.removeItem(e);e=i.data[t];if(!e)e=i.data[t-1];i.select(e);if(!e){i.showInput()}}switch(e.keyCode){case 8:e.preventDefault();n();break;case 37:case 38:this.select(null);this.showInput(t);break;case 39:case 40:t+=1;this.select(null);this.showInput(t);break;case 46:n();break}},__doSelectValue:function(){var e=this._listbox.getFocusedItem();if(e){this._listbox.setSelected(e)}this.lastInputText=this.text;this.hidePopup();this._doInsertSelectValue()},__OnInputKeyDown:function(e){this._selectOnLoad=null;if(this.isReadOnly()||this.allowInput==false)return false;e.stopPropagation();if(this.isReadOnly()||this.allowInput==false)return;var t=mini.getSelectRange(this._inputEl);var i=t[0],n=t[1],s=this._inputEl.value.length;var r=i==n&&i==0;var l=i==n&&n==s;if(this.isReadOnly()||this.allowInput==false){e.preventDefault()}if(e.keyCode==9){this.hidePopup();return}if(e.keyCode==16||e.keyCode==17||e.keyCode==18)return;
    switch(e.keyCode){case 13:if(this.isShowPopup){e.preventDefault();if(this._loading){this._selectOnLoad=true;return}this.__doSelectValue()}break;case 27:e.preventDefault();this.hidePopup();break;case 8:if(r){e.preventDefault()}case 37:if(r){if(this.isShowPopup){this.hidePopup()}else{if(this.editIndex>0){var o=this.editIndex-1;if(o<0)o=0;if(o>=this.data.length)o=this.data.length-1;this.showInput(false);this.select(o)}}}break;case 39:if(l){if(this.isShowPopup){this.hidePopup()}else{if(this.editIndex<=this.data.length-1){var o=this.editIndex;this.showInput(false);this.select(o)}}}break;case 38:e.preventDefault();if(this.isShowPopup){var o=-1;var a=this._listbox.getFocusedItem();if(a)o=this._listbox.indexOf(a);o--;if(o<0)o=0;this._listbox._focusItem(o,true)}break;case 40:e.preventDefault();if(this.isShowPopup){var o=-1;var a=this._listbox.getFocusedItem();if(a)o=this._listbox.indexOf(a);o++;if(o<0)o=0;if(o>=this._listbox.getCount())o=this._listbox.getCount()-1;this._listbox._focusItem(o,true)}else{this._startQuery(true)}break;default:break}},focus:function(){try{this._inputEl.focus()}catch(e){}},blur:function(){try{this._inputEl.blur()}catch(e){}},searchField:"key",setSearchField:function(e){this.searchField=e},getSearchField:function(){return this.searchField},getAttrs:function(e){var t=mini.TextBox.superclass.getAttrs.call(this,e);var i=jQuery(e);mini._ParseString(e,t,["value","text","valueField","textField","url","popupHeight","textName","onfocus","onbeforeload","onload","searchField"]);mini._ParseBool(e,t,["allowInput"]);mini._ParseInt(e,t,["popupMinHeight","popupMaxHeight"]);return t}});mini.regClass(mini.TextBoxList,"textboxlist");mini.TimeSpinner=function(){mini.TimeSpinner.superclass.constructor.call(this);this.setValue("00:00:00")};mini.extend(mini.TimeSpinner,mini.ButtonEdit,{value:null,format:"H:mm:ss",uiCls:"mini-timespinner",_getButtonHtml:function(){var e="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" "+"onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+e+'><span class="mini-buttonedit-up"><span></span></span><span class="mini-buttonedit-down"><span></span></span></span>'},_initEvents:function(){mini.TimeSpinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this);mini.on(this._textEl,"keydown",this.__OnKeyDown,this)},this)},setFormat:function(e){if(typeof e!="string")return;var t=["H:mm:ss","HH:mm:ss","H:mm","HH:mm","H","HH","mm:ss"];if(this.format!=e){this.format=e;this.text=this._textEl.value=this.getFormattedValue()}},getFormat:function(){return this.format},setValue:function(e,t){e=mini.parseTime(e,this.format);if(!e)e=mini.parseTime("00:00:00",this.format);if(mini.isDate(e))e=new Date(e.getTime());if(mini.formatDate(this.value,"H:mm:ss")!=mini.formatDate(e,"H:mm:ss")){this.value=e;this.text=this._textEl.value=this.getFormattedValue();this._valueEl.value=this.getFormValue();if(t===undefined)t=true;if(t)this._OnValueChanged()}},getValue:function(){return this.value==null?null:new Date(this.value.getTime())},getFormValue:function(){if(!this.value)return"";return mini.formatDate(this.value,"H:mm:ss")},getFormattedValue:function(){if(!this.value)return"";return mini.formatDate(this.value,this.format)},_ChangeValue:function(e,t){var i=this.getValue();if(i){switch(t){case"hours":var n=i.getHours()+e;if(n>23)n=23;if(n<0)n=0;i.setHours(n);break;case"minutes":var s=i.getMinutes()+e;if(s>59)s=59;if(s<0)s=0;i.setMinutes(s);break;case"seconds":var r=i.getSeconds()+e;if(r>59)r=59;if(r<0)r=0;i.setSeconds(r);break}}else{i="00:00:00"}this.setValue(i)},_SpinTimer:null,_StartSpin:function(e,t,i){this._StopSpin();this._ChangeValue(e,this._timeType);var n=this;var s=i;var r=new Date;this._SpinTimer=setInterval(function(){n._ChangeValue(e,n._timeType);i--;if(i==0&&t>50){n._StartSpin(e,t-100,s+3)}var l=new Date;if(l-r>500)n._StopSpin();r=l},t);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(e){this._DownValue=this.getFormValue();this._timeType="hours";if(e.spinType=="up"){this._StartSpin(1,230,2)}else{this._StartSpin(-1,230,2)}},_OnDocumentMouseUp:function(e){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this)},__OnInputTextChanged:function(e){var t=this.getFormValue();this.setValue(this._textEl.value)},getAttrs:function(e){var t=mini.TimeSpinner.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["format"]);return t}});mini.regClass(mini.TimeSpinner,"timespinner");mini.ToolBar=function(){mini.ToolBar.superclass.constructor.call(this)};mini.extend(mini.ToolBar,mini.Container,{_clearBorder:false,style:"",uiCls:"mini-toolbar",_create:function(){this.el=document.createElement("div");this.el.className="mini-toolbar"},_initEvents:function(){},doLayout:function(){if(!this.canLayout())return;var e=mini.getChildNodes(this.el,true);for(var t=0,i=e.length;t<i;t++){mini.layout(e[t])}},set_bodyParent:function(e){if(!e)return;this.el=e;this.doLayout()},getAttrs:function(e){var t={};mini._ParseString(e,t,["id","borderStyle"]);this.el=e;this.el.uid=this.uid;this.addCls(this.uiCls);return t}});mini.regClass(mini.ToolBar,"toolbar");mini.Tree=function(e){this.root={_id:-1,_pid:"",_level:-1};this.data=this.root[this.nodesField]=[];this._idNodes={};this.idNodes={};this._viewNodes=null;mini.Tree.superclass.constructor.call(this,e);this.on("beforeexpand",function(e){var t=e.node;var i=this.isLeaf(t);var n=t[this.nodesField];if(!i&&(!n||n.length==0)){if(this.loadOnExpand&&t.asyncLoad!==false){e.cancel=true;this.loadNode(t)}}},this);this.doUpdate()};mini.Tree.NodeUID=1;var lastNodeLevel=[];mini.extend(mini.Tree,mini.Control,{_ajaxOption:{async:true,type:"get"},isTree:true,_displayStyle:"block",autoLoad:true,autoEscape:true,loadOnExpand:true,leafFixed:false,removeOnCollapse:true,expandOnDblClick:true,expandOnNodeClick:false,value:"",_selectedNode:null,allowSelect:true,showCheckBox:false,showFolderCheckBox:true,showExpandButtons:true,enableHotTrack:true,showArrow:false,expandOnLoad:false,delimiter:",",url:"",root:null,resultAsTree:true,parentField:"pid",idField:"id",textField:"text",iconField:"iconCls",nodesField:"children",showTreeIcon:false,showTreeLines:true,checkRecursive:false,allowAnim:true,_checkBoxCls:"mini-tree-checkbox",_selectedNodeCls:"mini-tree-selectedNode",_nodeHoverCls:"mini-tree-node-hover",leafIcon:"mini-tree-leaf",folderIcon:"mini-tree-folder",_borderCls:"mini-tree-border",_headerCls:"mini-tree-header",_bodyCls:"mini-tree-body",_nodeCls:"mini-tree-node",_nodesCls:"mini-tree-nodes",_expandNodeCls:"mini-tree-expand",_collapseNodeCls:"mini-tree-collapse",_eciconCls:"mini-tree-node-ecicon",_inNodeCls:"mini-tree-nodeshow",set:function(e){if(typeof e=="string"){return this}var t=e.value;delete e.value;var i=e.url;delete e.url;var n=e.data;delete e.data;mini.Tree.superclass.set.call(this,e);if(!mini.isNull(n)){this.setData(n)}if(!mini.isNull(i)){this.setUrl(i)}if(!mini.isNull(t)){this.setValue(t)}return this},uiCls:"mini-tree",destroy:function(e){mini.clearEvent(document);delete this._idNodes;delete this.idNodes;delete this._viewNodes;delete this._selectedNode;delete this._focusedNode;if(this._headerEl){mini.clearEvent(this._headerEl);this._borderEl.removeChild(this._headerEl);this._headerEl=null}if(this._bodyEl){mini.clearEvent(this._bodyEl);this._borderEl.removeChild(this._bodyEl);this._bodyEl=null}if(this._borderEl){mini.clearEvent(this._borderEl);this.el.removeChild(this._borderEl);this._borderEl=null}if(this._DragDrop){mini.clearEvent(this._DragDrop);this._DragDrop.destroy(e);this._DragDrop=null}delete this._cellErrors;delete this._cellMapErrors;delete this.data;delete this._list;delete this.root;delete this._indexs;mini.Tree.superclass.destroy.call(this,e)},_create:function(){this.el=document.createElement("div");this.el.className="mini-tree";if(this.showTreeLines==true){mini.addClass(this.el,"mini-tree-treeLine")}this.el.style.display="block";this._borderEl=mini.append(this.el,'<div class="'+this._borderCls+'">'+'<div class="'+this._headerCls+'"></div><div class="'+this._bodyCls+'"></div></div>');this._headerEl=this._borderEl.childNodes[0];this._bodyEl=this._borderEl.childNodes[1];this._DragDrop=new mini._TreeDragDrop(this)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"dblclick",this.__OnDblClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"mousemove",this.__OnMouseMove,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this)},this)},load:function(e,t){if(typeof e=="undefined")this._doLoad({},this.root);else if(typeof e=="string"){this.url=e;this._doLoad(t,this.root)}else this.setData(e)},setData:function(data){if(typeof data=="string"){data=eval("("+data+")")}this.loadData(data);this.data=data;this._cellErrors=[];this._cellMapErrors={}},getData:function(){return this.data},toArray:function(){return this.getList()},getList:function(){if(!this._list){this._list=mini.treeToArray(this.root[this.nodesField],this.nodesField,this.idField,this.parentField,"-1");this._indexs={};for(var e=0,t=this._list.length;e<t;e++){var i=this._list[e];this._indexs[i[this.idField]]=e}}return this._list},_clearTree:function(){this._list=null;this._indexs=null},loadList:function(e,t,i){t=t||this.idField;i=i||this.parentField;var n=mini.arrayToTree(e,this.nodesField,t,i);this.setData(n)},loadData:function(e){if(!mini.isArray(e))e=[];this.root[this.nodesField]=e;this.data=e;this.idNodes={};this._idNodes={};this._updateParentAndLevel(this.root,null);this.cascadeChild(this.root,function(e){if(mini.isNull(e.expanded)){var t=this.getLevel(e);if(this.expandOnLoad===true||mini.isNumber(this.expandOnLoad)&&t<=this.expandOnLoad){e.expanded=true}else{e.expanded=false}}if(e.isLeaf===false){var i=e[this.nodesField];if(i&&i.length>0){delete e.isLeaf}}},this);this._viewNodes=null;this._selectedNode=null;this.doUpdate()},clearData:function(){this.loadData([])},setUrl:function(e){this.url=this.parseUrl(e);if(this.autoLoad)this.load(this.url)},getUrl:function(){return this.url},loadNode:function(e,t){e=this.getNode(e);if(!e)return;if(this.isLeaf(e))return;var i={};i[this.idField]=this.getItemValue(e);var n=this;n.addNodeCls(e,"mini-tree-loading");var s=new Date;this._doLoad(i,e,function(i){var r=new Date-s;if(r<60)r=60-r;n.removeNodeCls(e,"mini-tree-loading");n.removeNodes(e[n.nodesField]);if(i&&i.length>0){n.addNodes(i,e);if(t!==false){n.expandNode(e,true)}else{n.collapseNode(e,true)}n.fire("loadnode",{node:e})}else{if(!n.leafFixed){delete e.isLeaf}n._doUpdateNodeTitle(e);if(n.leafFixed){if(t!==false){n.expandNode(e,true)}else{n.collapseNode(e,true)}e.asyncLoad=false}}},function(t){n.removeNodeCls(e,"mini-tree-loading")});this.ajaxAsync=false},setAjaxOption:function(e){mini.copyTo(this._ajaxOption,e)},getAjaxOption:function(e){return this._ajaxOption},_doLoad:function(params,node,success,fail){try{var url=eval(this.url);if(url!=undefined){this.url=url}}catch(e){}var isRoot=node==this.root;var e={url:this.url,async:this._ajaxOption.async,type:this._ajaxOption.type,params:params,data:params,cache:!!this.cache,cancel:false,node:node,isRoot:isRoot};this.fire("beforeload",e);if(e.data!=e.params&&e.params!=params){e.data=e.params}if(e.cancel==true)return;if(node!=this.root){}var sf=this;var container=node;if(isRoot){mini.addClass(this._bodyEl,"mini-tree-loading");this._bodyEl.innerHTML="<div class='mini-treegrid-ec-icon'>&nbsp;</div>"}else{sf.addNodeCls(container,"mini-tree-loading")}mini.copyTo(e,{success:function(e,t,i){if(isRoot){mini.removeClass(sf._bodyEl,"mini-tree-loading");sf._bodyEl.innerHTML=""}else{sf.removeNodeCls(container,"mini-tree-loading")}var n=null;try{n=mini.decode(e)}catch(s){n=[];if(mini_debugger==true){alert("tree json is error.")}}if(sf.dataField){n=mini._getMap(sf.dataField,n)}if(!n)n=[];var s={result:n,data:n,cancel:false,node:node};if(sf.resultAsTree==false){s.data=mini.arrayToTree(s.data,sf.nodesField,sf.idField,sf.parentField)}sf.fire("preload",s);if(s.cancel==true)return;if(isRoot){sf.setData(s.data)}if(success)success(s.data);sf._doCheckLoadNodes();sf.fire("load",s)},error:function(e,t,i){if(isRoot){mini.removeClass(sf._bodyEl,"mini-tree-loading");sf._bodyEl.innerHTML=""}else{sf.removeNodeCls(container,"mini-tree-loading")}var n={xmlHttp:e,errorCode:t};if(fail)fail(n);if(mini_debugger==true){alert("network error")}sf.fire("loaderror",n)}});this._ajaxer=mini.ajax(e)},getItemValue:function(e){if(!e)return"";var t=mini._getMap(this.idField,e);return mini.isNull(t)?"":String(t)},getItemText:function(e){if(!e)return"";var t=mini._getMap(this.textField,e);return mini.isNull(t)?"":String(t)},_OnDrawNode:function(e){var t=this.showCheckBox;if(t&&this.hasChildren(e)){t=this.showFolderCheckBox}var i=this.getItemText(e);var n={isLeaf:this.isLeaf(e),node:e,nodeHtml:i,nodeCls:"",nodeStyle:"",showCheckBox:t,iconCls:this.getNodeIcon(e),showTreeIcon:this.showTreeIcon};this.fire("drawnode",n);if(n.nodeHtml===null||n.nodeHtml===undefined||n.nodeHtml==="")n.nodeHtml="&nbsp;";return n},_createNodeTitle:function(e,t,i){var n=!i;if(!i)i=[];var s=e[this.textField];if(s===null||s===undefined)s="";var r=this.isLeaf(e);var l=this.getLevel(e);var o=this._OnDrawNode(e);var a=o.nodeCls;if(!r){if(!this._viewNodes)a=this.isExpandedNode(e)?this._expandNodeCls:this._collapseNodeCls;else{if(this._getViewChildNodes(e).length>0)a=this.isExpandedNode(e)?this._expandNodeCls:this._collapseNodeCls}}if(this._selectedNode==e){a+=" "+this._selectedNodeCls}if(!r){a+=" mini-tree-parentNode"}i[i.length]='<div class="mini-tree-nodetitle '+a+'" style="'+o.nodeStyle+'">';var h=this.getParentNode(e);var u=0;for(var d=u;d<=l;d++){if(d==l)continue;if(r){if(this.showExpandButtons==false&&d>=l-1){continue}}var c="";if(this._isInViewLastNode(e,d)){c="background:none"}i[i.length]='<span class="mini-tree-indent " style="'+c+'"></span>'}var f="";if(this._isViewFirstNode(e)&&this._isViewLastNode(e)){f="mini-tree-node-ecicon-last";if(h==this.root){f="mini-tree-node-ecicon-firstLast"}}else{if(this._isViewFirstNode(e)&&h&&h!=this.root){f=""}else if(this._isViewFirstNode(e)){f="mini-tree-node-ecicon-first"}else if(this._isViewLastNode(e)){f="mini-tree-node-ecicon-last"}}if(!r){i[i.length]='<a class="'+this._eciconCls+" "+f+'" style="'+(this.showExpandButtons?"":"display:none")+'" href="javascript:void(0);" onclick="return false;" hidefocus></a>'}else{i[i.length]='<span class="'+this._eciconCls+" "+f+'" ></span>'}i[i.length]='<span class="mini-tree-nodeshow">';if(o.showTreeIcon){i[i.length]='<span class="'+o.iconCls+' mini-tree-icon"></span>'}if(o.showCheckBox){var m=this._createCheckNodeId(e);var p=this.isCheckedNode(e);i[i.length]='<input type="checkbox" id="'+m+'" class="'+this._checkBoxCls+'" hidefocus '+(p?"checked":"")+" "+(e.enabled===false?"disabled":"")+"/>"}i[i.length]='<span class="mini-tree-nodetext">';if(t){var g=this.uid+"$edit$"+e._id;var s=e[this.textField];if(s===null||s===undefined)s="";i[i.length]='<input id="'+g+'" type="text" class="mini-tree-editinput" value="'+s+'"/>'}else{if(this.autoEscape){i[i.length]=mini.htmlEncode(o.nodeHtml)}else{i[i.length]=o.nodeHtml}}i[i.length]="</span>";i[i.length]="</span>";i[i.length]="</div>";if(n)return i.join("")},_createNode:function(e,t){var i=!t;if(!t)t=[];if(!e)return"";var n=this._createNodeId(e);var s=this.isVisibleNode(e)?"":"display:none";t[t.length]='<div id="';t[t.length]=n;t[t.length]='" class="';t[t.length]=this._nodeCls;if(e.enabled===false){t[t.length]=" mini-disabled"}t[t.length]='" style="';t[t.length]=s;t[t.length]='">';this._createNodeTitle(e,false,t);var r=this._getViewChildNodes(e);if(r&&r.length>0){if(this.removeOnCollapse&&this.isExpandedNode(e)){this._createNodes(r,e,t)}}t[t.length]="</div>";if(i)return t.join("")},_createNodes:function(e,t,i){var n=!i;if(!i)i=[];if(!e)return"";var s=this._createNodesId(t);var r=this.isExpandedNode(t)?"":"display:none";i[i.length]='<div id="';i[i.length]=s;i[i.length]='" class="';i[i.length]=this._nodesCls;i[i.length]='" style="';i[i.length]=r;i[i.length]='">';for(var l=0,o=e.length;l<o;l++){var a=e[l];this._createNode(a,i)}i[i.length]="</div>";if(n)return i.join("")},doUpdate:function(){if(!this._allowUpdate)return;var e=this._getViewChildNodes(this.root);var t=[];this._createNodes(e,this.root,t);var i=t.join("");this._bodyEl.innerHTML=i;this._deferLayout()},_doLayoutHeader:function(){},_deferLayout:function(){var e=this;if(this._layoutTimer)return;this._layoutTimer=setTimeout(function(){e.doLayout();e._layoutTimer=null},1)},doLayout:function(){if(this.showCheckBox){mini.addClass(this.el,"mini-tree-showCheckBox")}else{mini.removeClass(this.el,"mini-tree-showCheckBox")}if(this.enableHotTrack){mini.addClass(this.el,"mini-tree-hottrack")}else{mini.removeClass(this.el,"mini-tree-hottrack")}if(this.el){var e=this.el.firstChild;if(e){mini.addClass(e,"mini-tree-rootnodes")}}},filter:function(e,t){t=t||this;var i=this._viewNodes={},n=this.nodesField;function s(r){var l=r[n];if(!l)return false;var o=r._id;var a=[];for(var h=0,u=l.length;h<u;h++){var d=l[h];var c=s(d);var f=e.call(t,d,h,this);if(f===true||c){a.push(d);i[d._id]=null}}if(a.length>0)i[o]=a;return a.length>0}s(this.root);this.doUpdate();return this._viewNodes},clearFilter:function(){if(this._viewNodes){this._viewNodes=null;this.doUpdate()}},setShowCheckBox:function(e){if(this.showCheckBox!=e){this.showCheckBox=e;this.doUpdate()}},getShowCheckBox:function(){return this.showCheckBox},setShowFolderCheckBox:function(e){if(this.showFolderCheckBox!=e){this.showFolderCheckBox=e;this.doUpdate()}},getShowFolderCheckBox:function(){return this.showFolderCheckBox},setAllowSelect:function(e){if(this.allowSelect!=e){this.allowSelect=e;this.doUpdate()}},getAllowSelect:function(){return this.allowSelect},setShowTreeIcon:function(e){if(this.showTreeIcon!=e){this.showTreeIcon=e;this.doUpdate()}},getShowTreeIcon:function(){return this.showTreeIcon},setShowExpandButtons:function(e){if(this.showExpandButtons!=e){this.showExpandButtons=e;this.doUpdate()}},getShowExpandButtons:function(){return this.showExpandButtons},setEnableHotTrack:function(e){if(this.enableHotTrack!=e){this.enableHotTrack=e;this.doLayout()}},getEnableHotTrack:function(){return this.enableHotTrack},setExpandOnLoad:function(e){this.expandOnLoad=e},getExpandOnLoad:function(){return this.expandOnLoad},setCheckRecursive:function(e){if(this.checkRecursive!=e){this.checkRecursive=e}},getCheckRecursive:function(){return this.checkRecursive},getNodeIcon:function(e){var t=mini._getMap(this.iconField,e);if(!t){if(this.isLeaf(e))t=this.leafIcon;else t=this.folderIcon}return t},isAncestor:function(e,t){if(e==t)return true;if(!e||!t)return false;var i=this.getAncestors(t);for(var n=0,s=i.length;n<s;n++){if(i[n]==e)return true}return false},getAncestors:function(e){var t=[];while(1){var i=this.getParentNode(e);if(!i||i==this.root)break;t[t.length]=i;e=i}t.reverse();return t},getRootNode:function(){return this.root},getParentNode:function(e){if(!e)return null;if(e._pid==this.root._id)return this.root;return this._idNodes[e._pid]},isRoot:function(e){if(!e)return false;return e==this.root},_isViewFirstNode:function(e){if(this._viewNodes){var t=this.getParentNode(e);var i=this._getViewChildNodes(t);return i[0]===e}else{return this.isFirstNode(e)}},_isViewLastNode:function(e){if(this._viewNodes){var t=this.getParentNode(e);var i=this._getViewChildNodes(t);return i[i.length-1]===e}else{return this.isLastNode(e)}},_isInViewLastNode:function(e,t){if(this._viewNodes){var i=null;var n=this.getAncestors(e);for(var s=0,r=n.length;s<r;s++){var l=n[s];if(this.getLevel(l)==t){i=l}}if(!i||i==this.root)return false;return this._isViewLastNode(i)}else{return this.isInLastNode(e,t)}},_getViewChildNodes:function(e){var t=this.getChildNodes(e);if(!t)return[];if(this._viewNodes){var i=[];for(var n=0;n<t.length;n++){if(this._viewNodes.hasOwnProperty(t[n]._id))i.push(t[n])}return i}else return t},getChildNodes:function(e){e=this.getNode(e);if(!e)return null;return e[this.nodesField]},getAllChildNodes:function(e){e=this.getNode(e);if(!e)return[];var t=[];this.cascadeChild(e,function(e){t.push(e)},this);return t},indexOf:function(e){e=this.getNode(e);if(!e)return-1;this.getList();var t=this._indexs[e[this.idField]];if(mini.isNull(t))return-1;return t},getAt:function(e){var t=this.getList();return t[e]},indexOfChildren:function(e){var t=this.getParentNode(e);if(!t)return-1;var i=t[this.nodesField];return i.indexOf(e);l},hasChildren:function(e){var t=this.getChildNodes(e);return!!(t&&t.length>0)},isLeaf:function(e){if(!e||e.isLeaf===false)return false;var t=this.getChildNodes(e);if(t&&t.length>0)return false;return true},getLevel:function(e){return e._level},isExpandedNode:function(e){e=this.getNode(e);if(!e)return false;return e.expanded==true||mini.isNull(e.expanded)},isCheckedNode:function(e){e=this.getNode(e);if(!e)return false;return e.checked==true},isVisibleNode:function(e){if(e.visible==false)return false;var t=this.getParentNode(e);if(!t||t==this.root)return true;if(t.expanded===false)return false;return this.isVisibleNode(t)},isEnabledNode:function(e){return e.enabled!==false||this.enabled},isFirstNode:function(e){var t=this.getParentNode(e);var i=this.getChildNodes(t);return i[0]===e},isLastNode:function(e){var t=this.getParentNode(e);var i=this.getChildNodes(t);return i[i.length-1]===e},isInLastNode:function(e,t){var i=null;var n=this.getAncestors(e);for(var s=0,r=n.length;s<r;s++){var l=n[s];if(this.getLevel(l)==t){i=l}}if(!i||i==this.root)return false;return this.isLastNode(i)},bubbleParent:function(e,t,i){i=i||this;if(e)t.call(this,e);var n=this.getParentNode(e);if(n&&n!=this.root){this.bubbleParent(n,t,i)}},cascadeChild:function(e,t,i){if(!t)return;if(!e)e=this.root;var n=e[this.nodesField];if(n){n=n.clone();for(var s=0,r=n.length;s<r;s++){var l=n[s];if(t.call(i||this,l,s,e)===false)return;this.cascadeChild(l,t,i)}}},eachChild:function(e,t,i){if(!t||!e)return;var n=e[this.nodesField];if(n){var s=n.clone();for(var r=0,l=s.length;r<l;r++){var o=s[r];if(t.call(i||this,o,r,e)===false)break}}},_updateParentAndLevel:function(e,t){if(!e._id){e._id=mini.Tree.NodeUID++}this._idNodes[e._id]=e;this.idNodes[e[this.idField]]=e;e._pid=t?t._id:"";e._level=t?t._level+1:-1;this.cascadeChild(e,function(e,t,i){if(!e._id){e._id=mini.Tree.NodeUID++}this._idNodes[e._id]=e;this.idNodes[e[this.idField]]=e;e._pid=i._id;e._level=i._level+1},this);this._clearTree()},_updateNodeElLevel:function(e){var t=this;function i(e){t._doUpdateNodeTitle(e)}if(e!=this.root){i(e)}this.cascadeChild(e,function(e){i(e)},this)},removeNodes:function(e){if(!mini.isArray(e))return;e=e.clone();for(var t=0,i=e.length;t<i;t++){var n=e[t];this.removeNode(n)}},_doUpdateNodeTitle:function(e){var t=this._createNodeTitle(e);var i=this._getNodeEl(e);if(i){jQuery(i.firstChild).replaceWith(t)}},setNodeText:function(e,t){e=this.getNode(e);if(!e)return;e[this.textField]=t;this._doUpdateNodeTitle(e)},setNodeIconCls:function(e,t){e=this.getNode(e);if(!e)return;e[this.iconField]=t;this._doUpdateNodeTitle(e)},updateNode:function(e,t){e=this.getNode(e);if(!e||!t)return;var i=e[this.nodesField];mini.copyTo(e,t);e[this.nodesField]=i;this._doUpdateNodeTitle(e)},removeNode:function(e){e=this.getNode(e);if(!e)return;if(this._selectedNode==e){this._selectedNode=null}var t=[e];this.cascadeChild(e,function(e){t.push(e)},this);var i=this.getParentNode(e);i[this.nodesField].remove(e);this._updateParentAndLevel(e,i);var n=this._getNodeEl(e);if(n){n.parentNode.removeChild(n);if(this.isLeaf(i)){var s=this._getNodesEl(i);s.parentNode.removeChild(s)}}this._updateNodeElLevel(i);for(var r=0,l=t.length;r<l;r++){var e=t[r];delete e._id;delete e._pid;delete this._idNodes[e._id];delete this.idNodes[e[this.idField]]}},_getDropedParentNode:function(e,t,i){if(!i)t="add";switch(t){case"before":if(!i)return null;var n=this.getParentNode(i);return n;break;case"after":if(!i)return null;n=this.getParentNode(i);return n;break;case"add":return i;break;default:return null;break}},addNodes:function(e,t,i){if(!mini.isArray(e))return;for(var n=0,s=e.length;n<s;n++){var r=e[n];this.addNode(r,i,t)}},addNode:function(e,t,i){e=this.getNode(e);if(!e)return;if(!i)t="add";var n=i;switch(t){case"before":if(!n)return;i=this.getParentNode(n);var s=i[this.nodesField];t=s.indexOf(n);break;case"after":if(!n)return;i=this.getParentNode(n);var s=i[this.nodesField];t=s.indexOf(n)+1;break;case"add":break;default:break}i=this.getNode(i);if(!i)i=this.root;var r=i[this.nodesField];if(!r)r=i[this.nodesField]=[];t=parseInt(t);if(isNaN(t))t=r.length;var n=r[t];if(!n)t=r.length;r.insert(t,e);this._updateParentAndLevel(e,i);var l=this._getNodesEl(i);if(l){var o=this._createNode(e);var t=r.indexOf(e)+1;var n=r[t];if(n){var a=this._getNodeEl(n);jQuery(a).before(o)}else{mini.append(l,o)}}else{var o=this._createNode(i);var h=this._getNodeEl(i);jQuery(h).replaceWith(o)}i=this.getParentNode(e);this._updateNodeElLevel(i)},moveNodes:function(e,t,i){if(!e||e.length==0||!t||!i)return;this.beginUpdate();var n=this;for(var s=0,r=e.length;s<r;s++){var l=e[s];this.moveNode(l,t,i);if(s!=0){t=l;i="after"}}this.endUpdate()},moveNode:function(e,t,i){e=this.getNode(e);t=this.getNode(t);if(!e||!t||!i)return false;if(this.isAncestor(e,t))return false;var n=-1;var s=null;switch(i){case"before":s=this.getParentNode(t);n=this.indexOfChildren(t);break;case"after":s=this.getParentNode(t);n=this.indexOfChildren(t)+1;break;default:s=t;var r=this.getChildNodes(s);if(!r){r=s[this.nodesField]=[]}n=r.length;break}var l={};var r=this.getChildNodes(s);r.insert(n,l);var o=this.getParentNode(e);var a=this.getChildNodes(o);a.remove(e);n=r.indexOf(l);r[n]=e;this._updateParentAndLevel(e,s);this.doUpdate();return true},isEditingNode:function(e){return this._editingNode==e},beginEdit:function(e){e=this.getNode(e);if(!e)return;var t=this._getNodeEl(e);var i=this._createNodeTitle(e,true);var t=this._getNodeEl(e);if(t){jQuery(t.firstChild).replaceWith(i)}this._editingNode=e;var n=this.uid+"$edit$"+e._id;this._editInput=document.getElementById(n);this._editInput.focus();mini.selectRange(this._editInput,1e3,1e3);mini.on(this._editInput,"keydown",this.__OnEditInputKeyDown,this);mini.on(this._editInput,"blur",this.__OnEditInputBlur,this)},cancelEdit:function(){if(this._editingNode){this._doUpdateNodeTitle(this._editingNode);mini.un(this._editInput,"keydown",this.__OnEditInputKeyDown,this);mini.un(this._editInput,"blur",this.__OnEditInputBlur,this)}this._editingNode=null;this._editInput=null},__OnEditInputKeyDown:function(e){if(e.keyCode==13){var t=this._editInput.value;this.setNodeText(this._editingNode,t);this.cancelEdit();this.fire("endedit",{node:this._editingNode,text:t})}else if(e.keyCode==27){this.cancelEdit()}},__OnEditInputBlur:function(e){var t=this._editInput.value;this.setNodeText(this._editingNode,t);this.cancelEdit();this.fire("endedit",{node:this._editingNode,text:t})},_getNodeByEvent:function(e){if(mini.hasClass(e.target,this._nodesCls))return null;var t=mini.findParent(e.target,this._nodeCls);if(t){var i=t.id.split("$");var n=i[i.length-1];var s=this._idNodes[n];return s}return null},_createNodeId:function(e){return this.uid+"$"+e._id},_createNodesId:function(e){return this.uid+"$nodes$"+e._id},_createCheckNodeId:function(e){return this.uid+"$check$"+e._id},addNodeCls:function(e,t){var i=this._getNodeEl(e);if(i)mini.addClass(i,t)},removeNodeCls:function(e,t){var i=this._getNodeEl(e);if(i)mini.removeClass(i,t)},getNodeBox:function(e){var t=this._getNodeEl(e);if(t)return mini.getBox(t.firstChild)},_getNodeEl:function(e){if(!e)return null;var t=this._createNodeId(e);return document.getElementById(t)},_getNodeHoverEl:function(e){if(!e)return null;var t=this._getNodeTitleEl(e);if(t){t=mini.byClass(this._inNodeCls,t);return t}return null},_getNodeTitleEl:function(e){var t=this._getNodeEl(e);if(t)return t.firstChild},_getNodesEl:function(e){if(!e)return null;if(this.isVisibleNode(e)==false)return null;var t=this._createNodesId(e);return mini.byId(t,this.el)},_getCheckBoxEl:function(e){if(!e)return null;if(this.isVisibleNode(e)==false)return null;var t=this._createCheckNodeId(e);return mini.byId(t,this.el)},findNodes:function(e,t){var i=[];t=t||this;this.cascadeChild(this.root,function(n){if(e&&e.call(t,n)===true){i.push(n)}},this);return i},getNode:function(e){if(typeof e=="object")return e;return this.idNodes[e]||null},hideNode:function(e){e=this.getNode(e);if(!e)return;e.visible=false;var t=this._getNodeEl(e);t.style.display="none"},showNode:function(e){e=this.getNode(e);if(!e)return;e.visible=false;var t=this._getNodeEl(e);t.style.display=""},enableNode:function(e){e=this.getNode(e);if(!e)return;e.enabled=true;var t=this._getNodeEl(e);mini.removeClass(t,"mini-disabled");var i=this._getCheckBoxEl(e);if(i)i.disabled=false},disableNode:function(e){e=this.getNode(e);if(!e)return;e.enabled=false;var t=this._getNodeEl(e);mini.addClass(t,"mini-disabled");var i=this._getCheckBoxEl(e);if(i)i.disabled=true},_allowExpandLayout:true,expandNode:function(e,t){e=this.getNode(e);if(!e)return;var i=this.isExpandedNode(e);if(i)return;if(this.isLeaf(e))return;e.expanded=true;var n=this._getNodeEl(e);if(this.removeOnCollapse&&n){var s=this._createNode(e);jQuery(n).before(s);jQuery(n).remove()}var r=this._getNodesEl(e);if(r)r.style.display="";var r=this._getNodeEl(e);if(r){var l=r.firstChild;mini.removeClass(l,this._collapseNodeCls);mini.addClass(l,this._expandNodeCls)}this.fire("expand",{node:e});t=t&&!mini.isIE6;var o=this._getViewChildNodes(e);if(t&&o&&o.length>0){this._inAniming=true;var r=this._getNodesEl(e);if(!r)return;var a=mini.getHeight(r);r.style.height="1px";if(this._doPositoin){r.style.position="relative"}var h={height:a+"px"};var u=this;var d=jQuery(r);d.animate(h,180,function(){u._inAniming=false;u._doLayoutHeader();clearInterval(u._animateTimer);r.style.height="auto";if(u._doPositoin){r.style.position="static"}mini.repaint(n)});clearInterval(this._animateTimer);this._animateTimer=setInterval(function(){u._doLayoutHeader()},60)}this._doLayoutHeader();function c(){var e=this.getAllChildNodes(n);e.push(n);for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n&&n._indeterminate){var s=this._getCheckBoxEl(n);if(s&&n._indeterminate){s.indeterminate=n._indeterminate}}}}var f=this;c.call(f)},collapseNode:function(e,t){e=this.getNode(e);if(!e)return;var i=this.isExpandedNode(e);if(!i)return;if(this.isLeaf(e))return;e.expanded=false;var n=this._getNodeEl(e);var s=this._getNodesEl(e);if(s)s.style.display="none";var s=this._getNodeEl(e);if(s){var r=s.firstChild;mini.removeClass(r,this._expandNodeCls);mini.addClass(r,this._collapseNodeCls)}this.fire("collapse",{node:e});t=t&&!mini.isIE6;var l=this._getViewChildNodes(e);if(t&&l&&l.length>0){this._inAniming=true;var s=this._getNodesEl(e);if(!s)return;s.style.display="";s.style.height="auto";if(this._doPositoin){s.style.position="relative"}var o=mini.getHeight(s);var a={height:"1px"};var h=this;var u=jQuery(s);u.animate(a,180,function(){s.style.display="none";s.style.height="auto";if(h._doPositoin){s.style.position="static"}h._inAniming=false;h._doLayoutHeader();clearInterval(h._animateTimer);var t=h._getNodesEl(e);if(h.removeOnCollapse&&t){jQuery(t).remove()}mini.repaint(n)});clearInterval(this._animateTimer);this._animateTimer=setInterval(function(){h._doLayoutHeader()},60)}else{var d=this._getNodesEl(e);if(this.removeOnCollapse&&d){jQuery(d).remove()}}this._doLayoutHeader();if(this._allowExpandLayout){mini.repaint(this.el)}},toggleNode:function(e,t){if(this.isExpandedNode(e)){this.collapseNode(e,t)}else{this.expandNode(e,t)}},expandLevel:function(e){this.cascadeChild(this.root,function(t){if(this.getLevel(t)==e){if(t[this.nodesField]!=null){this.expandNode(t)}}},this)},collapseLevel:function(e){this.cascadeChild(this.root,function(t){
    if(this.getLevel(t)==e){if(t[this.nodesField]!=null){this.collapseNode(t)}}},this)},expandAll:function(){this.cascadeChild(this.root,function(e){if(e[this.nodesField]!=null){this.expandNode(e)}},this)},collapseAll:function(){this.cascadeChild(this.root,function(e){if(e[this.nodesField]!=null){this.collapseNode(e)}},this)},expandPath:function(e){e=this.getNode(e);if(!e)return;var t=this.getAncestors(e);for(var i=0,n=t.length;i<n;i++){this.expandNode(t[i])}},collapsePath:function(e){e=this.getNode(e);if(!e)return;var t=this.getAncestors(e);for(var i=0,n=t.length;i<n;i++){this.collapseNode(t[i])}},selectNode:function(e){e=this.getNode(e);var t=this._getNodeEl(this._selectedNode);if(t){mini.removeClass(t.firstChild,this._selectedNodeCls)}this._selectedNode=e;var t=this._getNodeEl(this._selectedNode);if(t){mini.addClass(t.firstChild,this._selectedNodeCls)}var i={node:e,isLeaf:this.isLeaf(e)};this.fire("nodeselect",i)},getSelectedNode:function(){return this._selectedNode},getSelectedNodes:function(){var e=[];if(this._selectedNode)e.push(this._selectedNode);return e},doUpdateCheckedState:function(){},autoCheckParent:false,setAutoCheckParent:function(e){this.autoCheckParent=e},getAutoCheckParent:function(e){return this.autoCheckParent},hasCheckedChildNode:function(e){var t=false;var i=this.getAllChildNodes(e);for(var n=0,s=i.length;n<s;n++){var r=i[n];if(this.isCheckedNode(r)){t=true;break}}return t},_doCheckLoadNodes:function(){var e=this.getList();var t=[];for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s.checked){t.push(s)}}for(var i=0,n=t.length;i<n;i++){var s=t[i];this._doCheckNode(s,true,this.checkRecursive)}},_doCheckNode:function(e,t,i){var n=e;var s=[];e.checked=t;e._indeterminate=false;s.push(e);if(i){this.cascadeChild(e,function(e){e.checked=t;e._indeterminate=false;s.push(e)},this);var r=this.getAncestors(e);r.reverse();for(var l=0,o=r.length;l<o;l++){var a=r[l];var h=this.getChildNodes(a);var u=true,d=false;for(var c=0,f=h.length;c<f;c++){var m=h[c];if(this.isCheckedNode(m)){d=true}else{u=false}}if(u){a.checked=true;a._indeterminate=false}else{a.checked=false;a._indeterminate=d}s.push(a)}}for(var l=0,o=s.length;l<o;l++){var e=s[l];var p=this._getCheckBoxEl(e);if(p){if(e.checked){p.indeterminate=false;p.checked=true}else{p.indeterminate=e._indeterminate;p.checked=false}}}if(this.autoCheckParent){var r=this.getAncestors(n);for(var l=0,o=r.length;l<o;l++){var a=r[l];var d=this.hasCheckedChildNode(a);if(d){a.checked=true;a._indeterminate=false;var p=this._getCheckBoxEl(a);if(p){p.indeterminate=false;p.checked=true}}}}},checkNode:function(e){e=this.getNode(e);if(!e)return;this._doCheckNode(e,true,this.checkRecursive)},uncheckNode:function(e){e=this.getNode(e);if(!e)return;this._doCheckNode(e,false,this.checkRecursive)},checkNodes:function(e){if(!mini.isArray(e))e=[];for(var t=0,i=e.length;t<i;t++){var n=e[t];this.checkNode(n)}},uncheckNodes:function(e){if(!mini.isArray(e))e=[];for(var t=0,i=e.length;t<i;t++){var n=e[t];this.uncheckNode(n)}},checkAllNodes:function(){this.cascadeChild(this.root,function(e){this._doCheckNode(e,true,false)},this)},uncheckAllNodes:function(e){this.cascadeChild(this.root,function(e){this._doCheckNode(e,false,false)},this)},getCheckedNodes:function(e){var t=[];var i={};this.cascadeChild(this.root,function(n){if(n.checked==true){t.push(n);if(e){var s=this.getAncestors(n);for(var r=0,l=s.length;r<l;r++){var o=s[r];if(!i[o._id]){i[o._id]=o;t.push(o)}}}}},this);return t},setValue:function(e){if(mini.isNull(e))e="";e=String(e);var t=this.getCheckedNodes();this.uncheckNodes(t);this.value=e;if(this.showCheckBox){var i=String(e).split(this.delimiter);for(var n=0,s=i.length;n<s;n++){this.checkNode(i[n])}}else{this.value=e;this.selectNode(e)}},getNodesByValue:function(e){if(mini.isNull(e))e="";e=String(e);var t=[];var i=String(e).split(this.delimiter);for(var n=0,s=i.length;n<s;n++){var r=this.getNode(i[n]);if(r)t.push(r)}return t},getValueAndText:function(e){if(mini.isNull(e))e=[];if(!mini.isArray(e)){e=this.getNodesByValue(e)}var t=[];var i=[];for(var n=0,s=e.length;n<s;n++){var r=e[n];if(r){t.push(this.getItemValue(r));i.push(this.getItemText(r))}}return[t.join(this.delimiter),i.join(this.delimiter)]},getValue:function(e){var t=this.getCheckedNodes(e);var i=[];for(var n=0,s=t.length;n<s;n++){var r=this.getItemValue(t[n]);if(r)i.push(r)}return i.join(this.delimiter)},setResultAsTree:function(e){this.resultAsTree=e},getResultAsTree:function(){return this.resultAsTree},setParentField:function(e){this.parentField=e},getParentField:function(){return this.parentField},setIdField:function(e){this.idField=e},getIdField:function(){return this.idField},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},setShowTreeLines:function(e){this.showTreeLines=e;if(e==true){mini.addClass(this.el,"mini-tree-treeLine")}else{mini.removeClass(this.el,"mini-tree-treeLine")}},getShowTreeLines:function(){return this.showTreeLines},setShowArrow:function(e){this.showArrow=e;if(e==true){mini.addClass(this.el,"mini-tree-showArrows")}else{mini.removeClass(this.el,"mini-tree-showArrows")}},getShowArrow:function(){return this.showArrow},setIconField:function(e){this.iconField=e},getIconField:function(){return this.iconField},setNodesField:function(e){this.nodesField=e},getNodesField:function(){return this.nodesField},setTreeColumn:function(e){this.treeColumn=e},getTreeColumn:function(){return this.treeColumn},setLeafIcon:function(e){this.leafIcon=e},getLeafIcon:function(){return this.leafIcon},setFolderIcon:function(e){this.folderIcon=e},getFolderIcon:function(){return this.folderIcon},setExpandOnDblClick:function(e){this.expandOnDblClick=e},getExpandOnDblClick:function(){return this.expandOnDblClick},setExpandOnNodeClick:function(e){this.expandOnNodeClick=e;if(e){mini.addClass(this.el,"mini-tree-nodeclick")}else{mini.removeClass(this.el,"mini-tree-nodeclick")}},getExpandOnNodeClick:function(){return this.expandOnNodeClick},setRemoveOnCollapse:function(e){this.removeOnCollapse=e},getRemoveOnCollapse:function(){return this.removeOnCollapse},setLoadOnExpand:function(e){this.loadOnExpand=e},getLoadOnExpand:function(){return this.loadOnExpand},setAutoEscape:function(e){this.autoEscape=e},getAutoEscape:function(){return this.autoEscape},imgPath:"",setImgPath:function(e){this.imgPath=e},getImgPath:function(){return this.imgPath},imgField:"img",setImgField:function(e){this.imgField=e},getImgField:function(){return this.imgField},__OnDblClick:function(e){if(!this.enabled)return;if(mini.findParent(e.target,this._checkBoxCls))return;var t=this._getNodeByEvent(e);if(t&&t.enabled!==false){if(mini.findParent(e.target,this._inNodeCls)){var i=this.isExpandedNode(t);var n={node:t,expanded:i,cancel:false};this.fire("nodedblclick",{htmlEvent:e,node:t,isLeaf:this.isLeaf(t)});if(this.expandOnDblClick&&!this._inAniming){if(this._viewNodes){var s=this._getViewChildNodes(t);if(s.length==0)return}else if(!this.getChildNodes(t))return;if(i){this.fire("beforecollapse",n);if(n.cancel==true)return;this.collapseNode(t,this.allowAnim)}else{this.fire("beforeexpand",n);if(n.cancel==true)return;this.expandNode(t,this.allowAnim)}}}}},__OnClick:function(e){if(!this.enabled)return;var t=this._getNodeByEvent(e);if(t&&t.enabled!==false){var i=mini.findParent(e.target,this._inNodeCls)&&this.expandOnNodeClick;if(mini.findParent(e.target,this._checkBoxCls))i=false;if((mini.findParent(e.target,this._eciconCls)||i)&&this.isLeaf(t)==false){if(this._inAniming)return;var n=this.isExpandedNode(t);var s={node:t,expanded:n,cancel:false};if(!this._inAniming){if(this._viewNodes){var r=this._getViewChildNodes(t);if(r.length==0)return}if(n){this.fire("beforecollapse",s);if(s.cancel==true)return;this.collapseNode(t,this.allowAnim)}else{this.fire("beforeexpand",s);if(s.cancel==true)return;this.expandNode(t,this.allowAnim)}}}else if(mini.findParent(e.target,this._checkBoxCls)){var l=this.isCheckedNode(t);var s={isLeaf:this.isLeaf(t),node:t,checked:l,checkRecursive:this.checkRecursive,htmlEvent:e,cancel:false};this.fire("beforenodecheck",s);if(s.cancel==true){e.preventDefault();return}if(l){this.uncheckNode(t)}else{this.checkNode(t)}s.checked=this.isCheckedNode(t);this.fire("nodecheck",s)}else{this._OnNodeClick(t,e)}}},__OnMouseDown:function(e){if(!this.enabled)return;if(this._editInput&&!mini.findParent(e.target,"mini-tree-editinput"))this._editInput.blur();var t=this._getNodeByEvent(e);if(t){if(mini.findParent(e.target,this._eciconCls)){}else if(mini.findParent(e.target,this._checkBoxCls)){}else{this._OnNodeMouseDown(t,e)}}},_OnNodeMouseDown:function(e,t){var i=mini.findParent(t.target,this._inNodeCls);if(!i)return null;if(!this.isEnabledNode(e))return;var n={node:e,cancel:false,isLeaf:this.isLeaf(e),htmlEvent:t};if(this.allowSelect&&e.allowSelect!==false){if(this._selectedNode!=e){this.fire("beforenodeselect",n);if(n.cancel!=true){this.selectNode(e)}}}this.fire("nodeMouseDown",n)},_OnNodeClick:function(e,t){var i=mini.findParent(t.target,this._inNodeCls);if(!i)return null;if(t.target.tagName.toLowerCase()=="a"){t.target.hideFocus=true}if(!this.isEnabledNode(e))return;var n={node:e,cancel:false,isLeaf:this.isLeaf(e),htmlEvent:t};if(this._getColumnByEvent){var s=this._getColumnByEvent(t);if(s){n.column=s;n.field=s.field}}this.fire("nodeClick",n)},__OnMouseOver:function(e){if(this._dragging)return;if(mini.hasClass(e.target,"mini-tree-parentNode")||mini.hasClass(e.target,"mini-tree-rootnodes"))this.currentMouseOverNode=null;var t=this._getNodeByEvent(e);if(t){this._OnNodeMouseOver(t,e)}},_OnNodeMouseOver:function(e,t){if(!this.isEnabledNode(e))return;if(!mini.findParent(t.target,this._inNodeCls))return;var t={node:e,htmlEvent:t};if(this.currentMouseOverNode!=e)this.fire("nodemouseover",t);this.currentMouseOverNode=e},__OnMouseMove:function(e){var t=this._getNodeByEvent(e);if(t){this._OnNodeMouseMove(t,e)}},__OnMouseOut:function(e){var t=this._getNodeByEvent(e);if(t){this._OnNodeMouseOut(t,e)}},_OnNodeMouseOut:function(e,t){if(!this.isEnabledNode(e))return;if(!mini.findParent(t.target,this._inNodeCls))return;this.blurNode();var t={node:e,htmlEvent:t};this.fire("nodemouseout",t)},_OnNodeMouseMove:function(e,t){if(!this.isEnabledNode(e))return;if(!mini.findParent(t.target,this._inNodeCls))return;if(this.enableHotTrack==true){this.focusNode(e)}var t={node:e,htmlEvent:t};this.fire("nodemousemove",t)},focusNode:function(e,t){e=this.getNode(e);if(!e)return;function i(){var i=this._getNodeHoverEl(e);if(t&&i){this.scrollIntoView(e)}if(this._focusedNode==e)return;this.blurNode();this._focusedNode=e;mini.addClass(i,this._nodeHoverCls)}var n=this;i.call(n)},blurNode:function(){if(!this._focusedNode)return;var e=this._getNodeHoverEl(this._focusedNode);if(e){mini.removeClass(e,this._nodeHoverCls)}this._focusedNode=null},scrollIntoView:function(e){e=this.getNode(e);if(!e)return;this.expandNode(e);var t=this._getNodeEl(e);mini.scrollIntoView(t,this.el,false)},__OnHtmlContextMenu:function(e){if(mini.isAncestor(this._headerEl,e.target)){return true}return mini.Tree.superclass.__OnHtmlContextMenu.call(this,e)},onNodeClick:function(e,t){this.on("nodeClick",e,t)},onBeforeNodeSelect:function(e,t){this.on("beforenodeselect",e,t)},onNodeSelect:function(e,t){this.on("nodeselect",e,t)},onBeforeNodeCheck:function(e,t){this.on("beforenodecheck",e,t)},onCheckNode:function(e,t){this.on("nodecheck",e,t)},onNodeMouseDown:function(e,t){this.on("nodemousedown",e,t)},onBeforeExpand:function(e,t){this.on("beforeexpand",e,t)},onExpand:function(e,t){this.on("expand",e,t)},onBeforeCollapse:function(e,t){this.on("beforecollapse",e,t)},onCollapse:function(e,t){this.on("collapse",e,t)},onBeforeLoad:function(e,t){this.on("beforeload",e,t)},onLoad:function(e,t){this.on("load",e,t)},onLoadError:function(e,t){this.on("loaderror",e,t)},onDataLoad:function(e,t){this.on("dataload",e,t)},_getDragData:function(){return this.getSelectedNodes().clone()},_getDragText:function(e){if(this.autoEscape==true){return mini.htmlEncode(this.getItemText(e[0]))}return this.getItemText(e[0])},allowDrag:false,allowDrop:false,dragGroupName:"",dropGroupName:"",allowLeafDropIn:false,setAllowLeafDropIn:function(e){this.allowLeafDropIn=e},getAllowLeafDropIn:function(){return this.allowLeafDropIn},setAllowDrag:function(e){this.allowDrag=e},getAllowDrag:function(){return this.allowDrag},setAllowDrop:function(e){this.allowDrop=e},getAllowDrop:function(){return this.allowDrop},setDragGroupName:function(e){this.dragGroupName=e},getDragGroupName:function(){return this.dragGroupName},setDropGroupName:function(e){this.dropGroupName=e},getDropGroupName:function(){return this.dropGroupName},isAllowDrag:function(e){if(!this.allowDrag)return false;if(e.allowDrag===false)return false;return true},_OnDragStart:function(e){var t={node:e,nodes:this._getDragData(),dragText:this._getDragText(this._getDragData()),cancel:false};this.fire("DragStart",t);return t},_OnDragDrop:function(e,t,i){e=e.clone();var n={dragNodes:e,targetNode:t,action:i,cancel:false};var s=this._getDropedParentNode(e,i,t);n.dragNode=n.dragNodes[0];n.dropNode=n.targetNode;n.dragAction=n.action;n.dropParentNode=s;this.fire("beforedrop",n);this.fire("DragDrop",n);return n},_OnGiveFeedback:function(e,t,i){var n={};n.effect=e;n.nodes=t;n.targetNode=i;n.node=n.nodes[0];n.dragNodes=t;n.dragNode=n.dragNodes[0];n.dropNode=n.targetNode;n.dragAction=n.action;this.fire("givefeedback",n);return n},_allowDrag:function(e){return true},getAttrs:function(e){var t=mini.Tree.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["data","value","url","idField","textField","iconField","nodesField","parentField","valueField","leafIcon","folderIcon","ondrawnode","onbeforenodeselect","onnodeselect","onnodemousedown","onnodeclick","onnodedblclick","onbeforeload","onpreload","onload","onloaderror","ondataload","onnodemouseover","onnodemouseout","onbeforenodecheck","onnodecheck","onbeforeexpand","onexpand","onbeforecollapse","oncollapse","dragGroupName","dropGroupName","onendedit","imgPath","imgField","expandOnLoad","ajaxOption","ondragstart","onbeforedrop","ondrop","ongivefeedback"]);mini._ParseBool(e,t,["allowSelect","showCheckBox","showExpandButtons","showTreeIcon","showTreeLines","checkRecursive","enableHotTrack","showFolderCheckBox","resultAsTree","allowLeafDropIn","allowDrag","allowDrop","showArrow","expandOnDblClick","removeOnCollapse","autoCheckParent","loadOnExpand","expandOnNodeClick","autoEscape","autoLoad"]);if(t.ajaxOption){t.ajaxOption=mini.decode(t.ajaxOption)}if(t.expandOnLoad){var i=parseInt(t.expandOnLoad);if(mini.isNumber(i)){t.expandOnLoad=i}else{t.expandOnLoad=t.expandOnLoad=="true"?true:false}}var n=t.idField||this.idField;var s=t.textField||this.textField;var r=t.iconField||this.iconField;var l=t.nodesField||this.nodesField;function o(e){var t=[];for(var i=0,a=e.length;i<a;i++){var h=e[i];var u=mini.getChildNodes(h);var d=u[0];var c=u[1];if(!d||!c)d=h;var f=jQuery(d);var m={};var p=m[n]=d.getAttribute("value");m[r]=f.attr("iconCls");m[s]=d.innerHTML;t.add(m);var g=f.attr("expanded");if(g){m.expanded=g=="false"?false:true}var v=f.attr("allowSelect");if(v){m.allowSelect=v=="false"?false:true}if(!c)continue;var _=mini.getChildNodes(c);var y=o(_);if(y.length>0){m[l]=y}}return t}var a=o(mini.getChildNodes(e));if(a.length>0){t.data=a}if(!t.idField&&t.valueField){t.idField=t.valueField}return t}});mini.regClass(mini.Tree,"tree");mini._TreeDragDrop=function(e){this.owner=e;this.owner.on("NodeMouseDown",this.__OnTreeNodeMouseDown,this)};mini._TreeDragDrop.prototype={destroy:function(e){mini.clearEvent(document);if(this.drag){mini.clearEvent(this.drag);this.drag.destroy(e);this.drag=null}this.owner=null;mini.clearEvent(this)},__OnTreeNodeMouseDown:function(e){var t=e.node;if(e.htmlEvent.button==mini.MouseButton.Right)return;var i=this.owner;if(i._dragging)return;if(i.isReadOnly()||i.isAllowDrag(e.node)==false)return;if(i.isEditingNode(t))return;if(!i._allowDrag(e.htmlEvent))return;this.dragData=i._getDragData();if(this.dragData.indexOf(t)==-1){this.dragData.push(t)}var n=this._getDrag();n.start(e.htmlEvent,t)},_OnDragStart:function(e,t){var i=this.owner;i._dragging=true;var n=i._OnDragStart(t);if(n.cancel)return;this.dragText=n.dragText;this.feedbackEl=mini.append(document.body,'<div class="mini-feedback"></div>');this.feedbackEl.innerHTML=this.dragText;this.lastFeedbackClass="";this.enableHotTrack=i.enableHotTrack;i.setEnableHotTrack(false)},_getDropTree:function(e){var t=mini.findParent(e.target,"mini-tree",500);if(t){return mini.get(t)}},_OnDragMove:function(e){var t=this.owner;var i=this._getDropTree(e.event);var n=e.now[0],s=e.now[1];mini.setXY(this.feedbackEl,n+15,s+18);this.dragAction="no";if(i){if(!t._allowDrag(e.event))this.dragAction="no";else{var r=i._getNodeByEvent(e.event);this.dropNode=r;if(r&&i.allowDrop==true){if(!i.isLeaf(r)){var l=r[i.nodesField];if(l&&l.length>0){}else{if(t.loadOnExpand&&r.asyncLoad!==false){i.loadNode(r)}else{}}}this.dragAction=this.getFeedback(r,s,3,i)}else{this.dragAction="no"}if(t&&i&&t!=i&&!r&&i.getChildNodes(i.root).length==0){r=i.getRootNode();this.dragAction="add";this.dropNode=r}}}this.lastFeedbackClass="mini-feedback-"+this.dragAction;this.feedbackEl.className="mini-feedback "+this.lastFeedbackClass;if(this.dragAction=="no")r=null;this.setRowFeedback(r,this.dragAction,i)},_OnDragStop:function(e){var t=this.owner;var i=this._getDropTree(e.event);t._dragging=false;mini.removeNode(this.feedbackEl);this.feedbackEl=null;this.setRowFeedback(null);var n=[];for(var s=0,r=this.dragData.length;s<r;s++){var l=this.dragData[s];var o=false;for(var a=0,h=this.dragData.length;a<h;a++){var u=this.dragData[a];if(u!=l){o=t.isAncestor(u,l);if(o)break}}if(!o){n.push(l)}}this.dragData=n;if(this.dropNode&&i&&this.dragAction!="no"){var d=t._OnDragDrop(this.dragData,this.dropNode,this.dragAction);if(d.cancel)return;var n=d.dragNodes,c=d.targetNode,f=d.action;if(t==i){t.moveNodes(n,c,f)}else{t.removeNodes(n);i.addNodes(n,c,f)}if(!this.dragData[0])return;var d={dragNode:this.dragData[0],dropNode:this.dropNode,dragAction:this.dragAction,dropParentNode:t.getParentNode(l)};t.fire("drop",d)}t.setEnableHotTrack(this.enableHotTrack);this.dropNode=null;this.dragData=null},setRowFeedback:function(e,t,i){if(this.lastAddDomNode){mini.removeClass(this.lastAddDomNode,"mini-tree-feedback-add")}if(e==null||this.dragAction=="add"){mini.removeNode(this.feedbackLine);this.feedbackLine=null}this.lastRowFeedback=e;if(e!=null){if(t=="before"||t=="after"){if(!this.feedbackLine){this.feedbackLine=mini.append(document.body,"<div class='mini-feedback-line'></div>")}this.feedbackLine.style.display="block";var n=i.getNodeBox(e);var s=n.x,r=n.y-1;if(t=="after"){r+=n.height}mini.setXY(this.feedbackLine,s,r);var l=i.getBox(true);mini.setWidth(this.feedbackLine,l.width)}else{var o=i._getNodeTitleEl(e);mini.addClass(o,"mini-tree-feedback-add");this.lastAddDomNode=o}}},getFeedback:function(e,t,i,n){var s=n.getNodeBox(e);var r=s.height;var l=t-s.y;var o=null;if(this.dragData.indexOf(e)!=-1)return"no";var a=false;if(i==3){a=n.isLeaf(e);for(var h=0,u=this.dragData.length;h<u;h++){var d=this.dragData[h];var c=n.isAncestor(d,e);if(c){o="no";break}}}if(o==null){if(a&&n.allowLeafDropIn==false){if(l>r/2)o="after";else o="before"}else{if(l>r/3*2)o="after";else if(r/3<=l&&l<=r/3*2)o="add";else o="before"}}var f=n._OnGiveFeedback(o,this.dragData,e);return f.effect},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:false,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag}};mini.TreeGrid=function(){this.columns=[];this._bottomColumns=[];this._idColumns={};this._nameColumns={};this._cellErrors=[];this._cellMapErrors={};mini.TreeGrid.superclass.constructor.call(this);this._resizeEl.style.display=this.allowResize?"":"none"};mini.extend(mini.TreeGrid,mini.Tree,{_rowIdField:"_id",width:300,height:180,minWidth:300,minHeight:150,maxWidth:5e3,maxHeight:3e3,allowResize:false,treeColumn:"",columns:[],columnWidth:80,allowResizeColumn:true,allowMoveColumn:true,_doPositoin:true,showPager:false,pageIndex:0,pageSize:10,totalCount:0,totalPage:0,_headerCellCls:"mini-treegrid-headerCell",_cellCls:"mini-treegrid-cell",_borderCls:"mini-treegrid-border",_headerCls:"mini-treegrid-header",_bodyCls:"mini-treegrid-body",_nodeCls:"mini-treegrid-node",_nodesCls:"mini-treegrid-nodes",_selectedNodeCls:"mini-treegrid-selectedNode",_nodeHoverCls:"mini-treegrid-hoverNode",_expandNodeCls:"mini-treegrid-expand",_collapseNodeCls:"mini-treegrid-collapse",_eciconCls:"mini-treegrid-ec-icon",_inNodeCls:"mini-treegrid-nodeTitle",_getNodeHoverEl:function(e){if(!e)return null;var t=this._getNodeTitleEl(e);var t=this._getNodeTitleEl(e);return t},uiCls:"mini-treegrid",_create:function(){mini.TreeGrid.superclass._create.call(this);this._footerEl=mini.append(this._borderEl,'<div class="mini-grid-footer"></div>');this._resizeEl=mini.append(this._borderEl,'<div class="mini-resizer-trigger" style=""></div>');mini.on(this._bodyEl,"scroll",this.__OnScroll,this);this._Resizer=new mini._Resizer(this);this._ColumnMove=new mini._ColumnMove(this);this._Splitter=new mini._ColumnSplitter(this);this._CellTip=new mini._CellToolTip(this);this._createPager()},_createPager:function(){this.pager=new mini.Pager;this.pager.render(this._footerEl);this.bindPager(this.pager)},bindPager:function(e){e.on("beforepagechanged",this.__OnPageChanged,this);this.on("load",function(t){e.update(this.pageIndex,this.pageSize,t.total,false);this.totalPage=e.totalPage},this)},__OnPageChanged:function(e){if(this.data.length==0&&!e.isreload){this.setPageSize(e.pageSize);return}this.gotoPage(e.pageIndex,e.pageSize)},gotoPage:function(e,t){var i={};if(mini.isNumber(e))i.pageIndex=e;if(mini.isNumber(t))i.pageSize=t;this.pageIndex=e;this.pageSize=t;this.load(this.url,i)},load:function(e,t){t=t||{};if(mini.isNull(t.pageIndex))t.pageIndex=0;if(mini.isNull(t.pageSize))t.pageSize=this.pageSize;this.url=e;this._doLoad(t,this.root)},_doLoad:function(params,node,success,fail){try{var url=eval(this.url);if(url!=undefined){this.url=url}}catch(e){}var isRoot=node==this.root;var e={url:this.url,async:this._ajaxOption.async,type:this._ajaxOption.type,params:params,data:params,cache:false,cancel:false,node:node,isRoot:isRoot};this.fire("beforeload",e);if(e.data!=e.params&&e.params!=params){e.data=e.params}if(e.cancel==true)return;if(node!=this.root){}var sf=this;var container=node;if(isRoot){mini.addClass(this._bodyEl,"mini-tree-loading");this._bodyEl.innerHTML="<div class='mini-treegrid-ec-icon'>&nbsp;</div>"}else{sf.addNodeCls(container,"mini-tree-loading")}mini.copyTo(e,{success:function(e,t,i){if(isRoot){mini.removeClass(sf._bodyEl,"mini-tree-loading");sf._bodyEl.innerHTML=""}else{sf.removeNodeCls(container,"mini-tree-loading")}var n=null;try{n=mini.decode(e)}catch(s){n=[];if(mini_debugger==true){alert("tree json is error.")}}if(sf.dataField){n=mini._getMap(sf.dataField,n)}if(!n)n=[];var s;if(n instanceof Array)s={result:n,data:n,cancel:false,node:node};else s={result:n,data:n.data,total:n.total,cancel:false,node:node};if(sf.resultAsTree==false){s.data=mini.arrayToTree(s.data,sf.nodesField,sf.idField,sf.parentField)}sf.fire("preload",s);if(s.cancel==true)return;if(isRoot){sf.setData(s.data)}if(success)success(s.data);sf._doCheckLoadNodes();sf.fire("load",s)},error:function(e,t,i){if(isRoot){mini.removeClass(sf._bodyEl,"mini-tree-loading");sf._bodyEl.innerHTML=""}else{sf.removeNodeCls(container,"mini-tree-loading")}var n={xmlHttp:e,errorCode:t};if(fail)fail(n);if(mini_debugger==true){alert("network error")}sf.fire("loaderror",n)}});this._ajaxer=mini.ajax(e)},_createColumnId:function(e){return this.uid+"$column$"+e.id},_getHeaderScrollEl:function(){return this._headerEl.firstChild},_CreateTopTr:function(e){var t="";var i=this.getBottomColumns();if(isIE){if(isIE6||isIE7||isIE8&&!jQuery.boxModel||isIE9&&!jQuery.boxModel){t+='<tr style="display:none;">'}else{t+="<tr >"}}else{t+="<tr>"}for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=r.width;var o=this._createColumnId(r)+"$"+e;t+='<td id="'+o+'" style="padding:0;border:0;margin:0;height:0;';if(r.width)t+="width:"+r.width;if(r.visible==false){t+=";display:none;"}t+='" ></td>'}t+="</tr>";return t},_doUpdateHeader:function(){var e=this.getColumnRows();var t=this.getBottomColumns();var i=t.length;var n=[];n[n.length]='<div class="mini-treegrid-headerInner"><table style="display:table" class="mini-treegrid-table" cellspacing="0" cellpadding="0">';n[n.length]=this._CreateTopTr("header");for(var s=0,r=e.length;s<r;s++){var l=e[s];n[n.length]="<tr >";for(var o=0,a=l.length;o<a;o++){var h=l[o];var u=h.header;if(typeof u=="function")u=u.call(this,h);if(mini.isNull(u)||u==="")u="&nbsp;";var d=this._createColumnId(h);n[n.length]='<td id="';n[n.length]=d;n[n.length]='" class="mini-treegrid-headerCell  '+(h.headerCls||"")+" ";if(o==a-1){n[n.length]=" mini-treegrid-last-column "}n[n.length]='" style="';var c=t.indexOf(h);if(h.visible==false){n[n.length]=";display:none;"}if(h.columns&&h.columns.length>0&&h.colspan==0){n[n.length]=";display:none;"}if(h.headerStyle){n[n.length]=h.headerStyle+";"}if(h.headerAlign){n[n.length]="text-align:"+h.headerAlign+";"}n[n.length]='" ';if(h.rowspan){n[n.length]='rowspan="'+h.rowspan+'" '}if(h.colspan){n[n.length]='colspan="'+h.colspan+'" '}n[n.length]=">";n[n.length]=u;n[n.length]="</td>"}n[n.length]="</tr>"}n[n.length]='</table><div class="mini-treegrid-topRightCell"></div></div>';var f=n.join("");this._headerEl.innerHTML=f;this._headerInnerEl=this._headerEl.firstChild;this._topRightCellEl=this._headerInnerEl.lastChild},_createNodeTitle:function(e,t,i){var n=!i;if(!i)i=[];var s=e[this.textField];if(s===null||s===undefined)s="";var r=this.isLeaf(e);var l=this.getLevel(e);var o="";if(!r){if(!this._viewNodes)o=this.isExpandedNode(e)?this._expandNodeCls:this._collapseNodeCls;else{if(this._getViewChildNodes(e).length>0)o=this.isExpandedNode(e)?this._expandNodeCls:this._collapseNodeCls}}if(this._selectedNode==e){o+=" "+this._selectedNodeCls}var a=this.getBottomColumns();i[i.length]='<table class="mini-treegrid-nodeTitle ';i[i.length]=o;i[i.length]='" cellspacing="0" cellpadding="0">';i[i.length]=this._CreateTopTr();i[i.length]="<tr>";for(var h=0,u=a.length;h<u;h++){var d=a[h];var c=this._createCellId(e,d);var f=this._OnDrawCell(e,d);var m=d.width;if(typeof m=="number")m=m+"px";i[i.length]='<td id="';i[i.length]=c;i[i.length]='" class="mini-treegrid-cell ';if(f.cellCls)i[i.length]=f.cellCls;if(h==u-1){i[i.length]=" mini-treegrid-last-column "}i[i.length]='" style="';if(f.cellStyle){i[i.length]=f.cellStyle;i[i.length]=";"}if(d.align){i[i.length]="text-align:";i[i.length]=d.align;i[i.length]=";"}if(d.visible==false){i[i.length]="display:none;"}i[i.length]='">';i[i.length]=f.cellHtml;i[i.length]="</td>";if(f.rowCls)rowCls=f.rowCls;if(f.rowStyle)rowStyle=f.rowStyle}i[i.length]="</table>";if(n)return i.join("")},doUpdate:function(){if(!this._allowUpdate)return;this._doUpdateHeader();var e=new Date;var t=this._getViewChildNodes(this.root);var i=[];this._createNodes(t,this.root,i);var n=i.join("");this._bodyEl.innerHTML=n;this._deferLayout()},getScrollLeft:function(){return this._bodyEl.scrollLeft},setShowPager:function(e){this.showPager=e},getFooterHeight:function(){return this.showPager?mini.getHeight(this._footerEl):0},doLayout:function(){if(!this.canLayout())return;var e=this.isAutoHeight();var t=this.isAutoWidth();var i=this.getWidth(true);var n=this.getHeight(true);var s=this.getHeaderHeight();this._bodyEl.style.width=i+"px";if(e){this._bodyEl.style.height="auto"}else{var r=n-s-this.getFooterHeight();this._bodyEl.style.height=r+"px"}this._doLayoutHeader();this._doLayoutTopRightCell();this.fire("layout")},_doLayoutTopRightCell:function(){var e=this._headerInnerEl.firstChild;var t=e.offsetWidth+1;var i=e.offsetHeight-1;if(i<0)i=0;this._topRightCellEl.style.height=i+"px"},_doLayoutHeader:function(){var e=this._bodyEl.scrollHeight;var t=this._bodyEl.clientHeight;var i=this.getWidth(true);var n=this._headerEl.firstChild.firstChild,s=this._bodyEl.firstChild;if(t>=e){if(s)s.style.width="100%";if(n)n.style.width="100%"}else{if(s){var r=parseInt(s.parentNode.offsetWidth-17)+"px";s.style.width=r}if(n)n.style.width=r}try{var r=this._headerEl.firstChild.firstChild.firstChild.offsetWidth;this._bodyEl.firstChild.style.width=r+"px"}catch(l){}this.__OnScroll()},getHeaderHeight:function(){return mini.getHeight(this._headerEl)},_getDragText:function(e){var t;for(var i=0;i<this.columns.length;i++){if(this.columns[i].name&&this.columns[i].name==this.treeColumn){t=this.columns[i].field;break}}if(t){var n=mini._getMap(t,e[0]);if(this.autoEscape==true){return mini.htmlEncode(n)}return n}return""},_OnDrawCell:function(e,t){var i=this.showCheckBox;if(i&&this.hasChildren(e)){i=this.showFolderCheckBox}var n=mini._getMap(t.field,e);var s={isLeaf:this.isLeaf(e),rowIndex:this.indexOf(e),showCheckBox:i,iconCls:this.getNodeIcon(e),showTreeIcon:this.showTreeIcon,sender:this,record:e,row:e,node:e,column:t,field:t?t.field:null,value:n,cellHtml:n,rowCls:null,cellCls:t?t.cellCls||"":"",rowStyle:null,cellStyle:t?t.cellStyle||"":""};if(t.dateFormat){if(mini.isDate(s.value))s.cellHtml=mini.formatDate(n,t.dateFormat);else s.cellHtml=n}var r=t.renderer;if(r){fn=typeof r=="function"?r:window[r];if(fn){s.cellHtml=fn.call(t,s)}}this.fire("drawcell",s);if(s.cellHtml===null||s.cellHtml===undefined||s.cellHtml==="")s.cellHtml="&nbsp;";if(!this.treeColumn||this.treeColumn!==t.name)return s;this._doTreeColumn(s);return s},_doTreeColumn:function(e){var t=e.node;if(mini.isNull(e.showTreeIcon))e.showTreeIcon=this.showTreeIcon;var i=e.cellHtml;if(this.autoEscape){i=mini.htmlEncode(i)}var n=this.isLeaf(t);var s=this.getLevel(t);var r=s*18;var l="";if(e.cellCls){e.cellCls+=" mini-treegrid-treecolumn "}else{e.cellCls=" mini-treegrid-treecolumn "}var o='<div class="mini-treegrid-treecolumn-inner '+l+'">';var a=this.getParentNode(t);var h=0;for(var u=h;u<=s;u++){if(u==s)continue;if(n){if(this.showExpandButtons==false&&u>=s-1){continue}}var d="";if(this._isInViewLastNode(t,u)){d="background:none;"}o+='<span class="mini-treegrid-indent " style="'+d+"left:"+u*18+'px;"></span>'}var c="";if(this._isViewFirstNode(t)&&this._isViewLastNode(t)){c=this._eciconCls+"-last";if(a==this.root){c=this._eciconCls+"-firstLast"}}else{if(this._isViewFirstNode(t)&&a&&a!=this.root){c=""}else if(this._isViewFirstNode(t)){c=this._eciconCls+"-first"}else if(this._isViewLastNode(t)){c=this._eciconCls+"-last"}}if(!n){o+='<a href="#" onclick="return false;"  hidefocus class="'+this._eciconCls+" "+c+'" style="left:'+r+'px;"></a>'}else{o+='<span class="'+this._eciconCls+" "+c+'" style="left:'+r+'px;" ></span>'}r+=18;if(e.showTreeIcon){var f=this.getNodeIcon(t);o+='<div class="'+f+' mini-treegrid-nodeicon" style="left:'+r+'px;"></div>';r+=18}i='<span class="mini-tree-nodetext">'+i+"</span>";if(e.showCheckBox){var m=this._createCheckNodeId(t);var p=this.isCheckedNode(t);i='<input type="checkbox" id="'+m+'" class="'+this._checkBoxCls+'" hidefocus '+(p?"checked":"")+"/>"+i}o+='<div class="mini-treegrid-nodeshow" style="margin-left:'+(r+2)+'px;">'+i+"</div>";o+="</div>";i=o;e.cellHtml=i},setTreeColumn:function(e){if(this.treeColumn!=e){this.treeColumn=e;this.doUpdate()}},getTreeColumn:function(e){return this.treeColumn},setAllowResizeColumn:function(e){this.allowResizeColumn=e},getAllowResizeColumn:function(e){return this.allowResizeColumn},setAllowMoveColumn:function(e){this.allowMoveColumn=e},getAllowMoveColumn:function(e){return this.allowMoveColumn},setAllowResize:function(e){this.allowResize=e;this._resizeEl.style.display=this.allowResize?"":"none"},getAllowResize:function(){return this.allowResize},_createCellId:function(e,t){return this.uid+"$"+e._id+"$"+t._id},setColumnWidth:function(e,t){e=this.getColumn(e);if(!e)return;if(mini.isNumber(t))t+="px";e.width=t;this.doUpdate()},getColumnWidth:function(e){var t=this.getColumnBox(e);return t?t.width:0},__OnScroll:function(e){
    var t=this._bodyEl.scrollLeft;this._headerEl.firstChild.scrollLeft=t},_allowDrag:function(e){var t=mini.findParent(e.target,"mini-treegrid-treecolumn");if(t)return true;return false},getAttrs:function(e){var t=mini.TreeGrid.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["treeColumn","ondrawcell"]);mini._ParseBool(e,t,["allowResizeColumn","allowMoveColumn","allowResize","showPager"]);var i=mini.getChildNodes(e);for(var n=0,s=i.length;n<s;n++){var r=i[n];var l=jQuery(r).attr("property");if(!l)continue;l=l.toLowerCase();if(l=="columns"){t.columns=mini._ParseColumns(r)}}delete t.data;return t}});mini.copyTo(mini.TreeGrid.prototype,mini_Column_Prototype);mini.copyTo(mini.TreeGrid.prototype,mini_CellValidator_Prototype);mini.regClass(mini.TreeGrid,"treegrid");mini.TreeSelect=function(){this.data=[];mini.TreeSelect.superclass.constructor.call(this)};mini.extend(mini.TreeSelect,mini.PopupEdit,{_ajaxOption:{async:true,type:"get"},valueFromSelect:false,text:"",value:"",autoCheckParent:false,expandOnLoad:false,valueField:"id",textField:"text",nodesField:"children",delimiter:",",showClose:true,multiSelect:false,data:[],url:"",allowInput:false,showTreeIcon:false,showTreeLines:true,resultAsTree:false,parentField:"pid",checkRecursive:false,showFolderCheckBox:true,popupHeight:200,popupWidth:200,popupMaxHeight:250,popupMinWidth:100,set:function(e){if(typeof e=="string"){return this}var t=e.value,i=e.text,n=e.url,s=e.data,r=e.code;delete e.value;delete e.text;delete e.url;delete e.data;delete e.code;if(!e.onvaluechanged)this.defaultValueTriggerChange=false;mini.TreeSelect.superclass.set.call(this,e);if(!mini.isNull(s)){this.setData(s)}else if(!mini.isNull(n)){this.setUrl(n)}else if(!mini.isNull(r)){n=mini.globalOpts.codeUrl+r;this.setUrl(n)}if(!mini.isNull(t)){this.setValue(t,this.defaultValueTriggerChange)}if(!mini.isNull(i)){this.setText(i)}this.tree.cache=this.cache;return this},uiCls:"mini-treeselect",destroy:function(e){if(this.tree){mini.clearEvent(this.tree);this.tree.destroy(e);this.tree=null}this._destroyQueryToolBar();delete this.data;mini.TreeSelect.superclass.destroy.call(this,e)},uiCls:"mini-treeselect",_createPopup:function(){mini.TreeSelect.superclass._createPopup.call(this);this._createQueryToolBar();this.tree=new mini.Tree;this.tree.set({delimiter:this.delimiter});this.tree.setShowTreeIcon(true);this.tree.setStyle("border:0;width:100%;height:100%;");if(this.showQueryToolBar){this.popup.setStyle("overflow:hidden;")}this.tree.setResultAsTree(this.resultAsTree);this.tree.render(this.popup._contentEl);this.tree.setCheckRecursive(this.checkRecursive);this.tree.setShowFolderCheckBox(this.showFolderCheckBox);this.tree.on("nodeclick",this.__OnNodeClick,this);this.tree.on("nodecheck",this.__OnCheckedChanged,this);this.tree.on("expand",this.__OnTreeExpand,this);this.tree.on("collapse",this.__OnTreeCollapse,this);this.tree.on("beforenodecheck",this.__OnTreeBeforeNodeCheck,this);this.tree.on("beforenodeselect",this.__OnTreeBeforeNodeSelect,this);this.tree.allowAnim=false;var e=this;this.tree.on("beforeload",function(t){e.fire("beforeload",t)},this);this.tree.on("load",this.__OnTreeLoad,this);this.tree.on("loaderror",function(t){e.fire("loaderror",t)},this);this.tree.on("drawnode",function(t){e.fire("drawnode",t)},this)},__OnTreeLoad:function(e){if(this.isAsync()&&this._value)this.setValue(this._value,this.defaultValueTriggerChange,this.text);delete this._value;this.fire("load",e)},__OnTreeBeforeNodeCheck:function(e){e.tree=e.sender;this.fire("beforenodecheck",e)},__OnTreeBeforeNodeSelect:function(e){e.tree=e.sender;this.fire("beforenodeselect",e)},__OnTreeExpand:function(e){},__OnTreeCollapse:function(e){},__OnPopupKeyDown:function(e){if(e.keyCode==27||e.keyCode==13){this.hidePopup();this.focus()}},getSelectedNode:function(){return this.tree.getSelectedNode()},getCheckedNodes:function(e){return this.tree.getCheckedNodes(e)},getSelectedNodes:function(){return this.tree.getSelectedNodes()},getParentNode:function(e){return this.tree.getParentNode(e)},getChildNodes:function(e){return this.tree.getChildNodes(e)},showPopup:function(){if(mini.TreeSelect.superclass.showPopup.call(this)===false)return;if(this.showQueryToolBar){this.tree.setHeight(this.popup.getHeight()-35)}this.tree.setValue(this.value)},__OnPopupHide:function(e){this.__doFocusCls();if(this.tree)this.tree.clearFilter();this.fire("hidepopup")},getItem:function(e){return typeof e=="object"?e:this.data[e]},indexOf:function(e){return this.data.indexOf(e)},getAt:function(e){return this.data[e]},loadList:function(e,t,i){this.tree.loadList(e,t,i);this.data=this.tree.getData()},getList:function(){return this.tree.getList()},load:function(e){if(this.isAsync()&&this._value==undefined)this._value=this.value;this.tree.load(e)},setData:function(e){if(typeof e=="string"){e=this._eval(e)}if(!mini.isArray(e))e=[];e=mini.clone(e);this.tree.setData(e);this.data=this.tree.getData()},_eval:function(_){return eval("("+_+")")},getData:function(){return this.data},setUrl:function(e){this.getPopup();this.tree.cache=this.cache;this.tree.setUrl(this.parseUrl(e));this.url=this.tree.url;if(this.isAsync()&&this._value==undefined)this._value=this.value},getUrl:function(){return this.url},setTextField:function(e){if(this.tree)this.tree.setTextField(e);this.textField=e},getTextField:function(){return this.textField},setNodesField:function(e){if(this.tree)this.tree.setNodesField(e);this.nodesField=e},getNodesField:function(){return this.nodesField},isAsync:function(){return this._ajaxOption.async==true},setValue:function(e,t,i){if(this.isAsync())this._value=e;var n=this.getValue();var s=this.tree.getValueAndText(e);if(s[1]==""&&!this.valueFromSelect){s[0]=e;s[1]=i===undefined?e:i}this.value=s[0];this._valueEl.value=s[0];this.text=this._textEl.value=s[1];this._doEmpty();this.tree.setValue(this.value);if(!mini.isEquals(this.value,n)){if(t===undefined)t=true;if(t)this._OnValueChanged()}},setMultiSelect:function(e){if(this.multiSelect!=e){this.multiSelect=e;this.tree.setShowCheckBox(e);this.tree.setAllowSelect(!e);this.tree.setEnableHotTrack(!e)}},getMultiSelect:function(){return this.multiSelect},__OnInputTextChanged:function(){var e=this._textEl.value;var t=this.getValue();var i=this.tree.getSelectedNode();if(!i)this.setValue(e)},__OnNodeClick:function(e){if(this.multiSelect)return;var t=this.tree.getSelectedNode();var i=this.tree.getItemValue(t);var n=this.getValue();this.setValue(i);this.hidePopup();this.focus();this.fire("nodeclick",{node:e.node})},__OnCheckedChanged:function(e){if(!this.multiSelect)return;var t=this.tree.getValue();var i=this.getValue();this.setValue(t);this.fire("nodecheck",e)},__OnInputKeyDown:function(e){this.fire("keydown",{htmlEvent:e});if(e.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(e.keyCode==9){this.hidePopup();return}if(this.isReadOnly())return;switch(e.keyCode){case 27:if(this.isShowPopup()){e.stopPropagation()}this.hidePopup();break;case 13:var t=this;this.hidePopup();setTimeout(function(){t.fire("enter",e)},10);break;case 37:break;case 38:e.preventDefault();break;case 39:break;case 40:e.preventDefault();this.showPopup();break;default:if(this.isReadOnly()||this.allowInput==false){break}if(this.allowInput){this.tree._selectedNode=null;this.value=""}var t=this;setTimeout(function(){t._doQuery()},10);break}},_doQuery:function(){var e=this.textField;var t=this._textEl.value.toLowerCase();this.tree.filter(function(i){var n=String(i[e]?i[e]:"").toLowerCase();if(n.indexOf(t)!=-1){return true}else return false});this.tree.expandAll();this.showPopup()},setCheckRecursive:function(e){this.checkRecursive=e;if(this.tree)this.tree.setCheckRecursive(e)},getCheckRecursive:function(){return this.checkRecursive},setResultAsTree:function(e){this.resultAsTree=e;if(this.tree)this.tree.setResultAsTree(e)},getResultAsTree:function(){return this.resultAsTree},setParentField:function(e){this.parentField=e;if(this.tree)this.tree.setParentField(e)},getParentField:function(){return this.parentField},setValueField:function(e){if(this.tree)this.tree.setIdField(e);this.valueField=e},getValueField:function(){return this.valueField},setShowTreeIcon:function(e){this.showTreeIcon=e;if(this.tree)this.tree.setShowTreeIcon(e)},getShowTreeIcon:function(){return this.showTreeIcon},setShowTreeLines:function(e){this.showTreeLines=e;if(this.tree)this.tree.setShowTreeLines(e)},getShowTreeLines:function(){return this.showTreeLines},setShowFolderCheckBox:function(e){this.showFolderCheckBox=e;if(this.tree)this.tree.setShowFolderCheckBox(e)},getShowFolderCheckBox:function(){return this.showFolderCheckBox},setAutoCheckParent:function(e){this.autoCheckParent=e;if(this.tree)this.tree.setAutoCheckParent(e)},getAutoCheckParent:function(){return this.autoCheckParent},setExpandOnLoad:function(e){this.expandOnLoad=e;if(this.tree)this.tree.setExpandOnLoad(e)},getExpandOnLoad:function(){return this.expandOnLoad},setValueFromSelect:function(e){this.valueFromSelect=e},getValueFromSelect:function(){return this.valueFromSelect},setDataField:function(e){if(this.tree)this.tree.setDataField(e);this.dataField=e},setQueryField:function(e){this.tree.queryfield=e},getAttrs:function(e){var t=mini.TreeSelect.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["url","data","textField","valueField","nodesField","parentField","onnodecheck","onbeforenodecheck","onbeforenodeselect","expandOnLoad","onnodeclick","onbeforeload","onload","onloaderror","ondrawnode","queryField"]);mini._ParseBool(e,t,["multiSelect","resultAsTree","checkRecursive","showTreeIcon","showTreeLines","showFolderCheckBox","autoCheckParent","showQueryToolBar","valueFromSelect"]);if(t.expandOnLoad){var i=parseInt(t.expandOnLoad);if(mini.isNumber(i)){t.expandOnLoad=i}else{t.expandOnLoad=t.expandOnLoad=="true"?true:false}}return t}});mini.regClass(mini.TreeSelect,"TreeSelect");mini.Window=function(){mini.Window.superclass.constructor.call(this);this.addCls("mini-window");this.setVisible(false);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Window,mini.Panel,{x:0,y:0,state:"restore",_dragCls:"mini-window-drag",_resizeCls:"mini-window-resize",allowDrag:true,showCloseButton:true,showMaxButton:false,showMinButton:false,showCollapseButton:false,effect:"none",showModal:true,minWidth:150,minHeight:80,maxWidth:2e3,maxHeight:2e3,uiCls:"mini-window",_create:function(){mini.Window.superclass._create.call(this)},_initButtons:function(){this.buttons=[];var e=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(e);var t=this.createButton({name:"max",cls:"mini-tools-max",visible:this.showMaxButton});this.buttons.push(t);var i=this.createButton({name:"min",cls:"mini-tools-min",visible:this.showMinButton});this.buttons.push(i);var n=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(n)},_initEvents:function(){mini.Window.superclass._initEvents.call(this);mini._BindEvents(function(){mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);mini.on(this.el,"mousedown",this.__OnWindowMouseDown,this)},this)},doLayout:function(){if(!this.canLayout())return;if(this.state=="max"){var e=this.getParentBox();this.el.style.left="0px";this.el.style.top="0px";mini.setSize(this.el,e.width,e.height)}mini.Window.superclass.doLayout.call(this);if(this.allowDrag){mini.addClass(this.el,this._dragCls)}if(this.state=="max"){this._resizeGridEl.style.display="none";mini.removeClass(this.el,this._dragCls)}this._doModal()},_doModal:function(){var e=this.showModal&&this.isDisplay()&&this.visible;if(!this._modalEl&&this.showModal==false)return;if(!this._modalEl){this._modalEl=mini.append(document.body,'<div class="mini-modal mini-fixed" style="display:none"></div>')}function t(){mini.repaint(document.body);var t=document.documentElement;var i=parseInt(Math.max(document.body.scrollWidth,t?t.scrollWidth:0));var n=parseInt(Math.max(document.body.scrollHeight,t?t.scrollHeight:0));var s=mini.getViewportBox();var r=s.height;if(r<n)r=n;var l=s.width;if(l<i)l=i;this._modalEl.style.display=e?"block":"none";this._modalEl.style.height=r+"px";this._modalEl.style.width=l+"px";this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1}if(e){var i=this;if(i._modalEl){i._modalEl.style.display="block";i._modalEl.style.zIndex=mini.getStyle(i.el,"zIndex")-1}}else{this._modalEl.style.display="none"}},getParentBox:function(){var e=mini.getViewportBox();var t=this._containerEl||document.body;if(t!=document.body){e=mini.getBox(t)}e.scrollTop=t.scrollTop;e.scrollLeft=t.scrollLeft;e.scrollWidth=t.scrollWidth;e.scrollHeight=t.scrollHeight;return e},setShowModal:function(e){this.showModal=e},getShowModal:function(){return this.showModal},setMinWidth:function(e){if(isNaN(e))return;this.minWidth=e},getMinWidth:function(){return this.minWidth},setMinHeight:function(e){if(isNaN(e))return;this.minHeight=e},getMinHeight:function(){return this.minHeight},setMaxWidth:function(e){if(isNaN(e))return;this.maxWidth=e},getMaxWidth:function(){return this.maxWidth},setMaxHeight:function(e){if(isNaN(e))return;this.maxHeight=e},getMaxHeight:function(){return this.maxHeight},setAllowDrag:function(e){this.allowDrag=e;mini.removeClass(this.el,this._dragCls);if(e){mini.addClass(this.el,this._dragCls)}},getAllowDrag:function(){return this.allowDrag},setShowMaxButton:function(e){this.showMaxButton=e;var t=this.getButton("max");t.visible=e;this._doTools()},getShowMaxButton:function(){return this.showMaxButton},setShowMinButton:function(e){this.showMinButton=e;var t=this.getButton("min");t.visible=e;this._doTools()},getShowMinButton:function(){return this.showMinButton},max:function(){this.state="max";this.show();var e=this.getButton("max");if(e){e.cls="mini-tools-restore";this._doTools()}},restore:function(){this.state="restore";this.show(this.x,this.y);var e=this.getButton("max");if(e){e.cls="mini-tools-max";this._doTools()}},containerEl:null,showAtPos:function(e,t,i){this.show(e,t,i)},show:function(e,t,i){this._allowLayout=false;var n=this._containerEl||document.body;if(!this.isRender()||this.el.parentNode!=n){this.render(n)}this.el.style.zIndex=mini.getMaxZIndex();this._doShow(e,t);this._allowLayout=true;if(this.effect=="none"||this.effect!="fast"&&this.effect!="slow")this.setVisible(true);else{this.visible=true;var s=this;s.doLayout();this.el.style.display="none";$(this.el).fadeTo(this.effect,1,function(){if(isIE)this.style.removeAttribute("filter")})}try{this.el.focus()}catch(r){}},hide:function(){this.fire("beforehide");this.state="restore";delete this._width;delete this._height;var e=this;if(this.effect=="none"||this.effect!="fast"&&this.effect!="slow")this.setVisible(false);else{$(this.el).fadeTo(this.effect,0,function(){if(isIE)this.style.removeAttribute("filter");e.setVisible(false)})}this._doModal()},getWidth:function(){this._headerEl.style.width="50px";var e=mini.getWidth(this.el);this._headerEl.style.width="auto";return e},getBox:function(){this._headerEl.style.width="50px";this.el.style.display="";var e=mini.getWidth(this.el);this._headerEl.style.width="auto";var t=mini.getBox(this.el);t.width=e;t.right=t.x+e;return t},_measureSize:function(){var e=this.getBox();if(e.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);e=this.getBox()}if(e.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);e=this.getBox()}if(e.width<this.minWidth){mini.setWidth(this.el,this.minWidth);e=this.getBox()}if(e.height<this.minHeight){mini.setHeight(this.el,this.minHeight);e=this.getBox()}},setWidth:function(e){this.state="restore";delete this._width;mini.Window.superclass.setWidth.call(this,e)},setHeight:function(e){this.state="restore";delete this._height;mini.Window.superclass.setHeight.call(this,e)},_doShow:function(e,t){var i=this.getParentBox();if(this.state=="max"){if(!this._width){var n=this.getBox();this._width=n.width;this._height=n.height;this.x=n.x;this.y=n.y}}else{if(mini.isNull(e))e="center";if(mini.isNull(t))t="middle";this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";if(this._width){this.setWidth(this._width);this.setHeight(this._height)}else{this.setWidth(this.width);this.setHeight(this.height)}this._measureSize();var n=this.getBox();if(e=="left")e=0;if(e=="center")e=i.scrollLeft+i.width/2-n.width/2;if(e=="right")e=i.scrollLeft+i.width-n.width;if(t=="top")t=0;if(t=="middle")t=i.scrollTop+i.y+i.height/2-n.height/2;if(t=="bottom")t=i.scrollTop+i.height-n.height;if(e+n.width>i.scrollWidth)e=i.right-n.width;if(t+n.height>i.scrollHeight)t=i.bottom-n.height;if(e<0)e=0;if(t<0)t=0;this.el.style.display="";mini.setX(this.el,e);mini.setY(this.el,t);this.el.style.left=e+"px";this.el.style.top=t+"px";this.x=n.x;this.y=n.y}this.doLayout()},_OnButtonClick:function(e,t){var i=mini.Window.superclass._OnButtonClick.call(this,e,t);if(i.cancel==true)return i;if(i.name=="max"){if(this.state=="max"){this.restore()}else{this.max()}}return i},__OnWindowResize:function(e){if(this.state=="max"){this.doLayout()}},__OnWindowMouseDown:function(e){var t=this;if(this.state!="max"&&this.allowDrag&&mini.isAncestor(this._headerEl,e.target)&&!mini.findParent(e.target,"mini-tools")){var t=this;if(this.el){this.el.style.zIndex=mini.getMaxZIndex()}var i=this.getBox();var n=new mini.Drag({capture:true,onStart:function(){t._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask"></div>');t._dragProxy=mini.append(document.body,'<div class="mini-drag-proxy"></div>');t.el.style.display="none"},onMove:function(e){var n=e.now[0]-e.init[0],s=e.now[1]-e.init[1];n=i.x+n;s=i.y+s;var r=t.getParentBox();var l=n+i.width;var o=s+i.height;if(l>r.scrollWidth)n=r.scrollWidth-i.width;if(o>r.scrollHeight)s=r.scrollHeight-i.height;if(n<0)n=0;if(s<0)s=0;t.x=n;t.y=s;var a={x:n,y:s,width:i.width,height:i.height};mini.setBox(t._dragProxy,a);this.moved=true},onStop:function(){t.el.style.display="block";if(this.moved){var e=mini.getBox(t._dragProxy);mini.setXY(t.el,e.x,e.y)}jQuery(t._maskProxy).remove();t._maskProxy=null;jQuery(t._dragProxy).remove();t._dragProxy=null}});n.start(e)}},destroy:function(e){mini.un(window,"resize",this.__OnWindowResize,this);delete this.buttons;if(this._modalEl){jQuery(this._modalEl).remove();this._modalEl=null}if(this.shadowEl){jQuery(this.shadowEl).remove();this.shadowEl=null}mini.Window.superclass.destroy.call(this,e)},getAttrs:function(e){var t=mini.Window.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["modalStyle","effect","onbeforehide"]);mini._ParseBool(e,t,["showModal","showShadow","allowDrag","allowResize","showMaxButton","showMinButton"]);mini._ParseInt(e,t,["minWidth","minHeight","maxWidth","maxHeight"]);return t},showAtEl:function(e,t){e=mini.byId(e);if(!e)return;if(!this.isRender()||this.el.parentNode!=document.body){this.render(document.body)}var i={xAlign:this.xAlign,yAlign:this.yAlign,xOffset:0,yOffset:0,popupCls:this.popupCls};mini.copyTo(i,t);this._popupEl=e;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var n=mini.getViewportBox();var s=this.getBox();var r=mini.getBox(e);var l=i.xy;var o=i.xAlign,a=i.yAlign;var h=n.width/2-s.width/2,u=0;if(l){h=l[0];u=l[1]}switch(i.xAlign){case"outleft":h=r.x-s.width;break;case"left":h=r.x;break;case"center":h=r.x+r.width/2-s.width/2;break;case"right":h=r.right-s.width;break;case"outright":h=r.right;break;default:break}switch(i.yAlign){case"above":u=r.y-s.height;break;case"top":u=r.y;break;case"middle":u=r.y+r.height/2-s.height/2;break;case"bottom":u=r.bottom-s.height;break;case"below":u=r.bottom;break;default:break}h=parseInt(h);u=parseInt(u);if(i.outYAlign||i.outXAlign){if(i.outYAlign=="above"){if(u+s.height>n.bottom){var d=r.y-n.y;var c=n.bottom-r.bottom;if(d>c){u=r.y-s.height}}}if(i.outXAlign=="outleft"){if(h+s.width>n.right){var f=r.x-n.x;var m=n.right-r.right;if(f>m){h=r.x-s.width}}}if(i.outXAlign=="right"){if(h+s.width>n.right){h=r.right-s.width}}this._Show(h,u)}else{this.showAtPos(h+i.xOffset,u+i.yOffset)}}});mini.regClass(mini.Window,"window");mini.OutlookTree=function(){mini.OutlookTree.superclass.constructor.call(this);this.data=[]};mini.extend(mini.OutlookTree,mini.OutlookBar,{url:"",textField:"text",iconField:"iconCls",urlField:"url",resultAsTree:false,nodesField:"children",idField:"id",parentField:"pid",style:"width:100%;height:100%;",set:function(e){if(typeof e=="string"){return this}var t=e.url;delete e.url;var i=e.activeIndex;delete e.activeIndex;mini.OutlookTree.superclass.set.call(this,e);if(t){this.setUrl(t)}if(mini.isNumber(i)){this.setActiveIndex(i)}return this},uiCls:"mini-outlooktree",destroy:function(e){if(this._trees){var t=this._trees.clone();for(var i=0,n=t.length;i<n;i++){var s=t[i];s.destroy()}this._trees.length=0}mini.OutlookTree.superclass.destroy.call(this,e)},_doParseFields:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];n.text=n[this.textField];n.url=n[this.urlField];n.iconCls=n[this.iconField]}},_doLoad:function(){var e=[];try{e=mini.getData(this.url)}catch(t){if(mini_debugger==true){alert("outlooktree json is error.")}}if(this.dataField){e=mini._getMap(this.dataField,e)}if(!e)e=[];if(this.resultAsTree==false){e=mini.arrayToTree(e,this.nodesField,this.idField,this.parentField)}var i=mini.treeToArray(e,this.nodesField,this.idField,this.parentField);this._doParseFields(i);this.createNavBarTree(e);this.fire("load")},loadList:function(e,t,i){t=t||this.idField;i=i||this.parentField;this._doParseFields(e);var n=mini.arrayToTree(e,this.nodesField,t,i);this.load(n)},load:function(e){if(typeof e=="undefined"){this.setUrl(this.url)}else if(typeof e=="string"){this.setUrl(e)}else{var t;if(this.resultAsTree==false){t=mini.arrayToTree(e,this.nodesField,this.idField,this.parentField)}var i=mini.treeToArray(t,this.nodesField,this.idField,this.parentField);this._doParseFields(i);this.createNavBarTree(t)}},setData:function(e){this.load(e)},setUrl:function(e){this.url=this.parseUrl(e);this._doLoad()},getUrl:function(){return this.url},setTextField:function(e){this.textField=e},getTextField:function(){return this.textField},setIconField:function(e){this.iconField=e},getIconField:function(){return this.iconField},setUrlField:function(e){this.urlField=e},getUrlField:function(){return this.urlField},setResultAsTree:function(e){this.resultAsTree=e},getResultAsTree:function(){return this.resultAsTree},setNodesField:function(e){this.nodesField=e},getNodesField:function(){return this.nodesField},setIdField:function(e){this.idField=e},getIdField:function(){return this.idField},setParentField:function(e){this.parentField=e},getParentField:function(){return this.parentField},_selected:null,getSelected:function(){return this._selected},selectNode:function(e){e=this.getNode(e);if(!e)return;var t=this._getOwnerTree(e);t.selectNode(e)},expandPath:function(e){e=this.getNode(e);if(!e)return;var t=this._getOwnerTree(e);t.expandPath(e);this.expandGroup(t._ownerGroup)},findNodes:function(e,t){var i=[];t=t||this;for(var n=0,s=this._trees.length;n<s;n++){var r=this._trees[n];var l=r.findNodes(e,t);i.addRange(l)}return i},getNode:function(e){for(var t=0,i=this._trees.length;t<i;t++){var n=this._trees[t];var s=n.getNode(e);if(s)return s}return null},getList:function(){var e=[];for(var t=0,i=this._trees.length;t<i;t++){var n=this._trees[t];var s=n.getList();e.addRange(s)}return e},_getOwnerTree:function(e){if(!e)return;for(var t=0,i=this._trees.length;t<i;t++){var n=this._trees[t];if(n._idNodes[e._id])return n}},expandOnLoad:false,setExpandOnLoad:function(e){this.expandOnLoad=e},getExpandOnLoad:function(){return this.expandOnLoad},getAttrs:function(e){var t=mini.OutlookTree.superclass.getAttrs.call(this,e);t.text=e.innerHTML;mini._ParseString(e,t,["url","textField","urlField","idField","parentField","nodesField","iconField","onnodeclick","onnodeselect","onnodemousedown","expandOnLoad"]);mini._ParseBool(e,t,["resultAsTree"]);if(t.expandOnLoad){var i=parseInt(t.expandOnLoad);if(mini.isNumber(i)){t.expandOnLoad=i}else{t.expandOnLoad=t.expandOnLoad=="true"?true:false}}return t},autoCollapse:true,activeIndex:0,createNavBarTree:function(e){if(!mini.isArray(e))e=[];this.data=e;var t=[];for(var i=0,n=this.data.length;i<n;i++){var s=this.data[i];var r={};r.title=s.text;r.iconCls=s.iconCls;t.push(r);r._children=s[this.nodesField]}this.setGroups(t);if(this.getExpandOnLoad())this.setActiveIndex(this.activeIndex);this._trees=[];for(var i=0,n=this.groups.length;i<n;i++){var r=this.groups[i];var l=this.getGroupBodyEl(r);var e=new mini.Tree;e.set({expandOnLoad:this.expandOnLoad,showTreeIcon:true,style:"width:100%;height:100%;border:0;background:none",data:r._children});e.render(l);e.on("nodeclick",this.__OnNodeClick,this);e.on("nodeselect",this.__OnNodeSelect,this);e.on("nodemousedown",this.__OnNodeMouseDown,this);this._trees.push(e);delete r._children;e._ownerGroup=r}this.doLayout()},__OnNodeMouseDown:function(e){var t={node:e.node,isLeaf:e.sender.isLeaf(e.node),htmlEvent:e.htmlEvent};this.fire("nodemousedown",t)},__OnNodeClick:function(e){var t={node:e.node,isLeaf:e.sender.isLeaf(e.node),htmlEvent:e.htmlEvent};this.fire("nodeclick",t)},__OnNodeSelect:function(e){if(!e.node)return;for(var t=0,i=this._trees.length;t<i;t++){var n=this._trees[t];if(n!=e.sender){n.selectNode(null)}}var s={node:e.node,isLeaf:e.sender.isLeaf(e.node),htmlEvent:e.htmlEvent};this._selected=e.node;this.fire("nodeselect",s)}});mini.regClass(mini.OutlookTree,"outlooktree");mini.NavBarTree=function(){mini.NavBarTree.superclass.constructor.call(this)};mini.extend(mini.NavBarTree,mini.OutlookTree,{uiCls:"mini-navbartree"});mini.regClass(mini.NavBarTree,"navbartree");mini.Separator=function(){mini.Separator.superclass.constructor.call(this)};mini.extend(mini.Separator,mini.Control,{_clearBorder:false,uiCls:"mini-separator",_create:function(){this.el=document.createElement("span");this.el.className="mini-separator"}});mini.regClass(mini.Separator,"separator");mini.ToolTip=function(){mini.ToolTip.superclass.constructor.call(this)};mini.extend(mini.ToolTip,mini.Control,{selector:"[title]",placement:"bottom",trigger:"hover focus",uiCls:"mini-tooltip",_create:function(){this.el=jQuery('<div class="mini-tooltip"><div class="mini-tooltip-arrow"></div><div class="mini-tooltip-inner"></div></div>')[0];this.$element=jQuery(this.el);this.$element.appendTo(document.body)},_initEvents:function(){},_bindTooltip:function(){this.el.style.padding="";var e=jQuery(document),t=this.selector,i="tooltip";var n=this.trigger.split(" ");for(var s=n.length;s--;){var r=n[s];if(r=="click"){e.delegate(t,"click."+i,$.proxy(this._toggle,this))}else if(r!="manual"){var l=r=="hover"?"mouseenter":"focus";var o=r=="hover"?"mouseleave":"blur";e.delegate(t,l+"."+i,$.proxy(this._enter,this));e.delegate(t,o+"."+i,$.proxy(this._leave,this))}}},setSelector:function(e){this.selector=e;this._bindTooltip()},getSelector:function(){return this.selector},setPlacement:function(e){this.placement=e},getPlacement:function(){return this.placement},_enter:function(e){this.open(e.target)},_leave:function(e){this.close()},_toggle:function(e){if(this._getTip().css("display")=="none"){this.enter(e)}else{this.leave(e)}},open:function(e){var e=$(e)[0]||this.target,t=$(e),i=this.getContent(e);var n={element:e,content:i,cancel:!i};this.fire("beforeopen",n);if(n.cancel)return;this.$element.show();this._target=e;this.setContent(n.content);this.fire("open",{element:e})},close:function(){this._target=null;this.$element.hide()},showLoading:function(){this.setContent('<div class="mini-tooltip-loading"></div>')},setContent:function(e){this.$element.children(".mini-tooltip-inner").html(e||"&nbsp;");this.applyPlacement()},getContent:function(e){var t=e.title;if(t){$(e).attr("data-tooltip",t).attr("title","")}if(!t){t=$(e).attr("data-tooltip")}return t},applyPlacement:function(){if(!this._target)return;if(this.$element.css("display")=="none")return;var e=this._target,t=jQuery(e),i=t.attr("data-placement")||this.placement,n=this.$element;n.show().css({left:"-2000px",top:"-2000px"});function s(e){n.removeClass("mini-tooltip-left mini-tooltip-top mini-tooltip-right mini-tooltip-bottom mini-tooltip-bottomleft mini-tooltip-topleft mini-tooltip-bottomright mini-tooltip-topright").addClass("mini-tooltip-"+e)}function r(e){n.offset(e)}var l=mini.getBox(e);var o=mini.getViewportBox();var a=l.top-o.top,h=o.bottom-l.bottom;s(i);var u=mini.getBox(n[0]);var d=mini.getCalculatedOffset(i,l,u.width,u.height);if(i=="left"){}else if(i=="right"){}else if(i=="top"){}else if(i=="bottom"){}else if(i=="bottomleft"&&a>h){if(d.top+u.height>o.bottom){i="topleft"}}else if(i=="topleft"){}s(i);d=mini.getCalculatedOffset(i,l,u.width,u.height);r(d)},getAttrs:function(e){var t=mini.ToolTip.superclass.getAttrs.call(this,e);mini._ParseString(e,t,["selector","placement","onbeforeopen","onopen","onclose"]);return t}});mini.regClass(mini.ToolTip,"tooltip");mini._allComponents={};(function(){var e,t,i,n;for(t in mini){e=mini[t];if(typeof e=="function"&&e.prototype.isControl){mini._allComponents[t]=[e]}}for(t in mini._allComponents){e=mini._allComponents[t];if(e[0].superclass){i=e[0].superclass.constructor;for(n in mini._allComponents){if(mini._allComponents[n][0]==i){mini._allComponents[n].push(t)}}}}})();mini.plugin=function(e,t){if(e&&t){var i;for(i in t){mini._plugin(e,i,t[i])}}};mini._plugin=function(e,t,i){var n,s,r;if(typeof e=="string")n=mini._allComponents[e];else{for(s in mini._allComponents){if(mini._allComponents[s][0]===e){n=mini._allComponents[s]}}}e=n[0];for(var l=1,o=n.length;l<o;l++){r=mini[n[l]];if(r&&r.prototype&&e.prototype[t]===r.prototype[t]){mini._plugin(n[l],t,i)}}e.prototype[t]=i};mini.plugin(mini.TreeSelect,{showQueryToolBar:false,_createQueryToolBar:function(){if(this.showQueryToolBar&&!this.queryToolbar){this.queryToolbar=new mini.ToolBar;this.queryToolbar.render(this.popup._contentEl,"prepend");this.queryInput=new mini.TextBox;this.queryInput.setEmptyText("请录入查询条件");this.queryInput.setWidth(50);this.queryInput.render(this.queryToolbar.el);this.queryInput.on("enter",this._queryEvent,this);this.queryButton=new mini.Button;this.queryButton.setText("查询");this.queryButton.setPlain(true);this.queryButton.setStyle("margin-left:2px;");this.queryButton.render(this.queryToolbar.el);this.queryButton.onClick(this._queryEvent,this);this.on("showpopup",function(){var e=this.queryToolbar.getWidth();this.queryInput.setWidth(e-58)})}},_destroyQueryToolBar:function(e){if(this.queryInput){mini.clearEvent(this.queryInput);this.queryInput.destroy(e);this.queryInput=null}if(this.queryButton){mini.clearEvent(this.queryButton);this.queryButton.destroy(e);this.queryButton=null}if(this.queryToolbar){mini.clearEvent(this.queryToolbar);this.queryToolbar.destroy(e);this.queryToolbar=null}},_queryEvent:function(e){var t=this.queryInput.getValue();var i=this;if(t&&t.trim()){var n=null;this.tree.filter(function(e){var i=mini._getMap(this.queryfield,e);if(i==null||i==undefined)i="";i=String(i).toLowerCase();if(e[this.textField].toLowerCase().indexOf(t.toLowerCase())!=-1||e[this.idField].toLowerCase().indexOf(t.toLowerCase())!=-1||i.indexOf(t.toLowerCase())!=-1){if(!n||e[this.parentField]==n[this.idField]){n=e}return true}});if(n){this.tree.expandPath(n)}}else{this.tree.clearFilter()}},setShowQueryToolBar:function(e){this.showQueryToolBar=e;if(!this.queryToolbar)return;if(e){this.queryToolbar.el.style.display=""}else{this.queryToolbar.el.style.display="none"}},getShowQueryToolBar:function(){return this.showQueryToolBar},doUpdate:function(){mini.TreeSelect.superclass.doUpdate.call(this);this._createQueryToolBar()}});mini.locale="en-US";mini.dateInfo={monthsLong:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],daysLong:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["日","一","二","三","四","五","六"],quarterLong:["一季度","二季度","三季度","四季度"],
    quarterShort:["Q1","Q2","Q2","Q4"],halfYearLong:["上半年","下半年"],patterns:{d:"yyyy-M-d",D:"yyyy年M月d日",f:"yyyy年M月d日 H:mm",F:"yyyy年M月d日 H:mm:ss",g:"yyyy-M-d H:mm",G:"yyyy-M-d H:mm:ss",m:"MMMd日",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm",T:"H:mm:ss",U:"yyyy年M月d日 HH:mm:ss",y:"yyyy年MM月"},tt:{AM:"上午",PM:"下午"},ten:{Early:"上旬",Mid:"中旬",Late:"下旬"},today:"今天",clockType:24};if(mini.Calendar){mini.copyTo(mini.Calendar.prototype,{firstDayOfWeek:0,todayText:"今天",clearText:"清除",okText:"确定",cancelText:"取消",daysShort:["日","一","二","三","四","五","六"],format:"yyyy年MM月",timeFormat:"H:mm"})}for(var id in mini){var clazz=mini[id];if(clazz&&clazz.prototype&&clazz.prototype.isControl){clazz.prototype.requiredErrorText="不能为空"}}if(mini.TextBox){var vtypeErrorTexts={emailErrorText:"请输入邮件格式",urlErrorText:"请输入URL格式",floatErrorText:"请输入数字",intErrorText:"请输入整数",dateErrorText:"请输入日期格式 {0}",maxLengthErrorText:"不能超过 {0} 个字符",minLengthErrorText:"不能少于 {0} 个字符",maxErrorText:"数字不能大于 {0} ",minErrorText:"数字不能小于 {0} ",rangeLengthErrorText:"字符长度必须在 {0} 到 {1} 之间",rangeCharErrorText:"字符数必须在 {0} 到 {1} 之间",rangeErrorText:"数字必须在 {0} 到 {1} 之间",rangeDecimalsErrorText:"请保留小数点后 {0} 位小数."};mini.copyTo(mini.TextBox.prototype,vtypeErrorTexts);mini.copyTo(mini.Password.prototype,vtypeErrorTexts);mini.copyTo(mini.TextArea.prototype,vtypeErrorTexts)}if(mini.Pager){mini.copyTo(mini.Pager.prototype,{firstText:"首页",prevText:"上一页",nextText:"下一页",lastText:"尾页",pageInfoText:"每页 {0} 条, 共 {1} 条"})}if(window.mini.Gantt){mini.GanttView.ShortWeeks=["日","一","二","三","四","五","六"];mini.GanttView.LongWeeks=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];mini.Gantt.PredecessorLinkType=[{ID:0,Name:"完成-完成(FF)",Short:"FF"},{ID:1,Name:"完成-开始(FS)",Short:"FS"},{ID:2,Name:"开始-完成(SF)",Short:"SF"},{ID:3,Name:"开始-开始(SS)",Short:"SS"}];mini.Gantt.ConstraintType=[{ID:0,Name:"越早越好"},{ID:1,Name:"越晚越好"},{ID:2,Name:"必须开始于"},{ID:3,Name:"必须完成于"},{ID:4,Name:"不得早于...开始"},{ID:5,Name:"不得晚于...开始"},{ID:6,Name:"不得早于...完成"},{ID:7,Name:"不得晚于...完成"}];mini.copyTo(mini.Gantt,{ID_Text:"标识号",Name_Text:"任务名称",PercentComplete_Text:"进度",Duration_Text:"工期",Start_Text:"开始日期",Finish_Text:"完成日期",Critical_Text:"关键任务",PredecessorLink_Text:"前置任务",Work_Text:"工时",Priority_Text:"重要级别",Weight_Text:"权重",OutlineNumber_Text:"大纲字段",OutlineLevel_Text:"任务层级",ActualStart_Text:"实际开始日期",ActualFinish_Text:"实际完成日期",WBS_Text:"WBS",ConstraintType_Text:"限制类型",ConstraintDate_Text:"限制日期",Department_Text:"部门",Principal_Text:"负责人",Assignments_Text:"资源名称",Summary_Text:"摘要任务",Task_Text:"任务",Baseline_Text:"比较基准",LinkType_Text:"链接类型",LinkLag_Text:"延隔时间",From_Text:"从",To_Text:"到",Goto_Text:"转到任务",UpGrade_Text:"升级",DownGrade_Text:"降级",Add_Text:"新增",Edit_Text:"编辑",Remove_Text:"删除",Move_Text:"移动",ZoomIn_Text:"放大",ZoomOut_Text:"缩小",Deselect_Text:"取消选择",Split_Text:"拆分任务"})}if(typeof define==="function"&&define.amd){define("miniui",["jquery"],function(){return mini})}